[
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging buckets (30/60/90+ days) for unpaid invoices by customer\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Use ARTH for transaction data and ARCM for customer names\n2. Filter PayFullDate IS NULL to get only unpaid invoices\n3. Use DATEDIFF and CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to count records in gljr by company\n\nDatabase Schema:\nCREATE TABLE GLJR (\n  GLCo bcompany NOT NULL,\n  Jrnl bjrnl NOT NULL,\n  Description btransdesc,\n  Rev byn NOT NULL,\n  RevJrnl bjrnl,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count GLJR records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM GLJR WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "GLJR"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from APTD\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from APTD ().\n\n```sql\nSELECT *\nFROM APTD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from PRTH\n\nDatabase Schema:\nCREATE TABLE PRTH (\n  PRCo bcompany NOT NULL,\n  PRGroup bgroup NOT NULL,\n  PREndDate bdate NOT NULL,\n  Employee bemployee NOT NULL,\n  PaySeq tinyint NOT NULL,\n  PostSeq smallint NOT NULL,\n  Type char(1) NOT NULL,\n  PostDate bdate NOT NULL,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCDept bdept,\n  GLCo bcompany NOT NULL,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equipment bequip,\n  EMGroup tinyint,\n  CostCode bcostcode,\n  -- ... 41 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from PRTH ().\n\n```sql\nSELECT *\nFROM PRTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "PRTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from GLCO\n\nDatabase Schema:\nCREATE TABLE GLCO (\n  GLCo bcompany NOT NULL,\n  Consolid byn NOT NULL,\n  LastMthSubClsd bmonth NOT NULL,\n  LastMthGLClsd bmonth NOT NULL,\n  MaxOpen tinyint NOT NULL,\n  CashAccrual char(1) NOT NULL,\n  Unbal byn NOT NULL,\n  AuditCoParams byn NOT NULL,\n  AuditAccts byn NOT NULL,\n  AuditAutoJrnl byn NOT NULL,\n  AuditBals byn NOT NULL,\n  AuditBudgets byn NOT NULL,\n  AuditDetail byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  XCompJrnlEntryYN byn NOT NULL,\n  KeyID bigint NOT NULL,\n  LastMthAPClsd bmonth NOT NULL,\n  LastMthARClsd bmonth NOT NULL,\n  AttachBatchReportsYN byn NOT NULL,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from GLCO ().\n\n```sql\nSELECT *\nFROM GLCO WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "GLCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get data from SLHD for analysis\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'SLHD' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nJCJM, JCCD\n\nTo include SLHD in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to count records in gldt by company\n\nDatabase Schema:\nCREATE TABLE GLDT (\n  GLCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  GLTrans btrans NOT NULL,\n  GLAcct bglacct NOT NULL,\n  Jrnl bjrnl NOT NULL,\n  GLRef bglref NOT NULL,\n  SourceCo bcompany NOT NULL,\n  Source bsource NOT NULL,\n  ActDate bdate NOT NULL,\n  DatePosted bdate NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid NOT NULL,\n  Amount bdollar NOT NULL,\n  RevStatus tinyint NOT NULL,\n  Adjust char(1) NOT NULL,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  UniqueAttchID uniqueidentifier,\n  SrcTable varchar(128),\n  SrcKeyID bigint,\n  PRIMARY KEY (GLCo, Mth, GLTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count GLDT records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM GLDT WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "GLDT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoice totals with discounts and retainage\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Vendor invoice summary with discounts and retainage:\n1. Join APTH to APVM for vendor details\n2. Aggregate by vendor\n3. Include GrossAmt, DiscOffer, Retainage, and Balance\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(APTH.APTrans) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS GrossAmount,\n  SUM(APTH.DiscOffer) AS DiscountsOffered,\n  SUM(APTH.Retainage) AS RetainageHeld,\n  SUM(APTH.Balance) AS OpenBalance\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "basic",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate stored materials (Purchased - Installed) for SL billing\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Stored materials for SL billing:\n1. SLWI contains work item/billing details\n2. StoredMatls = Purchased - Installed (materials on-site but not yet used)\n3. WCCost = Work Completed Cost\n4. WCRetAmt and SMRetAmt = separate retainage for work vs materials\n5. Total billable = WCCost + StoredMatls\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description AS ItemDescription,\n  SLWI.StoredMatls,\n  SLWI.WCCost AS WorkCompletedCost,\n  SLWI.StoredMatls + SLWI.WCCost AS TotalBillable,\n  SLWI.WCRetAmt AS WorkRetainage,\n  SLWI.SMRetAmt AS MaterialsRetainage,\n  SLWI.WCRetAmt + SLWI.SMRetAmt AS TotalRetainage\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\n  AND SLWI.StoredMatls <> 0\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "basic",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get subcontractor costs with original, change orders, invoiced, paid, and retainage by vendor\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Subcontractor cost breakdown by vendor:\n1. Join SLHD (Header) to SLIT (Items) for subcontract details\n2. Join APVM for vendor names\n3. OrigCost = original contract amount\n4. CurCost - OrigCost = change order amounts\n5. InvCost = amounts invoiced\n6. Retainage = amounts held back\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  SLHD.SL AS SubcontractNum,\n  SLHD.Description AS SubcontractDesc,\n  SUM(SLIT.OrigCost) AS OriginalCost,\n  SUM(SLIT.CurCost - SLIT.OrigCost) AS ChangeOrderCost,\n  SUM(SLIT.CurCost) AS CurrentCost,\n  SUM(SLIT.InvCost) AS InvoicedCost,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost - SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nINNER JOIN APVM WITH (NOLOCK) ON SLHD.VendorGroup = APVM.VendorGroup AND SLHD.Vendor = APVM.Vendor\nWHERE SLHD.SLCo = @SLCo\nGROUP BY APVM.Vendor, APVM.Name, SLHD.SL, SLHD.Description\nORDER BY APVM.Name, SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "intermediate",
      "tables_used": [
        "SLHD",
        "SLIT",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to count records in preh by company\n\nDatabase Schema:\nCREATE TABLE PREH (\n  PRCo bcompany NOT NULL,\n  Employee bemployee NOT NULL,\n  LastName varchar(30) NOT NULL,\n  FirstName varchar(30),\n  MidName varchar(15),\n  SortName bsortname NOT NULL,\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  Phone bphone,\n  SSN char(11) NOT NULL,\n  Race char(2) NOT NULL,\n  Sex char(1) NOT NULL,\n  BirthDate smalldatetime,\n  HireDate bdate,\n  TermDate bdate,\n  PRGroup bgroup NOT NULL,\n  PRDept bdept NOT NULL,\n  -- ... 121 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count PREH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM PREH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "PREH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to join PREH with the available tables\n\nDatabase Schema:\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'PREH' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nSLHD, SLIT\n\nTo include PREH in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to join GLDT with the available tables\n\nDatabase Schema:\nCREATE TABLE PREH (\n  PRCo bcompany NOT NULL,\n  Employee bemployee NOT NULL,\n  LastName varchar(30) NOT NULL,\n  FirstName varchar(30),\n  MidName varchar(15),\n  SortName bsortname NOT NULL,\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  Phone bphone,\n  SSN char(11) NOT NULL,\n  Race char(2) NOT NULL,\n  Sex char(1) NOT NULL,\n  BirthDate smalldatetime,\n  HireDate bdate,\n  TermDate bdate,\n  PRGroup bgroup NOT NULL,\n  PRDept bdept NOT NULL,\n  -- ... 121 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nCREATE TABLE PRTH (\n  PRCo bcompany NOT NULL,\n  PRGroup bgroup NOT NULL,\n  PREndDate bdate NOT NULL,\n  Employee bemployee NOT NULL,\n  PaySeq tinyint NOT NULL,\n  PostSeq smallint NOT NULL,\n  Type char(1) NOT NULL,\n  PostDate bdate NOT NULL,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCDept bdept,\n  GLCo bcompany NOT NULL,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equipment bequip,\n  EMGroup tinyint,\n  CostCode bcostcode,\n  -- ... 41 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'GLDT' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nPREH, PRTH\n\nTo include GLDT in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query to reconcile ap oncost batch lines with original transactions\n\nDatabase Schema:\nCREATE TABLE APTL (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equip bequip,\n  EMGroup bgroup,\n  -- ... 56 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans, APLine)\n);\n\nCREATE TABLE APLB (\n  Co bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  BatchId bbatchid NOT NULL,\n  BatchSeq int NOT NULL,\n  APLine smallint NOT NULL,\n  BatchTransType char(1) NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  -- ... 120 more columns,\n  PRIMARY KEY (Co, Mth, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APHB (\n  Co bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  BatchId bbatchid NOT NULL,\n  BatchSeq int NOT NULL,\n  BatchTransType char(1) NOT NULL,\n  APTrans btrans,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  -- ... 88 more columns,\n  PRIMARY KEY (Co, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To reconcile AP oncost batches with original transactions:\n1. Join APLB (batch lines) to APTL (original lines) using ocApplyMth, ocApplyTrans, ocApplyLine\n2. Include APHB for batch header info\n3. Join to APTH and APVM for vendor context\n4. Compare batch vs original amounts\n\n```sql\nSELECT \n  APLB.Co AS BatchCo,\n  APLB.Mth AS BatchMth,\n  APLB.BatchId,\n  APLB.BatchSeq,\n  APLB.ocApplyMth,\n  APLB.ocApplyTrans,\n  APLB.ocApplyLine,\n  APTL.APCo AS OrigCo,\n  APTL.Mth AS OrigMth,\n  APTL.APTrans AS OrigTrans,\n  APTL.APLine AS OrigLine,\n  APTL.GrossAmt AS OrigAmount,\n  APLB.GrossAmt AS BatchAmount,\n  APVM.Name AS VendorName\nFROM APLB WITH (NOLOCK)\nINNER JOIN APHB WITH (NOLOCK) ON APLB.Co = APHB.Co AND APLB.Mth = APHB.Mth AND APLB.BatchId = APHB.BatchId\nINNER JOIN APTL WITH (NOLOCK) ON APLB.ocApplyMth = APTL.Mth \n  AND APLB.ocApplyTrans = APTL.APTrans \n  AND APLB.ocApplyLine = APTL.APLine\n  AND APLB.Co = APTL.APCo\nINNER JOIN APTH WITH (NOLOCK) ON APTL.APCo = APTH.APCo AND APTL.Mth = APTH.Mth AND APTL.APTrans = APTH.APTrans\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APLB.Co = @Co\nORDER BY APLB.BatchId, APLB.BatchSeq\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "basic",
      "tables_used": [
        "APLB",
        "APHB",
        "APTL",
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get customer balance summary by customer group\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Customer balance summary by group:\n1. Join ARTH to ARCM for customer details\n2. Use conditional SUM for open vs total balances\n3. Group by CustGroup for summary\n\n```sql\nSELECT \n  ARTH.CustGroup,\n  COUNT(DISTINCT ARTH.Customer) AS CustomerCount,\n  SUM(CASE WHEN ARTH.PayFullDate IS NULL THEN ARTH.Amount ELSE 0 END) AS OpenBalance,\n  SUM(ARTH.Amount) AS TotalBilled\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\nGROUP BY ARTH.CustGroup\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from ARTH\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from ARTH ().\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoices with their subcontract details\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I can partially answer this query, but the schema is incomplete.\n\nTo include subcontract details, the SLHD table is needed but not provided in the schema.\n\nHere's what I can provide with the available schema:\n\n```sql\nSELECT *\nFROM APTH WITH (NOLOCK)\nWHERE Co = @Co\n-- Note: Additional joins for SLHD would be needed for complete results\n```\n\nTo get the complete data you requested, please provide the DDL for SLHD.",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": [
        "APTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: What columns are in the SubcontractHeader table?\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'SubcontractHeader' does not exist in Viewpoint Vista.\n\nUse SLHD (SL Header) for subcontract headers.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM SLHD WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: count records in prtd by company\n\nDatabase Schema:\nCREATE TABLE PRTD (\n  PRCo bcompany NOT NULL,\n  Craft bcraft NOT NULL,\n  Class bclass NOT NULL,\n  Template smallint NOT NULL,\n  DLCode bedlcode NOT NULL,\n  Factor brate NOT NULL,\n  OldRate bunitcost NOT NULL,\n  NewRate bunitcost NOT NULL,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count PRTD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM PRTD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "PRTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate stored materials (Purchased - Installed) for SL billing\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Stored materials for SL billing:\n1. SLWI contains work item/billing details\n2. StoredMatls = Purchased - Installed (materials on-site but not yet used)\n3. WCCost = Work Completed Cost\n4. WCRetAmt and SMRetAmt = separate retainage for work vs materials\n5. Total billable = WCCost + StoredMatls\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description AS ItemDescription,\n  SLWI.StoredMatls,\n  SLWI.WCCost AS WorkCompletedCost,\n  SLWI.StoredMatls + SLWI.WCCost AS TotalBillable,\n  SLWI.WCRetAmt AS WorkRetainage,\n  SLWI.SMRetAmt AS MaterialsRetainage,\n  SLWI.WCRetAmt + SLWI.SMRetAmt AS TotalRetainage\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\n  AND SLWI.StoredMatls <> 0\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find jobs over budget with remaining cost projection\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Find jobs over budget:\n1. Aggregate JCCP by job from JCJM\n2. Compare total ActualCost to CurrEstCost\n3. Use HAVING to filter only over-budget jobs\n4. Sort by amount over budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description,\n  SUM(JCCP.CurrEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.CurrEstCost) - SUM(JCCP.ActualCost) AS RemainingBudget,\n  CASE WHEN SUM(JCCP.CurrEstCost) < SUM(JCCP.ActualCost) \n       THEN 'OVER BUDGET' ELSE 'OK' END AS Status\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\nGROUP BY JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.CurrEstCost)\nORDER BY (SUM(JCCP.ActualCost) - SUM(JCCP.CurrEstCost)) DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM",
        "JCCD",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How do I track ap hold status distinguishing retainage vs non-retainage holds\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APCO (\n  APCo bcompany NOT NULL,\n  GLCo bcompany NOT NULL,\n  ExpJrnl bjrnl,\n  GLExpInterfaceLvl tinyint NOT NULL,\n  GLExpSummaryDesc varchar(60),\n  GLExpTransDesc varchar(60),\n  GLJobDetailDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLEquipDetailDesc varchar(60),\n  GLExpDetailDesc varchar(60),\n  PayJrnl bjrnl,\n  GLPayInterfaceLvl tinyint NOT NULL,\n  GLPayDetailDesc varchar(60),\n  GLPaySummaryDesc varchar(60),\n  DiscOffGLAcct bglacct,\n  DiscTakenGLAcct bglacct,\n  ExpPayType tinyint,\n  JobPayType tinyint,\n  SubPayType tinyint,\n  RetPayType tinyint,\n  -- ... 92 more columns,\n  PRIMARY KEY (APCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To distinguish retainage vs non-retainage holds:\n1. Join APTD to APHD for hold details\n2. Join APCO to get RetHoldCode setting\n3. Compare APHD.HoldCode to APCO.RetHoldCode\n4. If equal, it's a retainage hold; otherwise non-retainage\n\n```sql\nSELECT \n  APTD.APCo,\n  APTD.Vendor,\n  APTD.Mth,\n  APTD.APTrans,\n  APHD.HoldCode,\n  CASE WHEN APHD.HoldCode = APCO.RetHoldCode \n       THEN 'Retainage Hold' \n       ELSE 'Non-Retainage Hold' END AS HoldType,\n  APTD.Amount\nFROM APTD WITH (NOLOCK)\nINNER JOIN APHD WITH (NOLOCK) ON APTD.APCo = APHD.APCo \n  AND APTD.Mth = APHD.Mth \n  AND APTD.APTrans = APHD.APTrans \n  AND APTD.APLine = APHD.APLine\nINNER JOIN APCO WITH (NOLOCK) ON APTD.APCo = APCO.APCo\nWHERE APTD.APCo = @APCo\n  AND APHD.HoldCode IS NOT NULL\nORDER BY APTD.Vendor, APTD.Mth\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "basic",
      "tables_used": [
        "APTD",
        "APHD",
        "APCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from JCCD\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from JCCD ().\n\n```sql\nSELECT *\nFROM JCCD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoice totals with discounts and retainage\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Vendor invoice summary with discounts and retainage:\n1. Join APTH to APVM for vendor details\n2. Aggregate by vendor\n3. Include GrossAmt, DiscOffer, Retainage, and Balance\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(APTH.APTrans) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS GrossAmount,\n  SUM(APTH.DiscOffer) AS DiscountsOffered,\n  SUM(APTH.Retainage) AS RetainageHeld,\n  SUM(APTH.Balance) AS OpenBalance\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get job cost variance by phase comparing budget to actual\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Job cost variance by phase:\n1. Join JCJM (Job Master) to JCCP (Cost Phase)\n2. Calculate variance as CurrEstCost - ActualCost\n3. Calculate percent complete from actuals vs budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  JCCP.Phase,\n  JCCP.CostType,\n  JCCP.OrigEstCost AS OriginalBudget,\n  JCCP.CurrEstCost AS CurrentBudget,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS Variance,\n  CASE WHEN JCCP.CurrEstCost <> 0 \n       THEN (JCCP.ActualCost / JCCP.CurrEstCost) * 100 \n       ELSE 0 END AS PercentComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.Job = @Job\nORDER BY JCCP.Phase, JCCP.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query to count records in slhd by company\n\nDatabase Schema:\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count SLHD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM SLHD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "SLHD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to track ap hold status distinguishing retainage vs non-retainage holds\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APCO (\n  APCo bcompany NOT NULL,\n  GLCo bcompany NOT NULL,\n  ExpJrnl bjrnl,\n  GLExpInterfaceLvl tinyint NOT NULL,\n  GLExpSummaryDesc varchar(60),\n  GLExpTransDesc varchar(60),\n  GLJobDetailDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLEquipDetailDesc varchar(60),\n  GLExpDetailDesc varchar(60),\n  PayJrnl bjrnl,\n  GLPayInterfaceLvl tinyint NOT NULL,\n  GLPayDetailDesc varchar(60),\n  GLPaySummaryDesc varchar(60),\n  DiscOffGLAcct bglacct,\n  DiscTakenGLAcct bglacct,\n  ExpPayType tinyint,\n  JobPayType tinyint,\n  SubPayType tinyint,\n  RetPayType tinyint,\n  -- ... 92 more columns,\n  PRIMARY KEY (APCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To distinguish retainage vs non-retainage holds:\n1. Join APTD to APHD for hold details\n2. Join APCO to get RetHoldCode setting\n3. Compare APHD.HoldCode to APCO.RetHoldCode\n4. If equal, it's a retainage hold; otherwise non-retainage\n\n```sql\nSELECT \n  APTD.APCo,\n  APTD.Vendor,\n  APTD.Mth,\n  APTD.APTrans,\n  APHD.HoldCode,\n  CASE WHEN APHD.HoldCode = APCO.RetHoldCode \n       THEN 'Retainage Hold' \n       ELSE 'Non-Retainage Hold' END AS HoldType,\n  APTD.Amount\nFROM APTD WITH (NOLOCK)\nINNER JOIN APHD WITH (NOLOCK) ON APTD.APCo = APHD.APCo \n  AND APTD.Mth = APHD.Mth \n  AND APTD.APTrans = APHD.APTrans \n  AND APTD.APLine = APHD.APLine\nINNER JOIN APCO WITH (NOLOCK) ON APTD.APCo = APCO.APCo\nWHERE APTD.APCo = @APCo\n  AND APHD.HoldCode IS NOT NULL\nORDER BY APTD.Vendor, APTD.Mth\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "basic",
      "tables_used": [
        "APTD",
        "APHD",
        "APCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: count records in jccd by company\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count JCCD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM JCCD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from GLDT\n\nDatabase Schema:\nCREATE TABLE GLDT (\n  GLCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  GLTrans btrans NOT NULL,\n  GLAcct bglacct NOT NULL,\n  Jrnl bjrnl NOT NULL,\n  GLRef bglref NOT NULL,\n  SourceCo bcompany NOT NULL,\n  Source bsource NOT NULL,\n  ActDate bdate NOT NULL,\n  DatePosted bdate NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid NOT NULL,\n  Amount bdollar NOT NULL,\n  RevStatus tinyint NOT NULL,\n  Adjust char(1) NOT NULL,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  UniqueAttchID uniqueidentifier,\n  SrcTable varchar(128),\n  SrcKeyID bigint,\n  PRIMARY KEY (GLCo, Mth, GLTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from GLDT ().\n\n```sql\nSELECT *\nFROM GLDT WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "GLDT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to reconcile ap oncost batch lines with original transactions\n\nDatabase Schema:\nCREATE TABLE APTL (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equip bequip,\n  EMGroup bgroup,\n  -- ... 56 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans, APLine)\n);\n\nCREATE TABLE APLB (\n  Co bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  BatchId bbatchid NOT NULL,\n  BatchSeq int NOT NULL,\n  APLine smallint NOT NULL,\n  BatchTransType char(1) NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  -- ... 120 more columns,\n  PRIMARY KEY (Co, Mth, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APHB (\n  Co bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  BatchId bbatchid NOT NULL,\n  BatchSeq int NOT NULL,\n  BatchTransType char(1) NOT NULL,\n  APTrans btrans,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  -- ... 88 more columns,\n  PRIMARY KEY (Co, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To reconcile AP oncost batches with original transactions:\n1. Join APLB (batch lines) to APTL (original lines) using ocApplyMth, ocApplyTrans, ocApplyLine\n2. Include APHB for batch header info\n3. Join to APTH and APVM for vendor context\n4. Compare batch vs original amounts\n\n```sql\nSELECT \n  APLB.Co AS BatchCo,\n  APLB.Mth AS BatchMth,\n  APLB.BatchId,\n  APLB.BatchSeq,\n  APLB.ocApplyMth,\n  APLB.ocApplyTrans,\n  APLB.ocApplyLine,\n  APTL.APCo AS OrigCo,\n  APTL.Mth AS OrigMth,\n  APTL.APTrans AS OrigTrans,\n  APTL.APLine AS OrigLine,\n  APTL.GrossAmt AS OrigAmount,\n  APLB.GrossAmt AS BatchAmount,\n  APVM.Name AS VendorName\nFROM APLB WITH (NOLOCK)\nINNER JOIN APHB WITH (NOLOCK) ON APLB.Co = APHB.Co AND APLB.Mth = APHB.Mth AND APLB.BatchId = APHB.BatchId\nINNER JOIN APTL WITH (NOLOCK) ON APLB.ocApplyMth = APTL.Mth \n  AND APLB.ocApplyTrans = APTL.APTrans \n  AND APLB.ocApplyLine = APTL.APLine\n  AND APLB.Co = APTL.APCo\nINNER JOIN APTH WITH (NOLOCK) ON APTL.APCo = APTH.APCo AND APTL.Mth = APTH.Mth AND APTL.APTrans = APTH.APTrans\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APLB.Co = @Co\nORDER BY APLB.BatchId, APLB.BatchSeq\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "basic",
      "tables_used": [
        "APLB",
        "APHB",
        "APTL",
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoice totals with discounts and retainage\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Vendor invoice summary with discounts and retainage:\n1. Join APTH to APVM for vendor details\n2. Aggregate by vendor\n3. Include GrossAmt, DiscOffer, Retainage, and Balance\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(APTH.APTrans) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS GrossAmount,\n  SUM(APTH.DiscOffer) AS DiscountsOffered,\n  SUM(APTH.Retainage) AS RetainageHeld,\n  SUM(APTH.Balance) AS OpenBalance\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: SELECT * FROM TimecardHeader\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'TimecardHeader' does not exist in Viewpoint Vista.\n\nUse PRTH (PR Timecard Header) for timecard headers.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM PRTH WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get customer balance summary by customer group\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Customer balance summary by group:\n1. Join ARTH to ARCM for customer details\n2. Use conditional SUM for open vs total balances\n3. Group by CustGroup for summary\n\n```sql\nSELECT \n  ARTH.CustGroup,\n  COUNT(DISTINCT ARTH.Customer) AS CustomerCount,\n  SUM(CASE WHEN ARTH.PayFullDate IS NULL THEN ARTH.Amount ELSE 0 END) AS OpenBalance,\n  SUM(ARTH.Amount) AS TotalBilled\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\nGROUP BY ARTH.CustGroup\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging buckets (30/60/90+ days) for unpaid invoices by customer\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Use ARTH for transaction data and ARCM for customer names\n2. Filter PayFullDate IS NULL to get only unpaid invoices\n3. Use DATEDIFF and CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from APTH\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from APTH ().\n\n```sql\nSELECT *\nFROM APTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get job cost variance by phase comparing budget to actual\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Job cost variance by phase:\n1. Join JCJM (Job Master) to JCCP (Cost Phase)\n2. Calculate variance as CurrEstCost - ActualCost\n3. Calculate percent complete from actuals vs budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  JCCP.Phase,\n  JCCP.CostType,\n  JCCP.OrigEstCost AS OriginalBudget,\n  JCCP.CurrEstCost AS CurrentBudget,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS Variance,\n  CASE WHEN JCCP.CurrEstCost <> 0 \n       THEN (JCCP.ActualCost / JCCP.CurrEstCost) * 100 \n       ELSE 0 END AS PercentComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.Job = @Job\nORDER BY JCCP.Phase, JCCP.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Query PREH along with the schema tables\n\nDatabase Schema:\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'PREH' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nSLHD, SLIT\n\nTo include PREH in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to reconcile ap oncost batch lines with original transactions\n\nDatabase Schema:\nCREATE TABLE APTL (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equip bequip,\n  EMGroup bgroup,\n  -- ... 56 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans, APLine)\n);\n\nCREATE TABLE APLB (\n  Co bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  BatchId bbatchid NOT NULL,\n  BatchSeq int NOT NULL,\n  APLine smallint NOT NULL,\n  BatchTransType char(1) NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  -- ... 120 more columns,\n  PRIMARY KEY (Co, Mth, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APHB (\n  Co bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  BatchId bbatchid NOT NULL,\n  BatchSeq int NOT NULL,\n  BatchTransType char(1) NOT NULL,\n  APTrans btrans,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  -- ... 88 more columns,\n  PRIMARY KEY (Co, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To reconcile AP oncost batches with original transactions:\n1. Join APLB (batch lines) to APTL (original lines) using ocApplyMth, ocApplyTrans, ocApplyLine\n2. Include APHB for batch header info\n3. Join to APTH and APVM for vendor context\n4. Compare batch vs original amounts\n\n```sql\nSELECT \n  APLB.Co AS BatchCo,\n  APLB.Mth AS BatchMth,\n  APLB.BatchId,\n  APLB.BatchSeq,\n  APLB.ocApplyMth,\n  APLB.ocApplyTrans,\n  APLB.ocApplyLine,\n  APTL.APCo AS OrigCo,\n  APTL.Mth AS OrigMth,\n  APTL.APTrans AS OrigTrans,\n  APTL.APLine AS OrigLine,\n  APTL.GrossAmt AS OrigAmount,\n  APLB.GrossAmt AS BatchAmount,\n  APVM.Name AS VendorName\nFROM APLB WITH (NOLOCK)\nINNER JOIN APHB WITH (NOLOCK) ON APLB.Co = APHB.Co AND APLB.Mth = APHB.Mth AND APLB.BatchId = APHB.BatchId\nINNER JOIN APTL WITH (NOLOCK) ON APLB.ocApplyMth = APTL.Mth \n  AND APLB.ocApplyTrans = APTL.APTrans \n  AND APLB.ocApplyLine = APTL.APLine\n  AND APLB.Co = APTL.APCo\nINNER JOIN APTH WITH (NOLOCK) ON APTL.APCo = APTH.APCo AND APTL.Mth = APTH.Mth AND APTL.APTrans = APTH.APTrans\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APLB.Co = @Co\nORDER BY APLB.BatchId, APLB.BatchSeq\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "basic",
      "tables_used": [
        "APLB",
        "APHB",
        "APTL",
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate stored materials (Purchased - Installed) for SL billing\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Stored materials for SL billing:\n1. SLWI contains work item/billing details\n2. StoredMatls = Purchased - Installed (materials on-site but not yet used)\n3. WCCost = Work Completed Cost\n4. WCRetAmt and SMRetAmt = separate retainage for work vs materials\n5. Total billable = WCCost + StoredMatls\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description AS ItemDescription,\n  SLWI.StoredMatls,\n  SLWI.WCCost AS WorkCompletedCost,\n  SLWI.StoredMatls + SLWI.WCCost AS TotalBillable,\n  SLWI.WCRetAmt AS WorkRetainage,\n  SLWI.SMRetAmt AS MaterialsRetainage,\n  SLWI.WCRetAmt + SLWI.SMRetAmt AS TotalRetainage\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\n  AND SLWI.StoredMatls <> 0\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need to aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to reconcile ap oncost batch lines with original transactions\n\nDatabase Schema:\nCREATE TABLE APTL (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equip bequip,\n  EMGroup bgroup,\n  -- ... 56 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans, APLine)\n);\n\nCREATE TABLE APLB (\n  Co bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  BatchId bbatchid NOT NULL,\n  BatchSeq int NOT NULL,\n  APLine smallint NOT NULL,\n  BatchTransType char(1) NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  -- ... 120 more columns,\n  PRIMARY KEY (Co, Mth, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APHB (\n  Co bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  BatchId bbatchid NOT NULL,\n  BatchSeq int NOT NULL,\n  BatchTransType char(1) NOT NULL,\n  APTrans btrans,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  -- ... 88 more columns,\n  PRIMARY KEY (Co, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To reconcile AP oncost batches with original transactions:\n1. Join APLB (batch lines) to APTL (original lines) using ocApplyMth, ocApplyTrans, ocApplyLine\n2. Include APHB for batch header info\n3. Join to APTH and APVM for vendor context\n4. Compare batch vs original amounts\n\n```sql\nSELECT \n  APLB.Co AS BatchCo,\n  APLB.Mth AS BatchMth,\n  APLB.BatchId,\n  APLB.BatchSeq,\n  APLB.ocApplyMth,\n  APLB.ocApplyTrans,\n  APLB.ocApplyLine,\n  APTL.APCo AS OrigCo,\n  APTL.Mth AS OrigMth,\n  APTL.APTrans AS OrigTrans,\n  APTL.APLine AS OrigLine,\n  APTL.GrossAmt AS OrigAmount,\n  APLB.GrossAmt AS BatchAmount,\n  APVM.Name AS VendorName\nFROM APLB WITH (NOLOCK)\nINNER JOIN APHB WITH (NOLOCK) ON APLB.Co = APHB.Co AND APLB.Mth = APHB.Mth AND APLB.BatchId = APHB.BatchId\nINNER JOIN APTL WITH (NOLOCK) ON APLB.ocApplyMth = APTL.Mth \n  AND APLB.ocApplyTrans = APTL.APTrans \n  AND APLB.ocApplyLine = APTL.APLine\n  AND APLB.Co = APTL.APCo\nINNER JOIN APTH WITH (NOLOCK) ON APTL.APCo = APTH.APCo AND APTL.Mth = APTH.Mth AND APTL.APTrans = APTH.APTrans\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APLB.Co = @Co\nORDER BY APLB.BatchId, APLB.BatchSeq\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APLB",
        "APHB",
        "APTL",
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: reconcile ap oncost batch lines with original transactions\n\nDatabase Schema:\nCREATE TABLE APTL (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equip bequip,\n  EMGroup bgroup,\n  -- ... 56 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans, APLine)\n);\n\nCREATE TABLE APLB (\n  Co bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  BatchId bbatchid NOT NULL,\n  BatchSeq int NOT NULL,\n  APLine smallint NOT NULL,\n  BatchTransType char(1) NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  -- ... 120 more columns,\n  PRIMARY KEY (Co, Mth, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APHB (\n  Co bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  BatchId bbatchid NOT NULL,\n  BatchSeq int NOT NULL,\n  BatchTransType char(1) NOT NULL,\n  APTrans btrans,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  -- ... 88 more columns,\n  PRIMARY KEY (Co, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To reconcile AP oncost batches with original transactions:\n1. Join APLB (batch lines) to APTL (original lines) using ocApplyMth, ocApplyTrans, ocApplyLine\n2. Include APHB for batch header info\n3. Join to APTH and APVM for vendor context\n4. Compare batch vs original amounts\n\n```sql\nSELECT \n  APLB.Co AS BatchCo,\n  APLB.Mth AS BatchMth,\n  APLB.BatchId,\n  APLB.BatchSeq,\n  APLB.ocApplyMth,\n  APLB.ocApplyTrans,\n  APLB.ocApplyLine,\n  APTL.APCo AS OrigCo,\n  APTL.Mth AS OrigMth,\n  APTL.APTrans AS OrigTrans,\n  APTL.APLine AS OrigLine,\n  APTL.GrossAmt AS OrigAmount,\n  APLB.GrossAmt AS BatchAmount,\n  APVM.Name AS VendorName\nFROM APLB WITH (NOLOCK)\nINNER JOIN APHB WITH (NOLOCK) ON APLB.Co = APHB.Co AND APLB.Mth = APHB.Mth AND APLB.BatchId = APHB.BatchId\nINNER JOIN APTL WITH (NOLOCK) ON APLB.ocApplyMth = APTL.Mth \n  AND APLB.ocApplyTrans = APTL.APTrans \n  AND APLB.ocApplyLine = APTL.APLine\n  AND APLB.Co = APTL.APCo\nINNER JOIN APTH WITH (NOLOCK) ON APTL.APCo = APTH.APCo AND APTL.Mth = APTH.Mth AND APTL.APTrans = APTH.APTrans\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APLB.Co = @Co\nORDER BY APLB.BatchId, APLB.BatchSeq\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APLB",
        "APHB",
        "APTL",
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: count records in aptd by company\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count APTD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM APTD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from SLWI\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from SLWI ().\n\n```sql\nSELECT *\nFROM SLWI WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "SLWI"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate stored materials (Purchased - Installed) for SL billing\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Stored materials for SL billing:\n1. SLWI contains work item/billing details\n2. StoredMatls = Purchased - Installed (materials on-site but not yet used)\n3. WCCost = Work Completed Cost\n4. WCRetAmt and SMRetAmt = separate retainage for work vs materials\n5. Total billable = WCCost + StoredMatls\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description AS ItemDescription,\n  SLWI.StoredMatls,\n  SLWI.WCCost AS WorkCompletedCost,\n  SLWI.StoredMatls + SLWI.WCCost AS TotalBillable,\n  SLWI.WCRetAmt AS WorkRetainage,\n  SLWI.SMRetAmt AS MaterialsRetainage,\n  SLWI.WCRetAmt + SLWI.SMRetAmt AS TotalRetainage\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\n  AND SLWI.StoredMatls <> 0\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "intermediate",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoice totals with discounts and retainage\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Vendor invoice summary with discounts and retainage:\n1. Join APTH to APVM for vendor details\n2. Aggregate by vendor\n3. Include GrossAmt, DiscOffer, Retainage, and Balance\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(APTH.APTrans) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS GrossAmount,\n  SUM(APTH.DiscOffer) AS DiscountsOffered,\n  SUM(APTH.Retainage) AS RetainageHeld,\n  SUM(APTH.Balance) AS OpenBalance\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoice totals with discounts and retainage\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Vendor invoice summary with discounts and retainage:\n1. Join APTH to APVM for vendor details\n2. Aggregate by vendor\n3. Include GrossAmt, DiscOffer, Retainage, and Balance\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(APTH.APTrans) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS GrossAmount,\n  SUM(APTH.DiscOffer) AS DiscountsOffered,\n  SUM(APTH.Retainage) AS RetainageHeld,\n  SUM(APTH.Balance) AS OpenBalance\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "basic",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get job cost variance by phase comparing budget to actual\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Job cost variance by phase:\n1. Join JCJM (Job Master) to JCCP (Cost Phase)\n2. Calculate variance as CurrEstCost - ActualCost\n3. Calculate percent complete from actuals vs budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  JCCP.Phase,\n  JCCP.CostType,\n  JCCP.OrigEstCost AS OriginalBudget,\n  JCCP.CurrEstCost AS CurrentBudget,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS Variance,\n  CASE WHEN JCCP.CurrEstCost <> 0 \n       THEN (JCCP.ActualCost / JCCP.CurrEstCost) * 100 \n       ELSE 0 END AS PercentComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.Job = @Job\nORDER BY JCCP.Phase, JCCP.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate stored materials (Purchased - Installed) for SL billing\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Stored materials for SL billing:\n1. SLWI contains work item/billing details\n2. StoredMatls = Purchased - Installed (materials on-site but not yet used)\n3. WCCost = Work Completed Cost\n4. WCRetAmt and SMRetAmt = separate retainage for work vs materials\n5. Total billable = WCCost + StoredMatls\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description AS ItemDescription,\n  SLWI.StoredMatls,\n  SLWI.WCCost AS WorkCompletedCost,\n  SLWI.StoredMatls + SLWI.WCCost AS TotalBillable,\n  SLWI.WCRetAmt AS WorkRetainage,\n  SLWI.SMRetAmt AS MaterialsRetainage,\n  SLWI.WCRetAmt + SLWI.SMRetAmt AS TotalRetainage\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\n  AND SLWI.StoredMatls <> 0\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "basic",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get job cost variance by phase comparing budget to actual\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Job cost variance by phase:\n1. Join JCJM (Job Master) to JCCP (Cost Phase)\n2. Calculate variance as CurrEstCost - ActualCost\n3. Calculate percent complete from actuals vs budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  JCCP.Phase,\n  JCCP.CostType,\n  JCCP.OrigEstCost AS OriginalBudget,\n  JCCP.CurrEstCost AS CurrentBudget,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS Variance,\n  CASE WHEN JCCP.CurrEstCost <> 0 \n       THEN (JCCP.ActualCost / JCCP.CurrEstCost) * 100 \n       ELSE 0 END AS PercentComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.Job = @Job\nORDER BY JCCP.Phase, JCCP.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Include JCJM in the query\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'JCJM' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nARTH, ARCM\n\nTo include JCJM in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: count records in arth by company\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count ARTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM ARTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from ARTH\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from ARTH ().\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find jobs over budget with remaining cost projection\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Find jobs over budget:\n1. Aggregate JCCP by job from JCJM\n2. Compare total ActualCost to CurrEstCost\n3. Use HAVING to filter only over-budget jobs\n4. Sort by amount over budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description,\n  SUM(JCCP.CurrEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.CurrEstCost) - SUM(JCCP.ActualCost) AS RemainingBudget,\n  CASE WHEN SUM(JCCP.CurrEstCost) < SUM(JCCP.ActualCost) \n       THEN 'OVER BUDGET' ELSE 'OK' END AS Status\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\nGROUP BY JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.CurrEstCost)\nORDER BY (SUM(JCCP.ActualCost) - SUM(JCCP.CurrEstCost)) DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM",
        "JCCD",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from PRTH\n\nDatabase Schema:\nCREATE TABLE PRTH (\n  PRCo bcompany NOT NULL,\n  PRGroup bgroup NOT NULL,\n  PREndDate bdate NOT NULL,\n  Employee bemployee NOT NULL,\n  PaySeq tinyint NOT NULL,\n  PostSeq smallint NOT NULL,\n  Type char(1) NOT NULL,\n  PostDate bdate NOT NULL,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCDept bdept,\n  GLCo bcompany NOT NULL,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equipment bequip,\n  EMGroup tinyint,\n  CostCode bcostcode,\n  -- ... 41 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from PRTH ().\n\n```sql\nSELECT *\nFROM PRTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "PRTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Include JCJM in the query\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'JCJM' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nARTH, ARCM\n\nTo include JCJM in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need to count records in slhd by company\n\nDatabase Schema:\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count SLHD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM SLHD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "SLHD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from ARTH\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from ARTH ().\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find all unpaid AR invoices older than 60 days\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find unpaid invoices over 60 days:\n1. Join ARTH to ARCM for customer information\n2. Filter PayFullDate IS NULL (unpaid)\n3. Use DATEDIFF to calculate age and filter > 60 days\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Mth,\n  ARTH.ARTrans,\n  ARCM.Name AS CustomerName,\n  ARTH.TransDate,\n  ARTH.Amount,\n  DATEDIFF(day, ARTH.TransDate, GETDATE()) AS DaysOutstanding\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\n  AND DATEDIFF(day, ARTH.TransDate, GETDATE()) > 60\nORDER BY ARTH.TransDate\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from APTH\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from APTH ().\n\n```sql\nSELECT *\nFROM APTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to count records in prco by company\n\nDatabase Schema:\nCREATE TABLE PRCO (\n  PRCo bcompany NOT NULL,\n  GLCo bcompany NOT NULL,\n  Jrnl bjrnl,\n  GLInterface byn NOT NULL,\n  CMCo bcompany NOT NULL,\n  APCo bcompany,\n  AutoOT byn NOT NULL,\n  OTEarnCode bedlcode,\n  JCCo bcompany NOT NULL,\n  AllowNoPhase byn NOT NULL,\n  JCInterface byn NOT NULL,\n  InsByPhase byn NOT NULL,\n  JCICraftClass byn NOT NULL,\n  JCICrew byn NOT NULL,\n  JCIEmployee byn NOT NULL,\n  JCIFactor byn NOT NULL,\n  JCIEarnType byn NOT NULL,\n  JCIShift byn NOT NULL,\n  JCIPostingDate byn NOT NULL,\n  JCILiabType byn NOT NULL,\n  -- ... 66 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count PRCO records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM PRCO WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "PRCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How do I count records in slwi by company\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count SLWI records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM SLWI WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "SLWI"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How is Projects structured?\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'Projects' does not exist in Viewpoint Vista.\n\nUse JCJM (JC Job Master) for project information. Vista calls projects 'Jobs'.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM JCJM WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get job cost variance by phase comparing budget to actual\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Job cost variance by phase:\n1. Join JCJM (Job Master) to JCCP (Cost Phase)\n2. Calculate variance as CurrEstCost - ActualCost\n3. Calculate percent complete from actuals vs budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  JCCP.Phase,\n  JCCP.CostType,\n  JCCP.OrigEstCost AS OriginalBudget,\n  JCCP.CurrEstCost AS CurrentBudget,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS Variance,\n  CASE WHEN JCCP.CurrEstCost <> 0 \n       THEN (JCCP.ActualCost / JCCP.CurrEstCost) * 100 \n       ELSE 0 END AS PercentComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.Job = @Job\nORDER BY JCCP.Phase, JCCP.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoice totals with discounts and retainage\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Vendor invoice summary with discounts and retainage:\n1. Join APTH to APVM for vendor details\n2. Aggregate by vendor\n3. Include GrossAmt, DiscOffer, Retainage, and Balance\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(APTH.APTrans) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS GrossAmount,\n  SUM(APTH.DiscOffer) AS DiscountsOffered,\n  SUM(APTH.Retainage) AS RetainageHeld,\n  SUM(APTH.Balance) AS OpenBalance\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from SLHD\n\nDatabase Schema:\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from SLHD ().\n\n```sql\nSELECT *\nFROM SLHD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "SLHD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from APTD\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from APTD ().\n\n```sql\nSELECT *\nFROM APTD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get data from PREH for analysis\n\nDatabase Schema:\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'PREH' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nSLHD, SLIT\n\nTo include PREH in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from JCCD\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from JCCD ().\n\n```sql\nSELECT *\nFROM JCCD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get subcontractor costs with original, change orders, invoiced, paid, and retainage by vendor\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Subcontractor cost breakdown by vendor:\n1. Join SLHD (Header) to SLIT (Items) for subcontract details\n2. Join APVM for vendor names\n3. OrigCost = original contract amount\n4. CurCost - OrigCost = change order amounts\n5. InvCost = amounts invoiced\n6. Retainage = amounts held back\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  SLHD.SL AS SubcontractNum,\n  SLHD.Description AS SubcontractDesc,\n  SUM(SLIT.OrigCost) AS OriginalCost,\n  SUM(SLIT.CurCost - SLIT.OrigCost) AS ChangeOrderCost,\n  SUM(SLIT.CurCost) AS CurrentCost,\n  SUM(SLIT.InvCost) AS InvoicedCost,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost - SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nINNER JOIN APVM WITH (NOLOCK) ON SLHD.VendorGroup = APVM.VendorGroup AND SLHD.Vendor = APVM.Vendor\nWHERE SLHD.SLCo = @SLCo\nGROUP BY APVM.Vendor, APVM.Name, SLHD.SL, SLHD.Description\nORDER BY APVM.Name, SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "intermediate",
      "tables_used": [
        "SLHD",
        "SLIT",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get customer balance summary by customer group\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Customer balance summary by group:\n1. Join ARTH to ARCM for customer details\n2. Use conditional SUM for open vs total balances\n3. Group by CustGroup for summary\n\n```sql\nSELECT \n  ARTH.CustGroup,\n  COUNT(DISTINCT ARTH.Customer) AS CustomerCount,\n  SUM(CASE WHEN ARTH.PayFullDate IS NULL THEN ARTH.Amount ELSE 0 END) AS OpenBalance,\n  SUM(ARTH.Amount) AS TotalBilled\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\nGROUP BY ARTH.CustGroup\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from GLCO\n\nDatabase Schema:\nCREATE TABLE GLCO (\n  GLCo bcompany NOT NULL,\n  Consolid byn NOT NULL,\n  LastMthSubClsd bmonth NOT NULL,\n  LastMthGLClsd bmonth NOT NULL,\n  MaxOpen tinyint NOT NULL,\n  CashAccrual char(1) NOT NULL,\n  Unbal byn NOT NULL,\n  AuditCoParams byn NOT NULL,\n  AuditAccts byn NOT NULL,\n  AuditAutoJrnl byn NOT NULL,\n  AuditBals byn NOT NULL,\n  AuditBudgets byn NOT NULL,\n  AuditDetail byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  XCompJrnlEntryYN byn NOT NULL,\n  KeyID bigint NOT NULL,\n  LastMthAPClsd bmonth NOT NULL,\n  LastMthARClsd bmonth NOT NULL,\n  AttachBatchReportsYN byn NOT NULL,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from GLCO ().\n\n```sql\nSELECT *\nFROM GLCO WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "GLCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get job cost variance by phase comparing budget to actual\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Job cost variance by phase:\n1. Join JCJM (Job Master) to JCCP (Cost Phase)\n2. Calculate variance as CurrEstCost - ActualCost\n3. Calculate percent complete from actuals vs budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  JCCP.Phase,\n  JCCP.CostType,\n  JCCP.OrigEstCost AS OriginalBudget,\n  JCCP.CurrEstCost AS CurrentBudget,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS Variance,\n  CASE WHEN JCCP.CurrEstCost <> 0 \n       THEN (JCCP.ActualCost / JCCP.CurrEstCost) * 100 \n       ELSE 0 END AS PercentComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.Job = @Job\nORDER BY JCCP.Phase, JCCP.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from GLJR\n\nDatabase Schema:\nCREATE TABLE GLJR (\n  GLCo bcompany NOT NULL,\n  Jrnl bjrnl NOT NULL,\n  Description btransdesc,\n  Rev byn NOT NULL,\n  RevJrnl bjrnl,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from GLJR ().\n\n```sql\nSELECT *\nFROM GLJR WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "GLJR"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How do I reconcile ap oncost batch lines with original transactions\n\nDatabase Schema:\nCREATE TABLE APTL (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equip bequip,\n  EMGroup bgroup,\n  -- ... 56 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans, APLine)\n);\n\nCREATE TABLE APLB (\n  Co bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  BatchId bbatchid NOT NULL,\n  BatchSeq int NOT NULL,\n  APLine smallint NOT NULL,\n  BatchTransType char(1) NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  -- ... 120 more columns,\n  PRIMARY KEY (Co, Mth, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APHB (\n  Co bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  BatchId bbatchid NOT NULL,\n  BatchSeq int NOT NULL,\n  BatchTransType char(1) NOT NULL,\n  APTrans btrans,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  -- ... 88 more columns,\n  PRIMARY KEY (Co, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To reconcile AP oncost batches with original transactions:\n1. Join APLB (batch lines) to APTL (original lines) using ocApplyMth, ocApplyTrans, ocApplyLine\n2. Include APHB for batch header info\n3. Join to APTH and APVM for vendor context\n4. Compare batch vs original amounts\n\n```sql\nSELECT \n  APLB.Co AS BatchCo,\n  APLB.Mth AS BatchMth,\n  APLB.BatchId,\n  APLB.BatchSeq,\n  APLB.ocApplyMth,\n  APLB.ocApplyTrans,\n  APLB.ocApplyLine,\n  APTL.APCo AS OrigCo,\n  APTL.Mth AS OrigMth,\n  APTL.APTrans AS OrigTrans,\n  APTL.APLine AS OrigLine,\n  APTL.GrossAmt AS OrigAmount,\n  APLB.GrossAmt AS BatchAmount,\n  APVM.Name AS VendorName\nFROM APLB WITH (NOLOCK)\nINNER JOIN APHB WITH (NOLOCK) ON APLB.Co = APHB.Co AND APLB.Mth = APHB.Mth AND APLB.BatchId = APHB.BatchId\nINNER JOIN APTL WITH (NOLOCK) ON APLB.ocApplyMth = APTL.Mth \n  AND APLB.ocApplyTrans = APTL.APTrans \n  AND APLB.ocApplyLine = APTL.APLine\n  AND APLB.Co = APTL.APCo\nINNER JOIN APTH WITH (NOLOCK) ON APTL.APCo = APTH.APCo AND APTL.Mth = APTH.Mth AND APTL.APTrans = APTH.APTrans\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APLB.Co = @Co\nORDER BY APLB.BatchId, APLB.BatchSeq\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APLB",
        "APHB",
        "APTL",
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How do I track ap hold status distinguishing retainage vs non-retainage holds\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APCO (\n  APCo bcompany NOT NULL,\n  GLCo bcompany NOT NULL,\n  ExpJrnl bjrnl,\n  GLExpInterfaceLvl tinyint NOT NULL,\n  GLExpSummaryDesc varchar(60),\n  GLExpTransDesc varchar(60),\n  GLJobDetailDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLEquipDetailDesc varchar(60),\n  GLExpDetailDesc varchar(60),\n  PayJrnl bjrnl,\n  GLPayInterfaceLvl tinyint NOT NULL,\n  GLPayDetailDesc varchar(60),\n  GLPaySummaryDesc varchar(60),\n  DiscOffGLAcct bglacct,\n  DiscTakenGLAcct bglacct,\n  ExpPayType tinyint,\n  JobPayType tinyint,\n  SubPayType tinyint,\n  RetPayType tinyint,\n  -- ... 92 more columns,\n  PRIMARY KEY (APCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To distinguish retainage vs non-retainage holds:\n1. Join APTD to APHD for hold details\n2. Join APCO to get RetHoldCode setting\n3. Compare APHD.HoldCode to APCO.RetHoldCode\n4. If equal, it's a retainage hold; otherwise non-retainage\n\n```sql\nSELECT \n  APTD.APCo,\n  APTD.Vendor,\n  APTD.Mth,\n  APTD.APTrans,\n  APHD.HoldCode,\n  CASE WHEN APHD.HoldCode = APCO.RetHoldCode \n       THEN 'Retainage Hold' \n       ELSE 'Non-Retainage Hold' END AS HoldType,\n  APTD.Amount\nFROM APTD WITH (NOLOCK)\nINNER JOIN APHD WITH (NOLOCK) ON APTD.APCo = APHD.APCo \n  AND APTD.Mth = APHD.Mth \n  AND APTD.APTrans = APHD.APTrans \n  AND APTD.APLine = APHD.APLine\nINNER JOIN APCO WITH (NOLOCK) ON APTD.APCo = APCO.APCo\nWHERE APTD.APCo = @APCo\n  AND APHD.HoldCode IS NOT NULL\nORDER BY APTD.Vendor, APTD.Mth\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTD",
        "APHD",
        "APCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to join GLDT with the available tables\n\nDatabase Schema:\nCREATE TABLE PREH (\n  PRCo bcompany NOT NULL,\n  Employee bemployee NOT NULL,\n  LastName varchar(30) NOT NULL,\n  FirstName varchar(30),\n  MidName varchar(15),\n  SortName bsortname NOT NULL,\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  Phone bphone,\n  SSN char(11) NOT NULL,\n  Race char(2) NOT NULL,\n  Sex char(1) NOT NULL,\n  BirthDate smalldatetime,\n  HireDate bdate,\n  TermDate bdate,\n  PRGroup bgroup NOT NULL,\n  PRDept bdept NOT NULL,\n  -- ... 121 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nCREATE TABLE PRTH (\n  PRCo bcompany NOT NULL,\n  PRGroup bgroup NOT NULL,\n  PREndDate bdate NOT NULL,\n  Employee bemployee NOT NULL,\n  PaySeq tinyint NOT NULL,\n  PostSeq smallint NOT NULL,\n  Type char(1) NOT NULL,\n  PostDate bdate NOT NULL,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCDept bdept,\n  GLCo bcompany NOT NULL,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equipment bequip,\n  EMGroup tinyint,\n  CostCode bcostcode,\n  -- ... 41 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'GLDT' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nPREH, PRTH\n\nTo include GLDT in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How do I count records in gljr by company\n\nDatabase Schema:\nCREATE TABLE GLJR (\n  GLCo bcompany NOT NULL,\n  Jrnl bjrnl NOT NULL,\n  Description btransdesc,\n  Rev byn NOT NULL,\n  RevJrnl bjrnl,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count GLJR records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM GLJR WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "GLJR"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Include PREH in the query\n\nDatabase Schema:\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'PREH' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nSLHD, SLIT\n\nTo include PREH in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get subcontractor costs with original, change orders, invoiced, paid, and retainage by vendor\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Subcontractor cost breakdown by vendor:\n1. Join SLHD (Header) to SLIT (Items) for subcontract details\n2. Join APVM for vendor names\n3. OrigCost = original contract amount\n4. CurCost - OrigCost = change order amounts\n5. InvCost = amounts invoiced\n6. Retainage = amounts held back\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  SLHD.SL AS SubcontractNum,\n  SLHD.Description AS SubcontractDesc,\n  SUM(SLIT.OrigCost) AS OriginalCost,\n  SUM(SLIT.CurCost - SLIT.OrigCost) AS ChangeOrderCost,\n  SUM(SLIT.CurCost) AS CurrentCost,\n  SUM(SLIT.InvCost) AS InvoicedCost,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost - SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nINNER JOIN APVM WITH (NOLOCK) ON SLHD.VendorGroup = APVM.VendorGroup AND SLHD.Vendor = APVM.Vendor\nWHERE SLHD.SLCo = @SLCo\nGROUP BY APVM.Vendor, APVM.Name, SLHD.SL, SLHD.Description\nORDER BY APVM.Name, SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLHD",
        "SLIT",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: List all fields in VendorMaster\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'VendorMaster' does not exist in Viewpoint Vista.\n\nUse APVM (AP Vendor Master) for vendor information.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM APVM WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to count records in slwi by company\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count SLWI records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM SLWI WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "SLWI"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to track ap hold status distinguishing retainage vs non-retainage holds\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APCO (\n  APCo bcompany NOT NULL,\n  GLCo bcompany NOT NULL,\n  ExpJrnl bjrnl,\n  GLExpInterfaceLvl tinyint NOT NULL,\n  GLExpSummaryDesc varchar(60),\n  GLExpTransDesc varchar(60),\n  GLJobDetailDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLEquipDetailDesc varchar(60),\n  GLExpDetailDesc varchar(60),\n  PayJrnl bjrnl,\n  GLPayInterfaceLvl tinyint NOT NULL,\n  GLPayDetailDesc varchar(60),\n  GLPaySummaryDesc varchar(60),\n  DiscOffGLAcct bglacct,\n  DiscTakenGLAcct bglacct,\n  ExpPayType tinyint,\n  JobPayType tinyint,\n  SubPayType tinyint,\n  RetPayType tinyint,\n  -- ... 92 more columns,\n  PRIMARY KEY (APCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To distinguish retainage vs non-retainage holds:\n1. Join APTD to APHD for hold details\n2. Join APCO to get RetHoldCode setting\n3. Compare APHD.HoldCode to APCO.RetHoldCode\n4. If equal, it's a retainage hold; otherwise non-retainage\n\n```sql\nSELECT \n  APTD.APCo,\n  APTD.Vendor,\n  APTD.Mth,\n  APTD.APTrans,\n  APHD.HoldCode,\n  CASE WHEN APHD.HoldCode = APCO.RetHoldCode \n       THEN 'Retainage Hold' \n       ELSE 'Non-Retainage Hold' END AS HoldType,\n  APTD.Amount\nFROM APTD WITH (NOLOCK)\nINNER JOIN APHD WITH (NOLOCK) ON APTD.APCo = APHD.APCo \n  AND APTD.Mth = APHD.Mth \n  AND APTD.APTrans = APHD.APTrans \n  AND APTD.APLine = APHD.APLine\nINNER JOIN APCO WITH (NOLOCK) ON APTD.APCo = APCO.APCo\nWHERE APTD.APCo = @APCo\n  AND APHD.HoldCode IS NOT NULL\nORDER BY APTD.Vendor, APTD.Mth\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "basic",
      "tables_used": [
        "APTD",
        "APHD",
        "APCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging buckets (30/60/90+ days) for unpaid invoices by customer\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Use ARTH for transaction data and ARCM for customer names\n2. Filter PayFullDate IS NULL to get only unpaid invoices\n3. Use DATEDIFF and CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get customer balance summary by customer group\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Customer balance summary by group:\n1. Join ARTH to ARCM for customer details\n2. Use conditional SUM for open vs total balances\n3. Group by CustGroup for summary\n\n```sql\nSELECT \n  ARTH.CustGroup,\n  COUNT(DISTINCT ARTH.Customer) AS CustomerCount,\n  SUM(CASE WHEN ARTH.PayFullDate IS NULL THEN ARTH.Amount ELSE 0 END) AS OpenBalance,\n  SUM(ARTH.Amount) AS TotalBilled\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\nGROUP BY ARTH.CustGroup\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need to count records in arth by company\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count ARTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM ARTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from ARTH\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from ARTH ().\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to reconcile ap oncost batch lines with original transactions\n\nDatabase Schema:\nCREATE TABLE APTL (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equip bequip,\n  EMGroup bgroup,\n  -- ... 56 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans, APLine)\n);\n\nCREATE TABLE APLB (\n  Co bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  BatchId bbatchid NOT NULL,\n  BatchSeq int NOT NULL,\n  APLine smallint NOT NULL,\n  BatchTransType char(1) NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  -- ... 120 more columns,\n  PRIMARY KEY (Co, Mth, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APHB (\n  Co bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  BatchId bbatchid NOT NULL,\n  BatchSeq int NOT NULL,\n  BatchTransType char(1) NOT NULL,\n  APTrans btrans,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  -- ... 88 more columns,\n  PRIMARY KEY (Co, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To reconcile AP oncost batches with original transactions:\n1. Join APLB (batch lines) to APTL (original lines) using ocApplyMth, ocApplyTrans, ocApplyLine\n2. Include APHB for batch header info\n3. Join to APTH and APVM for vendor context\n4. Compare batch vs original amounts\n\n```sql\nSELECT \n  APLB.Co AS BatchCo,\n  APLB.Mth AS BatchMth,\n  APLB.BatchId,\n  APLB.BatchSeq,\n  APLB.ocApplyMth,\n  APLB.ocApplyTrans,\n  APLB.ocApplyLine,\n  APTL.APCo AS OrigCo,\n  APTL.Mth AS OrigMth,\n  APTL.APTrans AS OrigTrans,\n  APTL.APLine AS OrigLine,\n  APTL.GrossAmt AS OrigAmount,\n  APLB.GrossAmt AS BatchAmount,\n  APVM.Name AS VendorName\nFROM APLB WITH (NOLOCK)\nINNER JOIN APHB WITH (NOLOCK) ON APLB.Co = APHB.Co AND APLB.Mth = APHB.Mth AND APLB.BatchId = APHB.BatchId\nINNER JOIN APTL WITH (NOLOCK) ON APLB.ocApplyMth = APTL.Mth \n  AND APLB.ocApplyTrans = APTL.APTrans \n  AND APLB.ocApplyLine = APTL.APLine\n  AND APLB.Co = APTL.APCo\nINNER JOIN APTH WITH (NOLOCK) ON APTL.APCo = APTH.APCo AND APTL.Mth = APTH.Mth AND APTL.APTrans = APTH.APTrans\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APLB.Co = @Co\nORDER BY APLB.BatchId, APLB.BatchSeq\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "basic",
      "tables_used": [
        "APLB",
        "APHB",
        "APTL",
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get subcontractor costs with original, change orders, invoiced, paid, and retainage by vendor\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Subcontractor cost breakdown by vendor:\n1. Join SLHD (Header) to SLIT (Items) for subcontract details\n2. Join APVM for vendor names\n3. OrigCost = original contract amount\n4. CurCost - OrigCost = change order amounts\n5. InvCost = amounts invoiced\n6. Retainage = amounts held back\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  SLHD.SL AS SubcontractNum,\n  SLHD.Description AS SubcontractDesc,\n  SUM(SLIT.OrigCost) AS OriginalCost,\n  SUM(SLIT.CurCost - SLIT.OrigCost) AS ChangeOrderCost,\n  SUM(SLIT.CurCost) AS CurrentCost,\n  SUM(SLIT.InvCost) AS InvoicedCost,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost - SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nINNER JOIN APVM WITH (NOLOCK) ON SLHD.VendorGroup = APVM.VendorGroup AND SLHD.Vendor = APVM.Vendor\nWHERE SLHD.SLCo = @SLCo\nGROUP BY APVM.Vendor, APVM.Name, SLHD.SL, SLHD.Description\nORDER BY APVM.Name, SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "intermediate",
      "tables_used": [
        "SLHD",
        "SLIT",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find all unpaid AR invoices older than 60 days\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find unpaid invoices over 60 days:\n1. Join ARTH to ARCM for customer information\n2. Filter PayFullDate IS NULL (unpaid)\n3. Use DATEDIFF to calculate age and filter > 60 days\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Mth,\n  ARTH.ARTrans,\n  ARCM.Name AS CustomerName,\n  ARTH.TransDate,\n  ARTH.Amount,\n  DATEDIFF(day, ARTH.TransDate, GETDATE()) AS DaysOutstanding\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\n  AND DATEDIFF(day, ARTH.TransDate, GETDATE()) > 60\nORDER BY ARTH.TransDate\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from APTH\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from APTH ().\n\n```sql\nSELECT *\nFROM APTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get subcontractor costs with original, change orders, invoiced, paid, and retainage by vendor\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Subcontractor cost breakdown by vendor:\n1. Join SLHD (Header) to SLIT (Items) for subcontract details\n2. Join APVM for vendor names\n3. OrigCost = original contract amount\n4. CurCost - OrigCost = change order amounts\n5. InvCost = amounts invoiced\n6. Retainage = amounts held back\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  SLHD.SL AS SubcontractNum,\n  SLHD.Description AS SubcontractDesc,\n  SUM(SLIT.OrigCost) AS OriginalCost,\n  SUM(SLIT.CurCost - SLIT.OrigCost) AS ChangeOrderCost,\n  SUM(SLIT.CurCost) AS CurrentCost,\n  SUM(SLIT.InvCost) AS InvoicedCost,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost - SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nINNER JOIN APVM WITH (NOLOCK) ON SLHD.VendorGroup = APVM.VendorGroup AND SLHD.Vendor = APVM.Vendor\nWHERE SLHD.SLCo = @SLCo\nGROUP BY APVM.Vendor, APVM.Name, SLHD.SL, SLHD.Description\nORDER BY APVM.Name, SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "basic",
      "tables_used": [
        "SLHD",
        "SLIT",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get subcontractor costs with original, change orders, invoiced, paid, and retainage by vendor\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Subcontractor cost breakdown by vendor:\n1. Join SLHD (Header) to SLIT (Items) for subcontract details\n2. Join APVM for vendor names\n3. OrigCost = original contract amount\n4. CurCost - OrigCost = change order amounts\n5. InvCost = amounts invoiced\n6. Retainage = amounts held back\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  SLHD.SL AS SubcontractNum,\n  SLHD.Description AS SubcontractDesc,\n  SUM(SLIT.OrigCost) AS OriginalCost,\n  SUM(SLIT.CurCost - SLIT.OrigCost) AS ChangeOrderCost,\n  SUM(SLIT.CurCost) AS CurrentCost,\n  SUM(SLIT.InvCost) AS InvoicedCost,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost - SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nINNER JOIN APVM WITH (NOLOCK) ON SLHD.VendorGroup = APVM.VendorGroup AND SLHD.Vendor = APVM.Vendor\nWHERE SLHD.SLCo = @SLCo\nGROUP BY APVM.Vendor, APVM.Name, SLHD.SL, SLHD.Description\nORDER BY APVM.Name, SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLHD",
        "SLIT",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging buckets (30/60/90+ days) for unpaid invoices by customer\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Use ARTH for transaction data and ARCM for customer names\n2. Filter PayFullDate IS NULL to get only unpaid invoices\n3. Use DATEDIFF and CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: What is the schema for ClientMaster?\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'ClientMaster' does not exist in Viewpoint Vista.\n\nUse ARCM (AR Customer Master) for client/customer information.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM ARCM WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoices with their subcontract details\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I can partially answer this query, but the schema is incomplete.\n\nTo include subcontract details, the SLHD table is needed but not provided in the schema.\n\nHere's what I can provide with the available schema:\n\n```sql\nSELECT *\nFROM APTH WITH (NOLOCK)\nWHERE Co = @Co\n-- Note: Additional joins for SLHD would be needed for complete results\n```\n\nTo get the complete data you requested, please provide the DDL for SLHD.",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": [
        "APTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoices with their subcontract details\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I can partially answer this query, but the schema is incomplete.\n\nTo include subcontract details, the SLHD table is needed but not provided in the schema.\n\nHere's what I can provide with the available schema:\n\n```sql\nSELECT *\nFROM APTH WITH (NOLOCK)\nWHERE Co = @Co\n-- Note: Additional joins for SLHD would be needed for complete results\n```\n\nTo get the complete data you requested, please provide the DDL for SLHD.",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": [
        "APTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate stored materials (Purchased - Installed) for SL billing\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Stored materials for SL billing:\n1. SLWI contains work item/billing details\n2. StoredMatls = Purchased - Installed (materials on-site but not yet used)\n3. WCCost = Work Completed Cost\n4. WCRetAmt and SMRetAmt = separate retainage for work vs materials\n5. Total billable = WCCost + StoredMatls\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description AS ItemDescription,\n  SLWI.StoredMatls,\n  SLWI.WCCost AS WorkCompletedCost,\n  SLWI.StoredMatls + SLWI.WCCost AS TotalBillable,\n  SLWI.WCRetAmt AS WorkRetainage,\n  SLWI.SMRetAmt AS MaterialsRetainage,\n  SLWI.WCRetAmt + SLWI.SMRetAmt AS TotalRetainage\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\n  AND SLWI.StoredMatls <> 0\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "basic",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to track ap hold status distinguishing retainage vs non-retainage holds\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APCO (\n  APCo bcompany NOT NULL,\n  GLCo bcompany NOT NULL,\n  ExpJrnl bjrnl,\n  GLExpInterfaceLvl tinyint NOT NULL,\n  GLExpSummaryDesc varchar(60),\n  GLExpTransDesc varchar(60),\n  GLJobDetailDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLEquipDetailDesc varchar(60),\n  GLExpDetailDesc varchar(60),\n  PayJrnl bjrnl,\n  GLPayInterfaceLvl tinyint NOT NULL,\n  GLPayDetailDesc varchar(60),\n  GLPaySummaryDesc varchar(60),\n  DiscOffGLAcct bglacct,\n  DiscTakenGLAcct bglacct,\n  ExpPayType tinyint,\n  JobPayType tinyint,\n  SubPayType tinyint,\n  RetPayType tinyint,\n  -- ... 92 more columns,\n  PRIMARY KEY (APCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To distinguish retainage vs non-retainage holds:\n1. Join APTD to APHD for hold details\n2. Join APCO to get RetHoldCode setting\n3. Compare APHD.HoldCode to APCO.RetHoldCode\n4. If equal, it's a retainage hold; otherwise non-retainage\n\n```sql\nSELECT \n  APTD.APCo,\n  APTD.Vendor,\n  APTD.Mth,\n  APTD.APTrans,\n  APHD.HoldCode,\n  CASE WHEN APHD.HoldCode = APCO.RetHoldCode \n       THEN 'Retainage Hold' \n       ELSE 'Non-Retainage Hold' END AS HoldType,\n  APTD.Amount\nFROM APTD WITH (NOLOCK)\nINNER JOIN APHD WITH (NOLOCK) ON APTD.APCo = APHD.APCo \n  AND APTD.Mth = APHD.Mth \n  AND APTD.APTrans = APHD.APTrans \n  AND APTD.APLine = APHD.APLine\nINNER JOIN APCO WITH (NOLOCK) ON APTD.APCo = APCO.APCo\nWHERE APTD.APCo = @APCo\n  AND APHD.HoldCode IS NOT NULL\nORDER BY APTD.Vendor, APTD.Mth\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTD",
        "APHD",
        "APCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How do I count records in prpc by company\n\nDatabase Schema:\nCREATE TABLE PRPC (\n  PRCo bcompany NOT NULL,\n  PRGroup bgroup NOT NULL,\n  PREndDate bdate NOT NULL,\n  BeginDate bdate NOT NULL,\n  MultiMth byn NOT NULL,\n  BeginMth bmonth NOT NULL,\n  EndMth bmonth,\n  CutoffDate bdate,\n  LimitMth bmonth NOT NULL,\n  Hrs smallint NOT NULL,\n  Days tinyint NOT NULL,\n  Wks tinyint NOT NULL,\n  Status tinyint NOT NULL,\n  DateClosed smalldatetime,\n  JCInterface byn NOT NULL,\n  EMInterface byn NOT NULL,\n  GLInterface byn NOT NULL,\n  APInterface byn NOT NULL,\n  LeaveProcess byn NOT NULL,\n  InUseBy bvpusername,\n  -- ... 7 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count PRPC records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM PRPC WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "PRPC"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get subcontractor costs with original, change orders, invoiced, paid, and retainage by vendor\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Subcontractor cost breakdown by vendor:\n1. Join SLHD (Header) to SLIT (Items) for subcontract details\n2. Join APVM for vendor names\n3. OrigCost = original contract amount\n4. CurCost - OrigCost = change order amounts\n5. InvCost = amounts invoiced\n6. Retainage = amounts held back\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  SLHD.SL AS SubcontractNum,\n  SLHD.Description AS SubcontractDesc,\n  SUM(SLIT.OrigCost) AS OriginalCost,\n  SUM(SLIT.CurCost - SLIT.OrigCost) AS ChangeOrderCost,\n  SUM(SLIT.CurCost) AS CurrentCost,\n  SUM(SLIT.InvCost) AS InvoicedCost,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost - SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nINNER JOIN APVM WITH (NOLOCK) ON SLHD.VendorGroup = APVM.VendorGroup AND SLHD.Vendor = APVM.Vendor\nWHERE SLHD.SLCo = @SLCo\nGROUP BY APVM.Vendor, APVM.Name, SLHD.SL, SLHD.Description\nORDER BY APVM.Name, SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "basic",
      "tables_used": [
        "SLHD",
        "SLIT",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find all unpaid AR invoices older than 60 days\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find unpaid invoices over 60 days:\n1. Join ARTH to ARCM for customer information\n2. Filter PayFullDate IS NULL (unpaid)\n3. Use DATEDIFF to calculate age and filter > 60 days\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Mth,\n  ARTH.ARTrans,\n  ARCM.Name AS CustomerName,\n  ARTH.TransDate,\n  ARTH.Amount,\n  DATEDIFF(day, ARTH.TransDate, GETDATE()) AS DaysOutstanding\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\n  AND DATEDIFF(day, ARTH.TransDate, GETDATE()) > 60\nORDER BY ARTH.TransDate\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to count records in aptd by company\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count APTD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM APTD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from PRTD\n\nDatabase Schema:\nCREATE TABLE PRTD (\n  PRCo bcompany NOT NULL,\n  Craft bcraft NOT NULL,\n  Class bclass NOT NULL,\n  Template smallint NOT NULL,\n  DLCode bedlcode NOT NULL,\n  Factor brate NOT NULL,\n  OldRate bunitcost NOT NULL,\n  NewRate bunitcost NOT NULL,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from PRTD ().\n\n```sql\nSELECT *\nFROM PRTD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "PRTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get data from GLDT for analysis\n\nDatabase Schema:\nCREATE TABLE PREH (\n  PRCo bcompany NOT NULL,\n  Employee bemployee NOT NULL,\n  LastName varchar(30) NOT NULL,\n  FirstName varchar(30),\n  MidName varchar(15),\n  SortName bsortname NOT NULL,\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  Phone bphone,\n  SSN char(11) NOT NULL,\n  Race char(2) NOT NULL,\n  Sex char(1) NOT NULL,\n  BirthDate smalldatetime,\n  HireDate bdate,\n  TermDate bdate,\n  PRGroup bgroup NOT NULL,\n  PRDept bdept NOT NULL,\n  -- ... 121 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nCREATE TABLE PRTH (\n  PRCo bcompany NOT NULL,\n  PRGroup bgroup NOT NULL,\n  PREndDate bdate NOT NULL,\n  Employee bemployee NOT NULL,\n  PaySeq tinyint NOT NULL,\n  PostSeq smallint NOT NULL,\n  Type char(1) NOT NULL,\n  PostDate bdate NOT NULL,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCDept bdept,\n  GLCo bcompany NOT NULL,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equipment bequip,\n  EMGroup tinyint,\n  CostCode bcostcode,\n  -- ... 41 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'GLDT' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nPREH, PRTH\n\nTo include GLDT in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging buckets (30/60/90+ days) for unpaid invoices by customer\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Use ARTH for transaction data and ARCM for customer names\n2. Filter PayFullDate IS NULL to get only unpaid invoices\n3. Use DATEDIFF and CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from APTD\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from APTD ().\n\n```sql\nSELECT *\nFROM APTD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to count records in glac by company\n\nDatabase Schema:\nCREATE TABLE GLAC (\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  Description bdesc,\n  AcctType char(1) NOT NULL,\n  SubType char(1),\n  NormBal char(1),\n  InterfaceDetail byn NOT NULL,\n  Active byn NOT NULL,\n  SummaryAcct bglacct NOT NULL,\n  CashAccrual char(1) NOT NULL,\n  CashOffAcct bglacct,\n  Notes varchar,\n  Part1 varchar(20),\n  Part2 varchar(20),\n  Part3 varchar(20),\n  Part4 varchar(20),\n  Part5 varchar(20),\n  Part6 varchar(20),\n  AllParts varchar(20),\n  CrossRefMemAcct bglacct,\n  -- ... 3 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count GLAC records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM GLAC WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "GLAC"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from ARTH\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from ARTH ().\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query to aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get subcontractor costs with original, change orders, invoiced, paid, and retainage by vendor\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Subcontractor cost breakdown by vendor:\n1. Join SLHD (Header) to SLIT (Items) for subcontract details\n2. Join APVM for vendor names\n3. OrigCost = original contract amount\n4. CurCost - OrigCost = change order amounts\n5. InvCost = amounts invoiced\n6. Retainage = amounts held back\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  SLHD.SL AS SubcontractNum,\n  SLHD.Description AS SubcontractDesc,\n  SUM(SLIT.OrigCost) AS OriginalCost,\n  SUM(SLIT.CurCost - SLIT.OrigCost) AS ChangeOrderCost,\n  SUM(SLIT.CurCost) AS CurrentCost,\n  SUM(SLIT.InvCost) AS InvoicedCost,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost - SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nINNER JOIN APVM WITH (NOLOCK) ON SLHD.VendorGroup = APVM.VendorGroup AND SLHD.Vendor = APVM.Vendor\nWHERE SLHD.SLCo = @SLCo\nGROUP BY APVM.Vendor, APVM.Name, SLHD.SL, SLHD.Description\nORDER BY APVM.Name, SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "intermediate",
      "tables_used": [
        "SLHD",
        "SLIT",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query to count records in jccd by company\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count JCCD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM JCCD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate stored materials (Purchased - Installed) for SL billing\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Stored materials for SL billing:\n1. SLWI contains work item/billing details\n2. StoredMatls = Purchased - Installed (materials on-site but not yet used)\n3. WCCost = Work Completed Cost\n4. WCRetAmt and SMRetAmt = separate retainage for work vs materials\n5. Total billable = WCCost + StoredMatls\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description AS ItemDescription,\n  SLWI.StoredMatls,\n  SLWI.WCCost AS WorkCompletedCost,\n  SLWI.StoredMatls + SLWI.WCCost AS TotalBillable,\n  SLWI.WCRetAmt AS WorkRetainage,\n  SLWI.SMRetAmt AS MaterialsRetainage,\n  SLWI.WCRetAmt + SLWI.SMRetAmt AS TotalRetainage\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\n  AND SLWI.StoredMatls <> 0\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "basic",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find jobs over budget with remaining cost projection\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Find jobs over budget:\n1. Aggregate JCCP by job from JCJM\n2. Compare total ActualCost to CurrEstCost\n3. Use HAVING to filter only over-budget jobs\n4. Sort by amount over budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description,\n  SUM(JCCP.CurrEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.CurrEstCost) - SUM(JCCP.ActualCost) AS RemainingBudget,\n  CASE WHEN SUM(JCCP.CurrEstCost) < SUM(JCCP.ActualCost) \n       THEN 'OVER BUDGET' ELSE 'OK' END AS Status\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\nGROUP BY JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.CurrEstCost)\nORDER BY (SUM(JCCP.ActualCost) - SUM(JCCP.CurrEstCost)) DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCJM",
        "JCCD",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get job cost variance by phase comparing budget to actual\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Job cost variance by phase:\n1. Join JCJM (Job Master) to JCCP (Cost Phase)\n2. Calculate variance as CurrEstCost - ActualCost\n3. Calculate percent complete from actuals vs budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  JCCP.Phase,\n  JCCP.CostType,\n  JCCP.OrigEstCost AS OriginalBudget,\n  JCCP.CurrEstCost AS CurrentBudget,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS Variance,\n  CASE WHEN JCCP.CurrEstCost <> 0 \n       THEN (JCCP.ActualCost / JCCP.CurrEstCost) * 100 \n       ELSE 0 END AS PercentComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.Job = @Job\nORDER BY JCCP.Phase, JCCP.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need to count records in jccd by company\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count JCCD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM JCCD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from GLDT\n\nDatabase Schema:\nCREATE TABLE GLDT (\n  GLCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  GLTrans btrans NOT NULL,\n  GLAcct bglacct NOT NULL,\n  Jrnl bjrnl NOT NULL,\n  GLRef bglref NOT NULL,\n  SourceCo bcompany NOT NULL,\n  Source bsource NOT NULL,\n  ActDate bdate NOT NULL,\n  DatePosted bdate NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid NOT NULL,\n  Amount bdollar NOT NULL,\n  RevStatus tinyint NOT NULL,\n  Adjust char(1) NOT NULL,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  UniqueAttchID uniqueidentifier,\n  SrcTable varchar(128),\n  SrcKeyID bigint,\n  PRIMARY KEY (GLCo, Mth, GLTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from GLDT ().\n\n```sql\nSELECT *\nFROM GLDT WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "GLDT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to count records in slwi by company\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count SLWI records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM SLWI WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLWI"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query to count records in glac by company\n\nDatabase Schema:\nCREATE TABLE GLAC (\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  Description bdesc,\n  AcctType char(1) NOT NULL,\n  SubType char(1),\n  NormBal char(1),\n  InterfaceDetail byn NOT NULL,\n  Active byn NOT NULL,\n  SummaryAcct bglacct NOT NULL,\n  CashAccrual char(1) NOT NULL,\n  CashOffAcct bglacct,\n  Notes varchar,\n  Part1 varchar(20),\n  Part2 varchar(20),\n  Part3 varchar(20),\n  Part4 varchar(20),\n  Part5 varchar(20),\n  Part6 varchar(20),\n  AllParts varchar(20),\n  CrossRefMemAcct bglacct,\n  -- ... 3 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count GLAC records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM GLAC WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "GLAC"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get customer balance summary by customer group\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Customer balance summary by group:\n1. Join ARTH to ARCM for customer details\n2. Use conditional SUM for open vs total balances\n3. Group by CustGroup for summary\n\n```sql\nSELECT \n  ARTH.CustGroup,\n  COUNT(DISTINCT ARTH.Customer) AS CustomerCount,\n  SUM(CASE WHEN ARTH.PayFullDate IS NULL THEN ARTH.Amount ELSE 0 END) AS OpenBalance,\n  SUM(ARTH.Amount) AS TotalBilled\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\nGROUP BY ARTH.CustGroup\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from GLJR\n\nDatabase Schema:\nCREATE TABLE GLJR (\n  GLCo bcompany NOT NULL,\n  Jrnl bjrnl NOT NULL,\n  Description btransdesc,\n  Rev byn NOT NULL,\n  RevJrnl bjrnl,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from GLJR ().\n\n```sql\nSELECT *\nFROM GLJR WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "GLJR"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How do I count records in arth by company\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count ARTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM ARTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get subcontractor costs with original, change orders, invoiced, paid, and retainage by vendor\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Subcontractor cost breakdown by vendor:\n1. Join SLHD (Header) to SLIT (Items) for subcontract details\n2. Join APVM for vendor names\n3. OrigCost = original contract amount\n4. CurCost - OrigCost = change order amounts\n5. InvCost = amounts invoiced\n6. Retainage = amounts held back\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  SLHD.SL AS SubcontractNum,\n  SLHD.Description AS SubcontractDesc,\n  SUM(SLIT.OrigCost) AS OriginalCost,\n  SUM(SLIT.CurCost - SLIT.OrigCost) AS ChangeOrderCost,\n  SUM(SLIT.CurCost) AS CurrentCost,\n  SUM(SLIT.InvCost) AS InvoicedCost,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost - SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nINNER JOIN APVM WITH (NOLOCK) ON SLHD.VendorGroup = APVM.VendorGroup AND SLHD.Vendor = APVM.Vendor\nWHERE SLHD.SLCo = @SLCo\nGROUP BY APVM.Vendor, APVM.Name, SLHD.SL, SLHD.Description\nORDER BY APVM.Name, SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "basic",
      "tables_used": [
        "SLHD",
        "SLIT",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to count records in jccd by company\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count JCCD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM JCCD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need to count records in glco by company\n\nDatabase Schema:\nCREATE TABLE GLCO (\n  GLCo bcompany NOT NULL,\n  Consolid byn NOT NULL,\n  LastMthSubClsd bmonth NOT NULL,\n  LastMthGLClsd bmonth NOT NULL,\n  MaxOpen tinyint NOT NULL,\n  CashAccrual char(1) NOT NULL,\n  Unbal byn NOT NULL,\n  AuditCoParams byn NOT NULL,\n  AuditAccts byn NOT NULL,\n  AuditAutoJrnl byn NOT NULL,\n  AuditBals byn NOT NULL,\n  AuditBudgets byn NOT NULL,\n  AuditDetail byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  XCompJrnlEntryYN byn NOT NULL,\n  KeyID bigint NOT NULL,\n  LastMthAPClsd bmonth NOT NULL,\n  LastMthARClsd bmonth NOT NULL,\n  AttachBatchReportsYN byn NOT NULL,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count GLCO records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM GLCO WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "GLCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to count records in glac by company\n\nDatabase Schema:\nCREATE TABLE GLAC (\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  Description bdesc,\n  AcctType char(1) NOT NULL,\n  SubType char(1),\n  NormBal char(1),\n  InterfaceDetail byn NOT NULL,\n  Active byn NOT NULL,\n  SummaryAcct bglacct NOT NULL,\n  CashAccrual char(1) NOT NULL,\n  CashOffAcct bglacct,\n  Notes varchar,\n  Part1 varchar(20),\n  Part2 varchar(20),\n  Part3 varchar(20),\n  Part4 varchar(20),\n  Part5 varchar(20),\n  Part6 varchar(20),\n  AllParts varchar(20),\n  CrossRefMemAcct bglacct,\n  -- ... 3 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count GLAC records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM GLAC WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "GLAC"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from ARTH\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from ARTH ().\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get subcontractor costs with original, change orders, invoiced, paid, and retainage by vendor\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Subcontractor cost breakdown by vendor:\n1. Join SLHD (Header) to SLIT (Items) for subcontract details\n2. Join APVM for vendor names\n3. OrigCost = original contract amount\n4. CurCost - OrigCost = change order amounts\n5. InvCost = amounts invoiced\n6. Retainage = amounts held back\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  SLHD.SL AS SubcontractNum,\n  SLHD.Description AS SubcontractDesc,\n  SUM(SLIT.OrigCost) AS OriginalCost,\n  SUM(SLIT.CurCost - SLIT.OrigCost) AS ChangeOrderCost,\n  SUM(SLIT.CurCost) AS CurrentCost,\n  SUM(SLIT.InvCost) AS InvoicedCost,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost - SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nINNER JOIN APVM WITH (NOLOCK) ON SLHD.VendorGroup = APVM.VendorGroup AND SLHD.Vendor = APVM.Vendor\nWHERE SLHD.SLCo = @SLCo\nGROUP BY APVM.Vendor, APVM.Name, SLHD.SL, SLHD.Description\nORDER BY APVM.Name, SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "intermediate",
      "tables_used": [
        "SLHD",
        "SLIT",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to count records in prpc by company\n\nDatabase Schema:\nCREATE TABLE PRPC (\n  PRCo bcompany NOT NULL,\n  PRGroup bgroup NOT NULL,\n  PREndDate bdate NOT NULL,\n  BeginDate bdate NOT NULL,\n  MultiMth byn NOT NULL,\n  BeginMth bmonth NOT NULL,\n  EndMth bmonth,\n  CutoffDate bdate,\n  LimitMth bmonth NOT NULL,\n  Hrs smallint NOT NULL,\n  Days tinyint NOT NULL,\n  Wks tinyint NOT NULL,\n  Status tinyint NOT NULL,\n  DateClosed smalldatetime,\n  JCInterface byn NOT NULL,\n  EMInterface byn NOT NULL,\n  GLInterface byn NOT NULL,\n  APInterface byn NOT NULL,\n  LeaveProcess byn NOT NULL,\n  InUseBy bvpusername,\n  -- ... 7 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count PRPC records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM PRPC WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "PRPC"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: count records in jccd by company\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count JCCD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM JCCD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging buckets (30/60/90+ days) for unpaid invoices by customer\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Use ARTH for transaction data and ARCM for customer names\n2. Filter PayFullDate IS NULL to get only unpaid invoices\n3. Use DATEDIFF and CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need to aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from ARTH\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from ARTH ().\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get data from GLDT for analysis\n\nDatabase Schema:\nCREATE TABLE PREH (\n  PRCo bcompany NOT NULL,\n  Employee bemployee NOT NULL,\n  LastName varchar(30) NOT NULL,\n  FirstName varchar(30),\n  MidName varchar(15),\n  SortName bsortname NOT NULL,\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  Phone bphone,\n  SSN char(11) NOT NULL,\n  Race char(2) NOT NULL,\n  Sex char(1) NOT NULL,\n  BirthDate smalldatetime,\n  HireDate bdate,\n  TermDate bdate,\n  PRGroup bgroup NOT NULL,\n  PRDept bdept NOT NULL,\n  -- ... 121 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nCREATE TABLE PRTH (\n  PRCo bcompany NOT NULL,\n  PRGroup bgroup NOT NULL,\n  PREndDate bdate NOT NULL,\n  Employee bemployee NOT NULL,\n  PaySeq tinyint NOT NULL,\n  PostSeq smallint NOT NULL,\n  Type char(1) NOT NULL,\n  PostDate bdate NOT NULL,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCDept bdept,\n  GLCo bcompany NOT NULL,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equipment bequip,\n  EMGroup tinyint,\n  CostCode bcostcode,\n  -- ... 41 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'GLDT' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nPREH, PRTH\n\nTo include GLDT in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How do I count records in arth by company\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count ARTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM ARTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging buckets (30/60/90+ days) for unpaid invoices by customer\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Use ARTH for transaction data and ARCM for customer names\n2. Filter PayFullDate IS NULL to get only unpaid invoices\n3. Use DATEDIFF and CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to reconcile ap oncost batch lines with original transactions\n\nDatabase Schema:\nCREATE TABLE APTL (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equip bequip,\n  EMGroup bgroup,\n  -- ... 56 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans, APLine)\n);\n\nCREATE TABLE APLB (\n  Co bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  BatchId bbatchid NOT NULL,\n  BatchSeq int NOT NULL,\n  APLine smallint NOT NULL,\n  BatchTransType char(1) NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  -- ... 120 more columns,\n  PRIMARY KEY (Co, Mth, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APHB (\n  Co bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  BatchId bbatchid NOT NULL,\n  BatchSeq int NOT NULL,\n  BatchTransType char(1) NOT NULL,\n  APTrans btrans,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  -- ... 88 more columns,\n  PRIMARY KEY (Co, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To reconcile AP oncost batches with original transactions:\n1. Join APLB (batch lines) to APTL (original lines) using ocApplyMth, ocApplyTrans, ocApplyLine\n2. Include APHB for batch header info\n3. Join to APTH and APVM for vendor context\n4. Compare batch vs original amounts\n\n```sql\nSELECT \n  APLB.Co AS BatchCo,\n  APLB.Mth AS BatchMth,\n  APLB.BatchId,\n  APLB.BatchSeq,\n  APLB.ocApplyMth,\n  APLB.ocApplyTrans,\n  APLB.ocApplyLine,\n  APTL.APCo AS OrigCo,\n  APTL.Mth AS OrigMth,\n  APTL.APTrans AS OrigTrans,\n  APTL.APLine AS OrigLine,\n  APTL.GrossAmt AS OrigAmount,\n  APLB.GrossAmt AS BatchAmount,\n  APVM.Name AS VendorName\nFROM APLB WITH (NOLOCK)\nINNER JOIN APHB WITH (NOLOCK) ON APLB.Co = APHB.Co AND APLB.Mth = APHB.Mth AND APLB.BatchId = APHB.BatchId\nINNER JOIN APTL WITH (NOLOCK) ON APLB.ocApplyMth = APTL.Mth \n  AND APLB.ocApplyTrans = APTL.APTrans \n  AND APLB.ocApplyLine = APTL.APLine\n  AND APLB.Co = APTL.APCo\nINNER JOIN APTH WITH (NOLOCK) ON APTL.APCo = APTH.APCo AND APTL.Mth = APTH.Mth AND APTL.APTrans = APTH.APTrans\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APLB.Co = @Co\nORDER BY APLB.BatchId, APLB.BatchSeq\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APLB",
        "APHB",
        "APTL",
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Join ChartOfAccounts with other tables\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'ChartOfAccounts' does not exist in Viewpoint Vista.\n\nUse GLAC (GL Account) for chart of accounts.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM GLAC WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging with customer contact information\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I can partially answer this query, but the schema is incomplete.\n\nThe query requires ARCM (AR Customer Master) for customer details, but only ARTH is provided in the schema.\n\nHere's what I can provide with the available schema:\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n-- Note: Additional joins for ARCM would be needed for complete results\n```\n\nTo get the complete data you requested, please provide the DDL for ARCM.",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to count records in gljr by company\n\nDatabase Schema:\nCREATE TABLE GLJR (\n  GLCo bcompany NOT NULL,\n  Jrnl bjrnl NOT NULL,\n  Description btransdesc,\n  Rev byn NOT NULL,\n  RevJrnl bjrnl,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count GLJR records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM GLJR WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "GLJR"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get data from ARCM for analysis\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'ARCM' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nAPTH, APVM\n\nTo include ARCM in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate stored materials (Purchased - Installed) for SL billing\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Stored materials for SL billing:\n1. SLWI contains work item/billing details\n2. StoredMatls = Purchased - Installed (materials on-site but not yet used)\n3. WCCost = Work Completed Cost\n4. WCRetAmt and SMRetAmt = separate retainage for work vs materials\n5. Total billable = WCCost + StoredMatls\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description AS ItemDescription,\n  SLWI.StoredMatls,\n  SLWI.WCCost AS WorkCompletedCost,\n  SLWI.StoredMatls + SLWI.WCCost AS TotalBillable,\n  SLWI.WCRetAmt AS WorkRetainage,\n  SLWI.SMRetAmt AS MaterialsRetainage,\n  SLWI.WCRetAmt + SLWI.SMRetAmt AS TotalRetainage\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\n  AND SLWI.StoredMatls <> 0\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "intermediate",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoice totals with discounts and retainage\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Vendor invoice summary with discounts and retainage:\n1. Join APTH to APVM for vendor details\n2. Aggregate by vendor\n3. Include GrossAmt, DiscOffer, Retainage, and Balance\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(APTH.APTrans) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS GrossAmount,\n  SUM(APTH.DiscOffer) AS DiscountsOffered,\n  SUM(APTH.Retainage) AS RetainageHeld,\n  SUM(APTH.Balance) AS OpenBalance\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoice totals with discounts and retainage\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Vendor invoice summary with discounts and retainage:\n1. Join APTH to APVM for vendor details\n2. Aggregate by vendor\n3. Include GrossAmt, DiscOffer, Retainage, and Balance\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(APTH.APTrans) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS GrossAmount,\n  SUM(APTH.DiscOffer) AS DiscountsOffered,\n  SUM(APTH.Retainage) AS RetainageHeld,\n  SUM(APTH.Balance) AS OpenBalance\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from ARTH\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from ARTH ().\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need to count records in aptd by company\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count APTD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM APTD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: List all fields in Customer\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'Customer' does not exist in Viewpoint Vista.\n\nUse ARCM (AR Customer Master) for customer information.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM ARCM WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from APTH\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from APTH ().\n\n```sql\nSELECT *\nFROM APTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate stored materials (Purchased - Installed) for SL billing\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Stored materials for SL billing:\n1. SLWI contains work item/billing details\n2. StoredMatls = Purchased - Installed (materials on-site but not yet used)\n3. WCCost = Work Completed Cost\n4. WCRetAmt and SMRetAmt = separate retainage for work vs materials\n5. Total billable = WCCost + StoredMatls\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description AS ItemDescription,\n  SLWI.StoredMatls,\n  SLWI.WCCost AS WorkCompletedCost,\n  SLWI.StoredMatls + SLWI.WCCost AS TotalBillable,\n  SLWI.WCRetAmt AS WorkRetainage,\n  SLWI.SMRetAmt AS MaterialsRetainage,\n  SLWI.WCRetAmt + SLWI.SMRetAmt AS TotalRetainage\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\n  AND SLWI.StoredMatls <> 0\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to count records in slwi by company\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count SLWI records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM SLWI WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "SLWI"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate stored materials (Purchased - Installed) for SL billing\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Stored materials for SL billing:\n1. SLWI contains work item/billing details\n2. StoredMatls = Purchased - Installed (materials on-site but not yet used)\n3. WCCost = Work Completed Cost\n4. WCRetAmt and SMRetAmt = separate retainage for work vs materials\n5. Total billable = WCCost + StoredMatls\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description AS ItemDescription,\n  SLWI.StoredMatls,\n  SLWI.WCCost AS WorkCompletedCost,\n  SLWI.StoredMatls + SLWI.WCCost AS TotalBillable,\n  SLWI.WCRetAmt AS WorkRetainage,\n  SLWI.SMRetAmt AS MaterialsRetainage,\n  SLWI.WCRetAmt + SLWI.SMRetAmt AS TotalRetainage\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\n  AND SLWI.StoredMatls <> 0\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "intermediate",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from JCCD\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from JCCD ().\n\n```sql\nSELECT *\nFROM JCCD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query to count records in slwi by company\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count SLWI records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM SLWI WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "SLWI"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate stored materials (Purchased - Installed) for SL billing\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Stored materials for SL billing:\n1. SLWI contains work item/billing details\n2. StoredMatls = Purchased - Installed (materials on-site but not yet used)\n3. WCCost = Work Completed Cost\n4. WCRetAmt and SMRetAmt = separate retainage for work vs materials\n5. Total billable = WCCost + StoredMatls\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description AS ItemDescription,\n  SLWI.StoredMatls,\n  SLWI.WCCost AS WorkCompletedCost,\n  SLWI.StoredMatls + SLWI.WCCost AS TotalBillable,\n  SLWI.WCRetAmt AS WorkRetainage,\n  SLWI.SMRetAmt AS MaterialsRetainage,\n  SLWI.WCRetAmt + SLWI.SMRetAmt AS TotalRetainage\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\n  AND SLWI.StoredMatls <> 0\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get job cost variance by phase comparing budget to actual\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Job cost variance by phase:\n1. Join JCJM (Job Master) to JCCP (Cost Phase)\n2. Calculate variance as CurrEstCost - ActualCost\n3. Calculate percent complete from actuals vs budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  JCCP.Phase,\n  JCCP.CostType,\n  JCCP.OrigEstCost AS OriginalBudget,\n  JCCP.CurrEstCost AS CurrentBudget,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS Variance,\n  CASE WHEN JCCP.CurrEstCost <> 0 \n       THEN (JCCP.ActualCost / JCCP.CurrEstCost) * 100 \n       ELSE 0 END AS PercentComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.Job = @Job\nORDER BY JCCP.Phase, JCCP.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get customer balance summary by customer group\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Customer balance summary by group:\n1. Join ARTH to ARCM for customer details\n2. Use conditional SUM for open vs total balances\n3. Group by CustGroup for summary\n\n```sql\nSELECT \n  ARTH.CustGroup,\n  COUNT(DISTINCT ARTH.Customer) AS CustomerCount,\n  SUM(CASE WHEN ARTH.PayFullDate IS NULL THEN ARTH.Amount ELSE 0 END) AS OpenBalance,\n  SUM(ARTH.Amount) AS TotalBilled\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\nGROUP BY ARTH.CustGroup\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get data from PREH for analysis\n\nDatabase Schema:\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'PREH' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nSLHD, SLIT\n\nTo include PREH in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get job cost variance by phase comparing budget to actual\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Job cost variance by phase:\n1. Join JCJM (Job Master) to JCCP (Cost Phase)\n2. Calculate variance as CurrEstCost - ActualCost\n3. Calculate percent complete from actuals vs budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  JCCP.Phase,\n  JCCP.CostType,\n  JCCP.OrigEstCost AS OriginalBudget,\n  JCCP.CurrEstCost AS CurrentBudget,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS Variance,\n  CASE WHEN JCCP.CurrEstCost <> 0 \n       THEN (JCCP.ActualCost / JCCP.CurrEstCost) * 100 \n       ELSE 0 END AS PercentComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.Job = @Job\nORDER BY JCCP.Phase, JCCP.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: List all fields in ChangeOrders\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'ChangeOrders' does not exist in Viewpoint Vista.\n\nUse JCOI (JC Change Order Item) for change order details.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM JCOI WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate stored materials (Purchased - Installed) for SL billing\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Stored materials for SL billing:\n1. SLWI contains work item/billing details\n2. StoredMatls = Purchased - Installed (materials on-site but not yet used)\n3. WCCost = Work Completed Cost\n4. WCRetAmt and SMRetAmt = separate retainage for work vs materials\n5. Total billable = WCCost + StoredMatls\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description AS ItemDescription,\n  SLWI.StoredMatls,\n  SLWI.WCCost AS WorkCompletedCost,\n  SLWI.StoredMatls + SLWI.WCCost AS TotalBillable,\n  SLWI.WCRetAmt AS WorkRetainage,\n  SLWI.SMRetAmt AS MaterialsRetainage,\n  SLWI.WCRetAmt + SLWI.SMRetAmt AS TotalRetainage\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\n  AND SLWI.StoredMatls <> 0\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "intermediate",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need to reconcile ap oncost batch lines with original transactions\n\nDatabase Schema:\nCREATE TABLE APTL (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equip bequip,\n  EMGroup bgroup,\n  -- ... 56 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans, APLine)\n);\n\nCREATE TABLE APLB (\n  Co bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  BatchId bbatchid NOT NULL,\n  BatchSeq int NOT NULL,\n  APLine smallint NOT NULL,\n  BatchTransType char(1) NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  -- ... 120 more columns,\n  PRIMARY KEY (Co, Mth, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APHB (\n  Co bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  BatchId bbatchid NOT NULL,\n  BatchSeq int NOT NULL,\n  BatchTransType char(1) NOT NULL,\n  APTrans btrans,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  -- ... 88 more columns,\n  PRIMARY KEY (Co, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To reconcile AP oncost batches with original transactions:\n1. Join APLB (batch lines) to APTL (original lines) using ocApplyMth, ocApplyTrans, ocApplyLine\n2. Include APHB for batch header info\n3. Join to APTH and APVM for vendor context\n4. Compare batch vs original amounts\n\n```sql\nSELECT \n  APLB.Co AS BatchCo,\n  APLB.Mth AS BatchMth,\n  APLB.BatchId,\n  APLB.BatchSeq,\n  APLB.ocApplyMth,\n  APLB.ocApplyTrans,\n  APLB.ocApplyLine,\n  APTL.APCo AS OrigCo,\n  APTL.Mth AS OrigMth,\n  APTL.APTrans AS OrigTrans,\n  APTL.APLine AS OrigLine,\n  APTL.GrossAmt AS OrigAmount,\n  APLB.GrossAmt AS BatchAmount,\n  APVM.Name AS VendorName\nFROM APLB WITH (NOLOCK)\nINNER JOIN APHB WITH (NOLOCK) ON APLB.Co = APHB.Co AND APLB.Mth = APHB.Mth AND APLB.BatchId = APHB.BatchId\nINNER JOIN APTL WITH (NOLOCK) ON APLB.ocApplyMth = APTL.Mth \n  AND APLB.ocApplyTrans = APTL.APTrans \n  AND APLB.ocApplyLine = APTL.APLine\n  AND APLB.Co = APTL.APCo\nINNER JOIN APTH WITH (NOLOCK) ON APTL.APCo = APTH.APCo AND APTL.Mth = APTH.Mth AND APTL.APTrans = APTH.APTrans\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APLB.Co = @Co\nORDER BY APLB.BatchId, APLB.BatchSeq\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "basic",
      "tables_used": [
        "APLB",
        "APHB",
        "APTL",
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query to aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get job cost variance by phase comparing budget to actual\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Job cost variance by phase:\n1. Join JCJM (Job Master) to JCCP (Cost Phase)\n2. Calculate variance as CurrEstCost - ActualCost\n3. Calculate percent complete from actuals vs budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  JCCP.Phase,\n  JCCP.CostType,\n  JCCP.OrigEstCost AS OriginalBudget,\n  JCCP.CurrEstCost AS CurrentBudget,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS Variance,\n  CASE WHEN JCCP.CurrEstCost <> 0 \n       THEN (JCCP.ActualCost / JCCP.CurrEstCost) * 100 \n       ELSE 0 END AS PercentComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.Job = @Job\nORDER BY JCCP.Phase, JCCP.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Include ARCM in the query\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'ARCM' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nAPTH, APVM\n\nTo include ARCM in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from GLAC\n\nDatabase Schema:\nCREATE TABLE GLAC (\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  Description bdesc,\n  AcctType char(1) NOT NULL,\n  SubType char(1),\n  NormBal char(1),\n  InterfaceDetail byn NOT NULL,\n  Active byn NOT NULL,\n  SummaryAcct bglacct NOT NULL,\n  CashAccrual char(1) NOT NULL,\n  CashOffAcct bglacct,\n  Notes varchar,\n  Part1 varchar(20),\n  Part2 varchar(20),\n  Part3 varchar(20),\n  Part4 varchar(20),\n  Part5 varchar(20),\n  Part6 varchar(20),\n  AllParts varchar(20),\n  CrossRefMemAcct bglacct,\n  -- ... 3 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from GLAC ().\n\n```sql\nSELECT *\nFROM GLAC WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "GLAC"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query to count records in gljr by company\n\nDatabase Schema:\nCREATE TABLE GLJR (\n  GLCo bcompany NOT NULL,\n  Jrnl bjrnl NOT NULL,\n  Description btransdesc,\n  Rev byn NOT NULL,\n  RevJrnl bjrnl,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count GLJR records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM GLJR WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "GLJR"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query to count records in gldt by company\n\nDatabase Schema:\nCREATE TABLE GLDT (\n  GLCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  GLTrans btrans NOT NULL,\n  GLAcct bglacct NOT NULL,\n  Jrnl bjrnl NOT NULL,\n  GLRef bglref NOT NULL,\n  SourceCo bcompany NOT NULL,\n  Source bsource NOT NULL,\n  ActDate bdate NOT NULL,\n  DatePosted bdate NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid NOT NULL,\n  Amount bdollar NOT NULL,\n  RevStatus tinyint NOT NULL,\n  Adjust char(1) NOT NULL,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  UniqueAttchID uniqueidentifier,\n  SrcTable varchar(128),\n  SrcKeyID bigint,\n  PRIMARY KEY (GLCo, Mth, GLTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count GLDT records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM GLDT WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "GLDT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoice totals with discounts and retainage\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Vendor invoice summary with discounts and retainage:\n1. Join APTH to APVM for vendor details\n2. Aggregate by vendor\n3. Include GrossAmt, DiscOffer, Retainage, and Balance\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(APTH.APTrans) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS GrossAmount,\n  SUM(APTH.DiscOffer) AS DiscountsOffered,\n  SUM(APTH.Retainage) AS RetainageHeld,\n  SUM(APTH.Balance) AS OpenBalance\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Include PREH in the query\n\nDatabase Schema:\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'PREH' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nSLHD, SLIT\n\nTo include PREH in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to join GLDT with the available tables\n\nDatabase Schema:\nCREATE TABLE PREH (\n  PRCo bcompany NOT NULL,\n  Employee bemployee NOT NULL,\n  LastName varchar(30) NOT NULL,\n  FirstName varchar(30),\n  MidName varchar(15),\n  SortName bsortname NOT NULL,\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  Phone bphone,\n  SSN char(11) NOT NULL,\n  Race char(2) NOT NULL,\n  Sex char(1) NOT NULL,\n  BirthDate smalldatetime,\n  HireDate bdate,\n  TermDate bdate,\n  PRGroup bgroup NOT NULL,\n  PRDept bdept NOT NULL,\n  -- ... 121 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nCREATE TABLE PRTH (\n  PRCo bcompany NOT NULL,\n  PRGroup bgroup NOT NULL,\n  PREndDate bdate NOT NULL,\n  Employee bemployee NOT NULL,\n  PaySeq tinyint NOT NULL,\n  PostSeq smallint NOT NULL,\n  Type char(1) NOT NULL,\n  PostDate bdate NOT NULL,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCDept bdept,\n  GLCo bcompany NOT NULL,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equipment bequip,\n  EMGroup tinyint,\n  CostCode bcostcode,\n  -- ... 41 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'GLDT' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nPREH, PRTH\n\nTo include GLDT in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show job costs with GL account descriptions\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I can partially answer this query, but the schema is incomplete.\n\nThe query requires GLAC for GL account descriptions, which is not in the provided schema.\n\nHere's what I can provide with the available schema:\n\n```sql\nSELECT *\nFROM JCCD WITH (NOLOCK)\nWHERE Co = @Co\n-- Note: Additional joins for GLAC would be needed for complete results\n```\n\nTo get the complete data you requested, please provide the DDL for GLAC.",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoice totals with discounts and retainage\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Vendor invoice summary with discounts and retainage:\n1. Join APTH to APVM for vendor details\n2. Aggregate by vendor\n3. Include GrossAmt, DiscOffer, Retainage, and Balance\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(APTH.APTrans) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS GrossAmount,\n  SUM(APTH.DiscOffer) AS DiscountsOffered,\n  SUM(APTH.Retainage) AS RetainageHeld,\n  SUM(APTH.Balance) AS OpenBalance\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get subcontractor costs with original, change orders, invoiced, paid, and retainage by vendor\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Subcontractor cost breakdown by vendor:\n1. Join SLHD (Header) to SLIT (Items) for subcontract details\n2. Join APVM for vendor names\n3. OrigCost = original contract amount\n4. CurCost - OrigCost = change order amounts\n5. InvCost = amounts invoiced\n6. Retainage = amounts held back\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  SLHD.SL AS SubcontractNum,\n  SLHD.Description AS SubcontractDesc,\n  SUM(SLIT.OrigCost) AS OriginalCost,\n  SUM(SLIT.CurCost - SLIT.OrigCost) AS ChangeOrderCost,\n  SUM(SLIT.CurCost) AS CurrentCost,\n  SUM(SLIT.InvCost) AS InvoicedCost,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost - SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nINNER JOIN APVM WITH (NOLOCK) ON SLHD.VendorGroup = APVM.VendorGroup AND SLHD.Vendor = APVM.Vendor\nWHERE SLHD.SLCo = @SLCo\nGROUP BY APVM.Vendor, APVM.Name, SLHD.SL, SLHD.Description\nORDER BY APVM.Name, SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "basic",
      "tables_used": [
        "SLHD",
        "SLIT",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: List all fields in Phases\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'Phases' does not exist in Viewpoint Vista.\n\nUse JCJP (JC Job Phase) for phase definitions.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM JCJP WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: SELECT * FROM ARInvoice\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'ARInvoice' does not exist in Viewpoint Vista.\n\nUse ARTH (AR Transaction Header) for AR invoices.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from ARTH\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from ARTH ().\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from SLWI\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from SLWI ().\n\n```sql\nSELECT *\nFROM SLWI WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "SLWI"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from APTD\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from APTD ().\n\n```sql\nSELECT *\nFROM APTD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get customer balance summary by customer group\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Customer balance summary by group:\n1. Join ARTH to ARCM for customer details\n2. Use conditional SUM for open vs total balances\n3. Group by CustGroup for summary\n\n```sql\nSELECT \n  ARTH.CustGroup,\n  COUNT(DISTINCT ARTH.Customer) AS CustomerCount,\n  SUM(CASE WHEN ARTH.PayFullDate IS NULL THEN ARTH.Amount ELSE 0 END) AS OpenBalance,\n  SUM(ARTH.Amount) AS TotalBilled\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\nGROUP BY ARTH.CustGroup\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How do I count records in arth by company\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count ARTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM ARTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need to count records in jccd by company\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count JCCD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM JCCD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to join ARCM with the available tables\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'ARCM' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nAPTH, APVM\n\nTo include ARCM in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get subcontractor costs with original, change orders, invoiced, paid, and retainage by vendor\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Subcontractor cost breakdown by vendor:\n1. Join SLHD (Header) to SLIT (Items) for subcontract details\n2. Join APVM for vendor names\n3. OrigCost = original contract amount\n4. CurCost - OrigCost = change order amounts\n5. InvCost = amounts invoiced\n6. Retainage = amounts held back\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  SLHD.SL AS SubcontractNum,\n  SLHD.Description AS SubcontractDesc,\n  SUM(SLIT.OrigCost) AS OriginalCost,\n  SUM(SLIT.CurCost - SLIT.OrigCost) AS ChangeOrderCost,\n  SUM(SLIT.CurCost) AS CurrentCost,\n  SUM(SLIT.InvCost) AS InvoicedCost,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost - SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nINNER JOIN APVM WITH (NOLOCK) ON SLHD.VendorGroup = APVM.VendorGroup AND SLHD.Vendor = APVM.Vendor\nWHERE SLHD.SLCo = @SLCo\nGROUP BY APVM.Vendor, APVM.Name, SLHD.SL, SLHD.Description\nORDER BY APVM.Name, SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "basic",
      "tables_used": [
        "SLHD",
        "SLIT",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to count records in arth by company\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count ARTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM ARTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How do I count records in arth by company\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count ARTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM ARTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate stored materials (Purchased - Installed) for SL billing\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Stored materials for SL billing:\n1. SLWI contains work item/billing details\n2. StoredMatls = Purchased - Installed (materials on-site but not yet used)\n3. WCCost = Work Completed Cost\n4. WCRetAmt and SMRetAmt = separate retainage for work vs materials\n5. Total billable = WCCost + StoredMatls\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description AS ItemDescription,\n  SLWI.StoredMatls,\n  SLWI.WCCost AS WorkCompletedCost,\n  SLWI.StoredMatls + SLWI.WCCost AS TotalBillable,\n  SLWI.WCRetAmt AS WorkRetainage,\n  SLWI.SMRetAmt AS MaterialsRetainage,\n  SLWI.WCRetAmt + SLWI.SMRetAmt AS TotalRetainage\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\n  AND SLWI.StoredMatls <> 0\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "intermediate",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query to aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from GLCO\n\nDatabase Schema:\nCREATE TABLE GLCO (\n  GLCo bcompany NOT NULL,\n  Consolid byn NOT NULL,\n  LastMthSubClsd bmonth NOT NULL,\n  LastMthGLClsd bmonth NOT NULL,\n  MaxOpen tinyint NOT NULL,\n  CashAccrual char(1) NOT NULL,\n  Unbal byn NOT NULL,\n  AuditCoParams byn NOT NULL,\n  AuditAccts byn NOT NULL,\n  AuditAutoJrnl byn NOT NULL,\n  AuditBals byn NOT NULL,\n  AuditBudgets byn NOT NULL,\n  AuditDetail byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  XCompJrnlEntryYN byn NOT NULL,\n  KeyID bigint NOT NULL,\n  LastMthAPClsd bmonth NOT NULL,\n  LastMthARClsd bmonth NOT NULL,\n  AttachBatchReportsYN byn NOT NULL,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from GLCO ().\n\n```sql\nSELECT *\nFROM GLCO WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "GLCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from SLWI\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from SLWI ().\n\n```sql\nSELECT *\nFROM SLWI WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLWI"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate stored materials (Purchased - Installed) for SL billing\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Stored materials for SL billing:\n1. SLWI contains work item/billing details\n2. StoredMatls = Purchased - Installed (materials on-site but not yet used)\n3. WCCost = Work Completed Cost\n4. WCRetAmt and SMRetAmt = separate retainage for work vs materials\n5. Total billable = WCCost + StoredMatls\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description AS ItemDescription,\n  SLWI.StoredMatls,\n  SLWI.WCCost AS WorkCompletedCost,\n  SLWI.StoredMatls + SLWI.WCCost AS TotalBillable,\n  SLWI.WCRetAmt AS WorkRetainage,\n  SLWI.SMRetAmt AS MaterialsRetainage,\n  SLWI.WCRetAmt + SLWI.SMRetAmt AS TotalRetainage\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\n  AND SLWI.StoredMatls <> 0\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "intermediate",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from JCCD\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from JCCD ().\n\n```sql\nSELECT *\nFROM JCCD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get customer balance summary by customer group\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Customer balance summary by group:\n1. Join ARTH to ARCM for customer details\n2. Use conditional SUM for open vs total balances\n3. Group by CustGroup for summary\n\n```sql\nSELECT \n  ARTH.CustGroup,\n  COUNT(DISTINCT ARTH.Customer) AS CustomerCount,\n  SUM(CASE WHEN ARTH.PayFullDate IS NULL THEN ARTH.Amount ELSE 0 END) AS OpenBalance,\n  SUM(ARTH.Amount) AS TotalBilled\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\nGROUP BY ARTH.CustGroup\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query to reconcile ap oncost batch lines with original transactions\n\nDatabase Schema:\nCREATE TABLE APTL (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equip bequip,\n  EMGroup bgroup,\n  -- ... 56 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans, APLine)\n);\n\nCREATE TABLE APLB (\n  Co bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  BatchId bbatchid NOT NULL,\n  BatchSeq int NOT NULL,\n  APLine smallint NOT NULL,\n  BatchTransType char(1) NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  -- ... 120 more columns,\n  PRIMARY KEY (Co, Mth, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APHB (\n  Co bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  BatchId bbatchid NOT NULL,\n  BatchSeq int NOT NULL,\n  BatchTransType char(1) NOT NULL,\n  APTrans btrans,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  -- ... 88 more columns,\n  PRIMARY KEY (Co, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To reconcile AP oncost batches with original transactions:\n1. Join APLB (batch lines) to APTL (original lines) using ocApplyMth, ocApplyTrans, ocApplyLine\n2. Include APHB for batch header info\n3. Join to APTH and APVM for vendor context\n4. Compare batch vs original amounts\n\n```sql\nSELECT \n  APLB.Co AS BatchCo,\n  APLB.Mth AS BatchMth,\n  APLB.BatchId,\n  APLB.BatchSeq,\n  APLB.ocApplyMth,\n  APLB.ocApplyTrans,\n  APLB.ocApplyLine,\n  APTL.APCo AS OrigCo,\n  APTL.Mth AS OrigMth,\n  APTL.APTrans AS OrigTrans,\n  APTL.APLine AS OrigLine,\n  APTL.GrossAmt AS OrigAmount,\n  APLB.GrossAmt AS BatchAmount,\n  APVM.Name AS VendorName\nFROM APLB WITH (NOLOCK)\nINNER JOIN APHB WITH (NOLOCK) ON APLB.Co = APHB.Co AND APLB.Mth = APHB.Mth AND APLB.BatchId = APHB.BatchId\nINNER JOIN APTL WITH (NOLOCK) ON APLB.ocApplyMth = APTL.Mth \n  AND APLB.ocApplyTrans = APTL.APTrans \n  AND APLB.ocApplyLine = APTL.APLine\n  AND APLB.Co = APTL.APCo\nINNER JOIN APTH WITH (NOLOCK) ON APTL.APCo = APTH.APCo AND APTL.Mth = APTH.Mth AND APTL.APTrans = APTH.APTrans\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APLB.Co = @Co\nORDER BY APLB.BatchId, APLB.BatchSeq\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APLB",
        "APHB",
        "APTL",
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How do I aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find all unpaid AR invoices older than 60 days\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find unpaid invoices over 60 days:\n1. Join ARTH to ARCM for customer information\n2. Filter PayFullDate IS NULL (unpaid)\n3. Use DATEDIFF to calculate age and filter > 60 days\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Mth,\n  ARTH.ARTrans,\n  ARCM.Name AS CustomerName,\n  ARTH.TransDate,\n  ARTH.Amount,\n  DATEDIFF(day, ARTH.TransDate, GETDATE()) AS DaysOutstanding\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\n  AND DATEDIFF(day, ARTH.TransDate, GETDATE()) > 60\nORDER BY ARTH.TransDate\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query to aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from PRPC\n\nDatabase Schema:\nCREATE TABLE PRPC (\n  PRCo bcompany NOT NULL,\n  PRGroup bgroup NOT NULL,\n  PREndDate bdate NOT NULL,\n  BeginDate bdate NOT NULL,\n  MultiMth byn NOT NULL,\n  BeginMth bmonth NOT NULL,\n  EndMth bmonth,\n  CutoffDate bdate,\n  LimitMth bmonth NOT NULL,\n  Hrs smallint NOT NULL,\n  Days tinyint NOT NULL,\n  Wks tinyint NOT NULL,\n  Status tinyint NOT NULL,\n  DateClosed smalldatetime,\n  JCInterface byn NOT NULL,\n  EMInterface byn NOT NULL,\n  GLInterface byn NOT NULL,\n  APInterface byn NOT NULL,\n  LeaveProcess byn NOT NULL,\n  InUseBy bvpusername,\n  -- ... 7 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from PRPC ().\n\n```sql\nSELECT *\nFROM PRPC WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "PRPC"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to count records in slwi by company\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count SLWI records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM SLWI WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLWI"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate stored materials (Purchased - Installed) for SL billing\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Stored materials for SL billing:\n1. SLWI contains work item/billing details\n2. StoredMatls = Purchased - Installed (materials on-site but not yet used)\n3. WCCost = Work Completed Cost\n4. WCRetAmt and SMRetAmt = separate retainage for work vs materials\n5. Total billable = WCCost + StoredMatls\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description AS ItemDescription,\n  SLWI.StoredMatls,\n  SLWI.WCCost AS WorkCompletedCost,\n  SLWI.StoredMatls + SLWI.WCCost AS TotalBillable,\n  SLWI.WCRetAmt AS WorkRetainage,\n  SLWI.SMRetAmt AS MaterialsRetainage,\n  SLWI.WCRetAmt + SLWI.SMRetAmt AS TotalRetainage\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\n  AND SLWI.StoredMatls <> 0\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from SLWI\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from SLWI ().\n\n```sql\nSELECT *\nFROM SLWI WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "SLWI"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find jobs over budget with remaining cost projection\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Find jobs over budget:\n1. Aggregate JCCP by job from JCJM\n2. Compare total ActualCost to CurrEstCost\n3. Use HAVING to filter only over-budget jobs\n4. Sort by amount over budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description,\n  SUM(JCCP.CurrEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.CurrEstCost) - SUM(JCCP.ActualCost) AS RemainingBudget,\n  CASE WHEN SUM(JCCP.CurrEstCost) < SUM(JCCP.ActualCost) \n       THEN 'OVER BUDGET' ELSE 'OK' END AS Status\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\nGROUP BY JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.CurrEstCost)\nORDER BY (SUM(JCCP.ActualCost) - SUM(JCCP.CurrEstCost)) DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCJM",
        "JCCD",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need to count records in jccd by company\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count JCCD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM JCCD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate stored materials (Purchased - Installed) for SL billing\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Stored materials for SL billing:\n1. SLWI contains work item/billing details\n2. StoredMatls = Purchased - Installed (materials on-site but not yet used)\n3. WCCost = Work Completed Cost\n4. WCRetAmt and SMRetAmt = separate retainage for work vs materials\n5. Total billable = WCCost + StoredMatls\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description AS ItemDescription,\n  SLWI.StoredMatls,\n  SLWI.WCCost AS WorkCompletedCost,\n  SLWI.StoredMatls + SLWI.WCCost AS TotalBillable,\n  SLWI.WCRetAmt AS WorkRetainage,\n  SLWI.SMRetAmt AS MaterialsRetainage,\n  SLWI.WCRetAmt + SLWI.SMRetAmt AS TotalRetainage\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\n  AND SLWI.StoredMatls <> 0\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "basic",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to count records in arth by company\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count ARTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM ARTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging buckets (30/60/90+ days) for unpaid invoices by customer\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Use ARTH for transaction data and ARCM for customer names\n2. Filter PayFullDate IS NULL to get only unpaid invoices\n3. Use DATEDIFF and CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need to aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: SELECT * FROM Customers\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'Customers' does not exist in Viewpoint Vista.\n\nUse ARCM (AR Customer Master) for customer information. Vista uses abbreviated table names.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM ARCM WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from APTD\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from APTD ().\n\n```sql\nSELECT *\nFROM APTD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How do I aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate stored materials (Purchased - Installed) for SL billing\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Stored materials for SL billing:\n1. SLWI contains work item/billing details\n2. StoredMatls = Purchased - Installed (materials on-site but not yet used)\n3. WCCost = Work Completed Cost\n4. WCRetAmt and SMRetAmt = separate retainage for work vs materials\n5. Total billable = WCCost + StoredMatls\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description AS ItemDescription,\n  SLWI.StoredMatls,\n  SLWI.WCCost AS WorkCompletedCost,\n  SLWI.StoredMatls + SLWI.WCCost AS TotalBillable,\n  SLWI.WCRetAmt AS WorkRetainage,\n  SLWI.SMRetAmt AS MaterialsRetainage,\n  SLWI.WCRetAmt + SLWI.SMRetAmt AS TotalRetainage\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\n  AND SLWI.StoredMatls <> 0\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from PRTD\n\nDatabase Schema:\nCREATE TABLE PRTD (\n  PRCo bcompany NOT NULL,\n  Craft bcraft NOT NULL,\n  Class bclass NOT NULL,\n  Template smallint NOT NULL,\n  DLCode bedlcode NOT NULL,\n  Factor brate NOT NULL,\n  OldRate bunitcost NOT NULL,\n  NewRate bunitcost NOT NULL,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from PRTD ().\n\n```sql\nSELECT *\nFROM PRTD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "PRTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from ARTH\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from ARTH ().\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate stored materials (Purchased - Installed) for SL billing\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Stored materials for SL billing:\n1. SLWI contains work item/billing details\n2. StoredMatls = Purchased - Installed (materials on-site but not yet used)\n3. WCCost = Work Completed Cost\n4. WCRetAmt and SMRetAmt = separate retainage for work vs materials\n5. Total billable = WCCost + StoredMatls\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description AS ItemDescription,\n  SLWI.StoredMatls,\n  SLWI.WCCost AS WorkCompletedCost,\n  SLWI.StoredMatls + SLWI.WCCost AS TotalBillable,\n  SLWI.WCRetAmt AS WorkRetainage,\n  SLWI.SMRetAmt AS MaterialsRetainage,\n  SLWI.WCRetAmt + SLWI.SMRetAmt AS TotalRetainage\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\n  AND SLWI.StoredMatls <> 0\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get subcontractor costs with original, change orders, invoiced, paid, and retainage by vendor\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Subcontractor cost breakdown by vendor:\n1. Join SLHD (Header) to SLIT (Items) for subcontract details\n2. Join APVM for vendor names\n3. OrigCost = original contract amount\n4. CurCost - OrigCost = change order amounts\n5. InvCost = amounts invoiced\n6. Retainage = amounts held back\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  SLHD.SL AS SubcontractNum,\n  SLHD.Description AS SubcontractDesc,\n  SUM(SLIT.OrigCost) AS OriginalCost,\n  SUM(SLIT.CurCost - SLIT.OrigCost) AS ChangeOrderCost,\n  SUM(SLIT.CurCost) AS CurrentCost,\n  SUM(SLIT.InvCost) AS InvoicedCost,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost - SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nINNER JOIN APVM WITH (NOLOCK) ON SLHD.VendorGroup = APVM.VendorGroup AND SLHD.Vendor = APVM.Vendor\nWHERE SLHD.SLCo = @SLCo\nGROUP BY APVM.Vendor, APVM.Name, SLHD.SL, SLHD.Description\nORDER BY APVM.Name, SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLHD",
        "SLIT",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging buckets (30/60/90+ days) for unpaid invoices by customer\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Use ARTH for transaction data and ARCM for customer names\n2. Filter PayFullDate IS NULL to get only unpaid invoices\n3. Use DATEDIFF and CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to track ap hold status distinguishing retainage vs non-retainage holds\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APCO (\n  APCo bcompany NOT NULL,\n  GLCo bcompany NOT NULL,\n  ExpJrnl bjrnl,\n  GLExpInterfaceLvl tinyint NOT NULL,\n  GLExpSummaryDesc varchar(60),\n  GLExpTransDesc varchar(60),\n  GLJobDetailDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLEquipDetailDesc varchar(60),\n  GLExpDetailDesc varchar(60),\n  PayJrnl bjrnl,\n  GLPayInterfaceLvl tinyint NOT NULL,\n  GLPayDetailDesc varchar(60),\n  GLPaySummaryDesc varchar(60),\n  DiscOffGLAcct bglacct,\n  DiscTakenGLAcct bglacct,\n  ExpPayType tinyint,\n  JobPayType tinyint,\n  SubPayType tinyint,\n  RetPayType tinyint,\n  -- ... 92 more columns,\n  PRIMARY KEY (APCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To distinguish retainage vs non-retainage holds:\n1. Join APTD to APHD for hold details\n2. Join APCO to get RetHoldCode setting\n3. Compare APHD.HoldCode to APCO.RetHoldCode\n4. If equal, it's a retainage hold; otherwise non-retainage\n\n```sql\nSELECT \n  APTD.APCo,\n  APTD.Vendor,\n  APTD.Mth,\n  APTD.APTrans,\n  APHD.HoldCode,\n  CASE WHEN APHD.HoldCode = APCO.RetHoldCode \n       THEN 'Retainage Hold' \n       ELSE 'Non-Retainage Hold' END AS HoldType,\n  APTD.Amount\nFROM APTD WITH (NOLOCK)\nINNER JOIN APHD WITH (NOLOCK) ON APTD.APCo = APHD.APCo \n  AND APTD.Mth = APHD.Mth \n  AND APTD.APTrans = APHD.APTrans \n  AND APTD.APLine = APHD.APLine\nINNER JOIN APCO WITH (NOLOCK) ON APTD.APCo = APCO.APCo\nWHERE APTD.APCo = @APCo\n  AND APHD.HoldCode IS NOT NULL\nORDER BY APTD.Vendor, APTD.Mth\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "basic",
      "tables_used": [
        "APTD",
        "APHD",
        "APCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find jobs over budget with remaining cost projection\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Find jobs over budget:\n1. Aggregate JCCP by job from JCJM\n2. Compare total ActualCost to CurrEstCost\n3. Use HAVING to filter only over-budget jobs\n4. Sort by amount over budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description,\n  SUM(JCCP.CurrEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.CurrEstCost) - SUM(JCCP.ActualCost) AS RemainingBudget,\n  CASE WHEN SUM(JCCP.CurrEstCost) < SUM(JCCP.ActualCost) \n       THEN 'OVER BUDGET' ELSE 'OK' END AS Status\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\nGROUP BY JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.CurrEstCost)\nORDER BY (SUM(JCCP.ActualCost) - SUM(JCCP.CurrEstCost)) DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM",
        "JCCD",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need to track ap hold status distinguishing retainage vs non-retainage holds\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APCO (\n  APCo bcompany NOT NULL,\n  GLCo bcompany NOT NULL,\n  ExpJrnl bjrnl,\n  GLExpInterfaceLvl tinyint NOT NULL,\n  GLExpSummaryDesc varchar(60),\n  GLExpTransDesc varchar(60),\n  GLJobDetailDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLEquipDetailDesc varchar(60),\n  GLExpDetailDesc varchar(60),\n  PayJrnl bjrnl,\n  GLPayInterfaceLvl tinyint NOT NULL,\n  GLPayDetailDesc varchar(60),\n  GLPaySummaryDesc varchar(60),\n  DiscOffGLAcct bglacct,\n  DiscTakenGLAcct bglacct,\n  ExpPayType tinyint,\n  JobPayType tinyint,\n  SubPayType tinyint,\n  RetPayType tinyint,\n  -- ... 92 more columns,\n  PRIMARY KEY (APCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To distinguish retainage vs non-retainage holds:\n1. Join APTD to APHD for hold details\n2. Join APCO to get RetHoldCode setting\n3. Compare APHD.HoldCode to APCO.RetHoldCode\n4. If equal, it's a retainage hold; otherwise non-retainage\n\n```sql\nSELECT \n  APTD.APCo,\n  APTD.Vendor,\n  APTD.Mth,\n  APTD.APTrans,\n  APHD.HoldCode,\n  CASE WHEN APHD.HoldCode = APCO.RetHoldCode \n       THEN 'Retainage Hold' \n       ELSE 'Non-Retainage Hold' END AS HoldType,\n  APTD.Amount\nFROM APTD WITH (NOLOCK)\nINNER JOIN APHD WITH (NOLOCK) ON APTD.APCo = APHD.APCo \n  AND APTD.Mth = APHD.Mth \n  AND APTD.APTrans = APHD.APTrans \n  AND APTD.APLine = APHD.APLine\nINNER JOIN APCO WITH (NOLOCK) ON APTD.APCo = APCO.APCo\nWHERE APTD.APCo = @APCo\n  AND APHD.HoldCode IS NOT NULL\nORDER BY APTD.Vendor, APTD.Mth\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTD",
        "APHD",
        "APCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query to aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get subcontractor costs with original, change orders, invoiced, paid, and retainage by vendor\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Subcontractor cost breakdown by vendor:\n1. Join SLHD (Header) to SLIT (Items) for subcontract details\n2. Join APVM for vendor names\n3. OrigCost = original contract amount\n4. CurCost - OrigCost = change order amounts\n5. InvCost = amounts invoiced\n6. Retainage = amounts held back\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  SLHD.SL AS SubcontractNum,\n  SLHD.Description AS SubcontractDesc,\n  SUM(SLIT.OrigCost) AS OriginalCost,\n  SUM(SLIT.CurCost - SLIT.OrigCost) AS ChangeOrderCost,\n  SUM(SLIT.CurCost) AS CurrentCost,\n  SUM(SLIT.InvCost) AS InvoicedCost,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost - SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nINNER JOIN APVM WITH (NOLOCK) ON SLHD.VendorGroup = APVM.VendorGroup AND SLHD.Vendor = APVM.Vendor\nWHERE SLHD.SLCo = @SLCo\nGROUP BY APVM.Vendor, APVM.Name, SLHD.SL, SLHD.Description\nORDER BY APVM.Name, SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "basic",
      "tables_used": [
        "SLHD",
        "SLIT",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate stored materials (Purchased - Installed) for SL billing\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Stored materials for SL billing:\n1. SLWI contains work item/billing details\n2. StoredMatls = Purchased - Installed (materials on-site but not yet used)\n3. WCCost = Work Completed Cost\n4. WCRetAmt and SMRetAmt = separate retainage for work vs materials\n5. Total billable = WCCost + StoredMatls\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description AS ItemDescription,\n  SLWI.StoredMatls,\n  SLWI.WCCost AS WorkCompletedCost,\n  SLWI.StoredMatls + SLWI.WCCost AS TotalBillable,\n  SLWI.WCRetAmt AS WorkRetainage,\n  SLWI.SMRetAmt AS MaterialsRetainage,\n  SLWI.WCRetAmt + SLWI.SMRetAmt AS TotalRetainage\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\n  AND SLWI.StoredMatls <> 0\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "basic",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get customer balance summary by customer group\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Customer balance summary by group:\n1. Join ARTH to ARCM for customer details\n2. Use conditional SUM for open vs total balances\n3. Group by CustGroup for summary\n\n```sql\nSELECT \n  ARTH.CustGroup,\n  COUNT(DISTINCT ARTH.Customer) AS CustomerCount,\n  SUM(CASE WHEN ARTH.PayFullDate IS NULL THEN ARTH.Amount ELSE 0 END) AS OpenBalance,\n  SUM(ARTH.Amount) AS TotalBilled\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\nGROUP BY ARTH.CustGroup\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How do I aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate stored materials (Purchased - Installed) for SL billing\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Stored materials for SL billing:\n1. SLWI contains work item/billing details\n2. StoredMatls = Purchased - Installed (materials on-site but not yet used)\n3. WCCost = Work Completed Cost\n4. WCRetAmt and SMRetAmt = separate retainage for work vs materials\n5. Total billable = WCCost + StoredMatls\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description AS ItemDescription,\n  SLWI.StoredMatls,\n  SLWI.WCCost AS WorkCompletedCost,\n  SLWI.StoredMatls + SLWI.WCCost AS TotalBillable,\n  SLWI.WCRetAmt AS WorkRetainage,\n  SLWI.SMRetAmt AS MaterialsRetainage,\n  SLWI.WCRetAmt + SLWI.SMRetAmt AS TotalRetainage\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\n  AND SLWI.StoredMatls <> 0\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: reconcile ap oncost batch lines with original transactions\n\nDatabase Schema:\nCREATE TABLE APTL (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equip bequip,\n  EMGroup bgroup,\n  -- ... 56 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans, APLine)\n);\n\nCREATE TABLE APLB (\n  Co bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  BatchId bbatchid NOT NULL,\n  BatchSeq int NOT NULL,\n  APLine smallint NOT NULL,\n  BatchTransType char(1) NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  -- ... 120 more columns,\n  PRIMARY KEY (Co, Mth, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APHB (\n  Co bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  BatchId bbatchid NOT NULL,\n  BatchSeq int NOT NULL,\n  BatchTransType char(1) NOT NULL,\n  APTrans btrans,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  -- ... 88 more columns,\n  PRIMARY KEY (Co, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To reconcile AP oncost batches with original transactions:\n1. Join APLB (batch lines) to APTL (original lines) using ocApplyMth, ocApplyTrans, ocApplyLine\n2. Include APHB for batch header info\n3. Join to APTH and APVM for vendor context\n4. Compare batch vs original amounts\n\n```sql\nSELECT \n  APLB.Co AS BatchCo,\n  APLB.Mth AS BatchMth,\n  APLB.BatchId,\n  APLB.BatchSeq,\n  APLB.ocApplyMth,\n  APLB.ocApplyTrans,\n  APLB.ocApplyLine,\n  APTL.APCo AS OrigCo,\n  APTL.Mth AS OrigMth,\n  APTL.APTrans AS OrigTrans,\n  APTL.APLine AS OrigLine,\n  APTL.GrossAmt AS OrigAmount,\n  APLB.GrossAmt AS BatchAmount,\n  APVM.Name AS VendorName\nFROM APLB WITH (NOLOCK)\nINNER JOIN APHB WITH (NOLOCK) ON APLB.Co = APHB.Co AND APLB.Mth = APHB.Mth AND APLB.BatchId = APHB.BatchId\nINNER JOIN APTL WITH (NOLOCK) ON APLB.ocApplyMth = APTL.Mth \n  AND APLB.ocApplyTrans = APTL.APTrans \n  AND APLB.ocApplyLine = APTL.APLine\n  AND APLB.Co = APTL.APCo\nINNER JOIN APTH WITH (NOLOCK) ON APTL.APCo = APTH.APCo AND APTL.Mth = APTH.Mth AND APTL.APTrans = APTH.APTrans\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APLB.Co = @Co\nORDER BY APLB.BatchId, APLB.BatchSeq\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APLB",
        "APHB",
        "APTL",
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need to count records in arth by company\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count ARTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM ARTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: count records in prth by company\n\nDatabase Schema:\nCREATE TABLE PRTH (\n  PRCo bcompany NOT NULL,\n  PRGroup bgroup NOT NULL,\n  PREndDate bdate NOT NULL,\n  Employee bemployee NOT NULL,\n  PaySeq tinyint NOT NULL,\n  PostSeq smallint NOT NULL,\n  Type char(1) NOT NULL,\n  PostDate bdate NOT NULL,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCDept bdept,\n  GLCo bcompany NOT NULL,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equipment bequip,\n  EMGroup tinyint,\n  CostCode bcostcode,\n  -- ... 41 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count PRTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM PRTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "PRTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query to aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoice totals with discounts and retainage\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Vendor invoice summary with discounts and retainage:\n1. Join APTH to APVM for vendor details\n2. Aggregate by vendor\n3. Include GrossAmt, DiscOffer, Retainage, and Balance\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(APTH.APTrans) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS GrossAmount,\n  SUM(APTH.DiscOffer) AS DiscountsOffered,\n  SUM(APTH.Retainage) AS RetainageHeld,\n  SUM(APTH.Balance) AS OpenBalance\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to query Transactions\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'Transactions' does not exist in Viewpoint Vista.\n\nUse GLDT (GL Detail) for GL transactions, or module-specific tables like APTH, ARTH, JCCD.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM GLDT WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get job cost variance by phase comparing budget to actual\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Job cost variance by phase:\n1. Join JCJM (Job Master) to JCCP (Cost Phase)\n2. Calculate variance as CurrEstCost - ActualCost\n3. Calculate percent complete from actuals vs budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  JCCP.Phase,\n  JCCP.CostType,\n  JCCP.OrigEstCost AS OriginalBudget,\n  JCCP.CurrEstCost AS CurrentBudget,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS Variance,\n  CASE WHEN JCCP.CurrEstCost <> 0 \n       THEN (JCCP.ActualCost / JCCP.CurrEstCost) * 100 \n       ELSE 0 END AS PercentComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.Job = @Job\nORDER BY JCCP.Phase, JCCP.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from JCCD\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from JCCD ().\n\n```sql\nSELECT *\nFROM JCCD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find jobs over budget with remaining cost projection\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Find jobs over budget:\n1. Aggregate JCCP by job from JCJM\n2. Compare total ActualCost to CurrEstCost\n3. Use HAVING to filter only over-budget jobs\n4. Sort by amount over budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description,\n  SUM(JCCP.CurrEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.CurrEstCost) - SUM(JCCP.ActualCost) AS RemainingBudget,\n  CASE WHEN SUM(JCCP.CurrEstCost) < SUM(JCCP.ActualCost) \n       THEN 'OVER BUDGET' ELSE 'OK' END AS Status\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\nGROUP BY JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.CurrEstCost)\nORDER BY (SUM(JCCP.ActualCost) - SUM(JCCP.CurrEstCost)) DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM",
        "JCCD",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need to aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get data from GLDT for analysis\n\nDatabase Schema:\nCREATE TABLE PREH (\n  PRCo bcompany NOT NULL,\n  Employee bemployee NOT NULL,\n  LastName varchar(30) NOT NULL,\n  FirstName varchar(30),\n  MidName varchar(15),\n  SortName bsortname NOT NULL,\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  Phone bphone,\n  SSN char(11) NOT NULL,\n  Race char(2) NOT NULL,\n  Sex char(1) NOT NULL,\n  BirthDate smalldatetime,\n  HireDate bdate,\n  TermDate bdate,\n  PRGroup bgroup NOT NULL,\n  PRDept bdept NOT NULL,\n  -- ... 121 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nCREATE TABLE PRTH (\n  PRCo bcompany NOT NULL,\n  PRGroup bgroup NOT NULL,\n  PREndDate bdate NOT NULL,\n  Employee bemployee NOT NULL,\n  PaySeq tinyint NOT NULL,\n  PostSeq smallint NOT NULL,\n  Type char(1) NOT NULL,\n  PostDate bdate NOT NULL,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCDept bdept,\n  GLCo bcompany NOT NULL,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equipment bequip,\n  EMGroup tinyint,\n  CostCode bcostcode,\n  -- ... 41 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'GLDT' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nPREH, PRTH\n\nTo include GLDT in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get customer balance summary by customer group\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Customer balance summary by group:\n1. Join ARTH to ARCM for customer details\n2. Use conditional SUM for open vs total balances\n3. Group by CustGroup for summary\n\n```sql\nSELECT \n  ARTH.CustGroup,\n  COUNT(DISTINCT ARTH.Customer) AS CustomerCount,\n  SUM(CASE WHEN ARTH.PayFullDate IS NULL THEN ARTH.Amount ELSE 0 END) AS OpenBalance,\n  SUM(ARTH.Amount) AS TotalBilled\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\nGROUP BY ARTH.CustGroup\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from PRTH\n\nDatabase Schema:\nCREATE TABLE PRTH (\n  PRCo bcompany NOT NULL,\n  PRGroup bgroup NOT NULL,\n  PREndDate bdate NOT NULL,\n  Employee bemployee NOT NULL,\n  PaySeq tinyint NOT NULL,\n  PostSeq smallint NOT NULL,\n  Type char(1) NOT NULL,\n  PostDate bdate NOT NULL,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCDept bdept,\n  GLCo bcompany NOT NULL,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equipment bequip,\n  EMGroup tinyint,\n  CostCode bcostcode,\n  -- ... 41 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from PRTH ().\n\n```sql\nSELECT *\nFROM PRTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "PRTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from PREH\n\nDatabase Schema:\nCREATE TABLE PREH (\n  PRCo bcompany NOT NULL,\n  Employee bemployee NOT NULL,\n  LastName varchar(30) NOT NULL,\n  FirstName varchar(30),\n  MidName varchar(15),\n  SortName bsortname NOT NULL,\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  Phone bphone,\n  SSN char(11) NOT NULL,\n  Race char(2) NOT NULL,\n  Sex char(1) NOT NULL,\n  BirthDate smalldatetime,\n  HireDate bdate,\n  TermDate bdate,\n  PRGroup bgroup NOT NULL,\n  PRDept bdept NOT NULL,\n  -- ... 121 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from PREH ().\n\n```sql\nSELECT *\nFROM PREH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "PREH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get customer balance summary by customer group\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Customer balance summary by group:\n1. Join ARTH to ARCM for customer details\n2. Use conditional SUM for open vs total balances\n3. Group by CustGroup for summary\n\n```sql\nSELECT \n  ARTH.CustGroup,\n  COUNT(DISTINCT ARTH.Customer) AS CustomerCount,\n  SUM(CASE WHEN ARTH.PayFullDate IS NULL THEN ARTH.Amount ELSE 0 END) AS OpenBalance,\n  SUM(ARTH.Amount) AS TotalBilled\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\nGROUP BY ARTH.CustGroup\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging buckets (30/60/90+ days) for unpaid invoices by customer\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Use ARTH for transaction data and ARCM for customer names\n2. Filter PayFullDate IS NULL to get only unpaid invoices\n3. Use DATEDIFF and CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging buckets (30/60/90+ days) for unpaid invoices by customer\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Use ARTH for transaction data and ARCM for customer names\n2. Filter PayFullDate IS NULL to get only unpaid invoices\n3. Use DATEDIFF and CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: List all fields in WorkOrders\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'WorkOrders' does not exist in Viewpoint Vista.\n\nUse SMWorkOrder for service management work orders.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM SMWorkOrder WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to count records in aptd by company\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count APTD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM APTD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from SLWI\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from SLWI ().\n\n```sql\nSELECT *\nFROM SLWI WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "SLWI"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoice totals with discounts and retainage\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Vendor invoice summary with discounts and retainage:\n1. Join APTH to APVM for vendor details\n2. Aggregate by vendor\n3. Include GrossAmt, DiscOffer, Retainage, and Balance\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(APTH.APTrans) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS GrossAmount,\n  SUM(APTH.DiscOffer) AS DiscountsOffered,\n  SUM(APTH.Retainage) AS RetainageHeld,\n  SUM(APTH.Balance) AS OpenBalance\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "basic",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find all unpaid AR invoices older than 60 days\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find unpaid invoices over 60 days:\n1. Join ARTH to ARCM for customer information\n2. Filter PayFullDate IS NULL (unpaid)\n3. Use DATEDIFF to calculate age and filter > 60 days\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Mth,\n  ARTH.ARTrans,\n  ARCM.Name AS CustomerName,\n  ARTH.TransDate,\n  ARTH.Amount,\n  DATEDIFF(day, ARTH.TransDate, GETDATE()) AS DaysOutstanding\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\n  AND DATEDIFF(day, ARTH.TransDate, GETDATE()) > 60\nORDER BY ARTH.TransDate\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoices with their subcontract details\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I can partially answer this query, but the schema is incomplete.\n\nTo include subcontract details, the SLHD table is needed but not provided in the schema.\n\nHere's what I can provide with the available schema:\n\n```sql\nSELECT *\nFROM APTH WITH (NOLOCK)\nWHERE Co = @Co\n-- Note: Additional joins for SLHD would be needed for complete results\n```\n\nTo get the complete data you requested, please provide the DDL for SLHD.",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": [
        "APTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: count records in aptd by company\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count APTD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM APTD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How do I reconcile ap oncost batch lines with original transactions\n\nDatabase Schema:\nCREATE TABLE APTL (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equip bequip,\n  EMGroup bgroup,\n  -- ... 56 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans, APLine)\n);\n\nCREATE TABLE APLB (\n  Co bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  BatchId bbatchid NOT NULL,\n  BatchSeq int NOT NULL,\n  APLine smallint NOT NULL,\n  BatchTransType char(1) NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  -- ... 120 more columns,\n  PRIMARY KEY (Co, Mth, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APHB (\n  Co bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  BatchId bbatchid NOT NULL,\n  BatchSeq int NOT NULL,\n  BatchTransType char(1) NOT NULL,\n  APTrans btrans,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  -- ... 88 more columns,\n  PRIMARY KEY (Co, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To reconcile AP oncost batches with original transactions:\n1. Join APLB (batch lines) to APTL (original lines) using ocApplyMth, ocApplyTrans, ocApplyLine\n2. Include APHB for batch header info\n3. Join to APTH and APVM for vendor context\n4. Compare batch vs original amounts\n\n```sql\nSELECT \n  APLB.Co AS BatchCo,\n  APLB.Mth AS BatchMth,\n  APLB.BatchId,\n  APLB.BatchSeq,\n  APLB.ocApplyMth,\n  APLB.ocApplyTrans,\n  APLB.ocApplyLine,\n  APTL.APCo AS OrigCo,\n  APTL.Mth AS OrigMth,\n  APTL.APTrans AS OrigTrans,\n  APTL.APLine AS OrigLine,\n  APTL.GrossAmt AS OrigAmount,\n  APLB.GrossAmt AS BatchAmount,\n  APVM.Name AS VendorName\nFROM APLB WITH (NOLOCK)\nINNER JOIN APHB WITH (NOLOCK) ON APLB.Co = APHB.Co AND APLB.Mth = APHB.Mth AND APLB.BatchId = APHB.BatchId\nINNER JOIN APTL WITH (NOLOCK) ON APLB.ocApplyMth = APTL.Mth \n  AND APLB.ocApplyTrans = APTL.APTrans \n  AND APLB.ocApplyLine = APTL.APLine\n  AND APLB.Co = APTL.APCo\nINNER JOIN APTH WITH (NOLOCK) ON APTL.APCo = APTH.APCo AND APTL.Mth = APTH.Mth AND APTL.APTrans = APTH.APTrans\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APLB.Co = @Co\nORDER BY APLB.BatchId, APLB.BatchSeq\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APLB",
        "APHB",
        "APTL",
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: count records in arth by company\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count ARTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM ARTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: What is the schema for CostCodes?\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'CostCodes' does not exist in Viewpoint Vista.\n\nUse JCCP (JC Cost Phase) for cost code/phase information with cost details.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM JCCP WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query to count records in arth by company\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count ARTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM ARTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to track ap hold status distinguishing retainage vs non-retainage holds\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APCO (\n  APCo bcompany NOT NULL,\n  GLCo bcompany NOT NULL,\n  ExpJrnl bjrnl,\n  GLExpInterfaceLvl tinyint NOT NULL,\n  GLExpSummaryDesc varchar(60),\n  GLExpTransDesc varchar(60),\n  GLJobDetailDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLEquipDetailDesc varchar(60),\n  GLExpDetailDesc varchar(60),\n  PayJrnl bjrnl,\n  GLPayInterfaceLvl tinyint NOT NULL,\n  GLPayDetailDesc varchar(60),\n  GLPaySummaryDesc varchar(60),\n  DiscOffGLAcct bglacct,\n  DiscTakenGLAcct bglacct,\n  ExpPayType tinyint,\n  JobPayType tinyint,\n  SubPayType tinyint,\n  RetPayType tinyint,\n  -- ... 92 more columns,\n  PRIMARY KEY (APCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To distinguish retainage vs non-retainage holds:\n1. Join APTD to APHD for hold details\n2. Join APCO to get RetHoldCode setting\n3. Compare APHD.HoldCode to APCO.RetHoldCode\n4. If equal, it's a retainage hold; otherwise non-retainage\n\n```sql\nSELECT \n  APTD.APCo,\n  APTD.Vendor,\n  APTD.Mth,\n  APTD.APTrans,\n  APHD.HoldCode,\n  CASE WHEN APHD.HoldCode = APCO.RetHoldCode \n       THEN 'Retainage Hold' \n       ELSE 'Non-Retainage Hold' END AS HoldType,\n  APTD.Amount\nFROM APTD WITH (NOLOCK)\nINNER JOIN APHD WITH (NOLOCK) ON APTD.APCo = APHD.APCo \n  AND APTD.Mth = APHD.Mth \n  AND APTD.APTrans = APHD.APTrans \n  AND APTD.APLine = APHD.APLine\nINNER JOIN APCO WITH (NOLOCK) ON APTD.APCo = APCO.APCo\nWHERE APTD.APCo = @APCo\n  AND APHD.HoldCode IS NOT NULL\nORDER BY APTD.Vendor, APTD.Mth\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "basic",
      "tables_used": [
        "APTD",
        "APHD",
        "APCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Include SLHD in the query\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'SLHD' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nJCJM, JCCD\n\nTo include SLHD in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: count records in preh by company\n\nDatabase Schema:\nCREATE TABLE PREH (\n  PRCo bcompany NOT NULL,\n  Employee bemployee NOT NULL,\n  LastName varchar(30) NOT NULL,\n  FirstName varchar(30),\n  MidName varchar(15),\n  SortName bsortname NOT NULL,\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  Phone bphone,\n  SSN char(11) NOT NULL,\n  Race char(2) NOT NULL,\n  Sex char(1) NOT NULL,\n  BirthDate smalldatetime,\n  HireDate bdate,\n  TermDate bdate,\n  PRGroup bgroup NOT NULL,\n  PRDept bdept NOT NULL,\n  -- ... 121 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count PREH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM PREH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "PREH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get customer balance summary by customer group\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Customer balance summary by group:\n1. Join ARTH to ARCM for customer details\n2. Use conditional SUM for open vs total balances\n3. Group by CustGroup for summary\n\n```sql\nSELECT \n  ARTH.CustGroup,\n  COUNT(DISTINCT ARTH.Customer) AS CustomerCount,\n  SUM(CASE WHEN ARTH.PayFullDate IS NULL THEN ARTH.Amount ELSE 0 END) AS OpenBalance,\n  SUM(ARTH.Amount) AS TotalBilled\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\nGROUP BY ARTH.CustGroup\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get subcontractor costs with original, change orders, invoiced, paid, and retainage by vendor\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Subcontractor cost breakdown by vendor:\n1. Join SLHD (Header) to SLIT (Items) for subcontract details\n2. Join APVM for vendor names\n3. OrigCost = original contract amount\n4. CurCost - OrigCost = change order amounts\n5. InvCost = amounts invoiced\n6. Retainage = amounts held back\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  SLHD.SL AS SubcontractNum,\n  SLHD.Description AS SubcontractDesc,\n  SUM(SLIT.OrigCost) AS OriginalCost,\n  SUM(SLIT.CurCost - SLIT.OrigCost) AS ChangeOrderCost,\n  SUM(SLIT.CurCost) AS CurrentCost,\n  SUM(SLIT.InvCost) AS InvoicedCost,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost - SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nINNER JOIN APVM WITH (NOLOCK) ON SLHD.VendorGroup = APVM.VendorGroup AND SLHD.Vendor = APVM.Vendor\nWHERE SLHD.SLCo = @SLCo\nGROUP BY APVM.Vendor, APVM.Name, SLHD.SL, SLHD.Description\nORDER BY APVM.Name, SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "intermediate",
      "tables_used": [
        "SLHD",
        "SLIT",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get job cost variance by phase comparing budget to actual\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Job cost variance by phase:\n1. Join JCJM (Job Master) to JCCP (Cost Phase)\n2. Calculate variance as CurrEstCost - ActualCost\n3. Calculate percent complete from actuals vs budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  JCCP.Phase,\n  JCCP.CostType,\n  JCCP.OrigEstCost AS OriginalBudget,\n  JCCP.CurrEstCost AS CurrentBudget,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS Variance,\n  CASE WHEN JCCP.CurrEstCost <> 0 \n       THEN (JCCP.ActualCost / JCCP.CurrEstCost) * 100 \n       ELSE 0 END AS PercentComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.Job = @Job\nORDER BY JCCP.Phase, JCCP.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoice totals with discounts and retainage\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Vendor invoice summary with discounts and retainage:\n1. Join APTH to APVM for vendor details\n2. Aggregate by vendor\n3. Include GrossAmt, DiscOffer, Retainage, and Balance\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(APTH.APTrans) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS GrossAmount,\n  SUM(APTH.DiscOffer) AS DiscountsOffered,\n  SUM(APTH.Retainage) AS RetainageHeld,\n  SUM(APTH.Balance) AS OpenBalance\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "basic",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find all unpaid AR invoices older than 60 days\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find unpaid invoices over 60 days:\n1. Join ARTH to ARCM for customer information\n2. Filter PayFullDate IS NULL (unpaid)\n3. Use DATEDIFF to calculate age and filter > 60 days\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Mth,\n  ARTH.ARTrans,\n  ARCM.Name AS CustomerName,\n  ARTH.TransDate,\n  ARTH.Amount,\n  DATEDIFF(day, ARTH.TransDate, GETDATE()) AS DaysOutstanding\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\n  AND DATEDIFF(day, ARTH.TransDate, GETDATE()) > 60\nORDER BY ARTH.TransDate\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: count records in arth by company\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count ARTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM ARTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from ARTH\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from ARTH ().\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find jobs over budget with remaining cost projection\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Find jobs over budget:\n1. Aggregate JCCP by job from JCJM\n2. Compare total ActualCost to CurrEstCost\n3. Use HAVING to filter only over-budget jobs\n4. Sort by amount over budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description,\n  SUM(JCCP.CurrEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.CurrEstCost) - SUM(JCCP.ActualCost) AS RemainingBudget,\n  CASE WHEN SUM(JCCP.CurrEstCost) < SUM(JCCP.ActualCost) \n       THEN 'OVER BUDGET' ELSE 'OK' END AS Status\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\nGROUP BY JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.CurrEstCost)\nORDER BY (SUM(JCCP.ActualCost) - SUM(JCCP.CurrEstCost)) DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCJM",
        "JCCD",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Query SLHD along with the schema tables\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'SLHD' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nJCJM, JCCD\n\nTo include SLHD in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from GLDT\n\nDatabase Schema:\nCREATE TABLE GLDT (\n  GLCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  GLTrans btrans NOT NULL,\n  GLAcct bglacct NOT NULL,\n  Jrnl bjrnl NOT NULL,\n  GLRef bglref NOT NULL,\n  SourceCo bcompany NOT NULL,\n  Source bsource NOT NULL,\n  ActDate bdate NOT NULL,\n  DatePosted bdate NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid NOT NULL,\n  Amount bdollar NOT NULL,\n  RevStatus tinyint NOT NULL,\n  Adjust char(1) NOT NULL,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  UniqueAttchID uniqueidentifier,\n  SrcTable varchar(128),\n  SrcKeyID bigint,\n  PRIMARY KEY (GLCo, Mth, GLTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from GLDT ().\n\n```sql\nSELECT *\nFROM GLDT WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "GLDT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoice totals with discounts and retainage\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Vendor invoice summary with discounts and retainage:\n1. Join APTH to APVM for vendor details\n2. Aggregate by vendor\n3. Include GrossAmt, DiscOffer, Retainage, and Balance\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(APTH.APTrans) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS GrossAmount,\n  SUM(APTH.DiscOffer) AS DiscountsOffered,\n  SUM(APTH.Retainage) AS RetainageHeld,\n  SUM(APTH.Balance) AS OpenBalance\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from APTH\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from APTH ().\n\n```sql\nSELECT *\nFROM APTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get data from ARCM for analysis\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'ARCM' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nAPTH, APVM\n\nTo include ARCM in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query to count records in arth by company\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count ARTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM ARTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from APTH\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from APTH ().\n\n```sql\nSELECT *\nFROM APTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to count records in preh by company\n\nDatabase Schema:\nCREATE TABLE PREH (\n  PRCo bcompany NOT NULL,\n  Employee bemployee NOT NULL,\n  LastName varchar(30) NOT NULL,\n  FirstName varchar(30),\n  MidName varchar(15),\n  SortName bsortname NOT NULL,\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  Phone bphone,\n  SSN char(11) NOT NULL,\n  Race char(2) NOT NULL,\n  Sex char(1) NOT NULL,\n  BirthDate smalldatetime,\n  HireDate bdate,\n  TermDate bdate,\n  PRGroup bgroup NOT NULL,\n  PRDept bdept NOT NULL,\n  -- ... 121 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count PREH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM PREH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "PREH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from SLWI\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from SLWI ().\n\n```sql\nSELECT *\nFROM SLWI WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "SLWI"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to count records in arth by company\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count ARTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM ARTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoice totals with discounts and retainage\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Vendor invoice summary with discounts and retainage:\n1. Join APTH to APVM for vendor details\n2. Aggregate by vendor\n3. Include GrossAmt, DiscOffer, Retainage, and Balance\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(APTH.APTrans) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS GrossAmount,\n  SUM(APTH.DiscOffer) AS DiscountsOffered,\n  SUM(APTH.Retainage) AS RetainageHeld,\n  SUM(APTH.Balance) AS OpenBalance\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from PREH\n\nDatabase Schema:\nCREATE TABLE PREH (\n  PRCo bcompany NOT NULL,\n  Employee bemployee NOT NULL,\n  LastName varchar(30) NOT NULL,\n  FirstName varchar(30),\n  MidName varchar(15),\n  SortName bsortname NOT NULL,\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  Phone bphone,\n  SSN char(11) NOT NULL,\n  Race char(2) NOT NULL,\n  Sex char(1) NOT NULL,\n  BirthDate smalldatetime,\n  HireDate bdate,\n  TermDate bdate,\n  PRGroup bgroup NOT NULL,\n  PRDept bdept NOT NULL,\n  -- ... 121 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from PREH ().\n\n```sql\nSELECT *\nFROM PREH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "PREH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging buckets (30/60/90+ days) for unpaid invoices by customer\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Use ARTH for transaction data and ARCM for customer names\n2. Filter PayFullDate IS NULL to get only unpaid invoices\n3. Use DATEDIFF and CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoice totals with discounts and retainage\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Vendor invoice summary with discounts and retainage:\n1. Join APTH to APVM for vendor details\n2. Aggregate by vendor\n3. Include GrossAmt, DiscOffer, Retainage, and Balance\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(APTH.APTrans) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS GrossAmount,\n  SUM(APTH.DiscOffer) AS DiscountsOffered,\n  SUM(APTH.Retainage) AS RetainageHeld,\n  SUM(APTH.Balance) AS OpenBalance\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to reconcile ap oncost batch lines with original transactions\n\nDatabase Schema:\nCREATE TABLE APTL (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equip bequip,\n  EMGroup bgroup,\n  -- ... 56 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans, APLine)\n);\n\nCREATE TABLE APLB (\n  Co bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  BatchId bbatchid NOT NULL,\n  BatchSeq int NOT NULL,\n  APLine smallint NOT NULL,\n  BatchTransType char(1) NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  -- ... 120 more columns,\n  PRIMARY KEY (Co, Mth, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APHB (\n  Co bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  BatchId bbatchid NOT NULL,\n  BatchSeq int NOT NULL,\n  BatchTransType char(1) NOT NULL,\n  APTrans btrans,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  -- ... 88 more columns,\n  PRIMARY KEY (Co, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To reconcile AP oncost batches with original transactions:\n1. Join APLB (batch lines) to APTL (original lines) using ocApplyMth, ocApplyTrans, ocApplyLine\n2. Include APHB for batch header info\n3. Join to APTH and APVM for vendor context\n4. Compare batch vs original amounts\n\n```sql\nSELECT \n  APLB.Co AS BatchCo,\n  APLB.Mth AS BatchMth,\n  APLB.BatchId,\n  APLB.BatchSeq,\n  APLB.ocApplyMth,\n  APLB.ocApplyTrans,\n  APLB.ocApplyLine,\n  APTL.APCo AS OrigCo,\n  APTL.Mth AS OrigMth,\n  APTL.APTrans AS OrigTrans,\n  APTL.APLine AS OrigLine,\n  APTL.GrossAmt AS OrigAmount,\n  APLB.GrossAmt AS BatchAmount,\n  APVM.Name AS VendorName\nFROM APLB WITH (NOLOCK)\nINNER JOIN APHB WITH (NOLOCK) ON APLB.Co = APHB.Co AND APLB.Mth = APHB.Mth AND APLB.BatchId = APHB.BatchId\nINNER JOIN APTL WITH (NOLOCK) ON APLB.ocApplyMth = APTL.Mth \n  AND APLB.ocApplyTrans = APTL.APTrans \n  AND APLB.ocApplyLine = APTL.APLine\n  AND APLB.Co = APTL.APCo\nINNER JOIN APTH WITH (NOLOCK) ON APTL.APCo = APTH.APCo AND APTL.Mth = APTH.Mth AND APTL.APTrans = APTH.APTrans\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APLB.Co = @Co\nORDER BY APLB.BatchId, APLB.BatchSeq\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APLB",
        "APHB",
        "APTL",
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to count records in gljr by company\n\nDatabase Schema:\nCREATE TABLE GLJR (\n  GLCo bcompany NOT NULL,\n  Jrnl bjrnl NOT NULL,\n  Description btransdesc,\n  Rev byn NOT NULL,\n  RevJrnl bjrnl,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count GLJR records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM GLJR WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "GLJR"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from ARTH\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from ARTH ().\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging buckets (30/60/90+ days) for unpaid invoices by customer\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Use ARTH for transaction data and ARCM for customer names\n2. Filter PayFullDate IS NULL to get only unpaid invoices\n3. Use DATEDIFF and CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from GLAC\n\nDatabase Schema:\nCREATE TABLE GLAC (\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  Description bdesc,\n  AcctType char(1) NOT NULL,\n  SubType char(1),\n  NormBal char(1),\n  InterfaceDetail byn NOT NULL,\n  Active byn NOT NULL,\n  SummaryAcct bglacct NOT NULL,\n  CashAccrual char(1) NOT NULL,\n  CashOffAcct bglacct,\n  Notes varchar,\n  Part1 varchar(20),\n  Part2 varchar(20),\n  Part3 varchar(20),\n  Part4 varchar(20),\n  Part5 varchar(20),\n  Part6 varchar(20),\n  AllParts varchar(20),\n  CrossRefMemAcct bglacct,\n  -- ... 3 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from GLAC ().\n\n```sql\nSELECT *\nFROM GLAC WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "GLAC"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoices with their subcontract details\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I can partially answer this query, but the schema is incomplete.\n\nTo include subcontract details, the SLHD table is needed but not provided in the schema.\n\nHere's what I can provide with the available schema:\n\n```sql\nSELECT *\nFROM APTH WITH (NOLOCK)\nWHERE Co = @Co\n-- Note: Additional joins for SLHD would be needed for complete results\n```\n\nTo get the complete data you requested, please provide the DDL for SLHD.",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": [
        "APTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need to count records in slhd by company\n\nDatabase Schema:\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count SLHD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM SLHD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "SLHD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need to count records in slwi by company\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count SLWI records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM SLWI WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "SLWI"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query to track ap hold status distinguishing retainage vs non-retainage holds\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APCO (\n  APCo bcompany NOT NULL,\n  GLCo bcompany NOT NULL,\n  ExpJrnl bjrnl,\n  GLExpInterfaceLvl tinyint NOT NULL,\n  GLExpSummaryDesc varchar(60),\n  GLExpTransDesc varchar(60),\n  GLJobDetailDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLEquipDetailDesc varchar(60),\n  GLExpDetailDesc varchar(60),\n  PayJrnl bjrnl,\n  GLPayInterfaceLvl tinyint NOT NULL,\n  GLPayDetailDesc varchar(60),\n  GLPaySummaryDesc varchar(60),\n  DiscOffGLAcct bglacct,\n  DiscTakenGLAcct bglacct,\n  ExpPayType tinyint,\n  JobPayType tinyint,\n  SubPayType tinyint,\n  RetPayType tinyint,\n  -- ... 92 more columns,\n  PRIMARY KEY (APCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To distinguish retainage vs non-retainage holds:\n1. Join APTD to APHD for hold details\n2. Join APCO to get RetHoldCode setting\n3. Compare APHD.HoldCode to APCO.RetHoldCode\n4. If equal, it's a retainage hold; otherwise non-retainage\n\n```sql\nSELECT \n  APTD.APCo,\n  APTD.Vendor,\n  APTD.Mth,\n  APTD.APTrans,\n  APHD.HoldCode,\n  CASE WHEN APHD.HoldCode = APCO.RetHoldCode \n       THEN 'Retainage Hold' \n       ELSE 'Non-Retainage Hold' END AS HoldType,\n  APTD.Amount\nFROM APTD WITH (NOLOCK)\nINNER JOIN APHD WITH (NOLOCK) ON APTD.APCo = APHD.APCo \n  AND APTD.Mth = APHD.Mth \n  AND APTD.APTrans = APHD.APTrans \n  AND APTD.APLine = APHD.APLine\nINNER JOIN APCO WITH (NOLOCK) ON APTD.APCo = APCO.APCo\nWHERE APTD.APCo = @APCo\n  AND APHD.HoldCode IS NOT NULL\nORDER BY APTD.Vendor, APTD.Mth\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTD",
        "APHD",
        "APCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from JCCD\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from JCCD ().\n\n```sql\nSELECT *\nFROM JCCD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need to aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need to aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoice totals with discounts and retainage\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Vendor invoice summary with discounts and retainage:\n1. Join APTH to APVM for vendor details\n2. Aggregate by vendor\n3. Include GrossAmt, DiscOffer, Retainage, and Balance\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(APTH.APTrans) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS GrossAmount,\n  SUM(APTH.DiscOffer) AS DiscountsOffered,\n  SUM(APTH.Retainage) AS RetainageHeld,\n  SUM(APTH.Balance) AS OpenBalance\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging buckets (30/60/90+ days) for unpaid invoices by customer\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Use ARTH for transaction data and ARCM for customer names\n2. Filter PayFullDate IS NULL to get only unpaid invoices\n3. Use DATEDIFF and CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get customer balance summary by customer group\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Customer balance summary by group:\n1. Join ARTH to ARCM for customer details\n2. Use conditional SUM for open vs total balances\n3. Group by CustGroup for summary\n\n```sql\nSELECT \n  ARTH.CustGroup,\n  COUNT(DISTINCT ARTH.Customer) AS CustomerCount,\n  SUM(CASE WHEN ARTH.PayFullDate IS NULL THEN ARTH.Amount ELSE 0 END) AS OpenBalance,\n  SUM(ARTH.Amount) AS TotalBilled\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\nGROUP BY ARTH.CustGroup\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to count records in jccd by company\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count JCCD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM JCCD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need to track ap hold status distinguishing retainage vs non-retainage holds\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APCO (\n  APCo bcompany NOT NULL,\n  GLCo bcompany NOT NULL,\n  ExpJrnl bjrnl,\n  GLExpInterfaceLvl tinyint NOT NULL,\n  GLExpSummaryDesc varchar(60),\n  GLExpTransDesc varchar(60),\n  GLJobDetailDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLEquipDetailDesc varchar(60),\n  GLExpDetailDesc varchar(60),\n  PayJrnl bjrnl,\n  GLPayInterfaceLvl tinyint NOT NULL,\n  GLPayDetailDesc varchar(60),\n  GLPaySummaryDesc varchar(60),\n  DiscOffGLAcct bglacct,\n  DiscTakenGLAcct bglacct,\n  ExpPayType tinyint,\n  JobPayType tinyint,\n  SubPayType tinyint,\n  RetPayType tinyint,\n  -- ... 92 more columns,\n  PRIMARY KEY (APCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To distinguish retainage vs non-retainage holds:\n1. Join APTD to APHD for hold details\n2. Join APCO to get RetHoldCode setting\n3. Compare APHD.HoldCode to APCO.RetHoldCode\n4. If equal, it's a retainage hold; otherwise non-retainage\n\n```sql\nSELECT \n  APTD.APCo,\n  APTD.Vendor,\n  APTD.Mth,\n  APTD.APTrans,\n  APHD.HoldCode,\n  CASE WHEN APHD.HoldCode = APCO.RetHoldCode \n       THEN 'Retainage Hold' \n       ELSE 'Non-Retainage Hold' END AS HoldType,\n  APTD.Amount\nFROM APTD WITH (NOLOCK)\nINNER JOIN APHD WITH (NOLOCK) ON APTD.APCo = APHD.APCo \n  AND APTD.Mth = APHD.Mth \n  AND APTD.APTrans = APHD.APTrans \n  AND APTD.APLine = APHD.APLine\nINNER JOIN APCO WITH (NOLOCK) ON APTD.APCo = APCO.APCo\nWHERE APTD.APCo = @APCo\n  AND APHD.HoldCode IS NOT NULL\nORDER BY APTD.Vendor, APTD.Mth\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "basic",
      "tables_used": [
        "APTD",
        "APHD",
        "APCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need to count records in prtd by company\n\nDatabase Schema:\nCREATE TABLE PRTD (\n  PRCo bcompany NOT NULL,\n  Craft bcraft NOT NULL,\n  Class bclass NOT NULL,\n  Template smallint NOT NULL,\n  DLCode bedlcode NOT NULL,\n  Factor brate NOT NULL,\n  OldRate bunitcost NOT NULL,\n  NewRate bunitcost NOT NULL,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count PRTD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM PRTD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "PRTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoice totals with discounts and retainage\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Vendor invoice summary with discounts and retainage:\n1. Join APTH to APVM for vendor details\n2. Aggregate by vendor\n3. Include GrossAmt, DiscOffer, Retainage, and Balance\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(APTH.APTrans) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS GrossAmount,\n  SUM(APTH.DiscOffer) AS DiscountsOffered,\n  SUM(APTH.Retainage) AS RetainageHeld,\n  SUM(APTH.Balance) AS OpenBalance\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find jobs over budget with remaining cost projection\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Find jobs over budget:\n1. Aggregate JCCP by job from JCJM\n2. Compare total ActualCost to CurrEstCost\n3. Use HAVING to filter only over-budget jobs\n4. Sort by amount over budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description,\n  SUM(JCCP.CurrEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.CurrEstCost) - SUM(JCCP.ActualCost) AS RemainingBudget,\n  CASE WHEN SUM(JCCP.CurrEstCost) < SUM(JCCP.ActualCost) \n       THEN 'OVER BUDGET' ELSE 'OK' END AS Status\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\nGROUP BY JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.CurrEstCost)\nORDER BY (SUM(JCCP.ActualCost) - SUM(JCCP.CurrEstCost)) DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCJM",
        "JCCD",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: List all fields in GLTransactions\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'GLTransactions' does not exist in Viewpoint Vista.\n\nUse GLDT (GL Detail) for GL transaction details.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM GLDT WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from ARTH\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from ARTH ().\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to count records in prtd by company\n\nDatabase Schema:\nCREATE TABLE PRTD (\n  PRCo bcompany NOT NULL,\n  Craft bcraft NOT NULL,\n  Class bclass NOT NULL,\n  Template smallint NOT NULL,\n  DLCode bedlcode NOT NULL,\n  Factor brate NOT NULL,\n  OldRate bunitcost NOT NULL,\n  NewRate bunitcost NOT NULL,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count PRTD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM PRTD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "PRTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate stored materials (Purchased - Installed) for SL billing\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Stored materials for SL billing:\n1. SLWI contains work item/billing details\n2. StoredMatls = Purchased - Installed (materials on-site but not yet used)\n3. WCCost = Work Completed Cost\n4. WCRetAmt and SMRetAmt = separate retainage for work vs materials\n5. Total billable = WCCost + StoredMatls\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description AS ItemDescription,\n  SLWI.StoredMatls,\n  SLWI.WCCost AS WorkCompletedCost,\n  SLWI.StoredMatls + SLWI.WCCost AS TotalBillable,\n  SLWI.WCRetAmt AS WorkRetainage,\n  SLWI.SMRetAmt AS MaterialsRetainage,\n  SLWI.WCRetAmt + SLWI.SMRetAmt AS TotalRetainage\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\n  AND SLWI.StoredMatls <> 0\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging buckets (30/60/90+ days) for unpaid invoices by customer\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Use ARTH for transaction data and ARCM for customer names\n2. Filter PayFullDate IS NULL to get only unpaid invoices\n3. Use DATEDIFF and CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from PREH\n\nDatabase Schema:\nCREATE TABLE PREH (\n  PRCo bcompany NOT NULL,\n  Employee bemployee NOT NULL,\n  LastName varchar(30) NOT NULL,\n  FirstName varchar(30),\n  MidName varchar(15),\n  SortName bsortname NOT NULL,\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  Phone bphone,\n  SSN char(11) NOT NULL,\n  Race char(2) NOT NULL,\n  Sex char(1) NOT NULL,\n  BirthDate smalldatetime,\n  HireDate bdate,\n  TermDate bdate,\n  PRGroup bgroup NOT NULL,\n  PRDept bdept NOT NULL,\n  -- ... 121 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from PREH ().\n\n```sql\nSELECT *\nFROM PREH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "PREH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from ChangeOrder\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'ChangeOrder' does not exist in Viewpoint Vista.\n\nUse JCOI (JC Change Order Item) for change order details.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM JCOI WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query to aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query to aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get customer balance summary by customer group\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Customer balance summary by group:\n1. Join ARTH to ARCM for customer details\n2. Use conditional SUM for open vs total balances\n3. Group by CustGroup for summary\n\n```sql\nSELECT \n  ARTH.CustGroup,\n  COUNT(DISTINCT ARTH.Customer) AS CustomerCount,\n  SUM(CASE WHEN ARTH.PayFullDate IS NULL THEN ARTH.Amount ELSE 0 END) AS OpenBalance,\n  SUM(ARTH.Amount) AS TotalBilled\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\nGROUP BY ARTH.CustGroup\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging buckets (30/60/90+ days) for unpaid invoices by customer\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Use ARTH for transaction data and ARCM for customer names\n2. Filter PayFullDate IS NULL to get only unpaid invoices\n3. Use DATEDIFF and CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get data from ARCM for analysis\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'ARCM' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nAPTH, APVM\n\nTo include ARCM in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to join JCJM with the available tables\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'JCJM' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nARTH, ARCM\n\nTo include JCJM in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging with customer contact information\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I can partially answer this query, but the schema is incomplete.\n\nThe query requires ARCM (AR Customer Master) for customer details, but only ARTH is provided in the schema.\n\nHere's what I can provide with the available schema:\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n-- Note: Additional joins for ARCM would be needed for complete results\n```\n\nTo get the complete data you requested, please provide the DDL for ARCM.",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: List all fields in ChangeOrders\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'ChangeOrders' does not exist in Viewpoint Vista.\n\nUse JCOI (JC Change Order Item) for change order details.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM JCOI WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging buckets (30/60/90+ days) for unpaid invoices by customer\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Use ARTH for transaction data and ARCM for customer names\n2. Filter PayFullDate IS NULL to get only unpaid invoices\n3. Use DATEDIFF and CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoice totals with discounts and retainage\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Vendor invoice summary with discounts and retainage:\n1. Join APTH to APVM for vendor details\n2. Aggregate by vendor\n3. Include GrossAmt, DiscOffer, Retainage, and Balance\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(APTH.APTrans) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS GrossAmount,\n  SUM(APTH.DiscOffer) AS DiscountsOffered,\n  SUM(APTH.Retainage) AS RetainageHeld,\n  SUM(APTH.Balance) AS OpenBalance\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from ARTH\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from ARTH ().\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get subcontractor costs with original, change orders, invoiced, paid, and retainage by vendor\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Subcontractor cost breakdown by vendor:\n1. Join SLHD (Header) to SLIT (Items) for subcontract details\n2. Join APVM for vendor names\n3. OrigCost = original contract amount\n4. CurCost - OrigCost = change order amounts\n5. InvCost = amounts invoiced\n6. Retainage = amounts held back\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  SLHD.SL AS SubcontractNum,\n  SLHD.Description AS SubcontractDesc,\n  SUM(SLIT.OrigCost) AS OriginalCost,\n  SUM(SLIT.CurCost - SLIT.OrigCost) AS ChangeOrderCost,\n  SUM(SLIT.CurCost) AS CurrentCost,\n  SUM(SLIT.InvCost) AS InvoicedCost,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost - SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nINNER JOIN APVM WITH (NOLOCK) ON SLHD.VendorGroup = APVM.VendorGroup AND SLHD.Vendor = APVM.Vendor\nWHERE SLHD.SLCo = @SLCo\nGROUP BY APVM.Vendor, APVM.Name, SLHD.SL, SLHD.Description\nORDER BY APVM.Name, SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "intermediate",
      "tables_used": [
        "SLHD",
        "SLIT",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from PREH\n\nDatabase Schema:\nCREATE TABLE PREH (\n  PRCo bcompany NOT NULL,\n  Employee bemployee NOT NULL,\n  LastName varchar(30) NOT NULL,\n  FirstName varchar(30),\n  MidName varchar(15),\n  SortName bsortname NOT NULL,\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  Phone bphone,\n  SSN char(11) NOT NULL,\n  Race char(2) NOT NULL,\n  Sex char(1) NOT NULL,\n  BirthDate smalldatetime,\n  HireDate bdate,\n  TermDate bdate,\n  PRGroup bgroup NOT NULL,\n  PRDept bdept NOT NULL,\n  -- ... 121 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from PREH ().\n\n```sql\nSELECT *\nFROM PREH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "PREH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to count records in prpc by company\n\nDatabase Schema:\nCREATE TABLE PRPC (\n  PRCo bcompany NOT NULL,\n  PRGroup bgroup NOT NULL,\n  PREndDate bdate NOT NULL,\n  BeginDate bdate NOT NULL,\n  MultiMth byn NOT NULL,\n  BeginMth bmonth NOT NULL,\n  EndMth bmonth,\n  CutoffDate bdate,\n  LimitMth bmonth NOT NULL,\n  Hrs smallint NOT NULL,\n  Days tinyint NOT NULL,\n  Wks tinyint NOT NULL,\n  Status tinyint NOT NULL,\n  DateClosed smalldatetime,\n  JCInterface byn NOT NULL,\n  EMInterface byn NOT NULL,\n  GLInterface byn NOT NULL,\n  APInterface byn NOT NULL,\n  LeaveProcess byn NOT NULL,\n  InUseBy bvpusername,\n  -- ... 7 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count PRPC records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM PRPC WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "PRPC"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get subcontractor costs with original, change orders, invoiced, paid, and retainage by vendor\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Subcontractor cost breakdown by vendor:\n1. Join SLHD (Header) to SLIT (Items) for subcontract details\n2. Join APVM for vendor names\n3. OrigCost = original contract amount\n4. CurCost - OrigCost = change order amounts\n5. InvCost = amounts invoiced\n6. Retainage = amounts held back\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  SLHD.SL AS SubcontractNum,\n  SLHD.Description AS SubcontractDesc,\n  SUM(SLIT.OrigCost) AS OriginalCost,\n  SUM(SLIT.CurCost - SLIT.OrigCost) AS ChangeOrderCost,\n  SUM(SLIT.CurCost) AS CurrentCost,\n  SUM(SLIT.InvCost) AS InvoicedCost,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost - SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nINNER JOIN APVM WITH (NOLOCK) ON SLHD.VendorGroup = APVM.VendorGroup AND SLHD.Vendor = APVM.Vendor\nWHERE SLHD.SLCo = @SLCo\nGROUP BY APVM.Vendor, APVM.Name, SLHD.SL, SLHD.Description\nORDER BY APVM.Name, SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "basic",
      "tables_used": [
        "SLHD",
        "SLIT",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging buckets (30/60/90+ days) for unpaid invoices by customer\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Use ARTH for transaction data and ARCM for customer names\n2. Filter PayFullDate IS NULL to get only unpaid invoices\n3. Use DATEDIFF and CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find jobs over budget with remaining cost projection\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Find jobs over budget:\n1. Aggregate JCCP by job from JCJM\n2. Compare total ActualCost to CurrEstCost\n3. Use HAVING to filter only over-budget jobs\n4. Sort by amount over budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description,\n  SUM(JCCP.CurrEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.CurrEstCost) - SUM(JCCP.ActualCost) AS RemainingBudget,\n  CASE WHEN SUM(JCCP.CurrEstCost) < SUM(JCCP.ActualCost) \n       THEN 'OVER BUDGET' ELSE 'OK' END AS Status\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\nGROUP BY JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.CurrEstCost)\nORDER BY (SUM(JCCP.ActualCost) - SUM(JCCP.CurrEstCost)) DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCJM",
        "JCCD",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to count records in gldt by company\n\nDatabase Schema:\nCREATE TABLE GLDT (\n  GLCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  GLTrans btrans NOT NULL,\n  GLAcct bglacct NOT NULL,\n  Jrnl bjrnl NOT NULL,\n  GLRef bglref NOT NULL,\n  SourceCo bcompany NOT NULL,\n  Source bsource NOT NULL,\n  ActDate bdate NOT NULL,\n  DatePosted bdate NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid NOT NULL,\n  Amount bdollar NOT NULL,\n  RevStatus tinyint NOT NULL,\n  Adjust char(1) NOT NULL,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  UniqueAttchID uniqueidentifier,\n  SrcTable varchar(128),\n  SrcKeyID bigint,\n  PRIMARY KEY (GLCo, Mth, GLTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count GLDT records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM GLDT WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "GLDT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get data from PREH for analysis\n\nDatabase Schema:\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'PREH' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nSLHD, SLIT\n\nTo include PREH in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to track ap hold status distinguishing retainage vs non-retainage holds\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APCO (\n  APCo bcompany NOT NULL,\n  GLCo bcompany NOT NULL,\n  ExpJrnl bjrnl,\n  GLExpInterfaceLvl tinyint NOT NULL,\n  GLExpSummaryDesc varchar(60),\n  GLExpTransDesc varchar(60),\n  GLJobDetailDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLEquipDetailDesc varchar(60),\n  GLExpDetailDesc varchar(60),\n  PayJrnl bjrnl,\n  GLPayInterfaceLvl tinyint NOT NULL,\n  GLPayDetailDesc varchar(60),\n  GLPaySummaryDesc varchar(60),\n  DiscOffGLAcct bglacct,\n  DiscTakenGLAcct bglacct,\n  ExpPayType tinyint,\n  JobPayType tinyint,\n  SubPayType tinyint,\n  RetPayType tinyint,\n  -- ... 92 more columns,\n  PRIMARY KEY (APCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To distinguish retainage vs non-retainage holds:\n1. Join APTD to APHD for hold details\n2. Join APCO to get RetHoldCode setting\n3. Compare APHD.HoldCode to APCO.RetHoldCode\n4. If equal, it's a retainage hold; otherwise non-retainage\n\n```sql\nSELECT \n  APTD.APCo,\n  APTD.Vendor,\n  APTD.Mth,\n  APTD.APTrans,\n  APHD.HoldCode,\n  CASE WHEN APHD.HoldCode = APCO.RetHoldCode \n       THEN 'Retainage Hold' \n       ELSE 'Non-Retainage Hold' END AS HoldType,\n  APTD.Amount\nFROM APTD WITH (NOLOCK)\nINNER JOIN APHD WITH (NOLOCK) ON APTD.APCo = APHD.APCo \n  AND APTD.Mth = APHD.Mth \n  AND APTD.APTrans = APHD.APTrans \n  AND APTD.APLine = APHD.APLine\nINNER JOIN APCO WITH (NOLOCK) ON APTD.APCo = APCO.APCo\nWHERE APTD.APCo = @APCo\n  AND APHD.HoldCode IS NOT NULL\nORDER BY APTD.Vendor, APTD.Mth\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTD",
        "APHD",
        "APCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from JCCD\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from JCCD ().\n\n```sql\nSELECT *\nFROM JCCD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from JCCD\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from JCCD ().\n\n```sql\nSELECT *\nFROM JCCD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from ARTH\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from ARTH ().\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoices with their subcontract details\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I can partially answer this query, but the schema is incomplete.\n\nTo include subcontract details, the SLHD table is needed but not provided in the schema.\n\nHere's what I can provide with the available schema:\n\n```sql\nSELECT *\nFROM APTH WITH (NOLOCK)\nWHERE Co = @Co\n-- Note: Additional joins for SLHD would be needed for complete results\n```\n\nTo get the complete data you requested, please provide the DDL for SLHD.",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": [
        "APTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show job costs with GL account descriptions\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I can partially answer this query, but the schema is incomplete.\n\nThe query requires GLAC for GL account descriptions, which is not in the provided schema.\n\nHere's what I can provide with the available schema:\n\n```sql\nSELECT *\nFROM JCCD WITH (NOLOCK)\nWHERE Co = @Co\n-- Note: Additional joins for GLAC would be needed for complete results\n```\n\nTo get the complete data you requested, please provide the DDL for GLAC.",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: count records in jccd by company\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count JCCD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM JCCD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Include JCJM in the query\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'JCJM' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nARTH, ARCM\n\nTo include JCJM in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get subcontractor costs with original, change orders, invoiced, paid, and retainage by vendor\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Subcontractor cost breakdown by vendor:\n1. Join SLHD (Header) to SLIT (Items) for subcontract details\n2. Join APVM for vendor names\n3. OrigCost = original contract amount\n4. CurCost - OrigCost = change order amounts\n5. InvCost = amounts invoiced\n6. Retainage = amounts held back\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  SLHD.SL AS SubcontractNum,\n  SLHD.Description AS SubcontractDesc,\n  SUM(SLIT.OrigCost) AS OriginalCost,\n  SUM(SLIT.CurCost - SLIT.OrigCost) AS ChangeOrderCost,\n  SUM(SLIT.CurCost) AS CurrentCost,\n  SUM(SLIT.InvCost) AS InvoicedCost,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost - SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nINNER JOIN APVM WITH (NOLOCK) ON SLHD.VendorGroup = APVM.VendorGroup AND SLHD.Vendor = APVM.Vendor\nWHERE SLHD.SLCo = @SLCo\nGROUP BY APVM.Vendor, APVM.Name, SLHD.SL, SLHD.Description\nORDER BY APVM.Name, SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLHD",
        "SLIT",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need to count records in slwi by company\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count SLWI records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM SLWI WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "SLWI"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate stored materials (Purchased - Installed) for SL billing\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Stored materials for SL billing:\n1. SLWI contains work item/billing details\n2. StoredMatls = Purchased - Installed (materials on-site but not yet used)\n3. WCCost = Work Completed Cost\n4. WCRetAmt and SMRetAmt = separate retainage for work vs materials\n5. Total billable = WCCost + StoredMatls\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description AS ItemDescription,\n  SLWI.StoredMatls,\n  SLWI.WCCost AS WorkCompletedCost,\n  SLWI.StoredMatls + SLWI.WCCost AS TotalBillable,\n  SLWI.WCRetAmt AS WorkRetainage,\n  SLWI.SMRetAmt AS MaterialsRetainage,\n  SLWI.WCRetAmt + SLWI.SMRetAmt AS TotalRetainage\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\n  AND SLWI.StoredMatls <> 0\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "basic",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from ARTH\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from ARTH ().\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show job costs with GL account descriptions\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I can partially answer this query, but the schema is incomplete.\n\nThe query requires GLAC for GL account descriptions, which is not in the provided schema.\n\nHere's what I can provide with the available schema:\n\n```sql\nSELECT *\nFROM JCCD WITH (NOLOCK)\nWHERE Co = @Co\n-- Note: Additional joins for GLAC would be needed for complete results\n```\n\nTo get the complete data you requested, please provide the DDL for GLAC.",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from ARTH\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from ARTH ().\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to count records in gldt by company\n\nDatabase Schema:\nCREATE TABLE GLDT (\n  GLCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  GLTrans btrans NOT NULL,\n  GLAcct bglacct NOT NULL,\n  Jrnl bjrnl NOT NULL,\n  GLRef bglref NOT NULL,\n  SourceCo bcompany NOT NULL,\n  Source bsource NOT NULL,\n  ActDate bdate NOT NULL,\n  DatePosted bdate NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid NOT NULL,\n  Amount bdollar NOT NULL,\n  RevStatus tinyint NOT NULL,\n  Adjust char(1) NOT NULL,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  UniqueAttchID uniqueidentifier,\n  SrcTable varchar(128),\n  SrcKeyID bigint,\n  PRIMARY KEY (GLCo, Mth, GLTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count GLDT records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM GLDT WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "GLDT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to count records in prth by company\n\nDatabase Schema:\nCREATE TABLE PRTH (\n  PRCo bcompany NOT NULL,\n  PRGroup bgroup NOT NULL,\n  PREndDate bdate NOT NULL,\n  Employee bemployee NOT NULL,\n  PaySeq tinyint NOT NULL,\n  PostSeq smallint NOT NULL,\n  Type char(1) NOT NULL,\n  PostDate bdate NOT NULL,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCDept bdept,\n  GLCo bcompany NOT NULL,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equipment bequip,\n  EMGroup tinyint,\n  CostCode bcostcode,\n  -- ... 41 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count PRTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM PRTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "PRTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging with customer contact information\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I can partially answer this query, but the schema is incomplete.\n\nThe query requires ARCM (AR Customer Master) for customer details, but only ARTH is provided in the schema.\n\nHere's what I can provide with the available schema:\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n-- Note: Additional joins for ARCM would be needed for complete results\n```\n\nTo get the complete data you requested, please provide the DDL for ARCM.",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find all unpaid AR invoices older than 60 days\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find unpaid invoices over 60 days:\n1. Join ARTH to ARCM for customer information\n2. Filter PayFullDate IS NULL (unpaid)\n3. Use DATEDIFF to calculate age and filter > 60 days\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Mth,\n  ARTH.ARTrans,\n  ARCM.Name AS CustomerName,\n  ARTH.TransDate,\n  ARTH.Amount,\n  DATEDIFF(day, ARTH.TransDate, GETDATE()) AS DaysOutstanding\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\n  AND DATEDIFF(day, ARTH.TransDate, GETDATE()) > 60\nORDER BY ARTH.TransDate\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get job cost variance by phase comparing budget to actual\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Job cost variance by phase:\n1. Join JCJM (Job Master) to JCCP (Cost Phase)\n2. Calculate variance as CurrEstCost - ActualCost\n3. Calculate percent complete from actuals vs budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  JCCP.Phase,\n  JCCP.CostType,\n  JCCP.OrigEstCost AS OriginalBudget,\n  JCCP.CurrEstCost AS CurrentBudget,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS Variance,\n  CASE WHEN JCCP.CurrEstCost <> 0 \n       THEN (JCCP.ActualCost / JCCP.CurrEstCost) * 100 \n       ELSE 0 END AS PercentComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.Job = @Job\nORDER BY JCCP.Phase, JCCP.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get job cost variance by phase comparing budget to actual\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Job cost variance by phase:\n1. Join JCJM (Job Master) to JCCP (Cost Phase)\n2. Calculate variance as CurrEstCost - ActualCost\n3. Calculate percent complete from actuals vs budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  JCCP.Phase,\n  JCCP.CostType,\n  JCCP.OrigEstCost AS OriginalBudget,\n  JCCP.CurrEstCost AS CurrentBudget,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS Variance,\n  CASE WHEN JCCP.CurrEstCost <> 0 \n       THEN (JCCP.ActualCost / JCCP.CurrEstCost) * 100 \n       ELSE 0 END AS PercentComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.Job = @Job\nORDER BY JCCP.Phase, JCCP.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How do I count records in aptd by company\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count APTD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM APTD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query to reconcile ap oncost batch lines with original transactions\n\nDatabase Schema:\nCREATE TABLE APTL (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equip bequip,\n  EMGroup bgroup,\n  -- ... 56 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans, APLine)\n);\n\nCREATE TABLE APLB (\n  Co bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  BatchId bbatchid NOT NULL,\n  BatchSeq int NOT NULL,\n  APLine smallint NOT NULL,\n  BatchTransType char(1) NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  -- ... 120 more columns,\n  PRIMARY KEY (Co, Mth, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APHB (\n  Co bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  BatchId bbatchid NOT NULL,\n  BatchSeq int NOT NULL,\n  BatchTransType char(1) NOT NULL,\n  APTrans btrans,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  -- ... 88 more columns,\n  PRIMARY KEY (Co, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To reconcile AP oncost batches with original transactions:\n1. Join APLB (batch lines) to APTL (original lines) using ocApplyMth, ocApplyTrans, ocApplyLine\n2. Include APHB for batch header info\n3. Join to APTH and APVM for vendor context\n4. Compare batch vs original amounts\n\n```sql\nSELECT \n  APLB.Co AS BatchCo,\n  APLB.Mth AS BatchMth,\n  APLB.BatchId,\n  APLB.BatchSeq,\n  APLB.ocApplyMth,\n  APLB.ocApplyTrans,\n  APLB.ocApplyLine,\n  APTL.APCo AS OrigCo,\n  APTL.Mth AS OrigMth,\n  APTL.APTrans AS OrigTrans,\n  APTL.APLine AS OrigLine,\n  APTL.GrossAmt AS OrigAmount,\n  APLB.GrossAmt AS BatchAmount,\n  APVM.Name AS VendorName\nFROM APLB WITH (NOLOCK)\nINNER JOIN APHB WITH (NOLOCK) ON APLB.Co = APHB.Co AND APLB.Mth = APHB.Mth AND APLB.BatchId = APHB.BatchId\nINNER JOIN APTL WITH (NOLOCK) ON APLB.ocApplyMth = APTL.Mth \n  AND APLB.ocApplyTrans = APTL.APTrans \n  AND APLB.ocApplyLine = APTL.APLine\n  AND APLB.Co = APTL.APCo\nINNER JOIN APTH WITH (NOLOCK) ON APTL.APCo = APTH.APCo AND APTL.Mth = APTH.Mth AND APTL.APTrans = APTH.APTrans\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APLB.Co = @Co\nORDER BY APLB.BatchId, APLB.BatchSeq\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "basic",
      "tables_used": [
        "APLB",
        "APHB",
        "APTL",
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from PRTH\n\nDatabase Schema:\nCREATE TABLE PRTH (\n  PRCo bcompany NOT NULL,\n  PRGroup bgroup NOT NULL,\n  PREndDate bdate NOT NULL,\n  Employee bemployee NOT NULL,\n  PaySeq tinyint NOT NULL,\n  PostSeq smallint NOT NULL,\n  Type char(1) NOT NULL,\n  PostDate bdate NOT NULL,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCDept bdept,\n  GLCo bcompany NOT NULL,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equipment bequip,\n  EMGroup tinyint,\n  CostCode bcostcode,\n  -- ... 41 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from PRTH ().\n\n```sql\nSELECT *\nFROM PRTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "PRTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate stored materials (Purchased - Installed) for SL billing\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Stored materials for SL billing:\n1. SLWI contains work item/billing details\n2. StoredMatls = Purchased - Installed (materials on-site but not yet used)\n3. WCCost = Work Completed Cost\n4. WCRetAmt and SMRetAmt = separate retainage for work vs materials\n5. Total billable = WCCost + StoredMatls\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description AS ItemDescription,\n  SLWI.StoredMatls,\n  SLWI.WCCost AS WorkCompletedCost,\n  SLWI.StoredMatls + SLWI.WCCost AS TotalBillable,\n  SLWI.WCRetAmt AS WorkRetainage,\n  SLWI.SMRetAmt AS MaterialsRetainage,\n  SLWI.WCRetAmt + SLWI.SMRetAmt AS TotalRetainage\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\n  AND SLWI.StoredMatls <> 0\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from GLDT\n\nDatabase Schema:\nCREATE TABLE GLDT (\n  GLCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  GLTrans btrans NOT NULL,\n  GLAcct bglacct NOT NULL,\n  Jrnl bjrnl NOT NULL,\n  GLRef bglref NOT NULL,\n  SourceCo bcompany NOT NULL,\n  Source bsource NOT NULL,\n  ActDate bdate NOT NULL,\n  DatePosted bdate NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid NOT NULL,\n  Amount bdollar NOT NULL,\n  RevStatus tinyint NOT NULL,\n  Adjust char(1) NOT NULL,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  UniqueAttchID uniqueidentifier,\n  SrcTable varchar(128),\n  SrcKeyID bigint,\n  PRIMARY KEY (GLCo, Mth, GLTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from GLDT ().\n\n```sql\nSELECT *\nFROM GLDT WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "GLDT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from PRTD\n\nDatabase Schema:\nCREATE TABLE PRTD (\n  PRCo bcompany NOT NULL,\n  Craft bcraft NOT NULL,\n  Class bclass NOT NULL,\n  Template smallint NOT NULL,\n  DLCode bedlcode NOT NULL,\n  Factor brate NOT NULL,\n  OldRate bunitcost NOT NULL,\n  NewRate bunitcost NOT NULL,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from PRTD ().\n\n```sql\nSELECT *\nFROM PRTD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "PRTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find jobs over budget with remaining cost projection\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Find jobs over budget:\n1. Aggregate JCCP by job from JCJM\n2. Compare total ActualCost to CurrEstCost\n3. Use HAVING to filter only over-budget jobs\n4. Sort by amount over budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description,\n  SUM(JCCP.CurrEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.CurrEstCost) - SUM(JCCP.ActualCost) AS RemainingBudget,\n  CASE WHEN SUM(JCCP.CurrEstCost) < SUM(JCCP.ActualCost) \n       THEN 'OVER BUDGET' ELSE 'OK' END AS Status\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\nGROUP BY JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.CurrEstCost)\nORDER BY (SUM(JCCP.ActualCost) - SUM(JCCP.CurrEstCost)) DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCJM",
        "JCCD",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to count records in jccd by company\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count JCCD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM JCCD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from JCCD\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from JCCD ().\n\n```sql\nSELECT *\nFROM JCCD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from JCCD\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from JCCD ().\n\n```sql\nSELECT *\nFROM JCCD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to reconcile ap oncost batch lines with original transactions\n\nDatabase Schema:\nCREATE TABLE APTL (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equip bequip,\n  EMGroup bgroup,\n  -- ... 56 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans, APLine)\n);\n\nCREATE TABLE APLB (\n  Co bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  BatchId bbatchid NOT NULL,\n  BatchSeq int NOT NULL,\n  APLine smallint NOT NULL,\n  BatchTransType char(1) NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  -- ... 120 more columns,\n  PRIMARY KEY (Co, Mth, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APHB (\n  Co bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  BatchId bbatchid NOT NULL,\n  BatchSeq int NOT NULL,\n  BatchTransType char(1) NOT NULL,\n  APTrans btrans,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  -- ... 88 more columns,\n  PRIMARY KEY (Co, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To reconcile AP oncost batches with original transactions:\n1. Join APLB (batch lines) to APTL (original lines) using ocApplyMth, ocApplyTrans, ocApplyLine\n2. Include APHB for batch header info\n3. Join to APTH and APVM for vendor context\n4. Compare batch vs original amounts\n\n```sql\nSELECT \n  APLB.Co AS BatchCo,\n  APLB.Mth AS BatchMth,\n  APLB.BatchId,\n  APLB.BatchSeq,\n  APLB.ocApplyMth,\n  APLB.ocApplyTrans,\n  APLB.ocApplyLine,\n  APTL.APCo AS OrigCo,\n  APTL.Mth AS OrigMth,\n  APTL.APTrans AS OrigTrans,\n  APTL.APLine AS OrigLine,\n  APTL.GrossAmt AS OrigAmount,\n  APLB.GrossAmt AS BatchAmount,\n  APVM.Name AS VendorName\nFROM APLB WITH (NOLOCK)\nINNER JOIN APHB WITH (NOLOCK) ON APLB.Co = APHB.Co AND APLB.Mth = APHB.Mth AND APLB.BatchId = APHB.BatchId\nINNER JOIN APTL WITH (NOLOCK) ON APLB.ocApplyMth = APTL.Mth \n  AND APLB.ocApplyTrans = APTL.APTrans \n  AND APLB.ocApplyLine = APTL.APLine\n  AND APLB.Co = APTL.APCo\nINNER JOIN APTH WITH (NOLOCK) ON APTL.APCo = APTH.APCo AND APTL.Mth = APTH.Mth AND APTL.APTrans = APTH.APTrans\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APLB.Co = @Co\nORDER BY APLB.BatchId, APLB.BatchSeq\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "basic",
      "tables_used": [
        "APLB",
        "APHB",
        "APTL",
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate stored materials (Purchased - Installed) for SL billing\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Stored materials for SL billing:\n1. SLWI contains work item/billing details\n2. StoredMatls = Purchased - Installed (materials on-site but not yet used)\n3. WCCost = Work Completed Cost\n4. WCRetAmt and SMRetAmt = separate retainage for work vs materials\n5. Total billable = WCCost + StoredMatls\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description AS ItemDescription,\n  SLWI.StoredMatls,\n  SLWI.WCCost AS WorkCompletedCost,\n  SLWI.StoredMatls + SLWI.WCCost AS TotalBillable,\n  SLWI.WCRetAmt AS WorkRetainage,\n  SLWI.SMRetAmt AS MaterialsRetainage,\n  SLWI.WCRetAmt + SLWI.SMRetAmt AS TotalRetainage\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\n  AND SLWI.StoredMatls <> 0\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need to count records in glco by company\n\nDatabase Schema:\nCREATE TABLE GLCO (\n  GLCo bcompany NOT NULL,\n  Consolid byn NOT NULL,\n  LastMthSubClsd bmonth NOT NULL,\n  LastMthGLClsd bmonth NOT NULL,\n  MaxOpen tinyint NOT NULL,\n  CashAccrual char(1) NOT NULL,\n  Unbal byn NOT NULL,\n  AuditCoParams byn NOT NULL,\n  AuditAccts byn NOT NULL,\n  AuditAutoJrnl byn NOT NULL,\n  AuditBals byn NOT NULL,\n  AuditBudgets byn NOT NULL,\n  AuditDetail byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  XCompJrnlEntryYN byn NOT NULL,\n  KeyID bigint NOT NULL,\n  LastMthAPClsd bmonth NOT NULL,\n  LastMthARClsd bmonth NOT NULL,\n  AttachBatchReportsYN byn NOT NULL,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count GLCO records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM GLCO WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "GLCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show job costs with GL account descriptions\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I can partially answer this query, but the schema is incomplete.\n\nThe query requires GLAC for GL account descriptions, which is not in the provided schema.\n\nHere's what I can provide with the available schema:\n\n```sql\nSELECT *\nFROM JCCD WITH (NOLOCK)\nWHERE Co = @Co\n-- Note: Additional joins for GLAC would be needed for complete results\n```\n\nTo get the complete data you requested, please provide the DDL for GLAC.",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How do I count records in arth by company\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count ARTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM ARTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get subcontractor costs with original, change orders, invoiced, paid, and retainage by vendor\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Subcontractor cost breakdown by vendor:\n1. Join SLHD (Header) to SLIT (Items) for subcontract details\n2. Join APVM for vendor names\n3. OrigCost = original contract amount\n4. CurCost - OrigCost = change order amounts\n5. InvCost = amounts invoiced\n6. Retainage = amounts held back\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  SLHD.SL AS SubcontractNum,\n  SLHD.Description AS SubcontractDesc,\n  SUM(SLIT.OrigCost) AS OriginalCost,\n  SUM(SLIT.CurCost - SLIT.OrigCost) AS ChangeOrderCost,\n  SUM(SLIT.CurCost) AS CurrentCost,\n  SUM(SLIT.InvCost) AS InvoicedCost,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost - SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nINNER JOIN APVM WITH (NOLOCK) ON SLHD.VendorGroup = APVM.VendorGroup AND SLHD.Vendor = APVM.Vendor\nWHERE SLHD.SLCo = @SLCo\nGROUP BY APVM.Vendor, APVM.Name, SLHD.SL, SLHD.Description\nORDER BY APVM.Name, SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "intermediate",
      "tables_used": [
        "SLHD",
        "SLIT",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find jobs over budget with remaining cost projection\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Find jobs over budget:\n1. Aggregate JCCP by job from JCJM\n2. Compare total ActualCost to CurrEstCost\n3. Use HAVING to filter only over-budget jobs\n4. Sort by amount over budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description,\n  SUM(JCCP.CurrEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.CurrEstCost) - SUM(JCCP.ActualCost) AS RemainingBudget,\n  CASE WHEN SUM(JCCP.CurrEstCost) < SUM(JCCP.ActualCost) \n       THEN 'OVER BUDGET' ELSE 'OK' END AS Status\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\nGROUP BY JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.CurrEstCost)\nORDER BY (SUM(JCCP.ActualCost) - SUM(JCCP.CurrEstCost)) DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCJM",
        "JCCD",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query to count records in jccd by company\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count JCCD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM JCCD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging buckets (30/60/90+ days) for unpaid invoices by customer\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Use ARTH for transaction data and ARCM for customer names\n2. Filter PayFullDate IS NULL to get only unpaid invoices\n3. Use DATEDIFF and CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoices with their subcontract details\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I can partially answer this query, but the schema is incomplete.\n\nTo include subcontract details, the SLHD table is needed but not provided in the schema.\n\nHere's what I can provide with the available schema:\n\n```sql\nSELECT *\nFROM APTH WITH (NOLOCK)\nWHERE Co = @Co\n-- Note: Additional joins for SLHD would be needed for complete results\n```\n\nTo get the complete data you requested, please provide the DDL for SLHD.",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": [
        "APTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from PRPC\n\nDatabase Schema:\nCREATE TABLE PRPC (\n  PRCo bcompany NOT NULL,\n  PRGroup bgroup NOT NULL,\n  PREndDate bdate NOT NULL,\n  BeginDate bdate NOT NULL,\n  MultiMth byn NOT NULL,\n  BeginMth bmonth NOT NULL,\n  EndMth bmonth,\n  CutoffDate bdate,\n  LimitMth bmonth NOT NULL,\n  Hrs smallint NOT NULL,\n  Days tinyint NOT NULL,\n  Wks tinyint NOT NULL,\n  Status tinyint NOT NULL,\n  DateClosed smalldatetime,\n  JCInterface byn NOT NULL,\n  EMInterface byn NOT NULL,\n  GLInterface byn NOT NULL,\n  APInterface byn NOT NULL,\n  LeaveProcess byn NOT NULL,\n  InUseBy bvpusername,\n  -- ... 7 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from PRPC ().\n\n```sql\nSELECT *\nFROM PRPC WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "PRPC"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show job costs with GL account descriptions\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I can partially answer this query, but the schema is incomplete.\n\nThe query requires GLAC for GL account descriptions, which is not in the provided schema.\n\nHere's what I can provide with the available schema:\n\n```sql\nSELECT *\nFROM JCCD WITH (NOLOCK)\nWHERE Co = @Co\n-- Note: Additional joins for GLAC would be needed for complete results\n```\n\nTo get the complete data you requested, please provide the DDL for GLAC.",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from PRPC\n\nDatabase Schema:\nCREATE TABLE PRPC (\n  PRCo bcompany NOT NULL,\n  PRGroup bgroup NOT NULL,\n  PREndDate bdate NOT NULL,\n  BeginDate bdate NOT NULL,\n  MultiMth byn NOT NULL,\n  BeginMth bmonth NOT NULL,\n  EndMth bmonth,\n  CutoffDate bdate,\n  LimitMth bmonth NOT NULL,\n  Hrs smallint NOT NULL,\n  Days tinyint NOT NULL,\n  Wks tinyint NOT NULL,\n  Status tinyint NOT NULL,\n  DateClosed smalldatetime,\n  JCInterface byn NOT NULL,\n  EMInterface byn NOT NULL,\n  GLInterface byn NOT NULL,\n  APInterface byn NOT NULL,\n  LeaveProcess byn NOT NULL,\n  InUseBy bvpusername,\n  -- ... 7 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from PRPC ().\n\n```sql\nSELECT *\nFROM PRPC WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "PRPC"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How do I count records in apth by company\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count APTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM APTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "APTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to count records in arth by company\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count ARTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM ARTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from APTD\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from APTD ().\n\n```sql\nSELECT *\nFROM APTD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from ARTH\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from ARTH ().\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get job cost variance by phase comparing budget to actual\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Job cost variance by phase:\n1. Join JCJM (Job Master) to JCCP (Cost Phase)\n2. Calculate variance as CurrEstCost - ActualCost\n3. Calculate percent complete from actuals vs budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  JCCP.Phase,\n  JCCP.CostType,\n  JCCP.OrigEstCost AS OriginalBudget,\n  JCCP.CurrEstCost AS CurrentBudget,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS Variance,\n  CASE WHEN JCCP.CurrEstCost <> 0 \n       THEN (JCCP.ActualCost / JCCP.CurrEstCost) * 100 \n       ELSE 0 END AS PercentComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.Job = @Job\nORDER BY JCCP.Phase, JCCP.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoice totals with discounts and retainage\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Vendor invoice summary with discounts and retainage:\n1. Join APTH to APVM for vendor details\n2. Aggregate by vendor\n3. Include GrossAmt, DiscOffer, Retainage, and Balance\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(APTH.APTrans) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS GrossAmount,\n  SUM(APTH.DiscOffer) AS DiscountsOffered,\n  SUM(APTH.Retainage) AS RetainageHeld,\n  SUM(APTH.Balance) AS OpenBalance\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from GLDT\n\nDatabase Schema:\nCREATE TABLE GLDT (\n  GLCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  GLTrans btrans NOT NULL,\n  GLAcct bglacct NOT NULL,\n  Jrnl bjrnl NOT NULL,\n  GLRef bglref NOT NULL,\n  SourceCo bcompany NOT NULL,\n  Source bsource NOT NULL,\n  ActDate bdate NOT NULL,\n  DatePosted bdate NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid NOT NULL,\n  Amount bdollar NOT NULL,\n  RevStatus tinyint NOT NULL,\n  Adjust char(1) NOT NULL,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  UniqueAttchID uniqueidentifier,\n  SrcTable varchar(128),\n  SrcKeyID bigint,\n  PRIMARY KEY (GLCo, Mth, GLTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from GLDT ().\n\n```sql\nSELECT *\nFROM GLDT WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "GLDT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to count records in jccd by company\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count JCCD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM JCCD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate stored materials (Purchased - Installed) for SL billing\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Stored materials for SL billing:\n1. SLWI contains work item/billing details\n2. StoredMatls = Purchased - Installed (materials on-site but not yet used)\n3. WCCost = Work Completed Cost\n4. WCRetAmt and SMRetAmt = separate retainage for work vs materials\n5. Total billable = WCCost + StoredMatls\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description AS ItemDescription,\n  SLWI.StoredMatls,\n  SLWI.WCCost AS WorkCompletedCost,\n  SLWI.StoredMatls + SLWI.WCCost AS TotalBillable,\n  SLWI.WCRetAmt AS WorkRetainage,\n  SLWI.SMRetAmt AS MaterialsRetainage,\n  SLWI.WCRetAmt + SLWI.SMRetAmt AS TotalRetainage\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\n  AND SLWI.StoredMatls <> 0\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from GLCO\n\nDatabase Schema:\nCREATE TABLE GLCO (\n  GLCo bcompany NOT NULL,\n  Consolid byn NOT NULL,\n  LastMthSubClsd bmonth NOT NULL,\n  LastMthGLClsd bmonth NOT NULL,\n  MaxOpen tinyint NOT NULL,\n  CashAccrual char(1) NOT NULL,\n  Unbal byn NOT NULL,\n  AuditCoParams byn NOT NULL,\n  AuditAccts byn NOT NULL,\n  AuditAutoJrnl byn NOT NULL,\n  AuditBals byn NOT NULL,\n  AuditBudgets byn NOT NULL,\n  AuditDetail byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  XCompJrnlEntryYN byn NOT NULL,\n  KeyID bigint NOT NULL,\n  LastMthAPClsd bmonth NOT NULL,\n  LastMthARClsd bmonth NOT NULL,\n  AttachBatchReportsYN byn NOT NULL,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from GLCO ().\n\n```sql\nSELECT *\nFROM GLCO WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "GLCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find jobs over budget with remaining cost projection\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Find jobs over budget:\n1. Aggregate JCCP by job from JCJM\n2. Compare total ActualCost to CurrEstCost\n3. Use HAVING to filter only over-budget jobs\n4. Sort by amount over budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description,\n  SUM(JCCP.CurrEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.CurrEstCost) - SUM(JCCP.ActualCost) AS RemainingBudget,\n  CASE WHEN SUM(JCCP.CurrEstCost) < SUM(JCCP.ActualCost) \n       THEN 'OVER BUDGET' ELSE 'OK' END AS Status\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\nGROUP BY JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.CurrEstCost)\nORDER BY (SUM(JCCP.ActualCost) - SUM(JCCP.CurrEstCost)) DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM",
        "JCCD",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How is Contracts structured?\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'Contracts' does not exist in Viewpoint Vista.\n\nUse JCCM (JC Contract Master) for contract information.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM JCCM WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from JCCD\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from JCCD ().\n\n```sql\nSELECT *\nFROM JCCD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: List all fields in EmployeeMaster\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'EmployeeMaster' does not exist in Viewpoint Vista.\n\nUse PREH (PR Employee Header) for employee master information.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM PREH WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get subcontractor costs with original, change orders, invoiced, paid, and retainage by vendor\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Subcontractor cost breakdown by vendor:\n1. Join SLHD (Header) to SLIT (Items) for subcontract details\n2. Join APVM for vendor names\n3. OrigCost = original contract amount\n4. CurCost - OrigCost = change order amounts\n5. InvCost = amounts invoiced\n6. Retainage = amounts held back\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  SLHD.SL AS SubcontractNum,\n  SLHD.Description AS SubcontractDesc,\n  SUM(SLIT.OrigCost) AS OriginalCost,\n  SUM(SLIT.CurCost - SLIT.OrigCost) AS ChangeOrderCost,\n  SUM(SLIT.CurCost) AS CurrentCost,\n  SUM(SLIT.InvCost) AS InvoicedCost,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost - SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nINNER JOIN APVM WITH (NOLOCK) ON SLHD.VendorGroup = APVM.VendorGroup AND SLHD.Vendor = APVM.Vendor\nWHERE SLHD.SLCo = @SLCo\nGROUP BY APVM.Vendor, APVM.Name, SLHD.SL, SLHD.Description\nORDER BY APVM.Name, SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "intermediate",
      "tables_used": [
        "SLHD",
        "SLIT",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from APTD\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from APTD ().\n\n```sql\nSELECT *\nFROM APTD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to count records in apth by company\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count APTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM APTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Describe the ChangeOrder table\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'ChangeOrder' does not exist in Viewpoint Vista.\n\nUse JCOI (JC Change Order Item) for change order details.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM JCOI WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find jobs over budget with remaining cost projection\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Find jobs over budget:\n1. Aggregate JCCP by job from JCJM\n2. Compare total ActualCost to CurrEstCost\n3. Use HAVING to filter only over-budget jobs\n4. Sort by amount over budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description,\n  SUM(JCCP.CurrEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.CurrEstCost) - SUM(JCCP.ActualCost) AS RemainingBudget,\n  CASE WHEN SUM(JCCP.CurrEstCost) < SUM(JCCP.ActualCost) \n       THEN 'OVER BUDGET' ELSE 'OK' END AS Status\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\nGROUP BY JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.CurrEstCost)\nORDER BY (SUM(JCCP.ActualCost) - SUM(JCCP.CurrEstCost)) DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCJM",
        "JCCD",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query to count records in gljr by company\n\nDatabase Schema:\nCREATE TABLE GLJR (\n  GLCo bcompany NOT NULL,\n  Jrnl bjrnl NOT NULL,\n  Description btransdesc,\n  Rev byn NOT NULL,\n  RevJrnl bjrnl,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count GLJR records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM GLJR WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "GLJR"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: track ap hold status distinguishing retainage vs non-retainage holds\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APCO (\n  APCo bcompany NOT NULL,\n  GLCo bcompany NOT NULL,\n  ExpJrnl bjrnl,\n  GLExpInterfaceLvl tinyint NOT NULL,\n  GLExpSummaryDesc varchar(60),\n  GLExpTransDesc varchar(60),\n  GLJobDetailDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLEquipDetailDesc varchar(60),\n  GLExpDetailDesc varchar(60),\n  PayJrnl bjrnl,\n  GLPayInterfaceLvl tinyint NOT NULL,\n  GLPayDetailDesc varchar(60),\n  GLPaySummaryDesc varchar(60),\n  DiscOffGLAcct bglacct,\n  DiscTakenGLAcct bglacct,\n  ExpPayType tinyint,\n  JobPayType tinyint,\n  SubPayType tinyint,\n  RetPayType tinyint,\n  -- ... 92 more columns,\n  PRIMARY KEY (APCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To distinguish retainage vs non-retainage holds:\n1. Join APTD to APHD for hold details\n2. Join APCO to get RetHoldCode setting\n3. Compare APHD.HoldCode to APCO.RetHoldCode\n4. If equal, it's a retainage hold; otherwise non-retainage\n\n```sql\nSELECT \n  APTD.APCo,\n  APTD.Vendor,\n  APTD.Mth,\n  APTD.APTrans,\n  APHD.HoldCode,\n  CASE WHEN APHD.HoldCode = APCO.RetHoldCode \n       THEN 'Retainage Hold' \n       ELSE 'Non-Retainage Hold' END AS HoldType,\n  APTD.Amount\nFROM APTD WITH (NOLOCK)\nINNER JOIN APHD WITH (NOLOCK) ON APTD.APCo = APHD.APCo \n  AND APTD.Mth = APHD.Mth \n  AND APTD.APTrans = APHD.APTrans \n  AND APTD.APLine = APHD.APLine\nINNER JOIN APCO WITH (NOLOCK) ON APTD.APCo = APCO.APCo\nWHERE APTD.APCo = @APCo\n  AND APHD.HoldCode IS NOT NULL\nORDER BY APTD.Vendor, APTD.Mth\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTD",
        "APHD",
        "APCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get subcontractor costs with original, change orders, invoiced, paid, and retainage by vendor\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Subcontractor cost breakdown by vendor:\n1. Join SLHD (Header) to SLIT (Items) for subcontract details\n2. Join APVM for vendor names\n3. OrigCost = original contract amount\n4. CurCost - OrigCost = change order amounts\n5. InvCost = amounts invoiced\n6. Retainage = amounts held back\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  SLHD.SL AS SubcontractNum,\n  SLHD.Description AS SubcontractDesc,\n  SUM(SLIT.OrigCost) AS OriginalCost,\n  SUM(SLIT.CurCost - SLIT.OrigCost) AS ChangeOrderCost,\n  SUM(SLIT.CurCost) AS CurrentCost,\n  SUM(SLIT.InvCost) AS InvoicedCost,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost - SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nINNER JOIN APVM WITH (NOLOCK) ON SLHD.VendorGroup = APVM.VendorGroup AND SLHD.Vendor = APVM.Vendor\nWHERE SLHD.SLCo = @SLCo\nGROUP BY APVM.Vendor, APVM.Name, SLHD.SL, SLHD.Description\nORDER BY APVM.Name, SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLHD",
        "SLIT",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get subcontractor costs with original, change orders, invoiced, paid, and retainage by vendor\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Subcontractor cost breakdown by vendor:\n1. Join SLHD (Header) to SLIT (Items) for subcontract details\n2. Join APVM for vendor names\n3. OrigCost = original contract amount\n4. CurCost - OrigCost = change order amounts\n5. InvCost = amounts invoiced\n6. Retainage = amounts held back\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  SLHD.SL AS SubcontractNum,\n  SLHD.Description AS SubcontractDesc,\n  SUM(SLIT.OrigCost) AS OriginalCost,\n  SUM(SLIT.CurCost - SLIT.OrigCost) AS ChangeOrderCost,\n  SUM(SLIT.CurCost) AS CurrentCost,\n  SUM(SLIT.InvCost) AS InvoicedCost,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost - SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nINNER JOIN APVM WITH (NOLOCK) ON SLHD.VendorGroup = APVM.VendorGroup AND SLHD.Vendor = APVM.Vendor\nWHERE SLHD.SLCo = @SLCo\nGROUP BY APVM.Vendor, APVM.Name, SLHD.SL, SLHD.Description\nORDER BY APVM.Name, SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLHD",
        "SLIT",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Include ARCM in the query\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'ARCM' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nAPTH, APVM\n\nTo include ARCM in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need to count records in jccd by company\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count JCCD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM JCCD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from APTH\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from APTH ().\n\n```sql\nSELECT *\nFROM APTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query to track ap hold status distinguishing retainage vs non-retainage holds\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APCO (\n  APCo bcompany NOT NULL,\n  GLCo bcompany NOT NULL,\n  ExpJrnl bjrnl,\n  GLExpInterfaceLvl tinyint NOT NULL,\n  GLExpSummaryDesc varchar(60),\n  GLExpTransDesc varchar(60),\n  GLJobDetailDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLEquipDetailDesc varchar(60),\n  GLExpDetailDesc varchar(60),\n  PayJrnl bjrnl,\n  GLPayInterfaceLvl tinyint NOT NULL,\n  GLPayDetailDesc varchar(60),\n  GLPaySummaryDesc varchar(60),\n  DiscOffGLAcct bglacct,\n  DiscTakenGLAcct bglacct,\n  ExpPayType tinyint,\n  JobPayType tinyint,\n  SubPayType tinyint,\n  RetPayType tinyint,\n  -- ... 92 more columns,\n  PRIMARY KEY (APCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To distinguish retainage vs non-retainage holds:\n1. Join APTD to APHD for hold details\n2. Join APCO to get RetHoldCode setting\n3. Compare APHD.HoldCode to APCO.RetHoldCode\n4. If equal, it's a retainage hold; otherwise non-retainage\n\n```sql\nSELECT \n  APTD.APCo,\n  APTD.Vendor,\n  APTD.Mth,\n  APTD.APTrans,\n  APHD.HoldCode,\n  CASE WHEN APHD.HoldCode = APCO.RetHoldCode \n       THEN 'Retainage Hold' \n       ELSE 'Non-Retainage Hold' END AS HoldType,\n  APTD.Amount\nFROM APTD WITH (NOLOCK)\nINNER JOIN APHD WITH (NOLOCK) ON APTD.APCo = APHD.APCo \n  AND APTD.Mth = APHD.Mth \n  AND APTD.APTrans = APHD.APTrans \n  AND APTD.APLine = APHD.APLine\nINNER JOIN APCO WITH (NOLOCK) ON APTD.APCo = APCO.APCo\nWHERE APTD.APCo = @APCo\n  AND APHD.HoldCode IS NOT NULL\nORDER BY APTD.Vendor, APTD.Mth\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTD",
        "APHD",
        "APCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging buckets (30/60/90+ days) for unpaid invoices by customer\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Use ARTH for transaction data and ARCM for customer names\n2. Filter PayFullDate IS NULL to get only unpaid invoices\n3. Use DATEDIFF and CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from APTD\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from APTD ().\n\n```sql\nSELECT *\nFROM APTD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: List all fields in Locations\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'Locations' does not exist in Viewpoint Vista.\n\nUse HQLC (HQ Location) for location information.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM HQLC WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need to count records in arth by company\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count ARTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM ARTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to count records in prth by company\n\nDatabase Schema:\nCREATE TABLE PRTH (\n  PRCo bcompany NOT NULL,\n  PRGroup bgroup NOT NULL,\n  PREndDate bdate NOT NULL,\n  Employee bemployee NOT NULL,\n  PaySeq tinyint NOT NULL,\n  PostSeq smallint NOT NULL,\n  Type char(1) NOT NULL,\n  PostDate bdate NOT NULL,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCDept bdept,\n  GLCo bcompany NOT NULL,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equipment bequip,\n  EMGroup tinyint,\n  CostCode bcostcode,\n  -- ... 41 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count PRTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM PRTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "PRTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get job cost variance by phase comparing budget to actual\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Job cost variance by phase:\n1. Join JCJM (Job Master) to JCCP (Cost Phase)\n2. Calculate variance as CurrEstCost - ActualCost\n3. Calculate percent complete from actuals vs budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  JCCP.Phase,\n  JCCP.CostType,\n  JCCP.OrigEstCost AS OriginalBudget,\n  JCCP.CurrEstCost AS CurrentBudget,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS Variance,\n  CASE WHEN JCCP.CurrEstCost <> 0 \n       THEN (JCCP.ActualCost / JCCP.CurrEstCost) * 100 \n       ELSE 0 END AS PercentComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.Job = @Job\nORDER BY JCCP.Phase, JCCP.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How do I count records in arth by company\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count ARTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM ARTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to count records in jccd by company\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count JCCD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM JCCD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to count records in prco by company\n\nDatabase Schema:\nCREATE TABLE PRCO (\n  PRCo bcompany NOT NULL,\n  GLCo bcompany NOT NULL,\n  Jrnl bjrnl,\n  GLInterface byn NOT NULL,\n  CMCo bcompany NOT NULL,\n  APCo bcompany,\n  AutoOT byn NOT NULL,\n  OTEarnCode bedlcode,\n  JCCo bcompany NOT NULL,\n  AllowNoPhase byn NOT NULL,\n  JCInterface byn NOT NULL,\n  InsByPhase byn NOT NULL,\n  JCICraftClass byn NOT NULL,\n  JCICrew byn NOT NULL,\n  JCIEmployee byn NOT NULL,\n  JCIFactor byn NOT NULL,\n  JCIEarnType byn NOT NULL,\n  JCIShift byn NOT NULL,\n  JCIPostingDate byn NOT NULL,\n  JCILiabType byn NOT NULL,\n  -- ... 66 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count PRCO records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM PRCO WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "PRCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from APTD\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from APTD ().\n\n```sql\nSELECT *\nFROM APTD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How do I count records in gljr by company\n\nDatabase Schema:\nCREATE TABLE GLJR (\n  GLCo bcompany NOT NULL,\n  Jrnl bjrnl NOT NULL,\n  Description btransdesc,\n  Rev byn NOT NULL,\n  RevJrnl bjrnl,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count GLJR records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM GLJR WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "GLJR"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from JCCD\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from JCCD ().\n\n```sql\nSELECT *\nFROM JCCD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Describe the Payments table\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'Payments' does not exist in Viewpoint Vista.\n\nFor AP payments, use APTD (AP Transaction Detail). For AR payments, use ARTH with appropriate ARTransType.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM APTD WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need to track ap hold status distinguishing retainage vs non-retainage holds\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APCO (\n  APCo bcompany NOT NULL,\n  GLCo bcompany NOT NULL,\n  ExpJrnl bjrnl,\n  GLExpInterfaceLvl tinyint NOT NULL,\n  GLExpSummaryDesc varchar(60),\n  GLExpTransDesc varchar(60),\n  GLJobDetailDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLEquipDetailDesc varchar(60),\n  GLExpDetailDesc varchar(60),\n  PayJrnl bjrnl,\n  GLPayInterfaceLvl tinyint NOT NULL,\n  GLPayDetailDesc varchar(60),\n  GLPaySummaryDesc varchar(60),\n  DiscOffGLAcct bglacct,\n  DiscTakenGLAcct bglacct,\n  ExpPayType tinyint,\n  JobPayType tinyint,\n  SubPayType tinyint,\n  RetPayType tinyint,\n  -- ... 92 more columns,\n  PRIMARY KEY (APCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To distinguish retainage vs non-retainage holds:\n1. Join APTD to APHD for hold details\n2. Join APCO to get RetHoldCode setting\n3. Compare APHD.HoldCode to APCO.RetHoldCode\n4. If equal, it's a retainage hold; otherwise non-retainage\n\n```sql\nSELECT \n  APTD.APCo,\n  APTD.Vendor,\n  APTD.Mth,\n  APTD.APTrans,\n  APHD.HoldCode,\n  CASE WHEN APHD.HoldCode = APCO.RetHoldCode \n       THEN 'Retainage Hold' \n       ELSE 'Non-Retainage Hold' END AS HoldType,\n  APTD.Amount\nFROM APTD WITH (NOLOCK)\nINNER JOIN APHD WITH (NOLOCK) ON APTD.APCo = APHD.APCo \n  AND APTD.Mth = APHD.Mth \n  AND APTD.APTrans = APHD.APTrans \n  AND APTD.APLine = APHD.APLine\nINNER JOIN APCO WITH (NOLOCK) ON APTD.APCo = APCO.APCo\nWHERE APTD.APCo = @APCo\n  AND APHD.HoldCode IS NOT NULL\nORDER BY APTD.Vendor, APTD.Mth\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTD",
        "APHD",
        "APCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging buckets (30/60/90+ days) for unpaid invoices by customer\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Use ARTH for transaction data and ARCM for customer names\n2. Filter PayFullDate IS NULL to get only unpaid invoices\n3. Use DATEDIFF and CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from APTD\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from APTD ().\n\n```sql\nSELECT *\nFROM APTD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need to count records in slhd by company\n\nDatabase Schema:\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count SLHD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM SLHD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "SLHD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query to count records in prpc by company\n\nDatabase Schema:\nCREATE TABLE PRPC (\n  PRCo bcompany NOT NULL,\n  PRGroup bgroup NOT NULL,\n  PREndDate bdate NOT NULL,\n  BeginDate bdate NOT NULL,\n  MultiMth byn NOT NULL,\n  BeginMth bmonth NOT NULL,\n  EndMth bmonth,\n  CutoffDate bdate,\n  LimitMth bmonth NOT NULL,\n  Hrs smallint NOT NULL,\n  Days tinyint NOT NULL,\n  Wks tinyint NOT NULL,\n  Status tinyint NOT NULL,\n  DateClosed smalldatetime,\n  JCInterface byn NOT NULL,\n  EMInterface byn NOT NULL,\n  GLInterface byn NOT NULL,\n  APInterface byn NOT NULL,\n  LeaveProcess byn NOT NULL,\n  InUseBy bvpusername,\n  -- ... 7 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count PRPC records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM PRPC WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "PRPC"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from SLHD\n\nDatabase Schema:\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from SLHD ().\n\n```sql\nSELECT *\nFROM SLHD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLHD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging buckets (30/60/90+ days) for unpaid invoices by customer\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Use ARTH for transaction data and ARCM for customer names\n2. Filter PayFullDate IS NULL to get only unpaid invoices\n3. Use DATEDIFF and CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get subcontractor costs with original, change orders, invoiced, paid, and retainage by vendor\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Subcontractor cost breakdown by vendor:\n1. Join SLHD (Header) to SLIT (Items) for subcontract details\n2. Join APVM for vendor names\n3. OrigCost = original contract amount\n4. CurCost - OrigCost = change order amounts\n5. InvCost = amounts invoiced\n6. Retainage = amounts held back\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  SLHD.SL AS SubcontractNum,\n  SLHD.Description AS SubcontractDesc,\n  SUM(SLIT.OrigCost) AS OriginalCost,\n  SUM(SLIT.CurCost - SLIT.OrigCost) AS ChangeOrderCost,\n  SUM(SLIT.CurCost) AS CurrentCost,\n  SUM(SLIT.InvCost) AS InvoicedCost,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost - SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nINNER JOIN APVM WITH (NOLOCK) ON SLHD.VendorGroup = APVM.VendorGroup AND SLHD.Vendor = APVM.Vendor\nWHERE SLHD.SLCo = @SLCo\nGROUP BY APVM.Vendor, APVM.Name, SLHD.SL, SLHD.Description\nORDER BY APVM.Name, SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "basic",
      "tables_used": [
        "SLHD",
        "SLIT",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to count records in preh by company\n\nDatabase Schema:\nCREATE TABLE PREH (\n  PRCo bcompany NOT NULL,\n  Employee bemployee NOT NULL,\n  LastName varchar(30) NOT NULL,\n  FirstName varchar(30),\n  MidName varchar(15),\n  SortName bsortname NOT NULL,\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  Phone bphone,\n  SSN char(11) NOT NULL,\n  Race char(2) NOT NULL,\n  Sex char(1) NOT NULL,\n  BirthDate smalldatetime,\n  HireDate bdate,\n  TermDate bdate,\n  PRGroup bgroup NOT NULL,\n  PRDept bdept NOT NULL,\n  -- ... 121 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count PREH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM PREH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "PREH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoice totals with discounts and retainage\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Vendor invoice summary with discounts and retainage:\n1. Join APTH to APVM for vendor details\n2. Aggregate by vendor\n3. Include GrossAmt, DiscOffer, Retainage, and Balance\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(APTH.APTrans) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS GrossAmount,\n  SUM(APTH.DiscOffer) AS DiscountsOffered,\n  SUM(APTH.Retainage) AS RetainageHeld,\n  SUM(APTH.Balance) AS OpenBalance\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need to count records in arth by company\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count ARTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM ARTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find jobs over budget with remaining cost projection\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Find jobs over budget:\n1. Aggregate JCCP by job from JCJM\n2. Compare total ActualCost to CurrEstCost\n3. Use HAVING to filter only over-budget jobs\n4. Sort by amount over budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description,\n  SUM(JCCP.CurrEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.CurrEstCost) - SUM(JCCP.ActualCost) AS RemainingBudget,\n  CASE WHEN SUM(JCCP.CurrEstCost) < SUM(JCCP.ActualCost) \n       THEN 'OVER BUDGET' ELSE 'OK' END AS Status\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\nGROUP BY JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.CurrEstCost)\nORDER BY (SUM(JCCP.ActualCost) - SUM(JCCP.CurrEstCost)) DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM",
        "JCCD",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need to count records in slhd by company\n\nDatabase Schema:\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count SLHD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM SLHD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLHD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get subcontractor costs with original, change orders, invoiced, paid, and retainage by vendor\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Subcontractor cost breakdown by vendor:\n1. Join SLHD (Header) to SLIT (Items) for subcontract details\n2. Join APVM for vendor names\n3. OrigCost = original contract amount\n4. CurCost - OrigCost = change order amounts\n5. InvCost = amounts invoiced\n6. Retainage = amounts held back\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  SLHD.SL AS SubcontractNum,\n  SLHD.Description AS SubcontractDesc,\n  SUM(SLIT.OrigCost) AS OriginalCost,\n  SUM(SLIT.CurCost - SLIT.OrigCost) AS ChangeOrderCost,\n  SUM(SLIT.CurCost) AS CurrentCost,\n  SUM(SLIT.InvCost) AS InvoicedCost,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost - SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nINNER JOIN APVM WITH (NOLOCK) ON SLHD.VendorGroup = APVM.VendorGroup AND SLHD.Vendor = APVM.Vendor\nWHERE SLHD.SLCo = @SLCo\nGROUP BY APVM.Vendor, APVM.Name, SLHD.SL, SLHD.Description\nORDER BY APVM.Name, SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLHD",
        "SLIT",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How do I aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get data from GLDT for analysis\n\nDatabase Schema:\nCREATE TABLE PREH (\n  PRCo bcompany NOT NULL,\n  Employee bemployee NOT NULL,\n  LastName varchar(30) NOT NULL,\n  FirstName varchar(30),\n  MidName varchar(15),\n  SortName bsortname NOT NULL,\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  Phone bphone,\n  SSN char(11) NOT NULL,\n  Race char(2) NOT NULL,\n  Sex char(1) NOT NULL,\n  BirthDate smalldatetime,\n  HireDate bdate,\n  TermDate bdate,\n  PRGroup bgroup NOT NULL,\n  PRDept bdept NOT NULL,\n  -- ... 121 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nCREATE TABLE PRTH (\n  PRCo bcompany NOT NULL,\n  PRGroup bgroup NOT NULL,\n  PREndDate bdate NOT NULL,\n  Employee bemployee NOT NULL,\n  PaySeq tinyint NOT NULL,\n  PostSeq smallint NOT NULL,\n  Type char(1) NOT NULL,\n  PostDate bdate NOT NULL,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCDept bdept,\n  GLCo bcompany NOT NULL,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equipment bequip,\n  EMGroup tinyint,\n  CostCode bcostcode,\n  -- ... 41 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'GLDT' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nPREH, PRTH\n\nTo include GLDT in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from SLHD\n\nDatabase Schema:\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from SLHD ().\n\n```sql\nSELECT *\nFROM SLHD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "SLHD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query to count records in preh by company\n\nDatabase Schema:\nCREATE TABLE PREH (\n  PRCo bcompany NOT NULL,\n  Employee bemployee NOT NULL,\n  LastName varchar(30) NOT NULL,\n  FirstName varchar(30),\n  MidName varchar(15),\n  SortName bsortname NOT NULL,\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  Phone bphone,\n  SSN char(11) NOT NULL,\n  Race char(2) NOT NULL,\n  Sex char(1) NOT NULL,\n  BirthDate smalldatetime,\n  HireDate bdate,\n  TermDate bdate,\n  PRGroup bgroup NOT NULL,\n  PRDept bdept NOT NULL,\n  -- ... 121 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count PREH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM PREH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "PREH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query to count records in arth by company\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count ARTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM ARTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find jobs over budget with remaining cost projection\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Find jobs over budget:\n1. Aggregate JCCP by job from JCJM\n2. Compare total ActualCost to CurrEstCost\n3. Use HAVING to filter only over-budget jobs\n4. Sort by amount over budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description,\n  SUM(JCCP.CurrEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.CurrEstCost) - SUM(JCCP.ActualCost) AS RemainingBudget,\n  CASE WHEN SUM(JCCP.CurrEstCost) < SUM(JCCP.ActualCost) \n       THEN 'OVER BUDGET' ELSE 'OK' END AS Status\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\nGROUP BY JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.CurrEstCost)\nORDER BY (SUM(JCCP.ActualCost) - SUM(JCCP.CurrEstCost)) DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM",
        "JCCD",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Include SLHD in the query\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'SLHD' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nJCJM, JCCD\n\nTo include SLHD in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show job costs with GL account descriptions\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I can partially answer this query, but the schema is incomplete.\n\nThe query requires GLAC for GL account descriptions, which is not in the provided schema.\n\nHere's what I can provide with the available schema:\n\n```sql\nSELECT *\nFROM JCCD WITH (NOLOCK)\nWHERE Co = @Co\n-- Note: Additional joins for GLAC would be needed for complete results\n```\n\nTo get the complete data you requested, please provide the DDL for GLAC.",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging buckets (30/60/90+ days) for unpaid invoices by customer\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Use ARTH for transaction data and ARCM for customer names\n2. Filter PayFullDate IS NULL to get only unpaid invoices\n3. Use DATEDIFF and CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging buckets (30/60/90+ days) for unpaid invoices by customer\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Use ARTH for transaction data and ARCM for customer names\n2. Filter PayFullDate IS NULL to get only unpaid invoices\n3. Use DATEDIFF and CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query to count records in jccd by company\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count JCCD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM JCCD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need to reconcile ap oncost batch lines with original transactions\n\nDatabase Schema:\nCREATE TABLE APTL (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equip bequip,\n  EMGroup bgroup,\n  -- ... 56 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans, APLine)\n);\n\nCREATE TABLE APLB (\n  Co bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  BatchId bbatchid NOT NULL,\n  BatchSeq int NOT NULL,\n  APLine smallint NOT NULL,\n  BatchTransType char(1) NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  -- ... 120 more columns,\n  PRIMARY KEY (Co, Mth, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APHB (\n  Co bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  BatchId bbatchid NOT NULL,\n  BatchSeq int NOT NULL,\n  BatchTransType char(1) NOT NULL,\n  APTrans btrans,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  -- ... 88 more columns,\n  PRIMARY KEY (Co, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To reconcile AP oncost batches with original transactions:\n1. Join APLB (batch lines) to APTL (original lines) using ocApplyMth, ocApplyTrans, ocApplyLine\n2. Include APHB for batch header info\n3. Join to APTH and APVM for vendor context\n4. Compare batch vs original amounts\n\n```sql\nSELECT \n  APLB.Co AS BatchCo,\n  APLB.Mth AS BatchMth,\n  APLB.BatchId,\n  APLB.BatchSeq,\n  APLB.ocApplyMth,\n  APLB.ocApplyTrans,\n  APLB.ocApplyLine,\n  APTL.APCo AS OrigCo,\n  APTL.Mth AS OrigMth,\n  APTL.APTrans AS OrigTrans,\n  APTL.APLine AS OrigLine,\n  APTL.GrossAmt AS OrigAmount,\n  APLB.GrossAmt AS BatchAmount,\n  APVM.Name AS VendorName\nFROM APLB WITH (NOLOCK)\nINNER JOIN APHB WITH (NOLOCK) ON APLB.Co = APHB.Co AND APLB.Mth = APHB.Mth AND APLB.BatchId = APHB.BatchId\nINNER JOIN APTL WITH (NOLOCK) ON APLB.ocApplyMth = APTL.Mth \n  AND APLB.ocApplyTrans = APTL.APTrans \n  AND APLB.ocApplyLine = APTL.APLine\n  AND APLB.Co = APTL.APCo\nINNER JOIN APTH WITH (NOLOCK) ON APTL.APCo = APTH.APCo AND APTL.Mth = APTH.Mth AND APTL.APTrans = APTH.APTrans\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APLB.Co = @Co\nORDER BY APLB.BatchId, APLB.BatchSeq\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APLB",
        "APHB",
        "APTL",
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from GLDT\n\nDatabase Schema:\nCREATE TABLE GLDT (\n  GLCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  GLTrans btrans NOT NULL,\n  GLAcct bglacct NOT NULL,\n  Jrnl bjrnl NOT NULL,\n  GLRef bglref NOT NULL,\n  SourceCo bcompany NOT NULL,\n  Source bsource NOT NULL,\n  ActDate bdate NOT NULL,\n  DatePosted bdate NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid NOT NULL,\n  Amount bdollar NOT NULL,\n  RevStatus tinyint NOT NULL,\n  Adjust char(1) NOT NULL,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  UniqueAttchID uniqueidentifier,\n  SrcTable varchar(128),\n  SrcKeyID bigint,\n  PRIMARY KEY (GLCo, Mth, GLTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from GLDT ().\n\n```sql\nSELECT *\nFROM GLDT WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "GLDT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find all unpaid AR invoices older than 60 days\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find unpaid invoices over 60 days:\n1. Join ARTH to ARCM for customer information\n2. Filter PayFullDate IS NULL (unpaid)\n3. Use DATEDIFF to calculate age and filter > 60 days\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Mth,\n  ARTH.ARTrans,\n  ARCM.Name AS CustomerName,\n  ARTH.TransDate,\n  ARTH.Amount,\n  DATEDIFF(day, ARTH.TransDate, GETDATE()) AS DaysOutstanding\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\n  AND DATEDIFF(day, ARTH.TransDate, GETDATE()) > 60\nORDER BY ARTH.TransDate\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from APTD\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from APTD ().\n\n```sql\nSELECT *\nFROM APTD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoice totals with discounts and retainage\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Vendor invoice summary with discounts and retainage:\n1. Join APTH to APVM for vendor details\n2. Aggregate by vendor\n3. Include GrossAmt, DiscOffer, Retainage, and Balance\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(APTH.APTrans) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS GrossAmount,\n  SUM(APTH.DiscOffer) AS DiscountsOffered,\n  SUM(APTH.Retainage) AS RetainageHeld,\n  SUM(APTH.Balance) AS OpenBalance\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "basic",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How do I count records in gljr by company\n\nDatabase Schema:\nCREATE TABLE GLJR (\n  GLCo bcompany NOT NULL,\n  Jrnl bjrnl NOT NULL,\n  Description btransdesc,\n  Rev byn NOT NULL,\n  RevJrnl bjrnl,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count GLJR records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM GLJR WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "GLJR"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from ARTH\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from ARTH ().\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find all unpaid AR invoices older than 60 days\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find unpaid invoices over 60 days:\n1. Join ARTH to ARCM for customer information\n2. Filter PayFullDate IS NULL (unpaid)\n3. Use DATEDIFF to calculate age and filter > 60 days\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Mth,\n  ARTH.ARTrans,\n  ARCM.Name AS CustomerName,\n  ARTH.TransDate,\n  ARTH.Amount,\n  DATEDIFF(day, ARTH.TransDate, GETDATE()) AS DaysOutstanding\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\n  AND DATEDIFF(day, ARTH.TransDate, GETDATE()) > 60\nORDER BY ARTH.TransDate\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get job cost variance by phase comparing budget to actual\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Job cost variance by phase:\n1. Join JCJM (Job Master) to JCCP (Cost Phase)\n2. Calculate variance as CurrEstCost - ActualCost\n3. Calculate percent complete from actuals vs budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  JCCP.Phase,\n  JCCP.CostType,\n  JCCP.OrigEstCost AS OriginalBudget,\n  JCCP.CurrEstCost AS CurrentBudget,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS Variance,\n  CASE WHEN JCCP.CurrEstCost <> 0 \n       THEN (JCCP.ActualCost / JCCP.CurrEstCost) * 100 \n       ELSE 0 END AS PercentComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.Job = @Job\nORDER BY JCCP.Phase, JCCP.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How do I count records in prpc by company\n\nDatabase Schema:\nCREATE TABLE PRPC (\n  PRCo bcompany NOT NULL,\n  PRGroup bgroup NOT NULL,\n  PREndDate bdate NOT NULL,\n  BeginDate bdate NOT NULL,\n  MultiMth byn NOT NULL,\n  BeginMth bmonth NOT NULL,\n  EndMth bmonth,\n  CutoffDate bdate,\n  LimitMth bmonth NOT NULL,\n  Hrs smallint NOT NULL,\n  Days tinyint NOT NULL,\n  Wks tinyint NOT NULL,\n  Status tinyint NOT NULL,\n  DateClosed smalldatetime,\n  JCInterface byn NOT NULL,\n  EMInterface byn NOT NULL,\n  GLInterface byn NOT NULL,\n  APInterface byn NOT NULL,\n  LeaveProcess byn NOT NULL,\n  InUseBy bvpusername,\n  -- ... 7 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count PRPC records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM PRPC WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "PRPC"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Include SLHD in the query\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'SLHD' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nJCJM, JCCD\n\nTo include SLHD in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: track ap hold status distinguishing retainage vs non-retainage holds\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APCO (\n  APCo bcompany NOT NULL,\n  GLCo bcompany NOT NULL,\n  ExpJrnl bjrnl,\n  GLExpInterfaceLvl tinyint NOT NULL,\n  GLExpSummaryDesc varchar(60),\n  GLExpTransDesc varchar(60),\n  GLJobDetailDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLEquipDetailDesc varchar(60),\n  GLExpDetailDesc varchar(60),\n  PayJrnl bjrnl,\n  GLPayInterfaceLvl tinyint NOT NULL,\n  GLPayDetailDesc varchar(60),\n  GLPaySummaryDesc varchar(60),\n  DiscOffGLAcct bglacct,\n  DiscTakenGLAcct bglacct,\n  ExpPayType tinyint,\n  JobPayType tinyint,\n  SubPayType tinyint,\n  RetPayType tinyint,\n  -- ... 92 more columns,\n  PRIMARY KEY (APCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To distinguish retainage vs non-retainage holds:\n1. Join APTD to APHD for hold details\n2. Join APCO to get RetHoldCode setting\n3. Compare APHD.HoldCode to APCO.RetHoldCode\n4. If equal, it's a retainage hold; otherwise non-retainage\n\n```sql\nSELECT \n  APTD.APCo,\n  APTD.Vendor,\n  APTD.Mth,\n  APTD.APTrans,\n  APHD.HoldCode,\n  CASE WHEN APHD.HoldCode = APCO.RetHoldCode \n       THEN 'Retainage Hold' \n       ELSE 'Non-Retainage Hold' END AS HoldType,\n  APTD.Amount\nFROM APTD WITH (NOLOCK)\nINNER JOIN APHD WITH (NOLOCK) ON APTD.APCo = APHD.APCo \n  AND APTD.Mth = APHD.Mth \n  AND APTD.APTrans = APHD.APTrans \n  AND APTD.APLine = APHD.APLine\nINNER JOIN APCO WITH (NOLOCK) ON APTD.APCo = APCO.APCo\nWHERE APTD.APCo = @APCo\n  AND APHD.HoldCode IS NOT NULL\nORDER BY APTD.Vendor, APTD.Mth\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "basic",
      "tables_used": [
        "APTD",
        "APHD",
        "APCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find jobs over budget with remaining cost projection\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Find jobs over budget:\n1. Aggregate JCCP by job from JCJM\n2. Compare total ActualCost to CurrEstCost\n3. Use HAVING to filter only over-budget jobs\n4. Sort by amount over budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description,\n  SUM(JCCP.CurrEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.CurrEstCost) - SUM(JCCP.ActualCost) AS RemainingBudget,\n  CASE WHEN SUM(JCCP.CurrEstCost) < SUM(JCCP.ActualCost) \n       THEN 'OVER BUDGET' ELSE 'OK' END AS Status\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\nGROUP BY JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.CurrEstCost)\nORDER BY (SUM(JCCP.ActualCost) - SUM(JCCP.CurrEstCost)) DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCJM",
        "JCCD",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging buckets (30/60/90+ days) for unpaid invoices by customer\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Use ARTH for transaction data and ARCM for customer names\n2. Filter PayFullDate IS NULL to get only unpaid invoices\n3. Use DATEDIFF and CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to track ap hold status distinguishing retainage vs non-retainage holds\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APCO (\n  APCo bcompany NOT NULL,\n  GLCo bcompany NOT NULL,\n  ExpJrnl bjrnl,\n  GLExpInterfaceLvl tinyint NOT NULL,\n  GLExpSummaryDesc varchar(60),\n  GLExpTransDesc varchar(60),\n  GLJobDetailDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLEquipDetailDesc varchar(60),\n  GLExpDetailDesc varchar(60),\n  PayJrnl bjrnl,\n  GLPayInterfaceLvl tinyint NOT NULL,\n  GLPayDetailDesc varchar(60),\n  GLPaySummaryDesc varchar(60),\n  DiscOffGLAcct bglacct,\n  DiscTakenGLAcct bglacct,\n  ExpPayType tinyint,\n  JobPayType tinyint,\n  SubPayType tinyint,\n  RetPayType tinyint,\n  -- ... 92 more columns,\n  PRIMARY KEY (APCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To distinguish retainage vs non-retainage holds:\n1. Join APTD to APHD for hold details\n2. Join APCO to get RetHoldCode setting\n3. Compare APHD.HoldCode to APCO.RetHoldCode\n4. If equal, it's a retainage hold; otherwise non-retainage\n\n```sql\nSELECT \n  APTD.APCo,\n  APTD.Vendor,\n  APTD.Mth,\n  APTD.APTrans,\n  APHD.HoldCode,\n  CASE WHEN APHD.HoldCode = APCO.RetHoldCode \n       THEN 'Retainage Hold' \n       ELSE 'Non-Retainage Hold' END AS HoldType,\n  APTD.Amount\nFROM APTD WITH (NOLOCK)\nINNER JOIN APHD WITH (NOLOCK) ON APTD.APCo = APHD.APCo \n  AND APTD.Mth = APHD.Mth \n  AND APTD.APTrans = APHD.APTrans \n  AND APTD.APLine = APHD.APLine\nINNER JOIN APCO WITH (NOLOCK) ON APTD.APCo = APCO.APCo\nWHERE APTD.APCo = @APCo\n  AND APHD.HoldCode IS NOT NULL\nORDER BY APTD.Vendor, APTD.Mth\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTD",
        "APHD",
        "APCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoice totals with discounts and retainage\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Vendor invoice summary with discounts and retainage:\n1. Join APTH to APVM for vendor details\n2. Aggregate by vendor\n3. Include GrossAmt, DiscOffer, Retainage, and Balance\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(APTH.APTrans) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS GrossAmount,\n  SUM(APTH.DiscOffer) AS DiscountsOffered,\n  SUM(APTH.Retainage) AS RetainageHeld,\n  SUM(APTH.Balance) AS OpenBalance\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "basic",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find jobs over budget with remaining cost projection\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Find jobs over budget:\n1. Aggregate JCCP by job from JCJM\n2. Compare total ActualCost to CurrEstCost\n3. Use HAVING to filter only over-budget jobs\n4. Sort by amount over budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description,\n  SUM(JCCP.CurrEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.CurrEstCost) - SUM(JCCP.ActualCost) AS RemainingBudget,\n  CASE WHEN SUM(JCCP.CurrEstCost) < SUM(JCCP.ActualCost) \n       THEN 'OVER BUDGET' ELSE 'OK' END AS Status\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\nGROUP BY JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.CurrEstCost)\nORDER BY (SUM(JCCP.ActualCost) - SUM(JCCP.CurrEstCost)) DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCJM",
        "JCCD",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get job cost variance by phase comparing budget to actual\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Job cost variance by phase:\n1. Join JCJM (Job Master) to JCCP (Cost Phase)\n2. Calculate variance as CurrEstCost - ActualCost\n3. Calculate percent complete from actuals vs budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  JCCP.Phase,\n  JCCP.CostType,\n  JCCP.OrigEstCost AS OriginalBudget,\n  JCCP.CurrEstCost AS CurrentBudget,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS Variance,\n  CASE WHEN JCCP.CurrEstCost <> 0 \n       THEN (JCCP.ActualCost / JCCP.CurrEstCost) * 100 \n       ELSE 0 END AS PercentComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.Job = @Job\nORDER BY JCCP.Phase, JCCP.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from ARTH\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from ARTH ().\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How do I count records in prpc by company\n\nDatabase Schema:\nCREATE TABLE PRPC (\n  PRCo bcompany NOT NULL,\n  PRGroup bgroup NOT NULL,\n  PREndDate bdate NOT NULL,\n  BeginDate bdate NOT NULL,\n  MultiMth byn NOT NULL,\n  BeginMth bmonth NOT NULL,\n  EndMth bmonth,\n  CutoffDate bdate,\n  LimitMth bmonth NOT NULL,\n  Hrs smallint NOT NULL,\n  Days tinyint NOT NULL,\n  Wks tinyint NOT NULL,\n  Status tinyint NOT NULL,\n  DateClosed smalldatetime,\n  JCInterface byn NOT NULL,\n  EMInterface byn NOT NULL,\n  GLInterface byn NOT NULL,\n  APInterface byn NOT NULL,\n  LeaveProcess byn NOT NULL,\n  InUseBy bvpusername,\n  -- ... 7 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count PRPC records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM PRPC WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "PRPC"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get job cost variance by phase comparing budget to actual\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Job cost variance by phase:\n1. Join JCJM (Job Master) to JCCP (Cost Phase)\n2. Calculate variance as CurrEstCost - ActualCost\n3. Calculate percent complete from actuals vs budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  JCCP.Phase,\n  JCCP.CostType,\n  JCCP.OrigEstCost AS OriginalBudget,\n  JCCP.CurrEstCost AS CurrentBudget,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS Variance,\n  CASE WHEN JCCP.CurrEstCost <> 0 \n       THEN (JCCP.ActualCost / JCCP.CurrEstCost) * 100 \n       ELSE 0 END AS PercentComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.Job = @Job\nORDER BY JCCP.Phase, JCCP.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from ARTH\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from ARTH ().\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: count records in prth by company\n\nDatabase Schema:\nCREATE TABLE PRTH (\n  PRCo bcompany NOT NULL,\n  PRGroup bgroup NOT NULL,\n  PREndDate bdate NOT NULL,\n  Employee bemployee NOT NULL,\n  PaySeq tinyint NOT NULL,\n  PostSeq smallint NOT NULL,\n  Type char(1) NOT NULL,\n  PostDate bdate NOT NULL,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCDept bdept,\n  GLCo bcompany NOT NULL,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equipment bequip,\n  EMGroup tinyint,\n  CostCode bcostcode,\n  -- ... 41 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count PRTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM PRTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "PRTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from ARTH\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from ARTH ().\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: track ap hold status distinguishing retainage vs non-retainage holds\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APCO (\n  APCo bcompany NOT NULL,\n  GLCo bcompany NOT NULL,\n  ExpJrnl bjrnl,\n  GLExpInterfaceLvl tinyint NOT NULL,\n  GLExpSummaryDesc varchar(60),\n  GLExpTransDesc varchar(60),\n  GLJobDetailDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLEquipDetailDesc varchar(60),\n  GLExpDetailDesc varchar(60),\n  PayJrnl bjrnl,\n  GLPayInterfaceLvl tinyint NOT NULL,\n  GLPayDetailDesc varchar(60),\n  GLPaySummaryDesc varchar(60),\n  DiscOffGLAcct bglacct,\n  DiscTakenGLAcct bglacct,\n  ExpPayType tinyint,\n  JobPayType tinyint,\n  SubPayType tinyint,\n  RetPayType tinyint,\n  -- ... 92 more columns,\n  PRIMARY KEY (APCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To distinguish retainage vs non-retainage holds:\n1. Join APTD to APHD for hold details\n2. Join APCO to get RetHoldCode setting\n3. Compare APHD.HoldCode to APCO.RetHoldCode\n4. If equal, it's a retainage hold; otherwise non-retainage\n\n```sql\nSELECT \n  APTD.APCo,\n  APTD.Vendor,\n  APTD.Mth,\n  APTD.APTrans,\n  APHD.HoldCode,\n  CASE WHEN APHD.HoldCode = APCO.RetHoldCode \n       THEN 'Retainage Hold' \n       ELSE 'Non-Retainage Hold' END AS HoldType,\n  APTD.Amount\nFROM APTD WITH (NOLOCK)\nINNER JOIN APHD WITH (NOLOCK) ON APTD.APCo = APHD.APCo \n  AND APTD.Mth = APHD.Mth \n  AND APTD.APTrans = APHD.APTrans \n  AND APTD.APLine = APHD.APLine\nINNER JOIN APCO WITH (NOLOCK) ON APTD.APCo = APCO.APCo\nWHERE APTD.APCo = @APCo\n  AND APHD.HoldCode IS NOT NULL\nORDER BY APTD.Vendor, APTD.Mth\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "basic",
      "tables_used": [
        "APTD",
        "APHD",
        "APCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from PRTD\n\nDatabase Schema:\nCREATE TABLE PRTD (\n  PRCo bcompany NOT NULL,\n  Craft bcraft NOT NULL,\n  Class bclass NOT NULL,\n  Template smallint NOT NULL,\n  DLCode bedlcode NOT NULL,\n  Factor brate NOT NULL,\n  OldRate bunitcost NOT NULL,\n  NewRate bunitcost NOT NULL,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from PRTD ().\n\n```sql\nSELECT *\nFROM PRTD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "PRTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get data from SLHD for analysis\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'SLHD' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nJCJM, JCCD\n\nTo include SLHD in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get customer balance summary by customer group\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Customer balance summary by group:\n1. Join ARTH to ARCM for customer details\n2. Use conditional SUM for open vs total balances\n3. Group by CustGroup for summary\n\n```sql\nSELECT \n  ARTH.CustGroup,\n  COUNT(DISTINCT ARTH.Customer) AS CustomerCount,\n  SUM(CASE WHEN ARTH.PayFullDate IS NULL THEN ARTH.Amount ELSE 0 END) AS OpenBalance,\n  SUM(ARTH.Amount) AS TotalBilled\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\nGROUP BY ARTH.CustGroup\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to track ap hold status distinguishing retainage vs non-retainage holds\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APCO (\n  APCo bcompany NOT NULL,\n  GLCo bcompany NOT NULL,\n  ExpJrnl bjrnl,\n  GLExpInterfaceLvl tinyint NOT NULL,\n  GLExpSummaryDesc varchar(60),\n  GLExpTransDesc varchar(60),\n  GLJobDetailDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLEquipDetailDesc varchar(60),\n  GLExpDetailDesc varchar(60),\n  PayJrnl bjrnl,\n  GLPayInterfaceLvl tinyint NOT NULL,\n  GLPayDetailDesc varchar(60),\n  GLPaySummaryDesc varchar(60),\n  DiscOffGLAcct bglacct,\n  DiscTakenGLAcct bglacct,\n  ExpPayType tinyint,\n  JobPayType tinyint,\n  SubPayType tinyint,\n  RetPayType tinyint,\n  -- ... 92 more columns,\n  PRIMARY KEY (APCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To distinguish retainage vs non-retainage holds:\n1. Join APTD to APHD for hold details\n2. Join APCO to get RetHoldCode setting\n3. Compare APHD.HoldCode to APCO.RetHoldCode\n4. If equal, it's a retainage hold; otherwise non-retainage\n\n```sql\nSELECT \n  APTD.APCo,\n  APTD.Vendor,\n  APTD.Mth,\n  APTD.APTrans,\n  APHD.HoldCode,\n  CASE WHEN APHD.HoldCode = APCO.RetHoldCode \n       THEN 'Retainage Hold' \n       ELSE 'Non-Retainage Hold' END AS HoldType,\n  APTD.Amount\nFROM APTD WITH (NOLOCK)\nINNER JOIN APHD WITH (NOLOCK) ON APTD.APCo = APHD.APCo \n  AND APTD.Mth = APHD.Mth \n  AND APTD.APTrans = APHD.APTrans \n  AND APTD.APLine = APHD.APLine\nINNER JOIN APCO WITH (NOLOCK) ON APTD.APCo = APCO.APCo\nWHERE APTD.APCo = @APCo\n  AND APHD.HoldCode IS NOT NULL\nORDER BY APTD.Vendor, APTD.Mth\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "basic",
      "tables_used": [
        "APTD",
        "APHD",
        "APCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging buckets (30/60/90+ days) for unpaid invoices by customer\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Use ARTH for transaction data and ARCM for customer names\n2. Filter PayFullDate IS NULL to get only unpaid invoices\n3. Use DATEDIFF and CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to count records in glac by company\n\nDatabase Schema:\nCREATE TABLE GLAC (\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  Description bdesc,\n  AcctType char(1) NOT NULL,\n  SubType char(1),\n  NormBal char(1),\n  InterfaceDetail byn NOT NULL,\n  Active byn NOT NULL,\n  SummaryAcct bglacct NOT NULL,\n  CashAccrual char(1) NOT NULL,\n  CashOffAcct bglacct,\n  Notes varchar,\n  Part1 varchar(20),\n  Part2 varchar(20),\n  Part3 varchar(20),\n  Part4 varchar(20),\n  Part5 varchar(20),\n  Part6 varchar(20),\n  AllParts varchar(20),\n  CrossRefMemAcct bglacct,\n  -- ... 3 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count GLAC records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM GLAC WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "GLAC"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get subcontractor costs with original, change orders, invoiced, paid, and retainage by vendor\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Subcontractor cost breakdown by vendor:\n1. Join SLHD (Header) to SLIT (Items) for subcontract details\n2. Join APVM for vendor names\n3. OrigCost = original contract amount\n4. CurCost - OrigCost = change order amounts\n5. InvCost = amounts invoiced\n6. Retainage = amounts held back\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  SLHD.SL AS SubcontractNum,\n  SLHD.Description AS SubcontractDesc,\n  SUM(SLIT.OrigCost) AS OriginalCost,\n  SUM(SLIT.CurCost - SLIT.OrigCost) AS ChangeOrderCost,\n  SUM(SLIT.CurCost) AS CurrentCost,\n  SUM(SLIT.InvCost) AS InvoicedCost,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost - SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nINNER JOIN APVM WITH (NOLOCK) ON SLHD.VendorGroup = APVM.VendorGroup AND SLHD.Vendor = APVM.Vendor\nWHERE SLHD.SLCo = @SLCo\nGROUP BY APVM.Vendor, APVM.Name, SLHD.SL, SLHD.Description\nORDER BY APVM.Name, SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "intermediate",
      "tables_used": [
        "SLHD",
        "SLIT",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query to count records in gljr by company\n\nDatabase Schema:\nCREATE TABLE GLJR (\n  GLCo bcompany NOT NULL,\n  Jrnl bjrnl NOT NULL,\n  Description btransdesc,\n  Rev byn NOT NULL,\n  RevJrnl bjrnl,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count GLJR records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM GLJR WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "GLJR"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoices with their subcontract details\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I can partially answer this query, but the schema is incomplete.\n\nTo include subcontract details, the SLHD table is needed but not provided in the schema.\n\nHere's what I can provide with the available schema:\n\n```sql\nSELECT *\nFROM APTH WITH (NOLOCK)\nWHERE Co = @Co\n-- Note: Additional joins for SLHD would be needed for complete results\n```\n\nTo get the complete data you requested, please provide the DDL for SLHD.",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": [
        "APTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate stored materials (Purchased - Installed) for SL billing\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Stored materials for SL billing:\n1. SLWI contains work item/billing details\n2. StoredMatls = Purchased - Installed (materials on-site but not yet used)\n3. WCCost = Work Completed Cost\n4. WCRetAmt and SMRetAmt = separate retainage for work vs materials\n5. Total billable = WCCost + StoredMatls\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description AS ItemDescription,\n  SLWI.StoredMatls,\n  SLWI.WCCost AS WorkCompletedCost,\n  SLWI.StoredMatls + SLWI.WCCost AS TotalBillable,\n  SLWI.WCRetAmt AS WorkRetainage,\n  SLWI.SMRetAmt AS MaterialsRetainage,\n  SLWI.WCRetAmt + SLWI.SMRetAmt AS TotalRetainage\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\n  AND SLWI.StoredMatls <> 0\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "basic",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: SELECT * FROM Customers\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'Customers' does not exist in Viewpoint Vista.\n\nUse ARCM (AR Customer Master) for customer information. Vista uses abbreviated table names.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM ARCM WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from APTH\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from APTH ().\n\n```sql\nSELECT *\nFROM APTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "APTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from GLJR\n\nDatabase Schema:\nCREATE TABLE GLJR (\n  GLCo bcompany NOT NULL,\n  Jrnl bjrnl NOT NULL,\n  Description btransdesc,\n  Rev byn NOT NULL,\n  RevJrnl bjrnl,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from GLJR ().\n\n```sql\nSELECT *\nFROM GLJR WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "GLJR"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get job cost variance by phase comparing budget to actual\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Job cost variance by phase:\n1. Join JCJM (Job Master) to JCCP (Cost Phase)\n2. Calculate variance as CurrEstCost - ActualCost\n3. Calculate percent complete from actuals vs budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  JCCP.Phase,\n  JCCP.CostType,\n  JCCP.OrigEstCost AS OriginalBudget,\n  JCCP.CurrEstCost AS CurrentBudget,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS Variance,\n  CASE WHEN JCCP.CurrEstCost <> 0 \n       THEN (JCCP.ActualCost / JCCP.CurrEstCost) * 100 \n       ELSE 0 END AS PercentComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.Job = @Job\nORDER BY JCCP.Phase, JCCP.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query to count records in gljr by company\n\nDatabase Schema:\nCREATE TABLE GLJR (\n  GLCo bcompany NOT NULL,\n  Jrnl bjrnl NOT NULL,\n  Description btransdesc,\n  Rev byn NOT NULL,\n  RevJrnl bjrnl,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count GLJR records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM GLJR WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "GLJR"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How do I count records in aptd by company\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count APTD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM APTD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Query ARCM along with the schema tables\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'ARCM' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nAPTH, APVM\n\nTo include ARCM in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to query Vendor\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'Vendor' does not exist in Viewpoint Vista.\n\nUse APVM (AP Vendor Master) for vendor information.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM APVM WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to count records in jccd by company\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count JCCD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM JCCD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How do I count records in slwi by company\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count SLWI records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM SLWI WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLWI"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate stored materials (Purchased - Installed) for SL billing\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Stored materials for SL billing:\n1. SLWI contains work item/billing details\n2. StoredMatls = Purchased - Installed (materials on-site but not yet used)\n3. WCCost = Work Completed Cost\n4. WCRetAmt and SMRetAmt = separate retainage for work vs materials\n5. Total billable = WCCost + StoredMatls\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description AS ItemDescription,\n  SLWI.StoredMatls,\n  SLWI.WCCost AS WorkCompletedCost,\n  SLWI.StoredMatls + SLWI.WCCost AS TotalBillable,\n  SLWI.WCRetAmt AS WorkRetainage,\n  SLWI.SMRetAmt AS MaterialsRetainage,\n  SLWI.WCRetAmt + SLWI.SMRetAmt AS TotalRetainage\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\n  AND SLWI.StoredMatls <> 0\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "basic",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate stored materials (Purchased - Installed) for SL billing\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Stored materials for SL billing:\n1. SLWI contains work item/billing details\n2. StoredMatls = Purchased - Installed (materials on-site but not yet used)\n3. WCCost = Work Completed Cost\n4. WCRetAmt and SMRetAmt = separate retainage for work vs materials\n5. Total billable = WCCost + StoredMatls\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description AS ItemDescription,\n  SLWI.StoredMatls,\n  SLWI.WCCost AS WorkCompletedCost,\n  SLWI.StoredMatls + SLWI.WCCost AS TotalBillable,\n  SLWI.WCRetAmt AS WorkRetainage,\n  SLWI.SMRetAmt AS MaterialsRetainage,\n  SLWI.WCRetAmt + SLWI.SMRetAmt AS TotalRetainage\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\n  AND SLWI.StoredMatls <> 0\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "intermediate",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to count records in gldt by company\n\nDatabase Schema:\nCREATE TABLE GLDT (\n  GLCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  GLTrans btrans NOT NULL,\n  GLAcct bglacct NOT NULL,\n  Jrnl bjrnl NOT NULL,\n  GLRef bglref NOT NULL,\n  SourceCo bcompany NOT NULL,\n  Source bsource NOT NULL,\n  ActDate bdate NOT NULL,\n  DatePosted bdate NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid NOT NULL,\n  Amount bdollar NOT NULL,\n  RevStatus tinyint NOT NULL,\n  Adjust char(1) NOT NULL,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  UniqueAttchID uniqueidentifier,\n  SrcTable varchar(128),\n  SrcKeyID bigint,\n  PRIMARY KEY (GLCo, Mth, GLTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count GLDT records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM GLDT WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "GLDT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Include ARCM in the query\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'ARCM' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nAPTH, APVM\n\nTo include ARCM in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get data from PREH for analysis\n\nDatabase Schema:\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'PREH' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nSLHD, SLIT\n\nTo include PREH in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Include PREH in the query\n\nDatabase Schema:\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'PREH' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nSLHD, SLIT\n\nTo include PREH in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find jobs over budget with remaining cost projection\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Find jobs over budget:\n1. Aggregate JCCP by job from JCJM\n2. Compare total ActualCost to CurrEstCost\n3. Use HAVING to filter only over-budget jobs\n4. Sort by amount over budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description,\n  SUM(JCCP.CurrEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.CurrEstCost) - SUM(JCCP.ActualCost) AS RemainingBudget,\n  CASE WHEN SUM(JCCP.CurrEstCost) < SUM(JCCP.ActualCost) \n       THEN 'OVER BUDGET' ELSE 'OK' END AS Status\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\nGROUP BY JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.CurrEstCost)\nORDER BY (SUM(JCCP.ActualCost) - SUM(JCCP.CurrEstCost)) DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCJM",
        "JCCD",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query to count records in slwi by company\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count SLWI records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM SLWI WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "SLWI"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from GLJR\n\nDatabase Schema:\nCREATE TABLE GLJR (\n  GLCo bcompany NOT NULL,\n  Jrnl bjrnl NOT NULL,\n  Description btransdesc,\n  Rev byn NOT NULL,\n  RevJrnl bjrnl,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from GLJR ().\n\n```sql\nSELECT *\nFROM GLJR WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "GLJR"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need to count records in preh by company\n\nDatabase Schema:\nCREATE TABLE PREH (\n  PRCo bcompany NOT NULL,\n  Employee bemployee NOT NULL,\n  LastName varchar(30) NOT NULL,\n  FirstName varchar(30),\n  MidName varchar(15),\n  SortName bsortname NOT NULL,\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  Phone bphone,\n  SSN char(11) NOT NULL,\n  Race char(2) NOT NULL,\n  Sex char(1) NOT NULL,\n  BirthDate smalldatetime,\n  HireDate bdate,\n  TermDate bdate,\n  PRGroup bgroup NOT NULL,\n  PRDept bdept NOT NULL,\n  -- ... 121 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count PREH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM PREH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "PREH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find jobs over budget with remaining cost projection\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Find jobs over budget:\n1. Aggregate JCCP by job from JCJM\n2. Compare total ActualCost to CurrEstCost\n3. Use HAVING to filter only over-budget jobs\n4. Sort by amount over budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description,\n  SUM(JCCP.CurrEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.CurrEstCost) - SUM(JCCP.ActualCost) AS RemainingBudget,\n  CASE WHEN SUM(JCCP.CurrEstCost) < SUM(JCCP.ActualCost) \n       THEN 'OVER BUDGET' ELSE 'OK' END AS Status\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\nGROUP BY JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.CurrEstCost)\nORDER BY (SUM(JCCP.ActualCost) - SUM(JCCP.CurrEstCost)) DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM",
        "JCCD",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: List all fields in Companies\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'Companies' does not exist in Viewpoint Vista.\n\nUse HQCO (HQ Company) for company information.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM HQCO WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate stored materials (Purchased - Installed) for SL billing\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Stored materials for SL billing:\n1. SLWI contains work item/billing details\n2. StoredMatls = Purchased - Installed (materials on-site but not yet used)\n3. WCCost = Work Completed Cost\n4. WCRetAmt and SMRetAmt = separate retainage for work vs materials\n5. Total billable = WCCost + StoredMatls\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description AS ItemDescription,\n  SLWI.StoredMatls,\n  SLWI.WCCost AS WorkCompletedCost,\n  SLWI.StoredMatls + SLWI.WCCost AS TotalBillable,\n  SLWI.WCRetAmt AS WorkRetainage,\n  SLWI.SMRetAmt AS MaterialsRetainage,\n  SLWI.WCRetAmt + SLWI.SMRetAmt AS TotalRetainage\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\n  AND SLWI.StoredMatls <> 0\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "basic",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Include GLDT in the query\n\nDatabase Schema:\nCREATE TABLE PREH (\n  PRCo bcompany NOT NULL,\n  Employee bemployee NOT NULL,\n  LastName varchar(30) NOT NULL,\n  FirstName varchar(30),\n  MidName varchar(15),\n  SortName bsortname NOT NULL,\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  Phone bphone,\n  SSN char(11) NOT NULL,\n  Race char(2) NOT NULL,\n  Sex char(1) NOT NULL,\n  BirthDate smalldatetime,\n  HireDate bdate,\n  TermDate bdate,\n  PRGroup bgroup NOT NULL,\n  PRDept bdept NOT NULL,\n  -- ... 121 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nCREATE TABLE PRTH (\n  PRCo bcompany NOT NULL,\n  PRGroup bgroup NOT NULL,\n  PREndDate bdate NOT NULL,\n  Employee bemployee NOT NULL,\n  PaySeq tinyint NOT NULL,\n  PostSeq smallint NOT NULL,\n  Type char(1) NOT NULL,\n  PostDate bdate NOT NULL,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCDept bdept,\n  GLCo bcompany NOT NULL,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equipment bequip,\n  EMGroup tinyint,\n  CostCode bcostcode,\n  -- ... 41 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'GLDT' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nPREH, PRTH\n\nTo include GLDT in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: SELECT * FROM ChartOfAccounts\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'ChartOfAccounts' does not exist in Viewpoint Vista.\n\nUse GLAC (GL Account) for chart of accounts.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM GLAC WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get job cost variance by phase comparing budget to actual\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Job cost variance by phase:\n1. Join JCJM (Job Master) to JCCP (Cost Phase)\n2. Calculate variance as CurrEstCost - ActualCost\n3. Calculate percent complete from actuals vs budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  JCCP.Phase,\n  JCCP.CostType,\n  JCCP.OrigEstCost AS OriginalBudget,\n  JCCP.CurrEstCost AS CurrentBudget,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS Variance,\n  CASE WHEN JCCP.CurrEstCost <> 0 \n       THEN (JCCP.ActualCost / JCCP.CurrEstCost) * 100 \n       ELSE 0 END AS PercentComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.Job = @Job\nORDER BY JCCP.Phase, JCCP.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get subcontractor costs with original, change orders, invoiced, paid, and retainage by vendor\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Subcontractor cost breakdown by vendor:\n1. Join SLHD (Header) to SLIT (Items) for subcontract details\n2. Join APVM for vendor names\n3. OrigCost = original contract amount\n4. CurCost - OrigCost = change order amounts\n5. InvCost = amounts invoiced\n6. Retainage = amounts held back\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  SLHD.SL AS SubcontractNum,\n  SLHD.Description AS SubcontractDesc,\n  SUM(SLIT.OrigCost) AS OriginalCost,\n  SUM(SLIT.CurCost - SLIT.OrigCost) AS ChangeOrderCost,\n  SUM(SLIT.CurCost) AS CurrentCost,\n  SUM(SLIT.InvCost) AS InvoicedCost,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost - SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nINNER JOIN APVM WITH (NOLOCK) ON SLHD.VendorGroup = APVM.VendorGroup AND SLHD.Vendor = APVM.Vendor\nWHERE SLHD.SLCo = @SLCo\nGROUP BY APVM.Vendor, APVM.Name, SLHD.SL, SLHD.Description\nORDER BY APVM.Name, SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLHD",
        "SLIT",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from PRTH\n\nDatabase Schema:\nCREATE TABLE PRTH (\n  PRCo bcompany NOT NULL,\n  PRGroup bgroup NOT NULL,\n  PREndDate bdate NOT NULL,\n  Employee bemployee NOT NULL,\n  PaySeq tinyint NOT NULL,\n  PostSeq smallint NOT NULL,\n  Type char(1) NOT NULL,\n  PostDate bdate NOT NULL,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCDept bdept,\n  GLCo bcompany NOT NULL,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equipment bequip,\n  EMGroup tinyint,\n  CostCode bcostcode,\n  -- ... 41 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from PRTH ().\n\n```sql\nSELECT *\nFROM PRTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "PRTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from APTD\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from APTD ().\n\n```sql\nSELECT *\nFROM APTD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How do I count records in prtd by company\n\nDatabase Schema:\nCREATE TABLE PRTD (\n  PRCo bcompany NOT NULL,\n  Craft bcraft NOT NULL,\n  Class bclass NOT NULL,\n  Template smallint NOT NULL,\n  DLCode bedlcode NOT NULL,\n  Factor brate NOT NULL,\n  OldRate bunitcost NOT NULL,\n  NewRate bunitcost NOT NULL,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count PRTD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM PRTD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "PRTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from GLAC\n\nDatabase Schema:\nCREATE TABLE GLAC (\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  Description bdesc,\n  AcctType char(1) NOT NULL,\n  SubType char(1),\n  NormBal char(1),\n  InterfaceDetail byn NOT NULL,\n  Active byn NOT NULL,\n  SummaryAcct bglacct NOT NULL,\n  CashAccrual char(1) NOT NULL,\n  CashOffAcct bglacct,\n  Notes varchar,\n  Part1 varchar(20),\n  Part2 varchar(20),\n  Part3 varchar(20),\n  Part4 varchar(20),\n  Part5 varchar(20),\n  Part6 varchar(20),\n  AllParts varchar(20),\n  CrossRefMemAcct bglacct,\n  -- ... 3 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from GLAC ().\n\n```sql\nSELECT *\nFROM GLAC WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "GLAC"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from GLDT\n\nDatabase Schema:\nCREATE TABLE GLDT (\n  GLCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  GLTrans btrans NOT NULL,\n  GLAcct bglacct NOT NULL,\n  Jrnl bjrnl NOT NULL,\n  GLRef bglref NOT NULL,\n  SourceCo bcompany NOT NULL,\n  Source bsource NOT NULL,\n  ActDate bdate NOT NULL,\n  DatePosted bdate NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid NOT NULL,\n  Amount bdollar NOT NULL,\n  RevStatus tinyint NOT NULL,\n  Adjust char(1) NOT NULL,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  UniqueAttchID uniqueidentifier,\n  SrcTable varchar(128),\n  SrcKeyID bigint,\n  PRIMARY KEY (GLCo, Mth, GLTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from GLDT ().\n\n```sql\nSELECT *\nFROM GLDT WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "GLDT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from GLDT\n\nDatabase Schema:\nCREATE TABLE GLDT (\n  GLCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  GLTrans btrans NOT NULL,\n  GLAcct bglacct NOT NULL,\n  Jrnl bjrnl NOT NULL,\n  GLRef bglref NOT NULL,\n  SourceCo bcompany NOT NULL,\n  Source bsource NOT NULL,\n  ActDate bdate NOT NULL,\n  DatePosted bdate NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid NOT NULL,\n  Amount bdollar NOT NULL,\n  RevStatus tinyint NOT NULL,\n  Adjust char(1) NOT NULL,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  UniqueAttchID uniqueidentifier,\n  SrcTable varchar(128),\n  SrcKeyID bigint,\n  PRIMARY KEY (GLCo, Mth, GLTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from GLDT ().\n\n```sql\nSELECT *\nFROM GLDT WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "GLDT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query to count records in arth by company\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count ARTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM ARTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging buckets (30/60/90+ days) for unpaid invoices by customer\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Use ARTH for transaction data and ARCM for customer names\n2. Filter PayFullDate IS NULL to get only unpaid invoices\n3. Use DATEDIFF and CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Include SLHD in the query\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'SLHD' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nJCJM, JCCD\n\nTo include SLHD in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from ARTH\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from ARTH ().\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need to count records in prth by company\n\nDatabase Schema:\nCREATE TABLE PRTH (\n  PRCo bcompany NOT NULL,\n  PRGroup bgroup NOT NULL,\n  PREndDate bdate NOT NULL,\n  Employee bemployee NOT NULL,\n  PaySeq tinyint NOT NULL,\n  PostSeq smallint NOT NULL,\n  Type char(1) NOT NULL,\n  PostDate bdate NOT NULL,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCDept bdept,\n  GLCo bcompany NOT NULL,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equipment bequip,\n  EMGroup tinyint,\n  CostCode bcostcode,\n  -- ... 41 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count PRTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM PRTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "PRTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find all unpaid AR invoices older than 60 days\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find unpaid invoices over 60 days:\n1. Join ARTH to ARCM for customer information\n2. Filter PayFullDate IS NULL (unpaid)\n3. Use DATEDIFF to calculate age and filter > 60 days\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Mth,\n  ARTH.ARTrans,\n  ARCM.Name AS CustomerName,\n  ARTH.TransDate,\n  ARTH.Amount,\n  DATEDIFF(day, ARTH.TransDate, GETDATE()) AS DaysOutstanding\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\n  AND DATEDIFF(day, ARTH.TransDate, GETDATE()) > 60\nORDER BY ARTH.TransDate\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from PRTH\n\nDatabase Schema:\nCREATE TABLE PRTH (\n  PRCo bcompany NOT NULL,\n  PRGroup bgroup NOT NULL,\n  PREndDate bdate NOT NULL,\n  Employee bemployee NOT NULL,\n  PaySeq tinyint NOT NULL,\n  PostSeq smallint NOT NULL,\n  Type char(1) NOT NULL,\n  PostDate bdate NOT NULL,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCDept bdept,\n  GLCo bcompany NOT NULL,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equipment bequip,\n  EMGroup tinyint,\n  CostCode bcostcode,\n  -- ... 41 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from PRTH ().\n\n```sql\nSELECT *\nFROM PRTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "PRTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find jobs over budget with remaining cost projection\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Find jobs over budget:\n1. Aggregate JCCP by job from JCJM\n2. Compare total ActualCost to CurrEstCost\n3. Use HAVING to filter only over-budget jobs\n4. Sort by amount over budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description,\n  SUM(JCCP.CurrEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.CurrEstCost) - SUM(JCCP.ActualCost) AS RemainingBudget,\n  CASE WHEN SUM(JCCP.CurrEstCost) < SUM(JCCP.ActualCost) \n       THEN 'OVER BUDGET' ELSE 'OK' END AS Status\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\nGROUP BY JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.CurrEstCost)\nORDER BY (SUM(JCCP.ActualCost) - SUM(JCCP.CurrEstCost)) DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCJM",
        "JCCD",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate stored materials (Purchased - Installed) for SL billing\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Stored materials for SL billing:\n1. SLWI contains work item/billing details\n2. StoredMatls = Purchased - Installed (materials on-site but not yet used)\n3. WCCost = Work Completed Cost\n4. WCRetAmt and SMRetAmt = separate retainage for work vs materials\n5. Total billable = WCCost + StoredMatls\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description AS ItemDescription,\n  SLWI.StoredMatls,\n  SLWI.WCCost AS WorkCompletedCost,\n  SLWI.StoredMatls + SLWI.WCCost AS TotalBillable,\n  SLWI.WCRetAmt AS WorkRetainage,\n  SLWI.SMRetAmt AS MaterialsRetainage,\n  SLWI.WCRetAmt + SLWI.SMRetAmt AS TotalRetainage\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\n  AND SLWI.StoredMatls <> 0\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging buckets (30/60/90+ days) for unpaid invoices by customer\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Use ARTH for transaction data and ARCM for customer names\n2. Filter PayFullDate IS NULL to get only unpaid invoices\n3. Use DATEDIFF and CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find all unpaid AR invoices older than 60 days\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find unpaid invoices over 60 days:\n1. Join ARTH to ARCM for customer information\n2. Filter PayFullDate IS NULL (unpaid)\n3. Use DATEDIFF to calculate age and filter > 60 days\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Mth,\n  ARTH.ARTrans,\n  ARCM.Name AS CustomerName,\n  ARTH.TransDate,\n  ARTH.Amount,\n  DATEDIFF(day, ARTH.TransDate, GETDATE()) AS DaysOutstanding\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\n  AND DATEDIFF(day, ARTH.TransDate, GETDATE()) > 60\nORDER BY ARTH.TransDate\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show job costs with GL account descriptions\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I can partially answer this query, but the schema is incomplete.\n\nThe query requires GLAC for GL account descriptions, which is not in the provided schema.\n\nHere's what I can provide with the available schema:\n\n```sql\nSELECT *\nFROM JCCD WITH (NOLOCK)\nWHERE Co = @Co\n-- Note: Additional joins for GLAC would be needed for complete results\n```\n\nTo get the complete data you requested, please provide the DDL for GLAC.",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from ARTH\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from ARTH ().\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoice totals with discounts and retainage\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Vendor invoice summary with discounts and retainage:\n1. Join APTH to APVM for vendor details\n2. Aggregate by vendor\n3. Include GrossAmt, DiscOffer, Retainage, and Balance\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(APTH.APTrans) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS GrossAmount,\n  SUM(APTH.DiscOffer) AS DiscountsOffered,\n  SUM(APTH.Retainage) AS RetainageHeld,\n  SUM(APTH.Balance) AS OpenBalance\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need to aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from GLDT\n\nDatabase Schema:\nCREATE TABLE GLDT (\n  GLCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  GLTrans btrans NOT NULL,\n  GLAcct bglacct NOT NULL,\n  Jrnl bjrnl NOT NULL,\n  GLRef bglref NOT NULL,\n  SourceCo bcompany NOT NULL,\n  Source bsource NOT NULL,\n  ActDate bdate NOT NULL,\n  DatePosted bdate NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid NOT NULL,\n  Amount bdollar NOT NULL,\n  RevStatus tinyint NOT NULL,\n  Adjust char(1) NOT NULL,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  UniqueAttchID uniqueidentifier,\n  SrcTable varchar(128),\n  SrcKeyID bigint,\n  PRIMARY KEY (GLCo, Mth, GLTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from GLDT ().\n\n```sql\nSELECT *\nFROM GLDT WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "GLDT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from ARTH\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from ARTH ().\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need to aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Query ARCM along with the schema tables\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'ARCM' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nAPTH, APVM\n\nTo include ARCM in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Join Departments with other tables\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'Departments' does not exist in Viewpoint Vista.\n\nUse JCDP (JC Department) for department information.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM JCDP WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get customer balance summary by customer group\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Customer balance summary by group:\n1. Join ARTH to ARCM for customer details\n2. Use conditional SUM for open vs total balances\n3. Group by CustGroup for summary\n\n```sql\nSELECT \n  ARTH.CustGroup,\n  COUNT(DISTINCT ARTH.Customer) AS CustomerCount,\n  SUM(CASE WHEN ARTH.PayFullDate IS NULL THEN ARTH.Amount ELSE 0 END) AS OpenBalance,\n  SUM(ARTH.Amount) AS TotalBilled\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\nGROUP BY ARTH.CustGroup\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get customer balance summary by customer group\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Customer balance summary by group:\n1. Join ARTH to ARCM for customer details\n2. Use conditional SUM for open vs total balances\n3. Group by CustGroup for summary\n\n```sql\nSELECT \n  ARTH.CustGroup,\n  COUNT(DISTINCT ARTH.Customer) AS CustomerCount,\n  SUM(CASE WHEN ARTH.PayFullDate IS NULL THEN ARTH.Amount ELSE 0 END) AS OpenBalance,\n  SUM(ARTH.Amount) AS TotalBilled\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\nGROUP BY ARTH.CustGroup\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoice totals with discounts and retainage\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Vendor invoice summary with discounts and retainage:\n1. Join APTH to APVM for vendor details\n2. Aggregate by vendor\n3. Include GrossAmt, DiscOffer, Retainage, and Balance\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(APTH.APTrans) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS GrossAmount,\n  SUM(APTH.DiscOffer) AS DiscountsOffered,\n  SUM(APTH.Retainage) AS RetainageHeld,\n  SUM(APTH.Balance) AS OpenBalance\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to count records in jccd by company\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count JCCD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM JCCD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to count records in arth by company\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count ARTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM ARTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from SLWI\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from SLWI ().\n\n```sql\nSELECT *\nFROM SLWI WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "SLWI"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find jobs over budget with remaining cost projection\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Find jobs over budget:\n1. Aggregate JCCP by job from JCJM\n2. Compare total ActualCost to CurrEstCost\n3. Use HAVING to filter only over-budget jobs\n4. Sort by amount over budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description,\n  SUM(JCCP.CurrEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.CurrEstCost) - SUM(JCCP.ActualCost) AS RemainingBudget,\n  CASE WHEN SUM(JCCP.CurrEstCost) < SUM(JCCP.ActualCost) \n       THEN 'OVER BUDGET' ELSE 'OK' END AS Status\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\nGROUP BY JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.CurrEstCost)\nORDER BY (SUM(JCCP.ActualCost) - SUM(JCCP.CurrEstCost)) DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCJM",
        "JCCD",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: count records in aptd by company\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count APTD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM APTD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to count records in gljr by company\n\nDatabase Schema:\nCREATE TABLE GLJR (\n  GLCo bcompany NOT NULL,\n  Jrnl bjrnl NOT NULL,\n  Description btransdesc,\n  Rev byn NOT NULL,\n  RevJrnl bjrnl,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count GLJR records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM GLJR WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "GLJR"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get customer balance summary by customer group\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Customer balance summary by group:\n1. Join ARTH to ARCM for customer details\n2. Use conditional SUM for open vs total balances\n3. Group by CustGroup for summary\n\n```sql\nSELECT \n  ARTH.CustGroup,\n  COUNT(DISTINCT ARTH.Customer) AS CustomerCount,\n  SUM(CASE WHEN ARTH.PayFullDate IS NULL THEN ARTH.Amount ELSE 0 END) AS OpenBalance,\n  SUM(ARTH.Amount) AS TotalBilled\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\nGROUP BY ARTH.CustGroup\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from GLCO\n\nDatabase Schema:\nCREATE TABLE GLCO (\n  GLCo bcompany NOT NULL,\n  Consolid byn NOT NULL,\n  LastMthSubClsd bmonth NOT NULL,\n  LastMthGLClsd bmonth NOT NULL,\n  MaxOpen tinyint NOT NULL,\n  CashAccrual char(1) NOT NULL,\n  Unbal byn NOT NULL,\n  AuditCoParams byn NOT NULL,\n  AuditAccts byn NOT NULL,\n  AuditAutoJrnl byn NOT NULL,\n  AuditBals byn NOT NULL,\n  AuditBudgets byn NOT NULL,\n  AuditDetail byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  XCompJrnlEntryYN byn NOT NULL,\n  KeyID bigint NOT NULL,\n  LastMthAPClsd bmonth NOT NULL,\n  LastMthARClsd bmonth NOT NULL,\n  AttachBatchReportsYN byn NOT NULL,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from GLCO ().\n\n```sql\nSELECT *\nFROM GLCO WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "GLCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from SLWI\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from SLWI ().\n\n```sql\nSELECT *\nFROM SLWI WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "SLWI"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to count records in apth by company\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count APTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM APTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "APTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get job cost variance by phase comparing budget to actual\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Job cost variance by phase:\n1. Join JCJM (Job Master) to JCCP (Cost Phase)\n2. Calculate variance as CurrEstCost - ActualCost\n3. Calculate percent complete from actuals vs budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  JCCP.Phase,\n  JCCP.CostType,\n  JCCP.OrigEstCost AS OriginalBudget,\n  JCCP.CurrEstCost AS CurrentBudget,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS Variance,\n  CASE WHEN JCCP.CurrEstCost <> 0 \n       THEN (JCCP.ActualCost / JCCP.CurrEstCost) * 100 \n       ELSE 0 END AS PercentComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.Job = @Job\nORDER BY JCCP.Phase, JCCP.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from APTH\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from APTH ().\n\n```sql\nSELECT *\nFROM APTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "APTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from GLJR\n\nDatabase Schema:\nCREATE TABLE GLJR (\n  GLCo bcompany NOT NULL,\n  Jrnl bjrnl NOT NULL,\n  Description btransdesc,\n  Rev byn NOT NULL,\n  RevJrnl bjrnl,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from GLJR ().\n\n```sql\nSELECT *\nFROM GLJR WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "GLJR"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from ARTH\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from ARTH ().\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: count records in jccd by company\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count JCCD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM JCCD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to count records in aptd by company\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count APTD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM APTD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need to count records in slwi by company\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count SLWI records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM SLWI WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "SLWI"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from ARTH\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from ARTH ().\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get customer balance summary by customer group\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Customer balance summary by group:\n1. Join ARTH to ARCM for customer details\n2. Use conditional SUM for open vs total balances\n3. Group by CustGroup for summary\n\n```sql\nSELECT \n  ARTH.CustGroup,\n  COUNT(DISTINCT ARTH.Customer) AS CustomerCount,\n  SUM(CASE WHEN ARTH.PayFullDate IS NULL THEN ARTH.Amount ELSE 0 END) AS OpenBalance,\n  SUM(ARTH.Amount) AS TotalBilled\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\nGROUP BY ARTH.CustGroup\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Query GLDT along with the schema tables\n\nDatabase Schema:\nCREATE TABLE PREH (\n  PRCo bcompany NOT NULL,\n  Employee bemployee NOT NULL,\n  LastName varchar(30) NOT NULL,\n  FirstName varchar(30),\n  MidName varchar(15),\n  SortName bsortname NOT NULL,\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  Phone bphone,\n  SSN char(11) NOT NULL,\n  Race char(2) NOT NULL,\n  Sex char(1) NOT NULL,\n  BirthDate smalldatetime,\n  HireDate bdate,\n  TermDate bdate,\n  PRGroup bgroup NOT NULL,\n  PRDept bdept NOT NULL,\n  -- ... 121 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nCREATE TABLE PRTH (\n  PRCo bcompany NOT NULL,\n  PRGroup bgroup NOT NULL,\n  PREndDate bdate NOT NULL,\n  Employee bemployee NOT NULL,\n  PaySeq tinyint NOT NULL,\n  PostSeq smallint NOT NULL,\n  Type char(1) NOT NULL,\n  PostDate bdate NOT NULL,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCDept bdept,\n  GLCo bcompany NOT NULL,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equipment bequip,\n  EMGroup tinyint,\n  CostCode bcostcode,\n  -- ... 41 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'GLDT' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nPREH, PRTH\n\nTo include GLDT in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from GLCO\n\nDatabase Schema:\nCREATE TABLE GLCO (\n  GLCo bcompany NOT NULL,\n  Consolid byn NOT NULL,\n  LastMthSubClsd bmonth NOT NULL,\n  LastMthGLClsd bmonth NOT NULL,\n  MaxOpen tinyint NOT NULL,\n  CashAccrual char(1) NOT NULL,\n  Unbal byn NOT NULL,\n  AuditCoParams byn NOT NULL,\n  AuditAccts byn NOT NULL,\n  AuditAutoJrnl byn NOT NULL,\n  AuditBals byn NOT NULL,\n  AuditBudgets byn NOT NULL,\n  AuditDetail byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  XCompJrnlEntryYN byn NOT NULL,\n  KeyID bigint NOT NULL,\n  LastMthAPClsd bmonth NOT NULL,\n  LastMthARClsd bmonth NOT NULL,\n  AttachBatchReportsYN byn NOT NULL,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from GLCO ().\n\n```sql\nSELECT *\nFROM GLCO WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "GLCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query to count records in arth by company\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count ARTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM ARTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How is Transactions structured?\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'Transactions' does not exist in Viewpoint Vista.\n\nUse GLDT (GL Detail) for GL transactions, or module-specific tables like APTH, ARTH, JCCD.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM GLDT WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: SELECT * FROM CostCodes\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'CostCodes' does not exist in Viewpoint Vista.\n\nUse JCCP (JC Cost Phase) for cost code/phase information with cost details.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM JCCP WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need to count records in arth by company\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count ARTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM ARTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from SLHD\n\nDatabase Schema:\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from SLHD ().\n\n```sql\nSELECT *\nFROM SLHD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLHD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get job cost variance by phase comparing budget to actual\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Job cost variance by phase:\n1. Join JCJM (Job Master) to JCCP (Cost Phase)\n2. Calculate variance as CurrEstCost - ActualCost\n3. Calculate percent complete from actuals vs budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  JCCP.Phase,\n  JCCP.CostType,\n  JCCP.OrigEstCost AS OriginalBudget,\n  JCCP.CurrEstCost AS CurrentBudget,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS Variance,\n  CASE WHEN JCCP.CurrEstCost <> 0 \n       THEN (JCCP.ActualCost / JCCP.CurrEstCost) * 100 \n       ELSE 0 END AS PercentComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.Job = @Job\nORDER BY JCCP.Phase, JCCP.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoice totals with discounts and retainage\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Vendor invoice summary with discounts and retainage:\n1. Join APTH to APVM for vendor details\n2. Aggregate by vendor\n3. Include GrossAmt, DiscOffer, Retainage, and Balance\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(APTH.APTrans) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS GrossAmount,\n  SUM(APTH.DiscOffer) AS DiscountsOffered,\n  SUM(APTH.Retainage) AS RetainageHeld,\n  SUM(APTH.Balance) AS OpenBalance\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get job cost variance by phase comparing budget to actual\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Job cost variance by phase:\n1. Join JCJM (Job Master) to JCCP (Cost Phase)\n2. Calculate variance as CurrEstCost - ActualCost\n3. Calculate percent complete from actuals vs budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  JCCP.Phase,\n  JCCP.CostType,\n  JCCP.OrigEstCost AS OriginalBudget,\n  JCCP.CurrEstCost AS CurrentBudget,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS Variance,\n  CASE WHEN JCCP.CurrEstCost <> 0 \n       THEN (JCCP.ActualCost / JCCP.CurrEstCost) * 100 \n       ELSE 0 END AS PercentComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.Job = @Job\nORDER BY JCCP.Phase, JCCP.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get job cost variance by phase comparing budget to actual\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Job cost variance by phase:\n1. Join JCJM (Job Master) to JCCP (Cost Phase)\n2. Calculate variance as CurrEstCost - ActualCost\n3. Calculate percent complete from actuals vs budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  JCCP.Phase,\n  JCCP.CostType,\n  JCCP.OrigEstCost AS OriginalBudget,\n  JCCP.CurrEstCost AS CurrentBudget,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS Variance,\n  CASE WHEN JCCP.CurrEstCost <> 0 \n       THEN (JCCP.ActualCost / JCCP.CurrEstCost) * 100 \n       ELSE 0 END AS PercentComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.Job = @Job\nORDER BY JCCP.Phase, JCCP.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find jobs over budget with remaining cost projection\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Find jobs over budget:\n1. Aggregate JCCP by job from JCJM\n2. Compare total ActualCost to CurrEstCost\n3. Use HAVING to filter only over-budget jobs\n4. Sort by amount over budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description,\n  SUM(JCCP.CurrEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.CurrEstCost) - SUM(JCCP.ActualCost) AS RemainingBudget,\n  CASE WHEN SUM(JCCP.CurrEstCost) < SUM(JCCP.ActualCost) \n       THEN 'OVER BUDGET' ELSE 'OK' END AS Status\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\nGROUP BY JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.CurrEstCost)\nORDER BY (SUM(JCCP.ActualCost) - SUM(JCCP.CurrEstCost)) DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCJM",
        "JCCD",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get subcontractor costs with original, change orders, invoiced, paid, and retainage by vendor\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Subcontractor cost breakdown by vendor:\n1. Join SLHD (Header) to SLIT (Items) for subcontract details\n2. Join APVM for vendor names\n3. OrigCost = original contract amount\n4. CurCost - OrigCost = change order amounts\n5. InvCost = amounts invoiced\n6. Retainage = amounts held back\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  SLHD.SL AS SubcontractNum,\n  SLHD.Description AS SubcontractDesc,\n  SUM(SLIT.OrigCost) AS OriginalCost,\n  SUM(SLIT.CurCost - SLIT.OrigCost) AS ChangeOrderCost,\n  SUM(SLIT.CurCost) AS CurrentCost,\n  SUM(SLIT.InvCost) AS InvoicedCost,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost - SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nINNER JOIN APVM WITH (NOLOCK) ON SLHD.VendorGroup = APVM.VendorGroup AND SLHD.Vendor = APVM.Vendor\nWHERE SLHD.SLCo = @SLCo\nGROUP BY APVM.Vendor, APVM.Name, SLHD.SL, SLHD.Description\nORDER BY APVM.Name, SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "intermediate",
      "tables_used": [
        "SLHD",
        "SLIT",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to count records in aptd by company\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count APTD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM APTD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get customer balance summary by customer group\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Customer balance summary by group:\n1. Join ARTH to ARCM for customer details\n2. Use conditional SUM for open vs total balances\n3. Group by CustGroup for summary\n\n```sql\nSELECT \n  ARTH.CustGroup,\n  COUNT(DISTINCT ARTH.Customer) AS CustomerCount,\n  SUM(CASE WHEN ARTH.PayFullDate IS NULL THEN ARTH.Amount ELSE 0 END) AS OpenBalance,\n  SUM(ARTH.Amount) AS TotalBilled\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\nGROUP BY ARTH.CustGroup\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get customer balance summary by customer group\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Customer balance summary by group:\n1. Join ARTH to ARCM for customer details\n2. Use conditional SUM for open vs total balances\n3. Group by CustGroup for summary\n\n```sql\nSELECT \n  ARTH.CustGroup,\n  COUNT(DISTINCT ARTH.Customer) AS CustomerCount,\n  SUM(CASE WHEN ARTH.PayFullDate IS NULL THEN ARTH.Amount ELSE 0 END) AS OpenBalance,\n  SUM(ARTH.Amount) AS TotalBilled\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\nGROUP BY ARTH.CustGroup\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need to reconcile ap oncost batch lines with original transactions\n\nDatabase Schema:\nCREATE TABLE APTL (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equip bequip,\n  EMGroup bgroup,\n  -- ... 56 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans, APLine)\n);\n\nCREATE TABLE APLB (\n  Co bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  BatchId bbatchid NOT NULL,\n  BatchSeq int NOT NULL,\n  APLine smallint NOT NULL,\n  BatchTransType char(1) NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  -- ... 120 more columns,\n  PRIMARY KEY (Co, Mth, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APHB (\n  Co bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  BatchId bbatchid NOT NULL,\n  BatchSeq int NOT NULL,\n  BatchTransType char(1) NOT NULL,\n  APTrans btrans,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  -- ... 88 more columns,\n  PRIMARY KEY (Co, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To reconcile AP oncost batches with original transactions:\n1. Join APLB (batch lines) to APTL (original lines) using ocApplyMth, ocApplyTrans, ocApplyLine\n2. Include APHB for batch header info\n3. Join to APTH and APVM for vendor context\n4. Compare batch vs original amounts\n\n```sql\nSELECT \n  APLB.Co AS BatchCo,\n  APLB.Mth AS BatchMth,\n  APLB.BatchId,\n  APLB.BatchSeq,\n  APLB.ocApplyMth,\n  APLB.ocApplyTrans,\n  APLB.ocApplyLine,\n  APTL.APCo AS OrigCo,\n  APTL.Mth AS OrigMth,\n  APTL.APTrans AS OrigTrans,\n  APTL.APLine AS OrigLine,\n  APTL.GrossAmt AS OrigAmount,\n  APLB.GrossAmt AS BatchAmount,\n  APVM.Name AS VendorName\nFROM APLB WITH (NOLOCK)\nINNER JOIN APHB WITH (NOLOCK) ON APLB.Co = APHB.Co AND APLB.Mth = APHB.Mth AND APLB.BatchId = APHB.BatchId\nINNER JOIN APTL WITH (NOLOCK) ON APLB.ocApplyMth = APTL.Mth \n  AND APLB.ocApplyTrans = APTL.APTrans \n  AND APLB.ocApplyLine = APTL.APLine\n  AND APLB.Co = APTL.APCo\nINNER JOIN APTH WITH (NOLOCK) ON APTL.APCo = APTH.APCo AND APTL.Mth = APTH.Mth AND APTL.APTrans = APTH.APTrans\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APLB.Co = @Co\nORDER BY APLB.BatchId, APLB.BatchSeq\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APLB",
        "APHB",
        "APTL",
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: What is the schema for Companies?\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'Companies' does not exist in Viewpoint Vista.\n\nUse HQCO (HQ Company) for company information.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM HQCO WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from JCCD\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from JCCD ().\n\n```sql\nSELECT *\nFROM JCCD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to join SLHD with the available tables\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'SLHD' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nJCJM, JCCD\n\nTo include SLHD in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to count records in apth by company\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count APTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM APTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "APTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging buckets (30/60/90+ days) for unpaid invoices by customer\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Use ARTH for transaction data and ARCM for customer names\n2. Filter PayFullDate IS NULL to get only unpaid invoices\n3. Use DATEDIFF and CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to count records in arth by company\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count ARTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM ARTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query to count records in slwi by company\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count SLWI records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM SLWI WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "SLWI"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need to count records in arth by company\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count ARTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM ARTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoice totals with discounts and retainage\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Vendor invoice summary with discounts and retainage:\n1. Join APTH to APVM for vendor details\n2. Aggregate by vendor\n3. Include GrossAmt, DiscOffer, Retainage, and Balance\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(APTH.APTrans) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS GrossAmount,\n  SUM(APTH.DiscOffer) AS DiscountsOffered,\n  SUM(APTH.Retainage) AS RetainageHeld,\n  SUM(APTH.Balance) AS OpenBalance\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from JCCD\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from JCCD ().\n\n```sql\nSELECT *\nFROM JCCD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Describe the Accounts table\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'Accounts' does not exist in Viewpoint Vista.\n\nUse GLAC (GL Account) for chart of accounts.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM GLAC WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get job cost variance by phase comparing budget to actual\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Job cost variance by phase:\n1. Join JCJM (Job Master) to JCCP (Cost Phase)\n2. Calculate variance as CurrEstCost - ActualCost\n3. Calculate percent complete from actuals vs budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  JCCP.Phase,\n  JCCP.CostType,\n  JCCP.OrigEstCost AS OriginalBudget,\n  JCCP.CurrEstCost AS CurrentBudget,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS Variance,\n  CASE WHEN JCCP.CurrEstCost <> 0 \n       THEN (JCCP.ActualCost / JCCP.CurrEstCost) * 100 \n       ELSE 0 END AS PercentComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.Job = @Job\nORDER BY JCCP.Phase, JCCP.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Include GLDT in the query\n\nDatabase Schema:\nCREATE TABLE PREH (\n  PRCo bcompany NOT NULL,\n  Employee bemployee NOT NULL,\n  LastName varchar(30) NOT NULL,\n  FirstName varchar(30),\n  MidName varchar(15),\n  SortName bsortname NOT NULL,\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  Phone bphone,\n  SSN char(11) NOT NULL,\n  Race char(2) NOT NULL,\n  Sex char(1) NOT NULL,\n  BirthDate smalldatetime,\n  HireDate bdate,\n  TermDate bdate,\n  PRGroup bgroup NOT NULL,\n  PRDept bdept NOT NULL,\n  -- ... 121 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nCREATE TABLE PRTH (\n  PRCo bcompany NOT NULL,\n  PRGroup bgroup NOT NULL,\n  PREndDate bdate NOT NULL,\n  Employee bemployee NOT NULL,\n  PaySeq tinyint NOT NULL,\n  PostSeq smallint NOT NULL,\n  Type char(1) NOT NULL,\n  PostDate bdate NOT NULL,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCDept bdept,\n  GLCo bcompany NOT NULL,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equipment bequip,\n  EMGroup tinyint,\n  CostCode bcostcode,\n  -- ... 41 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'GLDT' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nPREH, PRTH\n\nTo include GLDT in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from PRCO\n\nDatabase Schema:\nCREATE TABLE PRCO (\n  PRCo bcompany NOT NULL,\n  GLCo bcompany NOT NULL,\n  Jrnl bjrnl,\n  GLInterface byn NOT NULL,\n  CMCo bcompany NOT NULL,\n  APCo bcompany,\n  AutoOT byn NOT NULL,\n  OTEarnCode bedlcode,\n  JCCo bcompany NOT NULL,\n  AllowNoPhase byn NOT NULL,\n  JCInterface byn NOT NULL,\n  InsByPhase byn NOT NULL,\n  JCICraftClass byn NOT NULL,\n  JCICrew byn NOT NULL,\n  JCIEmployee byn NOT NULL,\n  JCIFactor byn NOT NULL,\n  JCIEarnType byn NOT NULL,\n  JCIShift byn NOT NULL,\n  JCIPostingDate byn NOT NULL,\n  JCILiabType byn NOT NULL,\n  -- ... 66 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from PRCO ().\n\n```sql\nSELECT *\nFROM PRCO WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "PRCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need to aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: reconcile ap oncost batch lines with original transactions\n\nDatabase Schema:\nCREATE TABLE APTL (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equip bequip,\n  EMGroup bgroup,\n  -- ... 56 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans, APLine)\n);\n\nCREATE TABLE APLB (\n  Co bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  BatchId bbatchid NOT NULL,\n  BatchSeq int NOT NULL,\n  APLine smallint NOT NULL,\n  BatchTransType char(1) NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  -- ... 120 more columns,\n  PRIMARY KEY (Co, Mth, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APHB (\n  Co bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  BatchId bbatchid NOT NULL,\n  BatchSeq int NOT NULL,\n  BatchTransType char(1) NOT NULL,\n  APTrans btrans,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  -- ... 88 more columns,\n  PRIMARY KEY (Co, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To reconcile AP oncost batches with original transactions:\n1. Join APLB (batch lines) to APTL (original lines) using ocApplyMth, ocApplyTrans, ocApplyLine\n2. Include APHB for batch header info\n3. Join to APTH and APVM for vendor context\n4. Compare batch vs original amounts\n\n```sql\nSELECT \n  APLB.Co AS BatchCo,\n  APLB.Mth AS BatchMth,\n  APLB.BatchId,\n  APLB.BatchSeq,\n  APLB.ocApplyMth,\n  APLB.ocApplyTrans,\n  APLB.ocApplyLine,\n  APTL.APCo AS OrigCo,\n  APTL.Mth AS OrigMth,\n  APTL.APTrans AS OrigTrans,\n  APTL.APLine AS OrigLine,\n  APTL.GrossAmt AS OrigAmount,\n  APLB.GrossAmt AS BatchAmount,\n  APVM.Name AS VendorName\nFROM APLB WITH (NOLOCK)\nINNER JOIN APHB WITH (NOLOCK) ON APLB.Co = APHB.Co AND APLB.Mth = APHB.Mth AND APLB.BatchId = APHB.BatchId\nINNER JOIN APTL WITH (NOLOCK) ON APLB.ocApplyMth = APTL.Mth \n  AND APLB.ocApplyTrans = APTL.APTrans \n  AND APLB.ocApplyLine = APTL.APLine\n  AND APLB.Co = APTL.APCo\nINNER JOIN APTH WITH (NOLOCK) ON APTL.APCo = APTH.APCo AND APTL.Mth = APTH.Mth AND APTL.APTrans = APTH.APTrans\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APLB.Co = @Co\nORDER BY APLB.BatchId, APLB.BatchSeq\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APLB",
        "APHB",
        "APTL",
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from PRCO\n\nDatabase Schema:\nCREATE TABLE PRCO (\n  PRCo bcompany NOT NULL,\n  GLCo bcompany NOT NULL,\n  Jrnl bjrnl,\n  GLInterface byn NOT NULL,\n  CMCo bcompany NOT NULL,\n  APCo bcompany,\n  AutoOT byn NOT NULL,\n  OTEarnCode bedlcode,\n  JCCo bcompany NOT NULL,\n  AllowNoPhase byn NOT NULL,\n  JCInterface byn NOT NULL,\n  InsByPhase byn NOT NULL,\n  JCICraftClass byn NOT NULL,\n  JCICrew byn NOT NULL,\n  JCIEmployee byn NOT NULL,\n  JCIFactor byn NOT NULL,\n  JCIEarnType byn NOT NULL,\n  JCIShift byn NOT NULL,\n  JCIPostingDate byn NOT NULL,\n  JCILiabType byn NOT NULL,\n  -- ... 66 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from PRCO ().\n\n```sql\nSELECT *\nFROM PRCO WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "PRCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get subcontractor costs with original, change orders, invoiced, paid, and retainage by vendor\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Subcontractor cost breakdown by vendor:\n1. Join SLHD (Header) to SLIT (Items) for subcontract details\n2. Join APVM for vendor names\n3. OrigCost = original contract amount\n4. CurCost - OrigCost = change order amounts\n5. InvCost = amounts invoiced\n6. Retainage = amounts held back\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  SLHD.SL AS SubcontractNum,\n  SLHD.Description AS SubcontractDesc,\n  SUM(SLIT.OrigCost) AS OriginalCost,\n  SUM(SLIT.CurCost - SLIT.OrigCost) AS ChangeOrderCost,\n  SUM(SLIT.CurCost) AS CurrentCost,\n  SUM(SLIT.InvCost) AS InvoicedCost,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost - SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nINNER JOIN APVM WITH (NOLOCK) ON SLHD.VendorGroup = APVM.VendorGroup AND SLHD.Vendor = APVM.Vendor\nWHERE SLHD.SLCo = @SLCo\nGROUP BY APVM.Vendor, APVM.Name, SLHD.SL, SLHD.Description\nORDER BY APVM.Name, SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "basic",
      "tables_used": [
        "SLHD",
        "SLIT",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate stored materials (Purchased - Installed) for SL billing\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Stored materials for SL billing:\n1. SLWI contains work item/billing details\n2. StoredMatls = Purchased - Installed (materials on-site but not yet used)\n3. WCCost = Work Completed Cost\n4. WCRetAmt and SMRetAmt = separate retainage for work vs materials\n5. Total billable = WCCost + StoredMatls\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description AS ItemDescription,\n  SLWI.StoredMatls,\n  SLWI.WCCost AS WorkCompletedCost,\n  SLWI.StoredMatls + SLWI.WCCost AS TotalBillable,\n  SLWI.WCRetAmt AS WorkRetainage,\n  SLWI.SMRetAmt AS MaterialsRetainage,\n  SLWI.WCRetAmt + SLWI.SMRetAmt AS TotalRetainage\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\n  AND SLWI.StoredMatls <> 0\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "basic",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoice totals with discounts and retainage\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Vendor invoice summary with discounts and retainage:\n1. Join APTH to APVM for vendor details\n2. Aggregate by vendor\n3. Include GrossAmt, DiscOffer, Retainage, and Balance\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(APTH.APTrans) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS GrossAmount,\n  SUM(APTH.DiscOffer) AS DiscountsOffered,\n  SUM(APTH.Retainage) AS RetainageHeld,\n  SUM(APTH.Balance) AS OpenBalance\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from PREH\n\nDatabase Schema:\nCREATE TABLE PREH (\n  PRCo bcompany NOT NULL,\n  Employee bemployee NOT NULL,\n  LastName varchar(30) NOT NULL,\n  FirstName varchar(30),\n  MidName varchar(15),\n  SortName bsortname NOT NULL,\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  Phone bphone,\n  SSN char(11) NOT NULL,\n  Race char(2) NOT NULL,\n  Sex char(1) NOT NULL,\n  BirthDate smalldatetime,\n  HireDate bdate,\n  TermDate bdate,\n  PRGroup bgroup NOT NULL,\n  PRDept bdept NOT NULL,\n  -- ... 121 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from PREH ().\n\n```sql\nSELECT *\nFROM PREH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "PREH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get customer balance summary by customer group\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Customer balance summary by group:\n1. Join ARTH to ARCM for customer details\n2. Use conditional SUM for open vs total balances\n3. Group by CustGroup for summary\n\n```sql\nSELECT \n  ARTH.CustGroup,\n  COUNT(DISTINCT ARTH.Customer) AS CustomerCount,\n  SUM(CASE WHEN ARTH.PayFullDate IS NULL THEN ARTH.Amount ELSE 0 END) AS OpenBalance,\n  SUM(ARTH.Amount) AS TotalBilled\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\nGROUP BY ARTH.CustGroup\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query to count records in slhd by company\n\nDatabase Schema:\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count SLHD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM SLHD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "SLHD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to count records in arth by company\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count ARTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM ARTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get subcontractor costs with original, change orders, invoiced, paid, and retainage by vendor\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Subcontractor cost breakdown by vendor:\n1. Join SLHD (Header) to SLIT (Items) for subcontract details\n2. Join APVM for vendor names\n3. OrigCost = original contract amount\n4. CurCost - OrigCost = change order amounts\n5. InvCost = amounts invoiced\n6. Retainage = amounts held back\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  SLHD.SL AS SubcontractNum,\n  SLHD.Description AS SubcontractDesc,\n  SUM(SLIT.OrigCost) AS OriginalCost,\n  SUM(SLIT.CurCost - SLIT.OrigCost) AS ChangeOrderCost,\n  SUM(SLIT.CurCost) AS CurrentCost,\n  SUM(SLIT.InvCost) AS InvoicedCost,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost - SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nINNER JOIN APVM WITH (NOLOCK) ON SLHD.VendorGroup = APVM.VendorGroup AND SLHD.Vendor = APVM.Vendor\nWHERE SLHD.SLCo = @SLCo\nGROUP BY APVM.Vendor, APVM.Name, SLHD.SL, SLHD.Description\nORDER BY APVM.Name, SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "intermediate",
      "tables_used": [
        "SLHD",
        "SLIT",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get customer balance summary by customer group\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Customer balance summary by group:\n1. Join ARTH to ARCM for customer details\n2. Use conditional SUM for open vs total balances\n3. Group by CustGroup for summary\n\n```sql\nSELECT \n  ARTH.CustGroup,\n  COUNT(DISTINCT ARTH.Customer) AS CustomerCount,\n  SUM(CASE WHEN ARTH.PayFullDate IS NULL THEN ARTH.Amount ELSE 0 END) AS OpenBalance,\n  SUM(ARTH.Amount) AS TotalBilled\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\nGROUP BY ARTH.CustGroup\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: count records in jccd by company\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count JCCD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM JCCD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query to count records in arth by company\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count ARTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM ARTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: track ap hold status distinguishing retainage vs non-retainage holds\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APCO (\n  APCo bcompany NOT NULL,\n  GLCo bcompany NOT NULL,\n  ExpJrnl bjrnl,\n  GLExpInterfaceLvl tinyint NOT NULL,\n  GLExpSummaryDesc varchar(60),\n  GLExpTransDesc varchar(60),\n  GLJobDetailDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLEquipDetailDesc varchar(60),\n  GLExpDetailDesc varchar(60),\n  PayJrnl bjrnl,\n  GLPayInterfaceLvl tinyint NOT NULL,\n  GLPayDetailDesc varchar(60),\n  GLPaySummaryDesc varchar(60),\n  DiscOffGLAcct bglacct,\n  DiscTakenGLAcct bglacct,\n  ExpPayType tinyint,\n  JobPayType tinyint,\n  SubPayType tinyint,\n  RetPayType tinyint,\n  -- ... 92 more columns,\n  PRIMARY KEY (APCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To distinguish retainage vs non-retainage holds:\n1. Join APTD to APHD for hold details\n2. Join APCO to get RetHoldCode setting\n3. Compare APHD.HoldCode to APCO.RetHoldCode\n4. If equal, it's a retainage hold; otherwise non-retainage\n\n```sql\nSELECT \n  APTD.APCo,\n  APTD.Vendor,\n  APTD.Mth,\n  APTD.APTrans,\n  APHD.HoldCode,\n  CASE WHEN APHD.HoldCode = APCO.RetHoldCode \n       THEN 'Retainage Hold' \n       ELSE 'Non-Retainage Hold' END AS HoldType,\n  APTD.Amount\nFROM APTD WITH (NOLOCK)\nINNER JOIN APHD WITH (NOLOCK) ON APTD.APCo = APHD.APCo \n  AND APTD.Mth = APHD.Mth \n  AND APTD.APTrans = APHD.APTrans \n  AND APTD.APLine = APHD.APLine\nINNER JOIN APCO WITH (NOLOCK) ON APTD.APCo = APCO.APCo\nWHERE APTD.APCo = @APCo\n  AND APHD.HoldCode IS NOT NULL\nORDER BY APTD.Vendor, APTD.Mth\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTD",
        "APHD",
        "APCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query to reconcile ap oncost batch lines with original transactions\n\nDatabase Schema:\nCREATE TABLE APTL (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equip bequip,\n  EMGroup bgroup,\n  -- ... 56 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans, APLine)\n);\n\nCREATE TABLE APLB (\n  Co bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  BatchId bbatchid NOT NULL,\n  BatchSeq int NOT NULL,\n  APLine smallint NOT NULL,\n  BatchTransType char(1) NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  -- ... 120 more columns,\n  PRIMARY KEY (Co, Mth, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APHB (\n  Co bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  BatchId bbatchid NOT NULL,\n  BatchSeq int NOT NULL,\n  BatchTransType char(1) NOT NULL,\n  APTrans btrans,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  -- ... 88 more columns,\n  PRIMARY KEY (Co, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To reconcile AP oncost batches with original transactions:\n1. Join APLB (batch lines) to APTL (original lines) using ocApplyMth, ocApplyTrans, ocApplyLine\n2. Include APHB for batch header info\n3. Join to APTH and APVM for vendor context\n4. Compare batch vs original amounts\n\n```sql\nSELECT \n  APLB.Co AS BatchCo,\n  APLB.Mth AS BatchMth,\n  APLB.BatchId,\n  APLB.BatchSeq,\n  APLB.ocApplyMth,\n  APLB.ocApplyTrans,\n  APLB.ocApplyLine,\n  APTL.APCo AS OrigCo,\n  APTL.Mth AS OrigMth,\n  APTL.APTrans AS OrigTrans,\n  APTL.APLine AS OrigLine,\n  APTL.GrossAmt AS OrigAmount,\n  APLB.GrossAmt AS BatchAmount,\n  APVM.Name AS VendorName\nFROM APLB WITH (NOLOCK)\nINNER JOIN APHB WITH (NOLOCK) ON APLB.Co = APHB.Co AND APLB.Mth = APHB.Mth AND APLB.BatchId = APHB.BatchId\nINNER JOIN APTL WITH (NOLOCK) ON APLB.ocApplyMth = APTL.Mth \n  AND APLB.ocApplyTrans = APTL.APTrans \n  AND APLB.ocApplyLine = APTL.APLine\n  AND APLB.Co = APTL.APCo\nINNER JOIN APTH WITH (NOLOCK) ON APTL.APCo = APTH.APCo AND APTL.Mth = APTH.Mth AND APTL.APTrans = APTH.APTrans\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APLB.Co = @Co\nORDER BY APLB.BatchId, APLB.BatchSeq\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "basic",
      "tables_used": [
        "APLB",
        "APHB",
        "APTL",
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from GLCO\n\nDatabase Schema:\nCREATE TABLE GLCO (\n  GLCo bcompany NOT NULL,\n  Consolid byn NOT NULL,\n  LastMthSubClsd bmonth NOT NULL,\n  LastMthGLClsd bmonth NOT NULL,\n  MaxOpen tinyint NOT NULL,\n  CashAccrual char(1) NOT NULL,\n  Unbal byn NOT NULL,\n  AuditCoParams byn NOT NULL,\n  AuditAccts byn NOT NULL,\n  AuditAutoJrnl byn NOT NULL,\n  AuditBals byn NOT NULL,\n  AuditBudgets byn NOT NULL,\n  AuditDetail byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  XCompJrnlEntryYN byn NOT NULL,\n  KeyID bigint NOT NULL,\n  LastMthAPClsd bmonth NOT NULL,\n  LastMthARClsd bmonth NOT NULL,\n  AttachBatchReportsYN byn NOT NULL,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from GLCO ().\n\n```sql\nSELECT *\nFROM GLCO WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "GLCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging with customer contact information\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I can partially answer this query, but the schema is incomplete.\n\nThe query requires ARCM (AR Customer Master) for customer details, but only ARTH is provided in the schema.\n\nHere's what I can provide with the available schema:\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n-- Note: Additional joins for ARCM would be needed for complete results\n```\n\nTo get the complete data you requested, please provide the DDL for ARCM.",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How do I aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoice totals with discounts and retainage\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Vendor invoice summary with discounts and retainage:\n1. Join APTH to APVM for vendor details\n2. Aggregate by vendor\n3. Include GrossAmt, DiscOffer, Retainage, and Balance\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(APTH.APTrans) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS GrossAmount,\n  SUM(APTH.DiscOffer) AS DiscountsOffered,\n  SUM(APTH.Retainage) AS RetainageHeld,\n  SUM(APTH.Balance) AS OpenBalance\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find all unpaid AR invoices older than 60 days\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find unpaid invoices over 60 days:\n1. Join ARTH to ARCM for customer information\n2. Filter PayFullDate IS NULL (unpaid)\n3. Use DATEDIFF to calculate age and filter > 60 days\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Mth,\n  ARTH.ARTrans,\n  ARCM.Name AS CustomerName,\n  ARTH.TransDate,\n  ARTH.Amount,\n  DATEDIFF(day, ARTH.TransDate, GETDATE()) AS DaysOutstanding\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\n  AND DATEDIFF(day, ARTH.TransDate, GETDATE()) > 60\nORDER BY ARTH.TransDate\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from ARTH\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from ARTH ().\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to reconcile ap oncost batch lines with original transactions\n\nDatabase Schema:\nCREATE TABLE APTL (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equip bequip,\n  EMGroup bgroup,\n  -- ... 56 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans, APLine)\n);\n\nCREATE TABLE APLB (\n  Co bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  BatchId bbatchid NOT NULL,\n  BatchSeq int NOT NULL,\n  APLine smallint NOT NULL,\n  BatchTransType char(1) NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  -- ... 120 more columns,\n  PRIMARY KEY (Co, Mth, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APHB (\n  Co bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  BatchId bbatchid NOT NULL,\n  BatchSeq int NOT NULL,\n  BatchTransType char(1) NOT NULL,\n  APTrans btrans,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  -- ... 88 more columns,\n  PRIMARY KEY (Co, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To reconcile AP oncost batches with original transactions:\n1. Join APLB (batch lines) to APTL (original lines) using ocApplyMth, ocApplyTrans, ocApplyLine\n2. Include APHB for batch header info\n3. Join to APTH and APVM for vendor context\n4. Compare batch vs original amounts\n\n```sql\nSELECT \n  APLB.Co AS BatchCo,\n  APLB.Mth AS BatchMth,\n  APLB.BatchId,\n  APLB.BatchSeq,\n  APLB.ocApplyMth,\n  APLB.ocApplyTrans,\n  APLB.ocApplyLine,\n  APTL.APCo AS OrigCo,\n  APTL.Mth AS OrigMth,\n  APTL.APTrans AS OrigTrans,\n  APTL.APLine AS OrigLine,\n  APTL.GrossAmt AS OrigAmount,\n  APLB.GrossAmt AS BatchAmount,\n  APVM.Name AS VendorName\nFROM APLB WITH (NOLOCK)\nINNER JOIN APHB WITH (NOLOCK) ON APLB.Co = APHB.Co AND APLB.Mth = APHB.Mth AND APLB.BatchId = APHB.BatchId\nINNER JOIN APTL WITH (NOLOCK) ON APLB.ocApplyMth = APTL.Mth \n  AND APLB.ocApplyTrans = APTL.APTrans \n  AND APLB.ocApplyLine = APTL.APLine\n  AND APLB.Co = APTL.APCo\nINNER JOIN APTH WITH (NOLOCK) ON APTL.APCo = APTH.APCo AND APTL.Mth = APTH.Mth AND APTL.APTrans = APTH.APTrans\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APLB.Co = @Co\nORDER BY APLB.BatchId, APLB.BatchSeq\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "basic",
      "tables_used": [
        "APLB",
        "APHB",
        "APTL",
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from ARTH\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from ARTH ().\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get subcontractor costs with original, change orders, invoiced, paid, and retainage by vendor\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Subcontractor cost breakdown by vendor:\n1. Join SLHD (Header) to SLIT (Items) for subcontract details\n2. Join APVM for vendor names\n3. OrigCost = original contract amount\n4. CurCost - OrigCost = change order amounts\n5. InvCost = amounts invoiced\n6. Retainage = amounts held back\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  SLHD.SL AS SubcontractNum,\n  SLHD.Description AS SubcontractDesc,\n  SUM(SLIT.OrigCost) AS OriginalCost,\n  SUM(SLIT.CurCost - SLIT.OrigCost) AS ChangeOrderCost,\n  SUM(SLIT.CurCost) AS CurrentCost,\n  SUM(SLIT.InvCost) AS InvoicedCost,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost - SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nINNER JOIN APVM WITH (NOLOCK) ON SLHD.VendorGroup = APVM.VendorGroup AND SLHD.Vendor = APVM.Vendor\nWHERE SLHD.SLCo = @SLCo\nGROUP BY APVM.Vendor, APVM.Name, SLHD.SL, SLHD.Description\nORDER BY APVM.Name, SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "basic",
      "tables_used": [
        "SLHD",
        "SLIT",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging buckets (30/60/90+ days) for unpaid invoices by customer\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Use ARTH for transaction data and ARCM for customer names\n2. Filter PayFullDate IS NULL to get only unpaid invoices\n3. Use DATEDIFF and CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find jobs over budget with remaining cost projection\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Find jobs over budget:\n1. Aggregate JCCP by job from JCJM\n2. Compare total ActualCost to CurrEstCost\n3. Use HAVING to filter only over-budget jobs\n4. Sort by amount over budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description,\n  SUM(JCCP.CurrEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.CurrEstCost) - SUM(JCCP.ActualCost) AS RemainingBudget,\n  CASE WHEN SUM(JCCP.CurrEstCost) < SUM(JCCP.ActualCost) \n       THEN 'OVER BUDGET' ELSE 'OK' END AS Status\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\nGROUP BY JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.CurrEstCost)\nORDER BY (SUM(JCCP.ActualCost) - SUM(JCCP.CurrEstCost)) DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCJM",
        "JCCD",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to count records in prpc by company\n\nDatabase Schema:\nCREATE TABLE PRPC (\n  PRCo bcompany NOT NULL,\n  PRGroup bgroup NOT NULL,\n  PREndDate bdate NOT NULL,\n  BeginDate bdate NOT NULL,\n  MultiMth byn NOT NULL,\n  BeginMth bmonth NOT NULL,\n  EndMth bmonth,\n  CutoffDate bdate,\n  LimitMth bmonth NOT NULL,\n  Hrs smallint NOT NULL,\n  Days tinyint NOT NULL,\n  Wks tinyint NOT NULL,\n  Status tinyint NOT NULL,\n  DateClosed smalldatetime,\n  JCInterface byn NOT NULL,\n  EMInterface byn NOT NULL,\n  GLInterface byn NOT NULL,\n  APInterface byn NOT NULL,\n  LeaveProcess byn NOT NULL,\n  InUseBy bvpusername,\n  -- ... 7 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count PRPC records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM PRPC WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "PRPC"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from APTH\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from APTH ().\n\n```sql\nSELECT *\nFROM APTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "APTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find all unpaid AR invoices older than 60 days\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find unpaid invoices over 60 days:\n1. Join ARTH to ARCM for customer information\n2. Filter PayFullDate IS NULL (unpaid)\n3. Use DATEDIFF to calculate age and filter > 60 days\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Mth,\n  ARTH.ARTrans,\n  ARCM.Name AS CustomerName,\n  ARTH.TransDate,\n  ARTH.Amount,\n  DATEDIFF(day, ARTH.TransDate, GETDATE()) AS DaysOutstanding\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\n  AND DATEDIFF(day, ARTH.TransDate, GETDATE()) > 60\nORDER BY ARTH.TransDate\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How do I count records in preh by company\n\nDatabase Schema:\nCREATE TABLE PREH (\n  PRCo bcompany NOT NULL,\n  Employee bemployee NOT NULL,\n  LastName varchar(30) NOT NULL,\n  FirstName varchar(30),\n  MidName varchar(15),\n  SortName bsortname NOT NULL,\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  Phone bphone,\n  SSN char(11) NOT NULL,\n  Race char(2) NOT NULL,\n  Sex char(1) NOT NULL,\n  BirthDate smalldatetime,\n  HireDate bdate,\n  TermDate bdate,\n  PRGroup bgroup NOT NULL,\n  PRDept bdept NOT NULL,\n  -- ... 121 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count PREH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM PREH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "PREH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from ARTH\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from ARTH ().\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Include SLHD in the query\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'SLHD' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nJCJM, JCCD\n\nTo include SLHD in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get subcontractor costs with original, change orders, invoiced, paid, and retainage by vendor\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Subcontractor cost breakdown by vendor:\n1. Join SLHD (Header) to SLIT (Items) for subcontract details\n2. Join APVM for vendor names\n3. OrigCost = original contract amount\n4. CurCost - OrigCost = change order amounts\n5. InvCost = amounts invoiced\n6. Retainage = amounts held back\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  SLHD.SL AS SubcontractNum,\n  SLHD.Description AS SubcontractDesc,\n  SUM(SLIT.OrigCost) AS OriginalCost,\n  SUM(SLIT.CurCost - SLIT.OrigCost) AS ChangeOrderCost,\n  SUM(SLIT.CurCost) AS CurrentCost,\n  SUM(SLIT.InvCost) AS InvoicedCost,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost - SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nINNER JOIN APVM WITH (NOLOCK) ON SLHD.VendorGroup = APVM.VendorGroup AND SLHD.Vendor = APVM.Vendor\nWHERE SLHD.SLCo = @SLCo\nGROUP BY APVM.Vendor, APVM.Name, SLHD.SL, SLHD.Description\nORDER BY APVM.Name, SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "intermediate",
      "tables_used": [
        "SLHD",
        "SLIT",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from PREH\n\nDatabase Schema:\nCREATE TABLE PREH (\n  PRCo bcompany NOT NULL,\n  Employee bemployee NOT NULL,\n  LastName varchar(30) NOT NULL,\n  FirstName varchar(30),\n  MidName varchar(15),\n  SortName bsortname NOT NULL,\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  Phone bphone,\n  SSN char(11) NOT NULL,\n  Race char(2) NOT NULL,\n  Sex char(1) NOT NULL,\n  BirthDate smalldatetime,\n  HireDate bdate,\n  TermDate bdate,\n  PRGroup bgroup NOT NULL,\n  PRDept bdept NOT NULL,\n  -- ... 121 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from PREH ().\n\n```sql\nSELECT *\nFROM PREH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "PREH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoice totals with discounts and retainage\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Vendor invoice summary with discounts and retainage:\n1. Join APTH to APVM for vendor details\n2. Aggregate by vendor\n3. Include GrossAmt, DiscOffer, Retainage, and Balance\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(APTH.APTrans) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS GrossAmount,\n  SUM(APTH.DiscOffer) AS DiscountsOffered,\n  SUM(APTH.Retainage) AS RetainageHeld,\n  SUM(APTH.Balance) AS OpenBalance\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Include JCJM in the query\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'JCJM' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nARTH, ARCM\n\nTo include JCJM in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from APTD\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from APTD ().\n\n```sql\nSELECT *\nFROM APTD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How do I count records in glac by company\n\nDatabase Schema:\nCREATE TABLE GLAC (\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  Description bdesc,\n  AcctType char(1) NOT NULL,\n  SubType char(1),\n  NormBal char(1),\n  InterfaceDetail byn NOT NULL,\n  Active byn NOT NULL,\n  SummaryAcct bglacct NOT NULL,\n  CashAccrual char(1) NOT NULL,\n  CashOffAcct bglacct,\n  Notes varchar,\n  Part1 varchar(20),\n  Part2 varchar(20),\n  Part3 varchar(20),\n  Part4 varchar(20),\n  Part5 varchar(20),\n  Part6 varchar(20),\n  AllParts varchar(20),\n  CrossRefMemAcct bglacct,\n  -- ... 3 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count GLAC records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM GLAC WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "GLAC"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: reconcile ap oncost batch lines with original transactions\n\nDatabase Schema:\nCREATE TABLE APTL (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equip bequip,\n  EMGroup bgroup,\n  -- ... 56 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans, APLine)\n);\n\nCREATE TABLE APLB (\n  Co bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  BatchId bbatchid NOT NULL,\n  BatchSeq int NOT NULL,\n  APLine smallint NOT NULL,\n  BatchTransType char(1) NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  -- ... 120 more columns,\n  PRIMARY KEY (Co, Mth, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APHB (\n  Co bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  BatchId bbatchid NOT NULL,\n  BatchSeq int NOT NULL,\n  BatchTransType char(1) NOT NULL,\n  APTrans btrans,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  -- ... 88 more columns,\n  PRIMARY KEY (Co, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To reconcile AP oncost batches with original transactions:\n1. Join APLB (batch lines) to APTL (original lines) using ocApplyMth, ocApplyTrans, ocApplyLine\n2. Include APHB for batch header info\n3. Join to APTH and APVM for vendor context\n4. Compare batch vs original amounts\n\n```sql\nSELECT \n  APLB.Co AS BatchCo,\n  APLB.Mth AS BatchMth,\n  APLB.BatchId,\n  APLB.BatchSeq,\n  APLB.ocApplyMth,\n  APLB.ocApplyTrans,\n  APLB.ocApplyLine,\n  APTL.APCo AS OrigCo,\n  APTL.Mth AS OrigMth,\n  APTL.APTrans AS OrigTrans,\n  APTL.APLine AS OrigLine,\n  APTL.GrossAmt AS OrigAmount,\n  APLB.GrossAmt AS BatchAmount,\n  APVM.Name AS VendorName\nFROM APLB WITH (NOLOCK)\nINNER JOIN APHB WITH (NOLOCK) ON APLB.Co = APHB.Co AND APLB.Mth = APHB.Mth AND APLB.BatchId = APHB.BatchId\nINNER JOIN APTL WITH (NOLOCK) ON APLB.ocApplyMth = APTL.Mth \n  AND APLB.ocApplyTrans = APTL.APTrans \n  AND APLB.ocApplyLine = APTL.APLine\n  AND APLB.Co = APTL.APCo\nINNER JOIN APTH WITH (NOLOCK) ON APTL.APCo = APTH.APCo AND APTL.Mth = APTH.Mth AND APTL.APTrans = APTH.APTrans\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APLB.Co = @Co\nORDER BY APLB.BatchId, APLB.BatchSeq\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APLB",
        "APHB",
        "APTL",
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query to count records in arth by company\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count ARTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM ARTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging buckets (30/60/90+ days) for unpaid invoices by customer\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Use ARTH for transaction data and ARCM for customer names\n2. Filter PayFullDate IS NULL to get only unpaid invoices\n3. Use DATEDIFF and CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find all unpaid AR invoices older than 60 days\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find unpaid invoices over 60 days:\n1. Join ARTH to ARCM for customer information\n2. Filter PayFullDate IS NULL (unpaid)\n3. Use DATEDIFF to calculate age and filter > 60 days\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Mth,\n  ARTH.ARTrans,\n  ARCM.Name AS CustomerName,\n  ARTH.TransDate,\n  ARTH.Amount,\n  DATEDIFF(day, ARTH.TransDate, GETDATE()) AS DaysOutstanding\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\n  AND DATEDIFF(day, ARTH.TransDate, GETDATE()) > 60\nORDER BY ARTH.TransDate\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from ARTH\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from ARTH ().\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need to count records in slhd by company\n\nDatabase Schema:\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count SLHD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM SLHD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "SLHD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate stored materials (Purchased - Installed) for SL billing\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Stored materials for SL billing:\n1. SLWI contains work item/billing details\n2. StoredMatls = Purchased - Installed (materials on-site but not yet used)\n3. WCCost = Work Completed Cost\n4. WCRetAmt and SMRetAmt = separate retainage for work vs materials\n5. Total billable = WCCost + StoredMatls\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description AS ItemDescription,\n  SLWI.StoredMatls,\n  SLWI.WCCost AS WorkCompletedCost,\n  SLWI.StoredMatls + SLWI.WCCost AS TotalBillable,\n  SLWI.WCRetAmt AS WorkRetainage,\n  SLWI.SMRetAmt AS MaterialsRetainage,\n  SLWI.WCRetAmt + SLWI.SMRetAmt AS TotalRetainage\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\n  AND SLWI.StoredMatls <> 0\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need to count records in preh by company\n\nDatabase Schema:\nCREATE TABLE PREH (\n  PRCo bcompany NOT NULL,\n  Employee bemployee NOT NULL,\n  LastName varchar(30) NOT NULL,\n  FirstName varchar(30),\n  MidName varchar(15),\n  SortName bsortname NOT NULL,\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  Phone bphone,\n  SSN char(11) NOT NULL,\n  Race char(2) NOT NULL,\n  Sex char(1) NOT NULL,\n  BirthDate smalldatetime,\n  HireDate bdate,\n  TermDate bdate,\n  PRGroup bgroup NOT NULL,\n  PRDept bdept NOT NULL,\n  -- ... 121 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count PREH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM PREH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "PREH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to count records in gldt by company\n\nDatabase Schema:\nCREATE TABLE GLDT (\n  GLCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  GLTrans btrans NOT NULL,\n  GLAcct bglacct NOT NULL,\n  Jrnl bjrnl NOT NULL,\n  GLRef bglref NOT NULL,\n  SourceCo bcompany NOT NULL,\n  Source bsource NOT NULL,\n  ActDate bdate NOT NULL,\n  DatePosted bdate NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid NOT NULL,\n  Amount bdollar NOT NULL,\n  RevStatus tinyint NOT NULL,\n  Adjust char(1) NOT NULL,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  UniqueAttchID uniqueidentifier,\n  SrcTable varchar(128),\n  SrcKeyID bigint,\n  PRIMARY KEY (GLCo, Mth, GLTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count GLDT records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM GLDT WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "GLDT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query to track ap hold status distinguishing retainage vs non-retainage holds\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APCO (\n  APCo bcompany NOT NULL,\n  GLCo bcompany NOT NULL,\n  ExpJrnl bjrnl,\n  GLExpInterfaceLvl tinyint NOT NULL,\n  GLExpSummaryDesc varchar(60),\n  GLExpTransDesc varchar(60),\n  GLJobDetailDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLEquipDetailDesc varchar(60),\n  GLExpDetailDesc varchar(60),\n  PayJrnl bjrnl,\n  GLPayInterfaceLvl tinyint NOT NULL,\n  GLPayDetailDesc varchar(60),\n  GLPaySummaryDesc varchar(60),\n  DiscOffGLAcct bglacct,\n  DiscTakenGLAcct bglacct,\n  ExpPayType tinyint,\n  JobPayType tinyint,\n  SubPayType tinyint,\n  RetPayType tinyint,\n  -- ... 92 more columns,\n  PRIMARY KEY (APCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To distinguish retainage vs non-retainage holds:\n1. Join APTD to APHD for hold details\n2. Join APCO to get RetHoldCode setting\n3. Compare APHD.HoldCode to APCO.RetHoldCode\n4. If equal, it's a retainage hold; otherwise non-retainage\n\n```sql\nSELECT \n  APTD.APCo,\n  APTD.Vendor,\n  APTD.Mth,\n  APTD.APTrans,\n  APHD.HoldCode,\n  CASE WHEN APHD.HoldCode = APCO.RetHoldCode \n       THEN 'Retainage Hold' \n       ELSE 'Non-Retainage Hold' END AS HoldType,\n  APTD.Amount\nFROM APTD WITH (NOLOCK)\nINNER JOIN APHD WITH (NOLOCK) ON APTD.APCo = APHD.APCo \n  AND APTD.Mth = APHD.Mth \n  AND APTD.APTrans = APHD.APTrans \n  AND APTD.APLine = APHD.APLine\nINNER JOIN APCO WITH (NOLOCK) ON APTD.APCo = APCO.APCo\nWHERE APTD.APCo = @APCo\n  AND APHD.HoldCode IS NOT NULL\nORDER BY APTD.Vendor, APTD.Mth\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "basic",
      "tables_used": [
        "APTD",
        "APHD",
        "APCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from PRTD\n\nDatabase Schema:\nCREATE TABLE PRTD (\n  PRCo bcompany NOT NULL,\n  Craft bcraft NOT NULL,\n  Class bclass NOT NULL,\n  Template smallint NOT NULL,\n  DLCode bedlcode NOT NULL,\n  Factor brate NOT NULL,\n  OldRate bunitcost NOT NULL,\n  NewRate bunitcost NOT NULL,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from PRTD ().\n\n```sql\nSELECT *\nFROM PRTD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "PRTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to track ap hold status distinguishing retainage vs non-retainage holds\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APCO (\n  APCo bcompany NOT NULL,\n  GLCo bcompany NOT NULL,\n  ExpJrnl bjrnl,\n  GLExpInterfaceLvl tinyint NOT NULL,\n  GLExpSummaryDesc varchar(60),\n  GLExpTransDesc varchar(60),\n  GLJobDetailDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLEquipDetailDesc varchar(60),\n  GLExpDetailDesc varchar(60),\n  PayJrnl bjrnl,\n  GLPayInterfaceLvl tinyint NOT NULL,\n  GLPayDetailDesc varchar(60),\n  GLPaySummaryDesc varchar(60),\n  DiscOffGLAcct bglacct,\n  DiscTakenGLAcct bglacct,\n  ExpPayType tinyint,\n  JobPayType tinyint,\n  SubPayType tinyint,\n  RetPayType tinyint,\n  -- ... 92 more columns,\n  PRIMARY KEY (APCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To distinguish retainage vs non-retainage holds:\n1. Join APTD to APHD for hold details\n2. Join APCO to get RetHoldCode setting\n3. Compare APHD.HoldCode to APCO.RetHoldCode\n4. If equal, it's a retainage hold; otherwise non-retainage\n\n```sql\nSELECT \n  APTD.APCo,\n  APTD.Vendor,\n  APTD.Mth,\n  APTD.APTrans,\n  APHD.HoldCode,\n  CASE WHEN APHD.HoldCode = APCO.RetHoldCode \n       THEN 'Retainage Hold' \n       ELSE 'Non-Retainage Hold' END AS HoldType,\n  APTD.Amount\nFROM APTD WITH (NOLOCK)\nINNER JOIN APHD WITH (NOLOCK) ON APTD.APCo = APHD.APCo \n  AND APTD.Mth = APHD.Mth \n  AND APTD.APTrans = APHD.APTrans \n  AND APTD.APLine = APHD.APLine\nINNER JOIN APCO WITH (NOLOCK) ON APTD.APCo = APCO.APCo\nWHERE APTD.APCo = @APCo\n  AND APHD.HoldCode IS NOT NULL\nORDER BY APTD.Vendor, APTD.Mth\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "basic",
      "tables_used": [
        "APTD",
        "APHD",
        "APCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to count records in prth by company\n\nDatabase Schema:\nCREATE TABLE PRTH (\n  PRCo bcompany NOT NULL,\n  PRGroup bgroup NOT NULL,\n  PREndDate bdate NOT NULL,\n  Employee bemployee NOT NULL,\n  PaySeq tinyint NOT NULL,\n  PostSeq smallint NOT NULL,\n  Type char(1) NOT NULL,\n  PostDate bdate NOT NULL,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCDept bdept,\n  GLCo bcompany NOT NULL,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equipment bequip,\n  EMGroup tinyint,\n  CostCode bcostcode,\n  -- ... 41 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count PRTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM PRTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "PRTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query to count records in glac by company\n\nDatabase Schema:\nCREATE TABLE GLAC (\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  Description bdesc,\n  AcctType char(1) NOT NULL,\n  SubType char(1),\n  NormBal char(1),\n  InterfaceDetail byn NOT NULL,\n  Active byn NOT NULL,\n  SummaryAcct bglacct NOT NULL,\n  CashAccrual char(1) NOT NULL,\n  CashOffAcct bglacct,\n  Notes varchar,\n  Part1 varchar(20),\n  Part2 varchar(20),\n  Part3 varchar(20),\n  Part4 varchar(20),\n  Part5 varchar(20),\n  Part6 varchar(20),\n  AllParts varchar(20),\n  CrossRefMemAcct bglacct,\n  -- ... 3 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count GLAC records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM GLAC WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "GLAC"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoice totals with discounts and retainage\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Vendor invoice summary with discounts and retainage:\n1. Join APTH to APVM for vendor details\n2. Aggregate by vendor\n3. Include GrossAmt, DiscOffer, Retainage, and Balance\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(APTH.APTrans) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS GrossAmount,\n  SUM(APTH.DiscOffer) AS DiscountsOffered,\n  SUM(APTH.Retainage) AS RetainageHeld,\n  SUM(APTH.Balance) AS OpenBalance\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find jobs over budget with remaining cost projection\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Find jobs over budget:\n1. Aggregate JCCP by job from JCJM\n2. Compare total ActualCost to CurrEstCost\n3. Use HAVING to filter only over-budget jobs\n4. Sort by amount over budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description,\n  SUM(JCCP.CurrEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.CurrEstCost) - SUM(JCCP.ActualCost) AS RemainingBudget,\n  CASE WHEN SUM(JCCP.CurrEstCost) < SUM(JCCP.ActualCost) \n       THEN 'OVER BUDGET' ELSE 'OK' END AS Status\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\nGROUP BY JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.CurrEstCost)\nORDER BY (SUM(JCCP.ActualCost) - SUM(JCCP.CurrEstCost)) DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM",
        "JCCD",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find all unpaid AR invoices older than 60 days\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find unpaid invoices over 60 days:\n1. Join ARTH to ARCM for customer information\n2. Filter PayFullDate IS NULL (unpaid)\n3. Use DATEDIFF to calculate age and filter > 60 days\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Mth,\n  ARTH.ARTrans,\n  ARCM.Name AS CustomerName,\n  ARTH.TransDate,\n  ARTH.Amount,\n  DATEDIFF(day, ARTH.TransDate, GETDATE()) AS DaysOutstanding\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\n  AND DATEDIFF(day, ARTH.TransDate, GETDATE()) > 60\nORDER BY ARTH.TransDate\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get customer balance summary by customer group\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Customer balance summary by group:\n1. Join ARTH to ARCM for customer details\n2. Use conditional SUM for open vs total balances\n3. Group by CustGroup for summary\n\n```sql\nSELECT \n  ARTH.CustGroup,\n  COUNT(DISTINCT ARTH.Customer) AS CustomerCount,\n  SUM(CASE WHEN ARTH.PayFullDate IS NULL THEN ARTH.Amount ELSE 0 END) AS OpenBalance,\n  SUM(ARTH.Amount) AS TotalBilled\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\nGROUP BY ARTH.CustGroup\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get subcontractor costs with original, change orders, invoiced, paid, and retainage by vendor\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Subcontractor cost breakdown by vendor:\n1. Join SLHD (Header) to SLIT (Items) for subcontract details\n2. Join APVM for vendor names\n3. OrigCost = original contract amount\n4. CurCost - OrigCost = change order amounts\n5. InvCost = amounts invoiced\n6. Retainage = amounts held back\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  SLHD.SL AS SubcontractNum,\n  SLHD.Description AS SubcontractDesc,\n  SUM(SLIT.OrigCost) AS OriginalCost,\n  SUM(SLIT.CurCost - SLIT.OrigCost) AS ChangeOrderCost,\n  SUM(SLIT.CurCost) AS CurrentCost,\n  SUM(SLIT.InvCost) AS InvoicedCost,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost - SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nINNER JOIN APVM WITH (NOLOCK) ON SLHD.VendorGroup = APVM.VendorGroup AND SLHD.Vendor = APVM.Vendor\nWHERE SLHD.SLCo = @SLCo\nGROUP BY APVM.Vendor, APVM.Name, SLHD.SL, SLHD.Description\nORDER BY APVM.Name, SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "intermediate",
      "tables_used": [
        "SLHD",
        "SLIT",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoice totals with discounts and retainage\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Vendor invoice summary with discounts and retainage:\n1. Join APTH to APVM for vendor details\n2. Aggregate by vendor\n3. Include GrossAmt, DiscOffer, Retainage, and Balance\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(APTH.APTrans) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS GrossAmount,\n  SUM(APTH.DiscOffer) AS DiscountsOffered,\n  SUM(APTH.Retainage) AS RetainageHeld,\n  SUM(APTH.Balance) AS OpenBalance\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to track ap hold status distinguishing retainage vs non-retainage holds\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APCO (\n  APCo bcompany NOT NULL,\n  GLCo bcompany NOT NULL,\n  ExpJrnl bjrnl,\n  GLExpInterfaceLvl tinyint NOT NULL,\n  GLExpSummaryDesc varchar(60),\n  GLExpTransDesc varchar(60),\n  GLJobDetailDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLEquipDetailDesc varchar(60),\n  GLExpDetailDesc varchar(60),\n  PayJrnl bjrnl,\n  GLPayInterfaceLvl tinyint NOT NULL,\n  GLPayDetailDesc varchar(60),\n  GLPaySummaryDesc varchar(60),\n  DiscOffGLAcct bglacct,\n  DiscTakenGLAcct bglacct,\n  ExpPayType tinyint,\n  JobPayType tinyint,\n  SubPayType tinyint,\n  RetPayType tinyint,\n  -- ... 92 more columns,\n  PRIMARY KEY (APCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To distinguish retainage vs non-retainage holds:\n1. Join APTD to APHD for hold details\n2. Join APCO to get RetHoldCode setting\n3. Compare APHD.HoldCode to APCO.RetHoldCode\n4. If equal, it's a retainage hold; otherwise non-retainage\n\n```sql\nSELECT \n  APTD.APCo,\n  APTD.Vendor,\n  APTD.Mth,\n  APTD.APTrans,\n  APHD.HoldCode,\n  CASE WHEN APHD.HoldCode = APCO.RetHoldCode \n       THEN 'Retainage Hold' \n       ELSE 'Non-Retainage Hold' END AS HoldType,\n  APTD.Amount\nFROM APTD WITH (NOLOCK)\nINNER JOIN APHD WITH (NOLOCK) ON APTD.APCo = APHD.APCo \n  AND APTD.Mth = APHD.Mth \n  AND APTD.APTrans = APHD.APTrans \n  AND APTD.APLine = APHD.APLine\nINNER JOIN APCO WITH (NOLOCK) ON APTD.APCo = APCO.APCo\nWHERE APTD.APCo = @APCo\n  AND APHD.HoldCode IS NOT NULL\nORDER BY APTD.Vendor, APTD.Mth\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTD",
        "APHD",
        "APCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get subcontractor costs with original, change orders, invoiced, paid, and retainage by vendor\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Subcontractor cost breakdown by vendor:\n1. Join SLHD (Header) to SLIT (Items) for subcontract details\n2. Join APVM for vendor names\n3. OrigCost = original contract amount\n4. CurCost - OrigCost = change order amounts\n5. InvCost = amounts invoiced\n6. Retainage = amounts held back\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  SLHD.SL AS SubcontractNum,\n  SLHD.Description AS SubcontractDesc,\n  SUM(SLIT.OrigCost) AS OriginalCost,\n  SUM(SLIT.CurCost - SLIT.OrigCost) AS ChangeOrderCost,\n  SUM(SLIT.CurCost) AS CurrentCost,\n  SUM(SLIT.InvCost) AS InvoicedCost,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost - SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nINNER JOIN APVM WITH (NOLOCK) ON SLHD.VendorGroup = APVM.VendorGroup AND SLHD.Vendor = APVM.Vendor\nWHERE SLHD.SLCo = @SLCo\nGROUP BY APVM.Vendor, APVM.Name, SLHD.SL, SLHD.Description\nORDER BY APVM.Name, SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "intermediate",
      "tables_used": [
        "SLHD",
        "SLIT",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to join JCJM with the available tables\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'JCJM' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nARTH, ARCM\n\nTo include JCJM in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to count records in slwi by company\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count SLWI records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM SLWI WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLWI"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from JCCD\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from JCCD ().\n\n```sql\nSELECT *\nFROM JCCD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from APTH\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from APTH ().\n\n```sql\nSELECT *\nFROM APTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How is Payments structured?\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'Payments' does not exist in Viewpoint Vista.\n\nFor AP payments, use APTD (AP Transaction Detail). For AR payments, use ARTH with appropriate ARTransType.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM APTD WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to join PREH with the available tables\n\nDatabase Schema:\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'PREH' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nSLHD, SLIT\n\nTo include PREH in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: track ap hold status distinguishing retainage vs non-retainage holds\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APCO (\n  APCo bcompany NOT NULL,\n  GLCo bcompany NOT NULL,\n  ExpJrnl bjrnl,\n  GLExpInterfaceLvl tinyint NOT NULL,\n  GLExpSummaryDesc varchar(60),\n  GLExpTransDesc varchar(60),\n  GLJobDetailDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLEquipDetailDesc varchar(60),\n  GLExpDetailDesc varchar(60),\n  PayJrnl bjrnl,\n  GLPayInterfaceLvl tinyint NOT NULL,\n  GLPayDetailDesc varchar(60),\n  GLPaySummaryDesc varchar(60),\n  DiscOffGLAcct bglacct,\n  DiscTakenGLAcct bglacct,\n  ExpPayType tinyint,\n  JobPayType tinyint,\n  SubPayType tinyint,\n  RetPayType tinyint,\n  -- ... 92 more columns,\n  PRIMARY KEY (APCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To distinguish retainage vs non-retainage holds:\n1. Join APTD to APHD for hold details\n2. Join APCO to get RetHoldCode setting\n3. Compare APHD.HoldCode to APCO.RetHoldCode\n4. If equal, it's a retainage hold; otherwise non-retainage\n\n```sql\nSELECT \n  APTD.APCo,\n  APTD.Vendor,\n  APTD.Mth,\n  APTD.APTrans,\n  APHD.HoldCode,\n  CASE WHEN APHD.HoldCode = APCO.RetHoldCode \n       THEN 'Retainage Hold' \n       ELSE 'Non-Retainage Hold' END AS HoldType,\n  APTD.Amount\nFROM APTD WITH (NOLOCK)\nINNER JOIN APHD WITH (NOLOCK) ON APTD.APCo = APHD.APCo \n  AND APTD.Mth = APHD.Mth \n  AND APTD.APTrans = APHD.APTrans \n  AND APTD.APLine = APHD.APLine\nINNER JOIN APCO WITH (NOLOCK) ON APTD.APCo = APCO.APCo\nWHERE APTD.APCo = @APCo\n  AND APHD.HoldCode IS NOT NULL\nORDER BY APTD.Vendor, APTD.Mth\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "basic",
      "tables_used": [
        "APTD",
        "APHD",
        "APCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from SLHD\n\nDatabase Schema:\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from SLHD ().\n\n```sql\nSELECT *\nFROM SLHD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "SLHD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: count records in aptd by company\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count APTD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM APTD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How do I count records in prpc by company\n\nDatabase Schema:\nCREATE TABLE PRPC (\n  PRCo bcompany NOT NULL,\n  PRGroup bgroup NOT NULL,\n  PREndDate bdate NOT NULL,\n  BeginDate bdate NOT NULL,\n  MultiMth byn NOT NULL,\n  BeginMth bmonth NOT NULL,\n  EndMth bmonth,\n  CutoffDate bdate,\n  LimitMth bmonth NOT NULL,\n  Hrs smallint NOT NULL,\n  Days tinyint NOT NULL,\n  Wks tinyint NOT NULL,\n  Status tinyint NOT NULL,\n  DateClosed smalldatetime,\n  JCInterface byn NOT NULL,\n  EMInterface byn NOT NULL,\n  GLInterface byn NOT NULL,\n  APInterface byn NOT NULL,\n  LeaveProcess byn NOT NULL,\n  InUseBy bvpusername,\n  -- ... 7 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count PRPC records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM PRPC WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "PRPC"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need to reconcile ap oncost batch lines with original transactions\n\nDatabase Schema:\nCREATE TABLE APTL (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equip bequip,\n  EMGroup bgroup,\n  -- ... 56 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans, APLine)\n);\n\nCREATE TABLE APLB (\n  Co bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  BatchId bbatchid NOT NULL,\n  BatchSeq int NOT NULL,\n  APLine smallint NOT NULL,\n  BatchTransType char(1) NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  -- ... 120 more columns,\n  PRIMARY KEY (Co, Mth, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APHB (\n  Co bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  BatchId bbatchid NOT NULL,\n  BatchSeq int NOT NULL,\n  BatchTransType char(1) NOT NULL,\n  APTrans btrans,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  -- ... 88 more columns,\n  PRIMARY KEY (Co, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To reconcile AP oncost batches with original transactions:\n1. Join APLB (batch lines) to APTL (original lines) using ocApplyMth, ocApplyTrans, ocApplyLine\n2. Include APHB for batch header info\n3. Join to APTH and APVM for vendor context\n4. Compare batch vs original amounts\n\n```sql\nSELECT \n  APLB.Co AS BatchCo,\n  APLB.Mth AS BatchMth,\n  APLB.BatchId,\n  APLB.BatchSeq,\n  APLB.ocApplyMth,\n  APLB.ocApplyTrans,\n  APLB.ocApplyLine,\n  APTL.APCo AS OrigCo,\n  APTL.Mth AS OrigMth,\n  APTL.APTrans AS OrigTrans,\n  APTL.APLine AS OrigLine,\n  APTL.GrossAmt AS OrigAmount,\n  APLB.GrossAmt AS BatchAmount,\n  APVM.Name AS VendorName\nFROM APLB WITH (NOLOCK)\nINNER JOIN APHB WITH (NOLOCK) ON APLB.Co = APHB.Co AND APLB.Mth = APHB.Mth AND APLB.BatchId = APHB.BatchId\nINNER JOIN APTL WITH (NOLOCK) ON APLB.ocApplyMth = APTL.Mth \n  AND APLB.ocApplyTrans = APTL.APTrans \n  AND APLB.ocApplyLine = APTL.APLine\n  AND APLB.Co = APTL.APCo\nINNER JOIN APTH WITH (NOLOCK) ON APTL.APCo = APTH.APCo AND APTL.Mth = APTH.Mth AND APTL.APTrans = APTH.APTrans\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APLB.Co = @Co\nORDER BY APLB.BatchId, APLB.BatchSeq\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APLB",
        "APHB",
        "APTL",
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to count records in aptd by company\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count APTD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM APTD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get customer balance summary by customer group\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Customer balance summary by group:\n1. Join ARTH to ARCM for customer details\n2. Use conditional SUM for open vs total balances\n3. Group by CustGroup for summary\n\n```sql\nSELECT \n  ARTH.CustGroup,\n  COUNT(DISTINCT ARTH.Customer) AS CustomerCount,\n  SUM(CASE WHEN ARTH.PayFullDate IS NULL THEN ARTH.Amount ELSE 0 END) AS OpenBalance,\n  SUM(ARTH.Amount) AS TotalBilled\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\nGROUP BY ARTH.CustGroup\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: track ap hold status distinguishing retainage vs non-retainage holds\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APCO (\n  APCo bcompany NOT NULL,\n  GLCo bcompany NOT NULL,\n  ExpJrnl bjrnl,\n  GLExpInterfaceLvl tinyint NOT NULL,\n  GLExpSummaryDesc varchar(60),\n  GLExpTransDesc varchar(60),\n  GLJobDetailDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLEquipDetailDesc varchar(60),\n  GLExpDetailDesc varchar(60),\n  PayJrnl bjrnl,\n  GLPayInterfaceLvl tinyint NOT NULL,\n  GLPayDetailDesc varchar(60),\n  GLPaySummaryDesc varchar(60),\n  DiscOffGLAcct bglacct,\n  DiscTakenGLAcct bglacct,\n  ExpPayType tinyint,\n  JobPayType tinyint,\n  SubPayType tinyint,\n  RetPayType tinyint,\n  -- ... 92 more columns,\n  PRIMARY KEY (APCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To distinguish retainage vs non-retainage holds:\n1. Join APTD to APHD for hold details\n2. Join APCO to get RetHoldCode setting\n3. Compare APHD.HoldCode to APCO.RetHoldCode\n4. If equal, it's a retainage hold; otherwise non-retainage\n\n```sql\nSELECT \n  APTD.APCo,\n  APTD.Vendor,\n  APTD.Mth,\n  APTD.APTrans,\n  APHD.HoldCode,\n  CASE WHEN APHD.HoldCode = APCO.RetHoldCode \n       THEN 'Retainage Hold' \n       ELSE 'Non-Retainage Hold' END AS HoldType,\n  APTD.Amount\nFROM APTD WITH (NOLOCK)\nINNER JOIN APHD WITH (NOLOCK) ON APTD.APCo = APHD.APCo \n  AND APTD.Mth = APHD.Mth \n  AND APTD.APTrans = APHD.APTrans \n  AND APTD.APLine = APHD.APLine\nINNER JOIN APCO WITH (NOLOCK) ON APTD.APCo = APCO.APCo\nWHERE APTD.APCo = @APCo\n  AND APHD.HoldCode IS NOT NULL\nORDER BY APTD.Vendor, APTD.Mth\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTD",
        "APHD",
        "APCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from GLDT\n\nDatabase Schema:\nCREATE TABLE GLDT (\n  GLCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  GLTrans btrans NOT NULL,\n  GLAcct bglacct NOT NULL,\n  Jrnl bjrnl NOT NULL,\n  GLRef bglref NOT NULL,\n  SourceCo bcompany NOT NULL,\n  Source bsource NOT NULL,\n  ActDate bdate NOT NULL,\n  DatePosted bdate NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid NOT NULL,\n  Amount bdollar NOT NULL,\n  RevStatus tinyint NOT NULL,\n  Adjust char(1) NOT NULL,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  UniqueAttchID uniqueidentifier,\n  SrcTable varchar(128),\n  SrcKeyID bigint,\n  PRIMARY KEY (GLCo, Mth, GLTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from GLDT ().\n\n```sql\nSELECT *\nFROM GLDT WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "GLDT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get subcontractor costs with original, change orders, invoiced, paid, and retainage by vendor\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Subcontractor cost breakdown by vendor:\n1. Join SLHD (Header) to SLIT (Items) for subcontract details\n2. Join APVM for vendor names\n3. OrigCost = original contract amount\n4. CurCost - OrigCost = change order amounts\n5. InvCost = amounts invoiced\n6. Retainage = amounts held back\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  SLHD.SL AS SubcontractNum,\n  SLHD.Description AS SubcontractDesc,\n  SUM(SLIT.OrigCost) AS OriginalCost,\n  SUM(SLIT.CurCost - SLIT.OrigCost) AS ChangeOrderCost,\n  SUM(SLIT.CurCost) AS CurrentCost,\n  SUM(SLIT.InvCost) AS InvoicedCost,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost - SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nINNER JOIN APVM WITH (NOLOCK) ON SLHD.VendorGroup = APVM.VendorGroup AND SLHD.Vendor = APVM.Vendor\nWHERE SLHD.SLCo = @SLCo\nGROUP BY APVM.Vendor, APVM.Name, SLHD.SL, SLHD.Description\nORDER BY APVM.Name, SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "basic",
      "tables_used": [
        "SLHD",
        "SLIT",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Query JCJM along with the schema tables\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'JCJM' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nARTH, ARCM\n\nTo include JCJM in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate stored materials (Purchased - Installed) for SL billing\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Stored materials for SL billing:\n1. SLWI contains work item/billing details\n2. StoredMatls = Purchased - Installed (materials on-site but not yet used)\n3. WCCost = Work Completed Cost\n4. WCRetAmt and SMRetAmt = separate retainage for work vs materials\n5. Total billable = WCCost + StoredMatls\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description AS ItemDescription,\n  SLWI.StoredMatls,\n  SLWI.WCCost AS WorkCompletedCost,\n  SLWI.StoredMatls + SLWI.WCCost AS TotalBillable,\n  SLWI.WCRetAmt AS WorkRetainage,\n  SLWI.SMRetAmt AS MaterialsRetainage,\n  SLWI.WCRetAmt + SLWI.SMRetAmt AS TotalRetainage\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\n  AND SLWI.StoredMatls <> 0\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "basic",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from PRTD\n\nDatabase Schema:\nCREATE TABLE PRTD (\n  PRCo bcompany NOT NULL,\n  Craft bcraft NOT NULL,\n  Class bclass NOT NULL,\n  Template smallint NOT NULL,\n  DLCode bedlcode NOT NULL,\n  Factor brate NOT NULL,\n  OldRate bunitcost NOT NULL,\n  NewRate bunitcost NOT NULL,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from PRTD ().\n\n```sql\nSELECT *\nFROM PRTD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "PRTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get subcontractor costs with original, change orders, invoiced, paid, and retainage by vendor\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Subcontractor cost breakdown by vendor:\n1. Join SLHD (Header) to SLIT (Items) for subcontract details\n2. Join APVM for vendor names\n3. OrigCost = original contract amount\n4. CurCost - OrigCost = change order amounts\n5. InvCost = amounts invoiced\n6. Retainage = amounts held back\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  SLHD.SL AS SubcontractNum,\n  SLHD.Description AS SubcontractDesc,\n  SUM(SLIT.OrigCost) AS OriginalCost,\n  SUM(SLIT.CurCost - SLIT.OrigCost) AS ChangeOrderCost,\n  SUM(SLIT.CurCost) AS CurrentCost,\n  SUM(SLIT.InvCost) AS InvoicedCost,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost - SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nINNER JOIN APVM WITH (NOLOCK) ON SLHD.VendorGroup = APVM.VendorGroup AND SLHD.Vendor = APVM.Vendor\nWHERE SLHD.SLCo = @SLCo\nGROUP BY APVM.Vendor, APVM.Name, SLHD.SL, SLHD.Description\nORDER BY APVM.Name, SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "basic",
      "tables_used": [
        "SLHD",
        "SLIT",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show job costs with GL account descriptions\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I can partially answer this query, but the schema is incomplete.\n\nThe query requires GLAC for GL account descriptions, which is not in the provided schema.\n\nHere's what I can provide with the available schema:\n\n```sql\nSELECT *\nFROM JCCD WITH (NOLOCK)\nWHERE Co = @Co\n-- Note: Additional joins for GLAC would be needed for complete results\n```\n\nTo get the complete data you requested, please provide the DDL for GLAC.",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find jobs over budget with remaining cost projection\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Find jobs over budget:\n1. Aggregate JCCP by job from JCJM\n2. Compare total ActualCost to CurrEstCost\n3. Use HAVING to filter only over-budget jobs\n4. Sort by amount over budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description,\n  SUM(JCCP.CurrEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.CurrEstCost) - SUM(JCCP.ActualCost) AS RemainingBudget,\n  CASE WHEN SUM(JCCP.CurrEstCost) < SUM(JCCP.ActualCost) \n       THEN 'OVER BUDGET' ELSE 'OK' END AS Status\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\nGROUP BY JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.CurrEstCost)\nORDER BY (SUM(JCCP.ActualCost) - SUM(JCCP.CurrEstCost)) DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCJM",
        "JCCD",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query to count records in apth by company\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count APTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM APTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from SLWI\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from SLWI ().\n\n```sql\nSELECT *\nFROM SLWI WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLWI"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from PREH\n\nDatabase Schema:\nCREATE TABLE PREH (\n  PRCo bcompany NOT NULL,\n  Employee bemployee NOT NULL,\n  LastName varchar(30) NOT NULL,\n  FirstName varchar(30),\n  MidName varchar(15),\n  SortName bsortname NOT NULL,\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  Phone bphone,\n  SSN char(11) NOT NULL,\n  Race char(2) NOT NULL,\n  Sex char(1) NOT NULL,\n  BirthDate smalldatetime,\n  HireDate bdate,\n  TermDate bdate,\n  PRGroup bgroup NOT NULL,\n  PRDept bdept NOT NULL,\n  -- ... 121 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from PREH ().\n\n```sql\nSELECT *\nFROM PREH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "PREH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from GLDT\n\nDatabase Schema:\nCREATE TABLE GLDT (\n  GLCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  GLTrans btrans NOT NULL,\n  GLAcct bglacct NOT NULL,\n  Jrnl bjrnl NOT NULL,\n  GLRef bglref NOT NULL,\n  SourceCo bcompany NOT NULL,\n  Source bsource NOT NULL,\n  ActDate bdate NOT NULL,\n  DatePosted bdate NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid NOT NULL,\n  Amount bdollar NOT NULL,\n  RevStatus tinyint NOT NULL,\n  Adjust char(1) NOT NULL,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  UniqueAttchID uniqueidentifier,\n  SrcTable varchar(128),\n  SrcKeyID bigint,\n  PRIMARY KEY (GLCo, Mth, GLTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from GLDT ().\n\n```sql\nSELECT *\nFROM GLDT WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "GLDT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query to aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: count records in arth by company\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count ARTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM ARTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from SLWI\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from SLWI ().\n\n```sql\nSELECT *\nFROM SLWI WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "SLWI"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from APTD\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from APTD ().\n\n```sql\nSELECT *\nFROM APTD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from GLJR\n\nDatabase Schema:\nCREATE TABLE GLJR (\n  GLCo bcompany NOT NULL,\n  Jrnl bjrnl NOT NULL,\n  Description btransdesc,\n  Rev byn NOT NULL,\n  RevJrnl bjrnl,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from GLJR ().\n\n```sql\nSELECT *\nFROM GLJR WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "GLJR"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query to reconcile ap oncost batch lines with original transactions\n\nDatabase Schema:\nCREATE TABLE APTL (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equip bequip,\n  EMGroup bgroup,\n  -- ... 56 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans, APLine)\n);\n\nCREATE TABLE APLB (\n  Co bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  BatchId bbatchid NOT NULL,\n  BatchSeq int NOT NULL,\n  APLine smallint NOT NULL,\n  BatchTransType char(1) NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  -- ... 120 more columns,\n  PRIMARY KEY (Co, Mth, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APHB (\n  Co bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  BatchId bbatchid NOT NULL,\n  BatchSeq int NOT NULL,\n  BatchTransType char(1) NOT NULL,\n  APTrans btrans,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  -- ... 88 more columns,\n  PRIMARY KEY (Co, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To reconcile AP oncost batches with original transactions:\n1. Join APLB (batch lines) to APTL (original lines) using ocApplyMth, ocApplyTrans, ocApplyLine\n2. Include APHB for batch header info\n3. Join to APTH and APVM for vendor context\n4. Compare batch vs original amounts\n\n```sql\nSELECT \n  APLB.Co AS BatchCo,\n  APLB.Mth AS BatchMth,\n  APLB.BatchId,\n  APLB.BatchSeq,\n  APLB.ocApplyMth,\n  APLB.ocApplyTrans,\n  APLB.ocApplyLine,\n  APTL.APCo AS OrigCo,\n  APTL.Mth AS OrigMth,\n  APTL.APTrans AS OrigTrans,\n  APTL.APLine AS OrigLine,\n  APTL.GrossAmt AS OrigAmount,\n  APLB.GrossAmt AS BatchAmount,\n  APVM.Name AS VendorName\nFROM APLB WITH (NOLOCK)\nINNER JOIN APHB WITH (NOLOCK) ON APLB.Co = APHB.Co AND APLB.Mth = APHB.Mth AND APLB.BatchId = APHB.BatchId\nINNER JOIN APTL WITH (NOLOCK) ON APLB.ocApplyMth = APTL.Mth \n  AND APLB.ocApplyTrans = APTL.APTrans \n  AND APLB.ocApplyLine = APTL.APLine\n  AND APLB.Co = APTL.APCo\nINNER JOIN APTH WITH (NOLOCK) ON APTL.APCo = APTH.APCo AND APTL.Mth = APTH.Mth AND APTL.APTrans = APTH.APTrans\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APLB.Co = @Co\nORDER BY APLB.BatchId, APLB.BatchSeq\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "basic",
      "tables_used": [
        "APLB",
        "APHB",
        "APTL",
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate stored materials (Purchased - Installed) for SL billing\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Stored materials for SL billing:\n1. SLWI contains work item/billing details\n2. StoredMatls = Purchased - Installed (materials on-site but not yet used)\n3. WCCost = Work Completed Cost\n4. WCRetAmt and SMRetAmt = separate retainage for work vs materials\n5. Total billable = WCCost + StoredMatls\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description AS ItemDescription,\n  SLWI.StoredMatls,\n  SLWI.WCCost AS WorkCompletedCost,\n  SLWI.StoredMatls + SLWI.WCCost AS TotalBillable,\n  SLWI.WCRetAmt AS WorkRetainage,\n  SLWI.SMRetAmt AS MaterialsRetainage,\n  SLWI.WCRetAmt + SLWI.SMRetAmt AS TotalRetainage\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\n  AND SLWI.StoredMatls <> 0\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "basic",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get job cost variance by phase comparing budget to actual\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Job cost variance by phase:\n1. Join JCJM (Job Master) to JCCP (Cost Phase)\n2. Calculate variance as CurrEstCost - ActualCost\n3. Calculate percent complete from actuals vs budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  JCCP.Phase,\n  JCCP.CostType,\n  JCCP.OrigEstCost AS OriginalBudget,\n  JCCP.CurrEstCost AS CurrentBudget,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS Variance,\n  CASE WHEN JCCP.CurrEstCost <> 0 \n       THEN (JCCP.ActualCost / JCCP.CurrEstCost) * 100 \n       ELSE 0 END AS PercentComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.Job = @Job\nORDER BY JCCP.Phase, JCCP.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from JCCD\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from JCCD ().\n\n```sql\nSELECT *\nFROM JCCD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from JCCD\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from JCCD ().\n\n```sql\nSELECT *\nFROM JCCD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find all unpaid AR invoices older than 60 days\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find unpaid invoices over 60 days:\n1. Join ARTH to ARCM for customer information\n2. Filter PayFullDate IS NULL (unpaid)\n3. Use DATEDIFF to calculate age and filter > 60 days\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Mth,\n  ARTH.ARTrans,\n  ARCM.Name AS CustomerName,\n  ARTH.TransDate,\n  ARTH.Amount,\n  DATEDIFF(day, ARTH.TransDate, GETDATE()) AS DaysOutstanding\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\n  AND DATEDIFF(day, ARTH.TransDate, GETDATE()) > 60\nORDER BY ARTH.TransDate\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from GLCO\n\nDatabase Schema:\nCREATE TABLE GLCO (\n  GLCo bcompany NOT NULL,\n  Consolid byn NOT NULL,\n  LastMthSubClsd bmonth NOT NULL,\n  LastMthGLClsd bmonth NOT NULL,\n  MaxOpen tinyint NOT NULL,\n  CashAccrual char(1) NOT NULL,\n  Unbal byn NOT NULL,\n  AuditCoParams byn NOT NULL,\n  AuditAccts byn NOT NULL,\n  AuditAutoJrnl byn NOT NULL,\n  AuditBals byn NOT NULL,\n  AuditBudgets byn NOT NULL,\n  AuditDetail byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  XCompJrnlEntryYN byn NOT NULL,\n  KeyID bigint NOT NULL,\n  LastMthAPClsd bmonth NOT NULL,\n  LastMthARClsd bmonth NOT NULL,\n  AttachBatchReportsYN byn NOT NULL,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from GLCO ().\n\n```sql\nSELECT *\nFROM GLCO WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "GLCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get job cost variance by phase comparing budget to actual\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Job cost variance by phase:\n1. Join JCJM (Job Master) to JCCP (Cost Phase)\n2. Calculate variance as CurrEstCost - ActualCost\n3. Calculate percent complete from actuals vs budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  JCCP.Phase,\n  JCCP.CostType,\n  JCCP.OrigEstCost AS OriginalBudget,\n  JCCP.CurrEstCost AS CurrentBudget,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS Variance,\n  CASE WHEN JCCP.CurrEstCost <> 0 \n       THEN (JCCP.ActualCost / JCCP.CurrEstCost) * 100 \n       ELSE 0 END AS PercentComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.Job = @Job\nORDER BY JCCP.Phase, JCCP.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from SLWI\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from SLWI ().\n\n```sql\nSELECT *\nFROM SLWI WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLWI"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find jobs over budget with remaining cost projection\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Find jobs over budget:\n1. Aggregate JCCP by job from JCJM\n2. Compare total ActualCost to CurrEstCost\n3. Use HAVING to filter only over-budget jobs\n4. Sort by amount over budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description,\n  SUM(JCCP.CurrEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.CurrEstCost) - SUM(JCCP.ActualCost) AS RemainingBudget,\n  CASE WHEN SUM(JCCP.CurrEstCost) < SUM(JCCP.ActualCost) \n       THEN 'OVER BUDGET' ELSE 'OK' END AS Status\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\nGROUP BY JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.CurrEstCost)\nORDER BY (SUM(JCCP.ActualCost) - SUM(JCCP.CurrEstCost)) DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM",
        "JCCD",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get subcontractor costs with original, change orders, invoiced, paid, and retainage by vendor\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Subcontractor cost breakdown by vendor:\n1. Join SLHD (Header) to SLIT (Items) for subcontract details\n2. Join APVM for vendor names\n3. OrigCost = original contract amount\n4. CurCost - OrigCost = change order amounts\n5. InvCost = amounts invoiced\n6. Retainage = amounts held back\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  SLHD.SL AS SubcontractNum,\n  SLHD.Description AS SubcontractDesc,\n  SUM(SLIT.OrigCost) AS OriginalCost,\n  SUM(SLIT.CurCost - SLIT.OrigCost) AS ChangeOrderCost,\n  SUM(SLIT.CurCost) AS CurrentCost,\n  SUM(SLIT.InvCost) AS InvoicedCost,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost - SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nINNER JOIN APVM WITH (NOLOCK) ON SLHD.VendorGroup = APVM.VendorGroup AND SLHD.Vendor = APVM.Vendor\nWHERE SLHD.SLCo = @SLCo\nGROUP BY APVM.Vendor, APVM.Name, SLHD.SL, SLHD.Description\nORDER BY APVM.Name, SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "basic",
      "tables_used": [
        "SLHD",
        "SLIT",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoice totals with discounts and retainage\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Vendor invoice summary with discounts and retainage:\n1. Join APTH to APVM for vendor details\n2. Aggregate by vendor\n3. Include GrossAmt, DiscOffer, Retainage, and Balance\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(APTH.APTrans) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS GrossAmount,\n  SUM(APTH.DiscOffer) AS DiscountsOffered,\n  SUM(APTH.Retainage) AS RetainageHeld,\n  SUM(APTH.Balance) AS OpenBalance\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from APTH\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from APTH ().\n\n```sql\nSELECT *\nFROM APTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query to count records in arth by company\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count ARTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM ARTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get subcontractor costs with original, change orders, invoiced, paid, and retainage by vendor\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Subcontractor cost breakdown by vendor:\n1. Join SLHD (Header) to SLIT (Items) for subcontract details\n2. Join APVM for vendor names\n3. OrigCost = original contract amount\n4. CurCost - OrigCost = change order amounts\n5. InvCost = amounts invoiced\n6. Retainage = amounts held back\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  SLHD.SL AS SubcontractNum,\n  SLHD.Description AS SubcontractDesc,\n  SUM(SLIT.OrigCost) AS OriginalCost,\n  SUM(SLIT.CurCost - SLIT.OrigCost) AS ChangeOrderCost,\n  SUM(SLIT.CurCost) AS CurrentCost,\n  SUM(SLIT.InvCost) AS InvoicedCost,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost - SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nINNER JOIN APVM WITH (NOLOCK) ON SLHD.VendorGroup = APVM.VendorGroup AND SLHD.Vendor = APVM.Vendor\nWHERE SLHD.SLCo = @SLCo\nGROUP BY APVM.Vendor, APVM.Name, SLHD.SL, SLHD.Description\nORDER BY APVM.Name, SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "intermediate",
      "tables_used": [
        "SLHD",
        "SLIT",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get job cost variance by phase comparing budget to actual\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Job cost variance by phase:\n1. Join JCJM (Job Master) to JCCP (Cost Phase)\n2. Calculate variance as CurrEstCost - ActualCost\n3. Calculate percent complete from actuals vs budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  JCCP.Phase,\n  JCCP.CostType,\n  JCCP.OrigEstCost AS OriginalBudget,\n  JCCP.CurrEstCost AS CurrentBudget,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS Variance,\n  CASE WHEN JCCP.CurrEstCost <> 0 \n       THEN (JCCP.ActualCost / JCCP.CurrEstCost) * 100 \n       ELSE 0 END AS PercentComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.Job = @Job\nORDER BY JCCP.Phase, JCCP.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to count records in prth by company\n\nDatabase Schema:\nCREATE TABLE PRTH (\n  PRCo bcompany NOT NULL,\n  PRGroup bgroup NOT NULL,\n  PREndDate bdate NOT NULL,\n  Employee bemployee NOT NULL,\n  PaySeq tinyint NOT NULL,\n  PostSeq smallint NOT NULL,\n  Type char(1) NOT NULL,\n  PostDate bdate NOT NULL,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCDept bdept,\n  GLCo bcompany NOT NULL,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equipment bequip,\n  EMGroup tinyint,\n  CostCode bcostcode,\n  -- ... 41 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count PRTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM PRTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "PRTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find all unpaid AR invoices older than 60 days\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find unpaid invoices over 60 days:\n1. Join ARTH to ARCM for customer information\n2. Filter PayFullDate IS NULL (unpaid)\n3. Use DATEDIFF to calculate age and filter > 60 days\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Mth,\n  ARTH.ARTrans,\n  ARCM.Name AS CustomerName,\n  ARTH.TransDate,\n  ARTH.Amount,\n  DATEDIFF(day, ARTH.TransDate, GETDATE()) AS DaysOutstanding\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\n  AND DATEDIFF(day, ARTH.TransDate, GETDATE()) > 60\nORDER BY ARTH.TransDate\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: count records in jccd by company\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count JCCD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM JCCD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from JCCD\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from JCCD ().\n\n```sql\nSELECT *\nFROM JCCD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoices with their subcontract details\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I can partially answer this query, but the schema is incomplete.\n\nTo include subcontract details, the SLHD table is needed but not provided in the schema.\n\nHere's what I can provide with the available schema:\n\n```sql\nSELECT *\nFROM APTH WITH (NOLOCK)\nWHERE Co = @Co\n-- Note: Additional joins for SLHD would be needed for complete results\n```\n\nTo get the complete data you requested, please provide the DDL for SLHD.",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": [
        "APTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find all unpaid AR invoices older than 60 days\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find unpaid invoices over 60 days:\n1. Join ARTH to ARCM for customer information\n2. Filter PayFullDate IS NULL (unpaid)\n3. Use DATEDIFF to calculate age and filter > 60 days\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Mth,\n  ARTH.ARTrans,\n  ARCM.Name AS CustomerName,\n  ARTH.TransDate,\n  ARTH.Amount,\n  DATEDIFF(day, ARTH.TransDate, GETDATE()) AS DaysOutstanding\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\n  AND DATEDIFF(day, ARTH.TransDate, GETDATE()) > 60\nORDER BY ARTH.TransDate\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: What is the schema for APInvoice?\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'APInvoice' does not exist in Viewpoint Vista.\n\nUse APTH (AP Transaction Header) for AP invoices.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM APTH WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoice totals with discounts and retainage\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Vendor invoice summary with discounts and retainage:\n1. Join APTH to APVM for vendor details\n2. Aggregate by vendor\n3. Include GrossAmt, DiscOffer, Retainage, and Balance\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(APTH.APTrans) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS GrossAmount,\n  SUM(APTH.DiscOffer) AS DiscountsOffered,\n  SUM(APTH.Retainage) AS RetainageHeld,\n  SUM(APTH.Balance) AS OpenBalance\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from GLDT\n\nDatabase Schema:\nCREATE TABLE GLDT (\n  GLCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  GLTrans btrans NOT NULL,\n  GLAcct bglacct NOT NULL,\n  Jrnl bjrnl NOT NULL,\n  GLRef bglref NOT NULL,\n  SourceCo bcompany NOT NULL,\n  Source bsource NOT NULL,\n  ActDate bdate NOT NULL,\n  DatePosted bdate NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid NOT NULL,\n  Amount bdollar NOT NULL,\n  RevStatus tinyint NOT NULL,\n  Adjust char(1) NOT NULL,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  UniqueAttchID uniqueidentifier,\n  SrcTable varchar(128),\n  SrcKeyID bigint,\n  PRIMARY KEY (GLCo, Mth, GLTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from GLDT ().\n\n```sql\nSELECT *\nFROM GLDT WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "GLDT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get subcontractor costs with original, change orders, invoiced, paid, and retainage by vendor\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Subcontractor cost breakdown by vendor:\n1. Join SLHD (Header) to SLIT (Items) for subcontract details\n2. Join APVM for vendor names\n3. OrigCost = original contract amount\n4. CurCost - OrigCost = change order amounts\n5. InvCost = amounts invoiced\n6. Retainage = amounts held back\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  SLHD.SL AS SubcontractNum,\n  SLHD.Description AS SubcontractDesc,\n  SUM(SLIT.OrigCost) AS OriginalCost,\n  SUM(SLIT.CurCost - SLIT.OrigCost) AS ChangeOrderCost,\n  SUM(SLIT.CurCost) AS CurrentCost,\n  SUM(SLIT.InvCost) AS InvoicedCost,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost - SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nINNER JOIN APVM WITH (NOLOCK) ON SLHD.VendorGroup = APVM.VendorGroup AND SLHD.Vendor = APVM.Vendor\nWHERE SLHD.SLCo = @SLCo\nGROUP BY APVM.Vendor, APVM.Name, SLHD.SL, SLHD.Description\nORDER BY APVM.Name, SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLHD",
        "SLIT",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find jobs over budget with remaining cost projection\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Find jobs over budget:\n1. Aggregate JCCP by job from JCJM\n2. Compare total ActualCost to CurrEstCost\n3. Use HAVING to filter only over-budget jobs\n4. Sort by amount over budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description,\n  SUM(JCCP.CurrEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.CurrEstCost) - SUM(JCCP.ActualCost) AS RemainingBudget,\n  CASE WHEN SUM(JCCP.CurrEstCost) < SUM(JCCP.ActualCost) \n       THEN 'OVER BUDGET' ELSE 'OK' END AS Status\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\nGROUP BY JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.CurrEstCost)\nORDER BY (SUM(JCCP.ActualCost) - SUM(JCCP.CurrEstCost)) DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCJM",
        "JCCD",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging buckets (30/60/90+ days) for unpaid invoices by customer\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Use ARTH for transaction data and ARCM for customer names\n2. Filter PayFullDate IS NULL to get only unpaid invoices\n3. Use DATEDIFF and CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How do I count records in arth by company\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count ARTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM ARTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from APTD\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from APTD ().\n\n```sql\nSELECT *\nFROM APTD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from SLWI\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from SLWI ().\n\n```sql\nSELECT *\nFROM SLWI WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "SLWI"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Include PREH in the query\n\nDatabase Schema:\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'PREH' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nSLHD, SLIT\n\nTo include PREH in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get customer balance summary by customer group\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Customer balance summary by group:\n1. Join ARTH to ARCM for customer details\n2. Use conditional SUM for open vs total balances\n3. Group by CustGroup for summary\n\n```sql\nSELECT \n  ARTH.CustGroup,\n  COUNT(DISTINCT ARTH.Customer) AS CustomerCount,\n  SUM(CASE WHEN ARTH.PayFullDate IS NULL THEN ARTH.Amount ELSE 0 END) AS OpenBalance,\n  SUM(ARTH.Amount) AS TotalBilled\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\nGROUP BY ARTH.CustGroup\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query to track ap hold status distinguishing retainage vs non-retainage holds\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APCO (\n  APCo bcompany NOT NULL,\n  GLCo bcompany NOT NULL,\n  ExpJrnl bjrnl,\n  GLExpInterfaceLvl tinyint NOT NULL,\n  GLExpSummaryDesc varchar(60),\n  GLExpTransDesc varchar(60),\n  GLJobDetailDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLEquipDetailDesc varchar(60),\n  GLExpDetailDesc varchar(60),\n  PayJrnl bjrnl,\n  GLPayInterfaceLvl tinyint NOT NULL,\n  GLPayDetailDesc varchar(60),\n  GLPaySummaryDesc varchar(60),\n  DiscOffGLAcct bglacct,\n  DiscTakenGLAcct bglacct,\n  ExpPayType tinyint,\n  JobPayType tinyint,\n  SubPayType tinyint,\n  RetPayType tinyint,\n  -- ... 92 more columns,\n  PRIMARY KEY (APCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To distinguish retainage vs non-retainage holds:\n1. Join APTD to APHD for hold details\n2. Join APCO to get RetHoldCode setting\n3. Compare APHD.HoldCode to APCO.RetHoldCode\n4. If equal, it's a retainage hold; otherwise non-retainage\n\n```sql\nSELECT \n  APTD.APCo,\n  APTD.Vendor,\n  APTD.Mth,\n  APTD.APTrans,\n  APHD.HoldCode,\n  CASE WHEN APHD.HoldCode = APCO.RetHoldCode \n       THEN 'Retainage Hold' \n       ELSE 'Non-Retainage Hold' END AS HoldType,\n  APTD.Amount\nFROM APTD WITH (NOLOCK)\nINNER JOIN APHD WITH (NOLOCK) ON APTD.APCo = APHD.APCo \n  AND APTD.Mth = APHD.Mth \n  AND APTD.APTrans = APHD.APTrans \n  AND APTD.APLine = APHD.APLine\nINNER JOIN APCO WITH (NOLOCK) ON APTD.APCo = APCO.APCo\nWHERE APTD.APCo = @APCo\n  AND APHD.HoldCode IS NOT NULL\nORDER BY APTD.Vendor, APTD.Mth\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "basic",
      "tables_used": [
        "APTD",
        "APHD",
        "APCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find jobs over budget with remaining cost projection\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Find jobs over budget:\n1. Aggregate JCCP by job from JCJM\n2. Compare total ActualCost to CurrEstCost\n3. Use HAVING to filter only over-budget jobs\n4. Sort by amount over budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description,\n  SUM(JCCP.CurrEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.CurrEstCost) - SUM(JCCP.ActualCost) AS RemainingBudget,\n  CASE WHEN SUM(JCCP.CurrEstCost) < SUM(JCCP.ActualCost) \n       THEN 'OVER BUDGET' ELSE 'OK' END AS Status\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\nGROUP BY JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.CurrEstCost)\nORDER BY (SUM(JCCP.ActualCost) - SUM(JCCP.CurrEstCost)) DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCJM",
        "JCCD",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoice totals with discounts and retainage\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Vendor invoice summary with discounts and retainage:\n1. Join APTH to APVM for vendor details\n2. Aggregate by vendor\n3. Include GrossAmt, DiscOffer, Retainage, and Balance\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(APTH.APTrans) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS GrossAmount,\n  SUM(APTH.DiscOffer) AS DiscountsOffered,\n  SUM(APTH.Retainage) AS RetainageHeld,\n  SUM(APTH.Balance) AS OpenBalance\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "basic",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to reconcile ap oncost batch lines with original transactions\n\nDatabase Schema:\nCREATE TABLE APTL (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equip bequip,\n  EMGroup bgroup,\n  -- ... 56 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans, APLine)\n);\n\nCREATE TABLE APLB (\n  Co bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  BatchId bbatchid NOT NULL,\n  BatchSeq int NOT NULL,\n  APLine smallint NOT NULL,\n  BatchTransType char(1) NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  -- ... 120 more columns,\n  PRIMARY KEY (Co, Mth, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APHB (\n  Co bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  BatchId bbatchid NOT NULL,\n  BatchSeq int NOT NULL,\n  BatchTransType char(1) NOT NULL,\n  APTrans btrans,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  -- ... 88 more columns,\n  PRIMARY KEY (Co, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To reconcile AP oncost batches with original transactions:\n1. Join APLB (batch lines) to APTL (original lines) using ocApplyMth, ocApplyTrans, ocApplyLine\n2. Include APHB for batch header info\n3. Join to APTH and APVM for vendor context\n4. Compare batch vs original amounts\n\n```sql\nSELECT \n  APLB.Co AS BatchCo,\n  APLB.Mth AS BatchMth,\n  APLB.BatchId,\n  APLB.BatchSeq,\n  APLB.ocApplyMth,\n  APLB.ocApplyTrans,\n  APLB.ocApplyLine,\n  APTL.APCo AS OrigCo,\n  APTL.Mth AS OrigMth,\n  APTL.APTrans AS OrigTrans,\n  APTL.APLine AS OrigLine,\n  APTL.GrossAmt AS OrigAmount,\n  APLB.GrossAmt AS BatchAmount,\n  APVM.Name AS VendorName\nFROM APLB WITH (NOLOCK)\nINNER JOIN APHB WITH (NOLOCK) ON APLB.Co = APHB.Co AND APLB.Mth = APHB.Mth AND APLB.BatchId = APHB.BatchId\nINNER JOIN APTL WITH (NOLOCK) ON APLB.ocApplyMth = APTL.Mth \n  AND APLB.ocApplyTrans = APTL.APTrans \n  AND APLB.ocApplyLine = APTL.APLine\n  AND APLB.Co = APTL.APCo\nINNER JOIN APTH WITH (NOLOCK) ON APTL.APCo = APTH.APCo AND APTL.Mth = APTH.Mth AND APTL.APTrans = APTH.APTrans\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APLB.Co = @Co\nORDER BY APLB.BatchId, APLB.BatchSeq\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "basic",
      "tables_used": [
        "APLB",
        "APHB",
        "APTL",
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How is EmployeeMaster structured?\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'EmployeeMaster' does not exist in Viewpoint Vista.\n\nUse PREH (PR Employee Header) for employee master information.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM PREH WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from Jobs\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'Jobs' does not exist in Viewpoint Vista.\n\nUse JCJM (JC Job Master) for job/project information.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM JCJM WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from ARTH\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from ARTH ().\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get job cost variance by phase comparing budget to actual\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Job cost variance by phase:\n1. Join JCJM (Job Master) to JCCP (Cost Phase)\n2. Calculate variance as CurrEstCost - ActualCost\n3. Calculate percent complete from actuals vs budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  JCCP.Phase,\n  JCCP.CostType,\n  JCCP.OrigEstCost AS OriginalBudget,\n  JCCP.CurrEstCost AS CurrentBudget,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS Variance,\n  CASE WHEN JCCP.CurrEstCost <> 0 \n       THEN (JCCP.ActualCost / JCCP.CurrEstCost) * 100 \n       ELSE 0 END AS PercentComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.Job = @Job\nORDER BY JCCP.Phase, JCCP.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: What columns are in the TimecardHeader table?\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'TimecardHeader' does not exist in Viewpoint Vista.\n\nUse PRTH (PR Timecard Header) for timecard headers.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM PRTH WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get subcontractor costs with original, change orders, invoiced, paid, and retainage by vendor\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Subcontractor cost breakdown by vendor:\n1. Join SLHD (Header) to SLIT (Items) for subcontract details\n2. Join APVM for vendor names\n3. OrigCost = original contract amount\n4. CurCost - OrigCost = change order amounts\n5. InvCost = amounts invoiced\n6. Retainage = amounts held back\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  SLHD.SL AS SubcontractNum,\n  SLHD.Description AS SubcontractDesc,\n  SUM(SLIT.OrigCost) AS OriginalCost,\n  SUM(SLIT.CurCost - SLIT.OrigCost) AS ChangeOrderCost,\n  SUM(SLIT.CurCost) AS CurrentCost,\n  SUM(SLIT.InvCost) AS InvoicedCost,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost - SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nINNER JOIN APVM WITH (NOLOCK) ON SLHD.VendorGroup = APVM.VendorGroup AND SLHD.Vendor = APVM.Vendor\nWHERE SLHD.SLCo = @SLCo\nGROUP BY APVM.Vendor, APVM.Name, SLHD.SL, SLHD.Description\nORDER BY APVM.Name, SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "intermediate",
      "tables_used": [
        "SLHD",
        "SLIT",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoice totals with discounts and retainage\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Vendor invoice summary with discounts and retainage:\n1. Join APTH to APVM for vendor details\n2. Aggregate by vendor\n3. Include GrossAmt, DiscOffer, Retainage, and Balance\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(APTH.APTrans) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS GrossAmount,\n  SUM(APTH.DiscOffer) AS DiscountsOffered,\n  SUM(APTH.Retainage) AS RetainageHeld,\n  SUM(APTH.Balance) AS OpenBalance\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate stored materials (Purchased - Installed) for SL billing\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Stored materials for SL billing:\n1. SLWI contains work item/billing details\n2. StoredMatls = Purchased - Installed (materials on-site but not yet used)\n3. WCCost = Work Completed Cost\n4. WCRetAmt and SMRetAmt = separate retainage for work vs materials\n5. Total billable = WCCost + StoredMatls\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description AS ItemDescription,\n  SLWI.StoredMatls,\n  SLWI.WCCost AS WorkCompletedCost,\n  SLWI.StoredMatls + SLWI.WCCost AS TotalBillable,\n  SLWI.WCRetAmt AS WorkRetainage,\n  SLWI.SMRetAmt AS MaterialsRetainage,\n  SLWI.WCRetAmt + SLWI.SMRetAmt AS TotalRetainage\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\n  AND SLWI.StoredMatls <> 0\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from PREH\n\nDatabase Schema:\nCREATE TABLE PREH (\n  PRCo bcompany NOT NULL,\n  Employee bemployee NOT NULL,\n  LastName varchar(30) NOT NULL,\n  FirstName varchar(30),\n  MidName varchar(15),\n  SortName bsortname NOT NULL,\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  Phone bphone,\n  SSN char(11) NOT NULL,\n  Race char(2) NOT NULL,\n  Sex char(1) NOT NULL,\n  BirthDate smalldatetime,\n  HireDate bdate,\n  TermDate bdate,\n  PRGroup bgroup NOT NULL,\n  PRDept bdept NOT NULL,\n  -- ... 121 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from PREH ().\n\n```sql\nSELECT *\nFROM PREH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "PREH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to count records in jccd by company\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count JCCD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM JCCD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get subcontractor costs with original, change orders, invoiced, paid, and retainage by vendor\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Subcontractor cost breakdown by vendor:\n1. Join SLHD (Header) to SLIT (Items) for subcontract details\n2. Join APVM for vendor names\n3. OrigCost = original contract amount\n4. CurCost - OrigCost = change order amounts\n5. InvCost = amounts invoiced\n6. Retainage = amounts held back\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  SLHD.SL AS SubcontractNum,\n  SLHD.Description AS SubcontractDesc,\n  SUM(SLIT.OrigCost) AS OriginalCost,\n  SUM(SLIT.CurCost - SLIT.OrigCost) AS ChangeOrderCost,\n  SUM(SLIT.CurCost) AS CurrentCost,\n  SUM(SLIT.InvCost) AS InvoicedCost,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost - SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nINNER JOIN APVM WITH (NOLOCK) ON SLHD.VendorGroup = APVM.VendorGroup AND SLHD.Vendor = APVM.Vendor\nWHERE SLHD.SLCo = @SLCo\nGROUP BY APVM.Vendor, APVM.Name, SLHD.SL, SLHD.Description\nORDER BY APVM.Name, SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "intermediate",
      "tables_used": [
        "SLHD",
        "SLIT",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get job cost variance by phase comparing budget to actual\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Job cost variance by phase:\n1. Join JCJM (Job Master) to JCCP (Cost Phase)\n2. Calculate variance as CurrEstCost - ActualCost\n3. Calculate percent complete from actuals vs budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  JCCP.Phase,\n  JCCP.CostType,\n  JCCP.OrigEstCost AS OriginalBudget,\n  JCCP.CurrEstCost AS CurrentBudget,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS Variance,\n  CASE WHEN JCCP.CurrEstCost <> 0 \n       THEN (JCCP.ActualCost / JCCP.CurrEstCost) * 100 \n       ELSE 0 END AS PercentComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.Job = @Job\nORDER BY JCCP.Phase, JCCP.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: count records in jccd by company\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count JCCD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM JCCD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need to aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging with customer contact information\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I can partially answer this query, but the schema is incomplete.\n\nThe query requires ARCM (AR Customer Master) for customer details, but only ARTH is provided in the schema.\n\nHere's what I can provide with the available schema:\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n-- Note: Additional joins for ARCM would be needed for complete results\n```\n\nTo get the complete data you requested, please provide the DDL for ARCM.",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging with customer contact information\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I can partially answer this query, but the schema is incomplete.\n\nThe query requires ARCM (AR Customer Master) for customer details, but only ARTH is provided in the schema.\n\nHere's what I can provide with the available schema:\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n-- Note: Additional joins for ARCM would be needed for complete results\n```\n\nTo get the complete data you requested, please provide the DDL for ARCM.",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate stored materials (Purchased - Installed) for SL billing\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Stored materials for SL billing:\n1. SLWI contains work item/billing details\n2. StoredMatls = Purchased - Installed (materials on-site but not yet used)\n3. WCCost = Work Completed Cost\n4. WCRetAmt and SMRetAmt = separate retainage for work vs materials\n5. Total billable = WCCost + StoredMatls\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description AS ItemDescription,\n  SLWI.StoredMatls,\n  SLWI.WCCost AS WorkCompletedCost,\n  SLWI.StoredMatls + SLWI.WCCost AS TotalBillable,\n  SLWI.WCRetAmt AS WorkRetainage,\n  SLWI.SMRetAmt AS MaterialsRetainage,\n  SLWI.WCRetAmt + SLWI.SMRetAmt AS TotalRetainage\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\n  AND SLWI.StoredMatls <> 0\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "basic",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get data from GLDT for analysis\n\nDatabase Schema:\nCREATE TABLE PREH (\n  PRCo bcompany NOT NULL,\n  Employee bemployee NOT NULL,\n  LastName varchar(30) NOT NULL,\n  FirstName varchar(30),\n  MidName varchar(15),\n  SortName bsortname NOT NULL,\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  Phone bphone,\n  SSN char(11) NOT NULL,\n  Race char(2) NOT NULL,\n  Sex char(1) NOT NULL,\n  BirthDate smalldatetime,\n  HireDate bdate,\n  TermDate bdate,\n  PRGroup bgroup NOT NULL,\n  PRDept bdept NOT NULL,\n  -- ... 121 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nCREATE TABLE PRTH (\n  PRCo bcompany NOT NULL,\n  PRGroup bgroup NOT NULL,\n  PREndDate bdate NOT NULL,\n  Employee bemployee NOT NULL,\n  PaySeq tinyint NOT NULL,\n  PostSeq smallint NOT NULL,\n  Type char(1) NOT NULL,\n  PostDate bdate NOT NULL,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCDept bdept,\n  GLCo bcompany NOT NULL,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equipment bequip,\n  EMGroup tinyint,\n  CostCode bcostcode,\n  -- ... 41 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'GLDT' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nPREH, PRTH\n\nTo include GLDT in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need to count records in preh by company\n\nDatabase Schema:\nCREATE TABLE PREH (\n  PRCo bcompany NOT NULL,\n  Employee bemployee NOT NULL,\n  LastName varchar(30) NOT NULL,\n  FirstName varchar(30),\n  MidName varchar(15),\n  SortName bsortname NOT NULL,\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  Phone bphone,\n  SSN char(11) NOT NULL,\n  Race char(2) NOT NULL,\n  Sex char(1) NOT NULL,\n  BirthDate smalldatetime,\n  HireDate bdate,\n  TermDate bdate,\n  PRGroup bgroup NOT NULL,\n  PRDept bdept NOT NULL,\n  -- ... 121 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count PREH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM PREH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "PREH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging with customer contact information\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I can partially answer this query, but the schema is incomplete.\n\nThe query requires ARCM (AR Customer Master) for customer details, but only ARTH is provided in the schema.\n\nHere's what I can provide with the available schema:\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n-- Note: Additional joins for ARCM would be needed for complete results\n```\n\nTo get the complete data you requested, please provide the DDL for ARCM.",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to track ap hold status distinguishing retainage vs non-retainage holds\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APCO (\n  APCo bcompany NOT NULL,\n  GLCo bcompany NOT NULL,\n  ExpJrnl bjrnl,\n  GLExpInterfaceLvl tinyint NOT NULL,\n  GLExpSummaryDesc varchar(60),\n  GLExpTransDesc varchar(60),\n  GLJobDetailDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLEquipDetailDesc varchar(60),\n  GLExpDetailDesc varchar(60),\n  PayJrnl bjrnl,\n  GLPayInterfaceLvl tinyint NOT NULL,\n  GLPayDetailDesc varchar(60),\n  GLPaySummaryDesc varchar(60),\n  DiscOffGLAcct bglacct,\n  DiscTakenGLAcct bglacct,\n  ExpPayType tinyint,\n  JobPayType tinyint,\n  SubPayType tinyint,\n  RetPayType tinyint,\n  -- ... 92 more columns,\n  PRIMARY KEY (APCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To distinguish retainage vs non-retainage holds:\n1. Join APTD to APHD for hold details\n2. Join APCO to get RetHoldCode setting\n3. Compare APHD.HoldCode to APCO.RetHoldCode\n4. If equal, it's a retainage hold; otherwise non-retainage\n\n```sql\nSELECT \n  APTD.APCo,\n  APTD.Vendor,\n  APTD.Mth,\n  APTD.APTrans,\n  APHD.HoldCode,\n  CASE WHEN APHD.HoldCode = APCO.RetHoldCode \n       THEN 'Retainage Hold' \n       ELSE 'Non-Retainage Hold' END AS HoldType,\n  APTD.Amount\nFROM APTD WITH (NOLOCK)\nINNER JOIN APHD WITH (NOLOCK) ON APTD.APCo = APHD.APCo \n  AND APTD.Mth = APHD.Mth \n  AND APTD.APTrans = APHD.APTrans \n  AND APTD.APLine = APHD.APLine\nINNER JOIN APCO WITH (NOLOCK) ON APTD.APCo = APCO.APCo\nWHERE APTD.APCo = @APCo\n  AND APHD.HoldCode IS NOT NULL\nORDER BY APTD.Vendor, APTD.Mth\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTD",
        "APHD",
        "APCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to count records in prpc by company\n\nDatabase Schema:\nCREATE TABLE PRPC (\n  PRCo bcompany NOT NULL,\n  PRGroup bgroup NOT NULL,\n  PREndDate bdate NOT NULL,\n  BeginDate bdate NOT NULL,\n  MultiMth byn NOT NULL,\n  BeginMth bmonth NOT NULL,\n  EndMth bmonth,\n  CutoffDate bdate,\n  LimitMth bmonth NOT NULL,\n  Hrs smallint NOT NULL,\n  Days tinyint NOT NULL,\n  Wks tinyint NOT NULL,\n  Status tinyint NOT NULL,\n  DateClosed smalldatetime,\n  JCInterface byn NOT NULL,\n  EMInterface byn NOT NULL,\n  GLInterface byn NOT NULL,\n  APInterface byn NOT NULL,\n  LeaveProcess byn NOT NULL,\n  InUseBy bvpusername,\n  -- ... 7 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count PRPC records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM PRPC WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "PRPC"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: What is the schema for TimeCards?\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'TimeCards' does not exist in Viewpoint Vista.\n\nUse PRTH (PR Timecard Header) for timecard information.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM PRTH WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to count records in jccd by company\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count JCCD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM JCCD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get job cost variance by phase comparing budget to actual\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Job cost variance by phase:\n1. Join JCJM (Job Master) to JCCP (Cost Phase)\n2. Calculate variance as CurrEstCost - ActualCost\n3. Calculate percent complete from actuals vs budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  JCCP.Phase,\n  JCCP.CostType,\n  JCCP.OrigEstCost AS OriginalBudget,\n  JCCP.CurrEstCost AS CurrentBudget,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS Variance,\n  CASE WHEN JCCP.CurrEstCost <> 0 \n       THEN (JCCP.ActualCost / JCCP.CurrEstCost) * 100 \n       ELSE 0 END AS PercentComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.Job = @Job\nORDER BY JCCP.Phase, JCCP.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: What columns are in the Vendors table?\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'Vendors' does not exist in Viewpoint Vista.\n\nUse APVM (AP Vendor Master) for vendor information. Vista uses abbreviated table names.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM APVM WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from PRPC\n\nDatabase Schema:\nCREATE TABLE PRPC (\n  PRCo bcompany NOT NULL,\n  PRGroup bgroup NOT NULL,\n  PREndDate bdate NOT NULL,\n  BeginDate bdate NOT NULL,\n  MultiMth byn NOT NULL,\n  BeginMth bmonth NOT NULL,\n  EndMth bmonth,\n  CutoffDate bdate,\n  LimitMth bmonth NOT NULL,\n  Hrs smallint NOT NULL,\n  Days tinyint NOT NULL,\n  Wks tinyint NOT NULL,\n  Status tinyint NOT NULL,\n  DateClosed smalldatetime,\n  JCInterface byn NOT NULL,\n  EMInterface byn NOT NULL,\n  GLInterface byn NOT NULL,\n  APInterface byn NOT NULL,\n  LeaveProcess byn NOT NULL,\n  InUseBy bvpusername,\n  -- ... 7 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from PRPC ().\n\n```sql\nSELECT *\nFROM PRPC WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "PRPC"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query to track ap hold status distinguishing retainage vs non-retainage holds\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APCO (\n  APCo bcompany NOT NULL,\n  GLCo bcompany NOT NULL,\n  ExpJrnl bjrnl,\n  GLExpInterfaceLvl tinyint NOT NULL,\n  GLExpSummaryDesc varchar(60),\n  GLExpTransDesc varchar(60),\n  GLJobDetailDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLEquipDetailDesc varchar(60),\n  GLExpDetailDesc varchar(60),\n  PayJrnl bjrnl,\n  GLPayInterfaceLvl tinyint NOT NULL,\n  GLPayDetailDesc varchar(60),\n  GLPaySummaryDesc varchar(60),\n  DiscOffGLAcct bglacct,\n  DiscTakenGLAcct bglacct,\n  ExpPayType tinyint,\n  JobPayType tinyint,\n  SubPayType tinyint,\n  RetPayType tinyint,\n  -- ... 92 more columns,\n  PRIMARY KEY (APCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To distinguish retainage vs non-retainage holds:\n1. Join APTD to APHD for hold details\n2. Join APCO to get RetHoldCode setting\n3. Compare APHD.HoldCode to APCO.RetHoldCode\n4. If equal, it's a retainage hold; otherwise non-retainage\n\n```sql\nSELECT \n  APTD.APCo,\n  APTD.Vendor,\n  APTD.Mth,\n  APTD.APTrans,\n  APHD.HoldCode,\n  CASE WHEN APHD.HoldCode = APCO.RetHoldCode \n       THEN 'Retainage Hold' \n       ELSE 'Non-Retainage Hold' END AS HoldType,\n  APTD.Amount\nFROM APTD WITH (NOLOCK)\nINNER JOIN APHD WITH (NOLOCK) ON APTD.APCo = APHD.APCo \n  AND APTD.Mth = APHD.Mth \n  AND APTD.APTrans = APHD.APTrans \n  AND APTD.APLine = APHD.APLine\nINNER JOIN APCO WITH (NOLOCK) ON APTD.APCo = APCO.APCo\nWHERE APTD.APCo = @APCo\n  AND APHD.HoldCode IS NOT NULL\nORDER BY APTD.Vendor, APTD.Mth\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTD",
        "APHD",
        "APCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: count records in arth by company\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count ARTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM ARTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoices with their subcontract details\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I can partially answer this query, but the schema is incomplete.\n\nTo include subcontract details, the SLHD table is needed but not provided in the schema.\n\nHere's what I can provide with the available schema:\n\n```sql\nSELECT *\nFROM APTH WITH (NOLOCK)\nWHERE Co = @Co\n-- Note: Additional joins for SLHD would be needed for complete results\n```\n\nTo get the complete data you requested, please provide the DDL for SLHD.",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": [
        "APTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get subcontractor costs with original, change orders, invoiced, paid, and retainage by vendor\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Subcontractor cost breakdown by vendor:\n1. Join SLHD (Header) to SLIT (Items) for subcontract details\n2. Join APVM for vendor names\n3. OrigCost = original contract amount\n4. CurCost - OrigCost = change order amounts\n5. InvCost = amounts invoiced\n6. Retainage = amounts held back\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  SLHD.SL AS SubcontractNum,\n  SLHD.Description AS SubcontractDesc,\n  SUM(SLIT.OrigCost) AS OriginalCost,\n  SUM(SLIT.CurCost - SLIT.OrigCost) AS ChangeOrderCost,\n  SUM(SLIT.CurCost) AS CurrentCost,\n  SUM(SLIT.InvCost) AS InvoicedCost,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost - SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nINNER JOIN APVM WITH (NOLOCK) ON SLHD.VendorGroup = APVM.VendorGroup AND SLHD.Vendor = APVM.Vendor\nWHERE SLHD.SLCo = @SLCo\nGROUP BY APVM.Vendor, APVM.Name, SLHD.SL, SLHD.Description\nORDER BY APVM.Name, SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "basic",
      "tables_used": [
        "SLHD",
        "SLIT",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get job cost variance by phase comparing budget to actual\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Job cost variance by phase:\n1. Join JCJM (Job Master) to JCCP (Cost Phase)\n2. Calculate variance as CurrEstCost - ActualCost\n3. Calculate percent complete from actuals vs budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  JCCP.Phase,\n  JCCP.CostType,\n  JCCP.OrigEstCost AS OriginalBudget,\n  JCCP.CurrEstCost AS CurrentBudget,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS Variance,\n  CASE WHEN JCCP.CurrEstCost <> 0 \n       THEN (JCCP.ActualCost / JCCP.CurrEstCost) * 100 \n       ELSE 0 END AS PercentComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.Job = @Job\nORDER BY JCCP.Phase, JCCP.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How do I aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How do I count records in gljr by company\n\nDatabase Schema:\nCREATE TABLE GLJR (\n  GLCo bcompany NOT NULL,\n  Jrnl bjrnl NOT NULL,\n  Description btransdesc,\n  Rev byn NOT NULL,\n  RevJrnl bjrnl,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count GLJR records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM GLJR WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "GLJR"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to count records in jccd by company\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count JCCD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM JCCD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get subcontractor costs with original, change orders, invoiced, paid, and retainage by vendor\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Subcontractor cost breakdown by vendor:\n1. Join SLHD (Header) to SLIT (Items) for subcontract details\n2. Join APVM for vendor names\n3. OrigCost = original contract amount\n4. CurCost - OrigCost = change order amounts\n5. InvCost = amounts invoiced\n6. Retainage = amounts held back\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  SLHD.SL AS SubcontractNum,\n  SLHD.Description AS SubcontractDesc,\n  SUM(SLIT.OrigCost) AS OriginalCost,\n  SUM(SLIT.CurCost - SLIT.OrigCost) AS ChangeOrderCost,\n  SUM(SLIT.CurCost) AS CurrentCost,\n  SUM(SLIT.InvCost) AS InvoicedCost,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost - SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nINNER JOIN APVM WITH (NOLOCK) ON SLHD.VendorGroup = APVM.VendorGroup AND SLHD.Vendor = APVM.Vendor\nWHERE SLHD.SLCo = @SLCo\nGROUP BY APVM.Vendor, APVM.Name, SLHD.SL, SLHD.Description\nORDER BY APVM.Name, SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "intermediate",
      "tables_used": [
        "SLHD",
        "SLIT",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to join PREH with the available tables\n\nDatabase Schema:\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'PREH' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nSLHD, SLIT\n\nTo include PREH in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query to count records in gldt by company\n\nDatabase Schema:\nCREATE TABLE GLDT (\n  GLCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  GLTrans btrans NOT NULL,\n  GLAcct bglacct NOT NULL,\n  Jrnl bjrnl NOT NULL,\n  GLRef bglref NOT NULL,\n  SourceCo bcompany NOT NULL,\n  Source bsource NOT NULL,\n  ActDate bdate NOT NULL,\n  DatePosted bdate NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid NOT NULL,\n  Amount bdollar NOT NULL,\n  RevStatus tinyint NOT NULL,\n  Adjust char(1) NOT NULL,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  UniqueAttchID uniqueidentifier,\n  SrcTable varchar(128),\n  SrcKeyID bigint,\n  PRIMARY KEY (GLCo, Mth, GLTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count GLDT records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM GLDT WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "GLDT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from PRCO\n\nDatabase Schema:\nCREATE TABLE PRCO (\n  PRCo bcompany NOT NULL,\n  GLCo bcompany NOT NULL,\n  Jrnl bjrnl,\n  GLInterface byn NOT NULL,\n  CMCo bcompany NOT NULL,\n  APCo bcompany,\n  AutoOT byn NOT NULL,\n  OTEarnCode bedlcode,\n  JCCo bcompany NOT NULL,\n  AllowNoPhase byn NOT NULL,\n  JCInterface byn NOT NULL,\n  InsByPhase byn NOT NULL,\n  JCICraftClass byn NOT NULL,\n  JCICrew byn NOT NULL,\n  JCIEmployee byn NOT NULL,\n  JCIFactor byn NOT NULL,\n  JCIEarnType byn NOT NULL,\n  JCIShift byn NOT NULL,\n  JCIPostingDate byn NOT NULL,\n  JCILiabType byn NOT NULL,\n  -- ... 66 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from PRCO ().\n\n```sql\nSELECT *\nFROM PRCO WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "PRCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate stored materials (Purchased - Installed) for SL billing\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Stored materials for SL billing:\n1. SLWI contains work item/billing details\n2. StoredMatls = Purchased - Installed (materials on-site but not yet used)\n3. WCCost = Work Completed Cost\n4. WCRetAmt and SMRetAmt = separate retainage for work vs materials\n5. Total billable = WCCost + StoredMatls\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description AS ItemDescription,\n  SLWI.StoredMatls,\n  SLWI.WCCost AS WorkCompletedCost,\n  SLWI.StoredMatls + SLWI.WCCost AS TotalBillable,\n  SLWI.WCRetAmt AS WorkRetainage,\n  SLWI.SMRetAmt AS MaterialsRetainage,\n  SLWI.WCRetAmt + SLWI.SMRetAmt AS TotalRetainage\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\n  AND SLWI.StoredMatls <> 0\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find all unpaid AR invoices older than 60 days\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find unpaid invoices over 60 days:\n1. Join ARTH to ARCM for customer information\n2. Filter PayFullDate IS NULL (unpaid)\n3. Use DATEDIFF to calculate age and filter > 60 days\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Mth,\n  ARTH.ARTrans,\n  ARCM.Name AS CustomerName,\n  ARTH.TransDate,\n  ARTH.Amount,\n  DATEDIFF(day, ARTH.TransDate, GETDATE()) AS DaysOutstanding\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\n  AND DATEDIFF(day, ARTH.TransDate, GETDATE()) > 60\nORDER BY ARTH.TransDate\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How do I count records in prco by company\n\nDatabase Schema:\nCREATE TABLE PRCO (\n  PRCo bcompany NOT NULL,\n  GLCo bcompany NOT NULL,\n  Jrnl bjrnl,\n  GLInterface byn NOT NULL,\n  CMCo bcompany NOT NULL,\n  APCo bcompany,\n  AutoOT byn NOT NULL,\n  OTEarnCode bedlcode,\n  JCCo bcompany NOT NULL,\n  AllowNoPhase byn NOT NULL,\n  JCInterface byn NOT NULL,\n  InsByPhase byn NOT NULL,\n  JCICraftClass byn NOT NULL,\n  JCICrew byn NOT NULL,\n  JCIEmployee byn NOT NULL,\n  JCIFactor byn NOT NULL,\n  JCIEarnType byn NOT NULL,\n  JCIShift byn NOT NULL,\n  JCIPostingDate byn NOT NULL,\n  JCILiabType byn NOT NULL,\n  -- ... 66 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count PRCO records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM PRCO WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "PRCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need to reconcile ap oncost batch lines with original transactions\n\nDatabase Schema:\nCREATE TABLE APTL (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equip bequip,\n  EMGroup bgroup,\n  -- ... 56 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans, APLine)\n);\n\nCREATE TABLE APLB (\n  Co bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  BatchId bbatchid NOT NULL,\n  BatchSeq int NOT NULL,\n  APLine smallint NOT NULL,\n  BatchTransType char(1) NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  -- ... 120 more columns,\n  PRIMARY KEY (Co, Mth, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APHB (\n  Co bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  BatchId bbatchid NOT NULL,\n  BatchSeq int NOT NULL,\n  BatchTransType char(1) NOT NULL,\n  APTrans btrans,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  -- ... 88 more columns,\n  PRIMARY KEY (Co, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To reconcile AP oncost batches with original transactions:\n1. Join APLB (batch lines) to APTL (original lines) using ocApplyMth, ocApplyTrans, ocApplyLine\n2. Include APHB for batch header info\n3. Join to APTH and APVM for vendor context\n4. Compare batch vs original amounts\n\n```sql\nSELECT \n  APLB.Co AS BatchCo,\n  APLB.Mth AS BatchMth,\n  APLB.BatchId,\n  APLB.BatchSeq,\n  APLB.ocApplyMth,\n  APLB.ocApplyTrans,\n  APLB.ocApplyLine,\n  APTL.APCo AS OrigCo,\n  APTL.Mth AS OrigMth,\n  APTL.APTrans AS OrigTrans,\n  APTL.APLine AS OrigLine,\n  APTL.GrossAmt AS OrigAmount,\n  APLB.GrossAmt AS BatchAmount,\n  APVM.Name AS VendorName\nFROM APLB WITH (NOLOCK)\nINNER JOIN APHB WITH (NOLOCK) ON APLB.Co = APHB.Co AND APLB.Mth = APHB.Mth AND APLB.BatchId = APHB.BatchId\nINNER JOIN APTL WITH (NOLOCK) ON APLB.ocApplyMth = APTL.Mth \n  AND APLB.ocApplyTrans = APTL.APTrans \n  AND APLB.ocApplyLine = APTL.APLine\n  AND APLB.Co = APTL.APCo\nINNER JOIN APTH WITH (NOLOCK) ON APTL.APCo = APTH.APCo AND APTL.Mth = APTH.Mth AND APTL.APTrans = APTH.APTrans\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APLB.Co = @Co\nORDER BY APLB.BatchId, APLB.BatchSeq\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APLB",
        "APHB",
        "APTL",
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to count records in arth by company\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count ARTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM ARTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get subcontractor costs with original, change orders, invoiced, paid, and retainage by vendor\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Subcontractor cost breakdown by vendor:\n1. Join SLHD (Header) to SLIT (Items) for subcontract details\n2. Join APVM for vendor names\n3. OrigCost = original contract amount\n4. CurCost - OrigCost = change order amounts\n5. InvCost = amounts invoiced\n6. Retainage = amounts held back\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  SLHD.SL AS SubcontractNum,\n  SLHD.Description AS SubcontractDesc,\n  SUM(SLIT.OrigCost) AS OriginalCost,\n  SUM(SLIT.CurCost - SLIT.OrigCost) AS ChangeOrderCost,\n  SUM(SLIT.CurCost) AS CurrentCost,\n  SUM(SLIT.InvCost) AS InvoicedCost,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost - SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nINNER JOIN APVM WITH (NOLOCK) ON SLHD.VendorGroup = APVM.VendorGroup AND SLHD.Vendor = APVM.Vendor\nWHERE SLHD.SLCo = @SLCo\nGROUP BY APVM.Vendor, APVM.Name, SLHD.SL, SLHD.Description\nORDER BY APVM.Name, SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLHD",
        "SLIT",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query to count records in jccd by company\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count JCCD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM JCCD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to count records in glac by company\n\nDatabase Schema:\nCREATE TABLE GLAC (\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  Description bdesc,\n  AcctType char(1) NOT NULL,\n  SubType char(1),\n  NormBal char(1),\n  InterfaceDetail byn NOT NULL,\n  Active byn NOT NULL,\n  SummaryAcct bglacct NOT NULL,\n  CashAccrual char(1) NOT NULL,\n  CashOffAcct bglacct,\n  Notes varchar,\n  Part1 varchar(20),\n  Part2 varchar(20),\n  Part3 varchar(20),\n  Part4 varchar(20),\n  Part5 varchar(20),\n  Part6 varchar(20),\n  AllParts varchar(20),\n  CrossRefMemAcct bglacct,\n  -- ... 3 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count GLAC records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM GLAC WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "GLAC"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get job cost variance by phase comparing budget to actual\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Job cost variance by phase:\n1. Join JCJM (Job Master) to JCCP (Cost Phase)\n2. Calculate variance as CurrEstCost - ActualCost\n3. Calculate percent complete from actuals vs budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  JCCP.Phase,\n  JCCP.CostType,\n  JCCP.OrigEstCost AS OriginalBudget,\n  JCCP.CurrEstCost AS CurrentBudget,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS Variance,\n  CASE WHEN JCCP.CurrEstCost <> 0 \n       THEN (JCCP.ActualCost / JCCP.CurrEstCost) * 100 \n       ELSE 0 END AS PercentComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.Job = @Job\nORDER BY JCCP.Phase, JCCP.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from PRPC\n\nDatabase Schema:\nCREATE TABLE PRPC (\n  PRCo bcompany NOT NULL,\n  PRGroup bgroup NOT NULL,\n  PREndDate bdate NOT NULL,\n  BeginDate bdate NOT NULL,\n  MultiMth byn NOT NULL,\n  BeginMth bmonth NOT NULL,\n  EndMth bmonth,\n  CutoffDate bdate,\n  LimitMth bmonth NOT NULL,\n  Hrs smallint NOT NULL,\n  Days tinyint NOT NULL,\n  Wks tinyint NOT NULL,\n  Status tinyint NOT NULL,\n  DateClosed smalldatetime,\n  JCInterface byn NOT NULL,\n  EMInterface byn NOT NULL,\n  GLInterface byn NOT NULL,\n  APInterface byn NOT NULL,\n  LeaveProcess byn NOT NULL,\n  InUseBy bvpusername,\n  -- ... 7 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from PRPC ().\n\n```sql\nSELECT *\nFROM PRPC WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "PRPC"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging buckets (30/60/90+ days) for unpaid invoices by customer\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Use ARTH for transaction data and ARCM for customer names\n2. Filter PayFullDate IS NULL to get only unpaid invoices\n3. Use DATEDIFF and CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get customer balance summary by customer group\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Customer balance summary by group:\n1. Join ARTH to ARCM for customer details\n2. Use conditional SUM for open vs total balances\n3. Group by CustGroup for summary\n\n```sql\nSELECT \n  ARTH.CustGroup,\n  COUNT(DISTINCT ARTH.Customer) AS CustomerCount,\n  SUM(CASE WHEN ARTH.PayFullDate IS NULL THEN ARTH.Amount ELSE 0 END) AS OpenBalance,\n  SUM(ARTH.Amount) AS TotalBilled\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\nGROUP BY ARTH.CustGroup\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from JCCD\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from JCCD ().\n\n```sql\nSELECT *\nFROM JCCD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from GLDT\n\nDatabase Schema:\nCREATE TABLE GLDT (\n  GLCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  GLTrans btrans NOT NULL,\n  GLAcct bglacct NOT NULL,\n  Jrnl bjrnl NOT NULL,\n  GLRef bglref NOT NULL,\n  SourceCo bcompany NOT NULL,\n  Source bsource NOT NULL,\n  ActDate bdate NOT NULL,\n  DatePosted bdate NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid NOT NULL,\n  Amount bdollar NOT NULL,\n  RevStatus tinyint NOT NULL,\n  Adjust char(1) NOT NULL,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  UniqueAttchID uniqueidentifier,\n  SrcTable varchar(128),\n  SrcKeyID bigint,\n  PRIMARY KEY (GLCo, Mth, GLTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from GLDT ().\n\n```sql\nSELECT *\nFROM GLDT WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "GLDT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Query ARCM along with the schema tables\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'ARCM' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nAPTH, APVM\n\nTo include ARCM in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get subcontractor costs with original, change orders, invoiced, paid, and retainage by vendor\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Subcontractor cost breakdown by vendor:\n1. Join SLHD (Header) to SLIT (Items) for subcontract details\n2. Join APVM for vendor names\n3. OrigCost = original contract amount\n4. CurCost - OrigCost = change order amounts\n5. InvCost = amounts invoiced\n6. Retainage = amounts held back\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  SLHD.SL AS SubcontractNum,\n  SLHD.Description AS SubcontractDesc,\n  SUM(SLIT.OrigCost) AS OriginalCost,\n  SUM(SLIT.CurCost - SLIT.OrigCost) AS ChangeOrderCost,\n  SUM(SLIT.CurCost) AS CurrentCost,\n  SUM(SLIT.InvCost) AS InvoicedCost,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost - SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nINNER JOIN APVM WITH (NOLOCK) ON SLHD.VendorGroup = APVM.VendorGroup AND SLHD.Vendor = APVM.Vendor\nWHERE SLHD.SLCo = @SLCo\nGROUP BY APVM.Vendor, APVM.Name, SLHD.SL, SLHD.Description\nORDER BY APVM.Name, SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLHD",
        "SLIT",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to count records in arth by company\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count ARTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM ARTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to query TimeCards\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'TimeCards' does not exist in Viewpoint Vista.\n\nUse PRTH (PR Timecard Header) for timecard information.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM PRTH WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: count records in slhd by company\n\nDatabase Schema:\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count SLHD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM SLHD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "SLHD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from PRTD\n\nDatabase Schema:\nCREATE TABLE PRTD (\n  PRCo bcompany NOT NULL,\n  Craft bcraft NOT NULL,\n  Class bclass NOT NULL,\n  Template smallint NOT NULL,\n  DLCode bedlcode NOT NULL,\n  Factor brate NOT NULL,\n  OldRate bunitcost NOT NULL,\n  NewRate bunitcost NOT NULL,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from PRTD ().\n\n```sql\nSELECT *\nFROM PRTD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "PRTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query to reconcile ap oncost batch lines with original transactions\n\nDatabase Schema:\nCREATE TABLE APTL (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equip bequip,\n  EMGroup bgroup,\n  -- ... 56 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans, APLine)\n);\n\nCREATE TABLE APLB (\n  Co bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  BatchId bbatchid NOT NULL,\n  BatchSeq int NOT NULL,\n  APLine smallint NOT NULL,\n  BatchTransType char(1) NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  -- ... 120 more columns,\n  PRIMARY KEY (Co, Mth, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APHB (\n  Co bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  BatchId bbatchid NOT NULL,\n  BatchSeq int NOT NULL,\n  BatchTransType char(1) NOT NULL,\n  APTrans btrans,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  -- ... 88 more columns,\n  PRIMARY KEY (Co, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To reconcile AP oncost batches with original transactions:\n1. Join APLB (batch lines) to APTL (original lines) using ocApplyMth, ocApplyTrans, ocApplyLine\n2. Include APHB for batch header info\n3. Join to APTH and APVM for vendor context\n4. Compare batch vs original amounts\n\n```sql\nSELECT \n  APLB.Co AS BatchCo,\n  APLB.Mth AS BatchMth,\n  APLB.BatchId,\n  APLB.BatchSeq,\n  APLB.ocApplyMth,\n  APLB.ocApplyTrans,\n  APLB.ocApplyLine,\n  APTL.APCo AS OrigCo,\n  APTL.Mth AS OrigMth,\n  APTL.APTrans AS OrigTrans,\n  APTL.APLine AS OrigLine,\n  APTL.GrossAmt AS OrigAmount,\n  APLB.GrossAmt AS BatchAmount,\n  APVM.Name AS VendorName\nFROM APLB WITH (NOLOCK)\nINNER JOIN APHB WITH (NOLOCK) ON APLB.Co = APHB.Co AND APLB.Mth = APHB.Mth AND APLB.BatchId = APHB.BatchId\nINNER JOIN APTL WITH (NOLOCK) ON APLB.ocApplyMth = APTL.Mth \n  AND APLB.ocApplyTrans = APTL.APTrans \n  AND APLB.ocApplyLine = APTL.APLine\n  AND APLB.Co = APTL.APCo\nINNER JOIN APTH WITH (NOLOCK) ON APTL.APCo = APTH.APCo AND APTL.Mth = APTH.Mth AND APTL.APTrans = APTH.APTrans\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APLB.Co = @Co\nORDER BY APLB.BatchId, APLB.BatchSeq\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APLB",
        "APHB",
        "APTL",
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get data from GLDT for analysis\n\nDatabase Schema:\nCREATE TABLE PREH (\n  PRCo bcompany NOT NULL,\n  Employee bemployee NOT NULL,\n  LastName varchar(30) NOT NULL,\n  FirstName varchar(30),\n  MidName varchar(15),\n  SortName bsortname NOT NULL,\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  Phone bphone,\n  SSN char(11) NOT NULL,\n  Race char(2) NOT NULL,\n  Sex char(1) NOT NULL,\n  BirthDate smalldatetime,\n  HireDate bdate,\n  TermDate bdate,\n  PRGroup bgroup NOT NULL,\n  PRDept bdept NOT NULL,\n  -- ... 121 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nCREATE TABLE PRTH (\n  PRCo bcompany NOT NULL,\n  PRGroup bgroup NOT NULL,\n  PREndDate bdate NOT NULL,\n  Employee bemployee NOT NULL,\n  PaySeq tinyint NOT NULL,\n  PostSeq smallint NOT NULL,\n  Type char(1) NOT NULL,\n  PostDate bdate NOT NULL,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCDept bdept,\n  GLCo bcompany NOT NULL,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equipment bequip,\n  EMGroup tinyint,\n  CostCode bcostcode,\n  -- ... 41 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'GLDT' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nPREH, PRTH\n\nTo include GLDT in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to count records in slwi by company\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count SLWI records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM SLWI WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "SLWI"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find jobs over budget with remaining cost projection\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Find jobs over budget:\n1. Aggregate JCCP by job from JCJM\n2. Compare total ActualCost to CurrEstCost\n3. Use HAVING to filter only over-budget jobs\n4. Sort by amount over budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description,\n  SUM(JCCP.CurrEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.CurrEstCost) - SUM(JCCP.ActualCost) AS RemainingBudget,\n  CASE WHEN SUM(JCCP.CurrEstCost) < SUM(JCCP.ActualCost) \n       THEN 'OVER BUDGET' ELSE 'OK' END AS Status\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\nGROUP BY JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.CurrEstCost)\nORDER BY (SUM(JCCP.ActualCost) - SUM(JCCP.CurrEstCost)) DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM",
        "JCCD",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from GLCO\n\nDatabase Schema:\nCREATE TABLE GLCO (\n  GLCo bcompany NOT NULL,\n  Consolid byn NOT NULL,\n  LastMthSubClsd bmonth NOT NULL,\n  LastMthGLClsd bmonth NOT NULL,\n  MaxOpen tinyint NOT NULL,\n  CashAccrual char(1) NOT NULL,\n  Unbal byn NOT NULL,\n  AuditCoParams byn NOT NULL,\n  AuditAccts byn NOT NULL,\n  AuditAutoJrnl byn NOT NULL,\n  AuditBals byn NOT NULL,\n  AuditBudgets byn NOT NULL,\n  AuditDetail byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  XCompJrnlEntryYN byn NOT NULL,\n  KeyID bigint NOT NULL,\n  LastMthAPClsd bmonth NOT NULL,\n  LastMthARClsd bmonth NOT NULL,\n  AttachBatchReportsYN byn NOT NULL,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from GLCO ().\n\n```sql\nSELECT *\nFROM GLCO WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "GLCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need to count records in prco by company\n\nDatabase Schema:\nCREATE TABLE PRCO (\n  PRCo bcompany NOT NULL,\n  GLCo bcompany NOT NULL,\n  Jrnl bjrnl,\n  GLInterface byn NOT NULL,\n  CMCo bcompany NOT NULL,\n  APCo bcompany,\n  AutoOT byn NOT NULL,\n  OTEarnCode bedlcode,\n  JCCo bcompany NOT NULL,\n  AllowNoPhase byn NOT NULL,\n  JCInterface byn NOT NULL,\n  InsByPhase byn NOT NULL,\n  JCICraftClass byn NOT NULL,\n  JCICrew byn NOT NULL,\n  JCIEmployee byn NOT NULL,\n  JCIFactor byn NOT NULL,\n  JCIEarnType byn NOT NULL,\n  JCIShift byn NOT NULL,\n  JCIPostingDate byn NOT NULL,\n  JCILiabType byn NOT NULL,\n  -- ... 66 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count PRCO records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM PRCO WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "PRCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query to count records in slwi by company\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count SLWI records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM SLWI WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLWI"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need to count records in jccd by company\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count JCCD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM JCCD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from JCCD\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from JCCD ().\n\n```sql\nSELECT *\nFROM JCCD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from PRTH\n\nDatabase Schema:\nCREATE TABLE PRTH (\n  PRCo bcompany NOT NULL,\n  PRGroup bgroup NOT NULL,\n  PREndDate bdate NOT NULL,\n  Employee bemployee NOT NULL,\n  PaySeq tinyint NOT NULL,\n  PostSeq smallint NOT NULL,\n  Type char(1) NOT NULL,\n  PostDate bdate NOT NULL,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCDept bdept,\n  GLCo bcompany NOT NULL,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equipment bequip,\n  EMGroup tinyint,\n  CostCode bcostcode,\n  -- ... 41 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from PRTH ().\n\n```sql\nSELECT *\nFROM PRTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "PRTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from JCCD\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from JCCD ().\n\n```sql\nSELECT *\nFROM JCCD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoice totals with discounts and retainage\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Vendor invoice summary with discounts and retainage:\n1. Join APTH to APVM for vendor details\n2. Aggregate by vendor\n3. Include GrossAmt, DiscOffer, Retainage, and Balance\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(APTH.APTrans) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS GrossAmount,\n  SUM(APTH.DiscOffer) AS DiscountsOffered,\n  SUM(APTH.Retainage) AS RetainageHeld,\n  SUM(APTH.Balance) AS OpenBalance\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "basic",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from JCCD\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from JCCD ().\n\n```sql\nSELECT *\nFROM JCCD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find jobs over budget with remaining cost projection\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Find jobs over budget:\n1. Aggregate JCCP by job from JCJM\n2. Compare total ActualCost to CurrEstCost\n3. Use HAVING to filter only over-budget jobs\n4. Sort by amount over budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description,\n  SUM(JCCP.CurrEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.CurrEstCost) - SUM(JCCP.ActualCost) AS RemainingBudget,\n  CASE WHEN SUM(JCCP.CurrEstCost) < SUM(JCCP.ActualCost) \n       THEN 'OVER BUDGET' ELSE 'OK' END AS Status\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\nGROUP BY JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.CurrEstCost)\nORDER BY (SUM(JCCP.ActualCost) - SUM(JCCP.CurrEstCost)) DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCJM",
        "JCCD",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get subcontractor costs with original, change orders, invoiced, paid, and retainage by vendor\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Subcontractor cost breakdown by vendor:\n1. Join SLHD (Header) to SLIT (Items) for subcontract details\n2. Join APVM for vendor names\n3. OrigCost = original contract amount\n4. CurCost - OrigCost = change order amounts\n5. InvCost = amounts invoiced\n6. Retainage = amounts held back\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  SLHD.SL AS SubcontractNum,\n  SLHD.Description AS SubcontractDesc,\n  SUM(SLIT.OrigCost) AS OriginalCost,\n  SUM(SLIT.CurCost - SLIT.OrigCost) AS ChangeOrderCost,\n  SUM(SLIT.CurCost) AS CurrentCost,\n  SUM(SLIT.InvCost) AS InvoicedCost,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost - SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nINNER JOIN APVM WITH (NOLOCK) ON SLHD.VendorGroup = APVM.VendorGroup AND SLHD.Vendor = APVM.Vendor\nWHERE SLHD.SLCo = @SLCo\nGROUP BY APVM.Vendor, APVM.Name, SLHD.SL, SLHD.Description\nORDER BY APVM.Name, SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLHD",
        "SLIT",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from JCCD\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from JCCD ().\n\n```sql\nSELECT *\nFROM JCCD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from JCCD\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from JCCD ().\n\n```sql\nSELECT *\nFROM JCCD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get data from JCJM for analysis\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'JCJM' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nARTH, ARCM\n\nTo include JCJM in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoice totals with discounts and retainage\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Vendor invoice summary with discounts and retainage:\n1. Join APTH to APVM for vendor details\n2. Aggregate by vendor\n3. Include GrossAmt, DiscOffer, Retainage, and Balance\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(APTH.APTrans) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS GrossAmount,\n  SUM(APTH.DiscOffer) AS DiscountsOffered,\n  SUM(APTH.Retainage) AS RetainageHeld,\n  SUM(APTH.Balance) AS OpenBalance\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to count records in preh by company\n\nDatabase Schema:\nCREATE TABLE PREH (\n  PRCo bcompany NOT NULL,\n  Employee bemployee NOT NULL,\n  LastName varchar(30) NOT NULL,\n  FirstName varchar(30),\n  MidName varchar(15),\n  SortName bsortname NOT NULL,\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  Phone bphone,\n  SSN char(11) NOT NULL,\n  Race char(2) NOT NULL,\n  Sex char(1) NOT NULL,\n  BirthDate smalldatetime,\n  HireDate bdate,\n  TermDate bdate,\n  PRGroup bgroup NOT NULL,\n  PRDept bdept NOT NULL,\n  -- ... 121 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count PREH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM PREH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "PREH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from ARTH\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from ARTH ().\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get job cost variance by phase comparing budget to actual\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Job cost variance by phase:\n1. Join JCJM (Job Master) to JCCP (Cost Phase)\n2. Calculate variance as CurrEstCost - ActualCost\n3. Calculate percent complete from actuals vs budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  JCCP.Phase,\n  JCCP.CostType,\n  JCCP.OrigEstCost AS OriginalBudget,\n  JCCP.CurrEstCost AS CurrentBudget,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS Variance,\n  CASE WHEN JCCP.CurrEstCost <> 0 \n       THEN (JCCP.ActualCost / JCCP.CurrEstCost) * 100 \n       ELSE 0 END AS PercentComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.Job = @Job\nORDER BY JCCP.Phase, JCCP.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate stored materials (Purchased - Installed) for SL billing\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Stored materials for SL billing:\n1. SLWI contains work item/billing details\n2. StoredMatls = Purchased - Installed (materials on-site but not yet used)\n3. WCCost = Work Completed Cost\n4. WCRetAmt and SMRetAmt = separate retainage for work vs materials\n5. Total billable = WCCost + StoredMatls\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description AS ItemDescription,\n  SLWI.StoredMatls,\n  SLWI.WCCost AS WorkCompletedCost,\n  SLWI.StoredMatls + SLWI.WCCost AS TotalBillable,\n  SLWI.WCRetAmt AS WorkRetainage,\n  SLWI.SMRetAmt AS MaterialsRetainage,\n  SLWI.WCRetAmt + SLWI.SMRetAmt AS TotalRetainage\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\n  AND SLWI.StoredMatls <> 0\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get subcontractor costs with original, change orders, invoiced, paid, and retainage by vendor\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Subcontractor cost breakdown by vendor:\n1. Join SLHD (Header) to SLIT (Items) for subcontract details\n2. Join APVM for vendor names\n3. OrigCost = original contract amount\n4. CurCost - OrigCost = change order amounts\n5. InvCost = amounts invoiced\n6. Retainage = amounts held back\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  SLHD.SL AS SubcontractNum,\n  SLHD.Description AS SubcontractDesc,\n  SUM(SLIT.OrigCost) AS OriginalCost,\n  SUM(SLIT.CurCost - SLIT.OrigCost) AS ChangeOrderCost,\n  SUM(SLIT.CurCost) AS CurrentCost,\n  SUM(SLIT.InvCost) AS InvoicedCost,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost - SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nINNER JOIN APVM WITH (NOLOCK) ON SLHD.VendorGroup = APVM.VendorGroup AND SLHD.Vendor = APVM.Vendor\nWHERE SLHD.SLCo = @SLCo\nGROUP BY APVM.Vendor, APVM.Name, SLHD.SL, SLHD.Description\nORDER BY APVM.Name, SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "intermediate",
      "tables_used": [
        "SLHD",
        "SLIT",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: count records in slhd by company\n\nDatabase Schema:\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count SLHD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM SLHD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLHD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from GLAC\n\nDatabase Schema:\nCREATE TABLE GLAC (\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  Description bdesc,\n  AcctType char(1) NOT NULL,\n  SubType char(1),\n  NormBal char(1),\n  InterfaceDetail byn NOT NULL,\n  Active byn NOT NULL,\n  SummaryAcct bglacct NOT NULL,\n  CashAccrual char(1) NOT NULL,\n  CashOffAcct bglacct,\n  Notes varchar,\n  Part1 varchar(20),\n  Part2 varchar(20),\n  Part3 varchar(20),\n  Part4 varchar(20),\n  Part5 varchar(20),\n  Part6 varchar(20),\n  AllParts varchar(20),\n  CrossRefMemAcct bglacct,\n  -- ... 3 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from GLAC ().\n\n```sql\nSELECT *\nFROM GLAC WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "GLAC"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoice totals with discounts and retainage\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Vendor invoice summary with discounts and retainage:\n1. Join APTH to APVM for vendor details\n2. Aggregate by vendor\n3. Include GrossAmt, DiscOffer, Retainage, and Balance\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(APTH.APTrans) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS GrossAmount,\n  SUM(APTH.DiscOffer) AS DiscountsOffered,\n  SUM(APTH.Retainage) AS RetainageHeld,\n  SUM(APTH.Balance) AS OpenBalance\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate stored materials (Purchased - Installed) for SL billing\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Stored materials for SL billing:\n1. SLWI contains work item/billing details\n2. StoredMatls = Purchased - Installed (materials on-site but not yet used)\n3. WCCost = Work Completed Cost\n4. WCRetAmt and SMRetAmt = separate retainage for work vs materials\n5. Total billable = WCCost + StoredMatls\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description AS ItemDescription,\n  SLWI.StoredMatls,\n  SLWI.WCCost AS WorkCompletedCost,\n  SLWI.StoredMatls + SLWI.WCCost AS TotalBillable,\n  SLWI.WCRetAmt AS WorkRetainage,\n  SLWI.SMRetAmt AS MaterialsRetainage,\n  SLWI.WCRetAmt + SLWI.SMRetAmt AS TotalRetainage\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\n  AND SLWI.StoredMatls <> 0\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "intermediate",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get subcontractor costs with original, change orders, invoiced, paid, and retainage by vendor\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Subcontractor cost breakdown by vendor:\n1. Join SLHD (Header) to SLIT (Items) for subcontract details\n2. Join APVM for vendor names\n3. OrigCost = original contract amount\n4. CurCost - OrigCost = change order amounts\n5. InvCost = amounts invoiced\n6. Retainage = amounts held back\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  SLHD.SL AS SubcontractNum,\n  SLHD.Description AS SubcontractDesc,\n  SUM(SLIT.OrigCost) AS OriginalCost,\n  SUM(SLIT.CurCost - SLIT.OrigCost) AS ChangeOrderCost,\n  SUM(SLIT.CurCost) AS CurrentCost,\n  SUM(SLIT.InvCost) AS InvoicedCost,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost - SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nINNER JOIN APVM WITH (NOLOCK) ON SLHD.VendorGroup = APVM.VendorGroup AND SLHD.Vendor = APVM.Vendor\nWHERE SLHD.SLCo = @SLCo\nGROUP BY APVM.Vendor, APVM.Name, SLHD.SL, SLHD.Description\nORDER BY APVM.Name, SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "basic",
      "tables_used": [
        "SLHD",
        "SLIT",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How do I count records in gljr by company\n\nDatabase Schema:\nCREATE TABLE GLJR (\n  GLCo bcompany NOT NULL,\n  Jrnl bjrnl NOT NULL,\n  Description btransdesc,\n  Rev byn NOT NULL,\n  RevJrnl bjrnl,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count GLJR records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM GLJR WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "GLJR"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to count records in glco by company\n\nDatabase Schema:\nCREATE TABLE GLCO (\n  GLCo bcompany NOT NULL,\n  Consolid byn NOT NULL,\n  LastMthSubClsd bmonth NOT NULL,\n  LastMthGLClsd bmonth NOT NULL,\n  MaxOpen tinyint NOT NULL,\n  CashAccrual char(1) NOT NULL,\n  Unbal byn NOT NULL,\n  AuditCoParams byn NOT NULL,\n  AuditAccts byn NOT NULL,\n  AuditAutoJrnl byn NOT NULL,\n  AuditBals byn NOT NULL,\n  AuditBudgets byn NOT NULL,\n  AuditDetail byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  XCompJrnlEntryYN byn NOT NULL,\n  KeyID bigint NOT NULL,\n  LastMthAPClsd bmonth NOT NULL,\n  LastMthARClsd bmonth NOT NULL,\n  AttachBatchReportsYN byn NOT NULL,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count GLCO records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM GLCO WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "GLCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get subcontractor costs with original, change orders, invoiced, paid, and retainage by vendor\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Subcontractor cost breakdown by vendor:\n1. Join SLHD (Header) to SLIT (Items) for subcontract details\n2. Join APVM for vendor names\n3. OrigCost = original contract amount\n4. CurCost - OrigCost = change order amounts\n5. InvCost = amounts invoiced\n6. Retainage = amounts held back\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  SLHD.SL AS SubcontractNum,\n  SLHD.Description AS SubcontractDesc,\n  SUM(SLIT.OrigCost) AS OriginalCost,\n  SUM(SLIT.CurCost - SLIT.OrigCost) AS ChangeOrderCost,\n  SUM(SLIT.CurCost) AS CurrentCost,\n  SUM(SLIT.InvCost) AS InvoicedCost,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost - SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nINNER JOIN APVM WITH (NOLOCK) ON SLHD.VendorGroup = APVM.VendorGroup AND SLHD.Vendor = APVM.Vendor\nWHERE SLHD.SLCo = @SLCo\nGROUP BY APVM.Vendor, APVM.Name, SLHD.SL, SLHD.Description\nORDER BY APVM.Name, SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLHD",
        "SLIT",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query to count records in jccd by company\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count JCCD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM JCCD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get job cost variance by phase comparing budget to actual\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Job cost variance by phase:\n1. Join JCJM (Job Master) to JCCP (Cost Phase)\n2. Calculate variance as CurrEstCost - ActualCost\n3. Calculate percent complete from actuals vs budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  JCCP.Phase,\n  JCCP.CostType,\n  JCCP.OrigEstCost AS OriginalBudget,\n  JCCP.CurrEstCost AS CurrentBudget,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS Variance,\n  CASE WHEN JCCP.CurrEstCost <> 0 \n       THEN (JCCP.ActualCost / JCCP.CurrEstCost) * 100 \n       ELSE 0 END AS PercentComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.Job = @Job\nORDER BY JCCP.Phase, JCCP.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate stored materials (Purchased - Installed) for SL billing\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Stored materials for SL billing:\n1. SLWI contains work item/billing details\n2. StoredMatls = Purchased - Installed (materials on-site but not yet used)\n3. WCCost = Work Completed Cost\n4. WCRetAmt and SMRetAmt = separate retainage for work vs materials\n5. Total billable = WCCost + StoredMatls\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description AS ItemDescription,\n  SLWI.StoredMatls,\n  SLWI.WCCost AS WorkCompletedCost,\n  SLWI.StoredMatls + SLWI.WCCost AS TotalBillable,\n  SLWI.WCRetAmt AS WorkRetainage,\n  SLWI.SMRetAmt AS MaterialsRetainage,\n  SLWI.WCRetAmt + SLWI.SMRetAmt AS TotalRetainage\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\n  AND SLWI.StoredMatls <> 0\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "intermediate",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query to count records in prtd by company\n\nDatabase Schema:\nCREATE TABLE PRTD (\n  PRCo bcompany NOT NULL,\n  Craft bcraft NOT NULL,\n  Class bclass NOT NULL,\n  Template smallint NOT NULL,\n  DLCode bedlcode NOT NULL,\n  Factor brate NOT NULL,\n  OldRate bunitcost NOT NULL,\n  NewRate bunitcost NOT NULL,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count PRTD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM PRTD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "PRTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from GLCO\n\nDatabase Schema:\nCREATE TABLE GLCO (\n  GLCo bcompany NOT NULL,\n  Consolid byn NOT NULL,\n  LastMthSubClsd bmonth NOT NULL,\n  LastMthGLClsd bmonth NOT NULL,\n  MaxOpen tinyint NOT NULL,\n  CashAccrual char(1) NOT NULL,\n  Unbal byn NOT NULL,\n  AuditCoParams byn NOT NULL,\n  AuditAccts byn NOT NULL,\n  AuditAutoJrnl byn NOT NULL,\n  AuditBals byn NOT NULL,\n  AuditBudgets byn NOT NULL,\n  AuditDetail byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  XCompJrnlEntryYN byn NOT NULL,\n  KeyID bigint NOT NULL,\n  LastMthAPClsd bmonth NOT NULL,\n  LastMthARClsd bmonth NOT NULL,\n  AttachBatchReportsYN byn NOT NULL,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from GLCO ().\n\n```sql\nSELECT *\nFROM GLCO WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "GLCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to count records in apth by company\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count APTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM APTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How do I reconcile ap oncost batch lines with original transactions\n\nDatabase Schema:\nCREATE TABLE APTL (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equip bequip,\n  EMGroup bgroup,\n  -- ... 56 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans, APLine)\n);\n\nCREATE TABLE APLB (\n  Co bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  BatchId bbatchid NOT NULL,\n  BatchSeq int NOT NULL,\n  APLine smallint NOT NULL,\n  BatchTransType char(1) NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  -- ... 120 more columns,\n  PRIMARY KEY (Co, Mth, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APHB (\n  Co bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  BatchId bbatchid NOT NULL,\n  BatchSeq int NOT NULL,\n  BatchTransType char(1) NOT NULL,\n  APTrans btrans,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  -- ... 88 more columns,\n  PRIMARY KEY (Co, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To reconcile AP oncost batches with original transactions:\n1. Join APLB (batch lines) to APTL (original lines) using ocApplyMth, ocApplyTrans, ocApplyLine\n2. Include APHB for batch header info\n3. Join to APTH and APVM for vendor context\n4. Compare batch vs original amounts\n\n```sql\nSELECT \n  APLB.Co AS BatchCo,\n  APLB.Mth AS BatchMth,\n  APLB.BatchId,\n  APLB.BatchSeq,\n  APLB.ocApplyMth,\n  APLB.ocApplyTrans,\n  APLB.ocApplyLine,\n  APTL.APCo AS OrigCo,\n  APTL.Mth AS OrigMth,\n  APTL.APTrans AS OrigTrans,\n  APTL.APLine AS OrigLine,\n  APTL.GrossAmt AS OrigAmount,\n  APLB.GrossAmt AS BatchAmount,\n  APVM.Name AS VendorName\nFROM APLB WITH (NOLOCK)\nINNER JOIN APHB WITH (NOLOCK) ON APLB.Co = APHB.Co AND APLB.Mth = APHB.Mth AND APLB.BatchId = APHB.BatchId\nINNER JOIN APTL WITH (NOLOCK) ON APLB.ocApplyMth = APTL.Mth \n  AND APLB.ocApplyTrans = APTL.APTrans \n  AND APLB.ocApplyLine = APTL.APLine\n  AND APLB.Co = APTL.APCo\nINNER JOIN APTH WITH (NOLOCK) ON APTL.APCo = APTH.APCo AND APTL.Mth = APTH.Mth AND APTL.APTrans = APTH.APTrans\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APLB.Co = @Co\nORDER BY APLB.BatchId, APLB.BatchSeq\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APLB",
        "APHB",
        "APTL",
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need to count records in gldt by company\n\nDatabase Schema:\nCREATE TABLE GLDT (\n  GLCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  GLTrans btrans NOT NULL,\n  GLAcct bglacct NOT NULL,\n  Jrnl bjrnl NOT NULL,\n  GLRef bglref NOT NULL,\n  SourceCo bcompany NOT NULL,\n  Source bsource NOT NULL,\n  ActDate bdate NOT NULL,\n  DatePosted bdate NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid NOT NULL,\n  Amount bdollar NOT NULL,\n  RevStatus tinyint NOT NULL,\n  Adjust char(1) NOT NULL,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  UniqueAttchID uniqueidentifier,\n  SrcTable varchar(128),\n  SrcKeyID bigint,\n  PRIMARY KEY (GLCo, Mth, GLTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count GLDT records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM GLDT WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "GLDT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query to track ap hold status distinguishing retainage vs non-retainage holds\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APCO (\n  APCo bcompany NOT NULL,\n  GLCo bcompany NOT NULL,\n  ExpJrnl bjrnl,\n  GLExpInterfaceLvl tinyint NOT NULL,\n  GLExpSummaryDesc varchar(60),\n  GLExpTransDesc varchar(60),\n  GLJobDetailDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLEquipDetailDesc varchar(60),\n  GLExpDetailDesc varchar(60),\n  PayJrnl bjrnl,\n  GLPayInterfaceLvl tinyint NOT NULL,\n  GLPayDetailDesc varchar(60),\n  GLPaySummaryDesc varchar(60),\n  DiscOffGLAcct bglacct,\n  DiscTakenGLAcct bglacct,\n  ExpPayType tinyint,\n  JobPayType tinyint,\n  SubPayType tinyint,\n  RetPayType tinyint,\n  -- ... 92 more columns,\n  PRIMARY KEY (APCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To distinguish retainage vs non-retainage holds:\n1. Join APTD to APHD for hold details\n2. Join APCO to get RetHoldCode setting\n3. Compare APHD.HoldCode to APCO.RetHoldCode\n4. If equal, it's a retainage hold; otherwise non-retainage\n\n```sql\nSELECT \n  APTD.APCo,\n  APTD.Vendor,\n  APTD.Mth,\n  APTD.APTrans,\n  APHD.HoldCode,\n  CASE WHEN APHD.HoldCode = APCO.RetHoldCode \n       THEN 'Retainage Hold' \n       ELSE 'Non-Retainage Hold' END AS HoldType,\n  APTD.Amount\nFROM APTD WITH (NOLOCK)\nINNER JOIN APHD WITH (NOLOCK) ON APTD.APCo = APHD.APCo \n  AND APTD.Mth = APHD.Mth \n  AND APTD.APTrans = APHD.APTrans \n  AND APTD.APLine = APHD.APLine\nINNER JOIN APCO WITH (NOLOCK) ON APTD.APCo = APCO.APCo\nWHERE APTD.APCo = @APCo\n  AND APHD.HoldCode IS NOT NULL\nORDER BY APTD.Vendor, APTD.Mth\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "basic",
      "tables_used": [
        "APTD",
        "APHD",
        "APCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: count records in slhd by company\n\nDatabase Schema:\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count SLHD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM SLHD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "SLHD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to count records in prtd by company\n\nDatabase Schema:\nCREATE TABLE PRTD (\n  PRCo bcompany NOT NULL,\n  Craft bcraft NOT NULL,\n  Class bclass NOT NULL,\n  Template smallint NOT NULL,\n  DLCode bedlcode NOT NULL,\n  Factor brate NOT NULL,\n  OldRate bunitcost NOT NULL,\n  NewRate bunitcost NOT NULL,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count PRTD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM PRTD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "PRTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need to track ap hold status distinguishing retainage vs non-retainage holds\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APCO (\n  APCo bcompany NOT NULL,\n  GLCo bcompany NOT NULL,\n  ExpJrnl bjrnl,\n  GLExpInterfaceLvl tinyint NOT NULL,\n  GLExpSummaryDesc varchar(60),\n  GLExpTransDesc varchar(60),\n  GLJobDetailDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLEquipDetailDesc varchar(60),\n  GLExpDetailDesc varchar(60),\n  PayJrnl bjrnl,\n  GLPayInterfaceLvl tinyint NOT NULL,\n  GLPayDetailDesc varchar(60),\n  GLPaySummaryDesc varchar(60),\n  DiscOffGLAcct bglacct,\n  DiscTakenGLAcct bglacct,\n  ExpPayType tinyint,\n  JobPayType tinyint,\n  SubPayType tinyint,\n  RetPayType tinyint,\n  -- ... 92 more columns,\n  PRIMARY KEY (APCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To distinguish retainage vs non-retainage holds:\n1. Join APTD to APHD for hold details\n2. Join APCO to get RetHoldCode setting\n3. Compare APHD.HoldCode to APCO.RetHoldCode\n4. If equal, it's a retainage hold; otherwise non-retainage\n\n```sql\nSELECT \n  APTD.APCo,\n  APTD.Vendor,\n  APTD.Mth,\n  APTD.APTrans,\n  APHD.HoldCode,\n  CASE WHEN APHD.HoldCode = APCO.RetHoldCode \n       THEN 'Retainage Hold' \n       ELSE 'Non-Retainage Hold' END AS HoldType,\n  APTD.Amount\nFROM APTD WITH (NOLOCK)\nINNER JOIN APHD WITH (NOLOCK) ON APTD.APCo = APHD.APCo \n  AND APTD.Mth = APHD.Mth \n  AND APTD.APTrans = APHD.APTrans \n  AND APTD.APLine = APHD.APLine\nINNER JOIN APCO WITH (NOLOCK) ON APTD.APCo = APCO.APCo\nWHERE APTD.APCo = @APCo\n  AND APHD.HoldCode IS NOT NULL\nORDER BY APTD.Vendor, APTD.Mth\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "basic",
      "tables_used": [
        "APTD",
        "APHD",
        "APCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How do I count records in jccd by company\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count JCCD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM JCCD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find all unpaid AR invoices older than 60 days\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find unpaid invoices over 60 days:\n1. Join ARTH to ARCM for customer information\n2. Filter PayFullDate IS NULL (unpaid)\n3. Use DATEDIFF to calculate age and filter > 60 days\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Mth,\n  ARTH.ARTrans,\n  ARCM.Name AS CustomerName,\n  ARTH.TransDate,\n  ARTH.Amount,\n  DATEDIFF(day, ARTH.TransDate, GETDATE()) AS DaysOutstanding\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\n  AND DATEDIFF(day, ARTH.TransDate, GETDATE()) > 60\nORDER BY ARTH.TransDate\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get subcontractor costs with original, change orders, invoiced, paid, and retainage by vendor\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Subcontractor cost breakdown by vendor:\n1. Join SLHD (Header) to SLIT (Items) for subcontract details\n2. Join APVM for vendor names\n3. OrigCost = original contract amount\n4. CurCost - OrigCost = change order amounts\n5. InvCost = amounts invoiced\n6. Retainage = amounts held back\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  SLHD.SL AS SubcontractNum,\n  SLHD.Description AS SubcontractDesc,\n  SUM(SLIT.OrigCost) AS OriginalCost,\n  SUM(SLIT.CurCost - SLIT.OrigCost) AS ChangeOrderCost,\n  SUM(SLIT.CurCost) AS CurrentCost,\n  SUM(SLIT.InvCost) AS InvoicedCost,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost - SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nINNER JOIN APVM WITH (NOLOCK) ON SLHD.VendorGroup = APVM.VendorGroup AND SLHD.Vendor = APVM.Vendor\nWHERE SLHD.SLCo = @SLCo\nGROUP BY APVM.Vendor, APVM.Name, SLHD.SL, SLHD.Description\nORDER BY APVM.Name, SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLHD",
        "SLIT",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: count records in arth by company\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count ARTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM ARTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need to track ap hold status distinguishing retainage vs non-retainage holds\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APCO (\n  APCo bcompany NOT NULL,\n  GLCo bcompany NOT NULL,\n  ExpJrnl bjrnl,\n  GLExpInterfaceLvl tinyint NOT NULL,\n  GLExpSummaryDesc varchar(60),\n  GLExpTransDesc varchar(60),\n  GLJobDetailDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLEquipDetailDesc varchar(60),\n  GLExpDetailDesc varchar(60),\n  PayJrnl bjrnl,\n  GLPayInterfaceLvl tinyint NOT NULL,\n  GLPayDetailDesc varchar(60),\n  GLPaySummaryDesc varchar(60),\n  DiscOffGLAcct bglacct,\n  DiscTakenGLAcct bglacct,\n  ExpPayType tinyint,\n  JobPayType tinyint,\n  SubPayType tinyint,\n  RetPayType tinyint,\n  -- ... 92 more columns,\n  PRIMARY KEY (APCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To distinguish retainage vs non-retainage holds:\n1. Join APTD to APHD for hold details\n2. Join APCO to get RetHoldCode setting\n3. Compare APHD.HoldCode to APCO.RetHoldCode\n4. If equal, it's a retainage hold; otherwise non-retainage\n\n```sql\nSELECT \n  APTD.APCo,\n  APTD.Vendor,\n  APTD.Mth,\n  APTD.APTrans,\n  APHD.HoldCode,\n  CASE WHEN APHD.HoldCode = APCO.RetHoldCode \n       THEN 'Retainage Hold' \n       ELSE 'Non-Retainage Hold' END AS HoldType,\n  APTD.Amount\nFROM APTD WITH (NOLOCK)\nINNER JOIN APHD WITH (NOLOCK) ON APTD.APCo = APHD.APCo \n  AND APTD.Mth = APHD.Mth \n  AND APTD.APTrans = APHD.APTrans \n  AND APTD.APLine = APHD.APLine\nINNER JOIN APCO WITH (NOLOCK) ON APTD.APCo = APCO.APCo\nWHERE APTD.APCo = @APCo\n  AND APHD.HoldCode IS NOT NULL\nORDER BY APTD.Vendor, APTD.Mth\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTD",
        "APHD",
        "APCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find jobs over budget with remaining cost projection\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Find jobs over budget:\n1. Aggregate JCCP by job from JCJM\n2. Compare total ActualCost to CurrEstCost\n3. Use HAVING to filter only over-budget jobs\n4. Sort by amount over budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description,\n  SUM(JCCP.CurrEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.CurrEstCost) - SUM(JCCP.ActualCost) AS RemainingBudget,\n  CASE WHEN SUM(JCCP.CurrEstCost) < SUM(JCCP.ActualCost) \n       THEN 'OVER BUDGET' ELSE 'OK' END AS Status\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\nGROUP BY JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.CurrEstCost)\nORDER BY (SUM(JCCP.ActualCost) - SUM(JCCP.CurrEstCost)) DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM",
        "JCCD",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get job cost variance by phase comparing budget to actual\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Job cost variance by phase:\n1. Join JCJM (Job Master) to JCCP (Cost Phase)\n2. Calculate variance as CurrEstCost - ActualCost\n3. Calculate percent complete from actuals vs budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  JCCP.Phase,\n  JCCP.CostType,\n  JCCP.OrigEstCost AS OriginalBudget,\n  JCCP.CurrEstCost AS CurrentBudget,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS Variance,\n  CASE WHEN JCCP.CurrEstCost <> 0 \n       THEN (JCCP.ActualCost / JCCP.CurrEstCost) * 100 \n       ELSE 0 END AS PercentComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.Job = @Job\nORDER BY JCCP.Phase, JCCP.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get subcontractor costs with original, change orders, invoiced, paid, and retainage by vendor\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Subcontractor cost breakdown by vendor:\n1. Join SLHD (Header) to SLIT (Items) for subcontract details\n2. Join APVM for vendor names\n3. OrigCost = original contract amount\n4. CurCost - OrigCost = change order amounts\n5. InvCost = amounts invoiced\n6. Retainage = amounts held back\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  SLHD.SL AS SubcontractNum,\n  SLHD.Description AS SubcontractDesc,\n  SUM(SLIT.OrigCost) AS OriginalCost,\n  SUM(SLIT.CurCost - SLIT.OrigCost) AS ChangeOrderCost,\n  SUM(SLIT.CurCost) AS CurrentCost,\n  SUM(SLIT.InvCost) AS InvoicedCost,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost - SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nINNER JOIN APVM WITH (NOLOCK) ON SLHD.VendorGroup = APVM.VendorGroup AND SLHD.Vendor = APVM.Vendor\nWHERE SLHD.SLCo = @SLCo\nGROUP BY APVM.Vendor, APVM.Name, SLHD.SL, SLHD.Description\nORDER BY APVM.Name, SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLHD",
        "SLIT",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: count records in aptd by company\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count APTD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM APTD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get job cost variance by phase comparing budget to actual\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Job cost variance by phase:\n1. Join JCJM (Job Master) to JCCP (Cost Phase)\n2. Calculate variance as CurrEstCost - ActualCost\n3. Calculate percent complete from actuals vs budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  JCCP.Phase,\n  JCCP.CostType,\n  JCCP.OrigEstCost AS OriginalBudget,\n  JCCP.CurrEstCost AS CurrentBudget,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS Variance,\n  CASE WHEN JCCP.CurrEstCost <> 0 \n       THEN (JCCP.ActualCost / JCCP.CurrEstCost) * 100 \n       ELSE 0 END AS PercentComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.Job = @Job\nORDER BY JCCP.Phase, JCCP.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from APTD\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from APTD ().\n\n```sql\nSELECT *\nFROM APTD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from GLDT\n\nDatabase Schema:\nCREATE TABLE GLDT (\n  GLCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  GLTrans btrans NOT NULL,\n  GLAcct bglacct NOT NULL,\n  Jrnl bjrnl NOT NULL,\n  GLRef bglref NOT NULL,\n  SourceCo bcompany NOT NULL,\n  Source bsource NOT NULL,\n  ActDate bdate NOT NULL,\n  DatePosted bdate NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid NOT NULL,\n  Amount bdollar NOT NULL,\n  RevStatus tinyint NOT NULL,\n  Adjust char(1) NOT NULL,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  UniqueAttchID uniqueidentifier,\n  SrcTable varchar(128),\n  SrcKeyID bigint,\n  PRIMARY KEY (GLCo, Mth, GLTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from GLDT ().\n\n```sql\nSELECT *\nFROM GLDT WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "GLDT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need to count records in jccd by company\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count JCCD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM JCCD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging buckets (30/60/90+ days) for unpaid invoices by customer\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Use ARTH for transaction data and ARCM for customer names\n2. Filter PayFullDate IS NULL to get only unpaid invoices\n3. Use DATEDIFF and CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from PREH\n\nDatabase Schema:\nCREATE TABLE PREH (\n  PRCo bcompany NOT NULL,\n  Employee bemployee NOT NULL,\n  LastName varchar(30) NOT NULL,\n  FirstName varchar(30),\n  MidName varchar(15),\n  SortName bsortname NOT NULL,\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  Phone bphone,\n  SSN char(11) NOT NULL,\n  Race char(2) NOT NULL,\n  Sex char(1) NOT NULL,\n  BirthDate smalldatetime,\n  HireDate bdate,\n  TermDate bdate,\n  PRGroup bgroup NOT NULL,\n  PRDept bdept NOT NULL,\n  -- ... 121 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from PREH ().\n\n```sql\nSELECT *\nFROM PREH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "PREH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How do I count records in prpc by company\n\nDatabase Schema:\nCREATE TABLE PRPC (\n  PRCo bcompany NOT NULL,\n  PRGroup bgroup NOT NULL,\n  PREndDate bdate NOT NULL,\n  BeginDate bdate NOT NULL,\n  MultiMth byn NOT NULL,\n  BeginMth bmonth NOT NULL,\n  EndMth bmonth,\n  CutoffDate bdate,\n  LimitMth bmonth NOT NULL,\n  Hrs smallint NOT NULL,\n  Days tinyint NOT NULL,\n  Wks tinyint NOT NULL,\n  Status tinyint NOT NULL,\n  DateClosed smalldatetime,\n  JCInterface byn NOT NULL,\n  EMInterface byn NOT NULL,\n  GLInterface byn NOT NULL,\n  APInterface byn NOT NULL,\n  LeaveProcess byn NOT NULL,\n  InUseBy bvpusername,\n  -- ... 7 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count PRPC records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM PRPC WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "PRPC"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging buckets (30/60/90+ days) for unpaid invoices by customer\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Use ARTH for transaction data and ARCM for customer names\n2. Filter PayFullDate IS NULL to get only unpaid invoices\n3. Use DATEDIFF and CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need to count records in slwi by company\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count SLWI records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM SLWI WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLWI"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get customer balance summary by customer group\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Customer balance summary by group:\n1. Join ARTH to ARCM for customer details\n2. Use conditional SUM for open vs total balances\n3. Group by CustGroup for summary\n\n```sql\nSELECT \n  ARTH.CustGroup,\n  COUNT(DISTINCT ARTH.Customer) AS CustomerCount,\n  SUM(CASE WHEN ARTH.PayFullDate IS NULL THEN ARTH.Amount ELSE 0 END) AS OpenBalance,\n  SUM(ARTH.Amount) AS TotalBilled\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\nGROUP BY ARTH.CustGroup\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need to count records in slwi by company\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count SLWI records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM SLWI WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "SLWI"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get subcontractor costs with original, change orders, invoiced, paid, and retainage by vendor\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Subcontractor cost breakdown by vendor:\n1. Join SLHD (Header) to SLIT (Items) for subcontract details\n2. Join APVM for vendor names\n3. OrigCost = original contract amount\n4. CurCost - OrigCost = change order amounts\n5. InvCost = amounts invoiced\n6. Retainage = amounts held back\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  SLHD.SL AS SubcontractNum,\n  SLHD.Description AS SubcontractDesc,\n  SUM(SLIT.OrigCost) AS OriginalCost,\n  SUM(SLIT.CurCost - SLIT.OrigCost) AS ChangeOrderCost,\n  SUM(SLIT.CurCost) AS CurrentCost,\n  SUM(SLIT.InvCost) AS InvoicedCost,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost - SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nINNER JOIN APVM WITH (NOLOCK) ON SLHD.VendorGroup = APVM.VendorGroup AND SLHD.Vendor = APVM.Vendor\nWHERE SLHD.SLCo = @SLCo\nGROUP BY APVM.Vendor, APVM.Name, SLHD.SL, SLHD.Description\nORDER BY APVM.Name, SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLHD",
        "SLIT",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging buckets (30/60/90+ days) for unpaid invoices by customer\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Use ARTH for transaction data and ARCM for customer names\n2. Filter PayFullDate IS NULL to get only unpaid invoices\n3. Use DATEDIFF and CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Query PREH along with the schema tables\n\nDatabase Schema:\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'PREH' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nSLHD, SLIT\n\nTo include PREH in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query to aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How do I aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How do I count records in aptd by company\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count APTD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM APTD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to count records in aptd by company\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count APTD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM APTD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to count records in apth by company\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count APTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM APTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find all unpaid AR invoices older than 60 days\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find unpaid invoices over 60 days:\n1. Join ARTH to ARCM for customer information\n2. Filter PayFullDate IS NULL (unpaid)\n3. Use DATEDIFF to calculate age and filter > 60 days\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Mth,\n  ARTH.ARTrans,\n  ARCM.Name AS CustomerName,\n  ARTH.TransDate,\n  ARTH.Amount,\n  DATEDIFF(day, ARTH.TransDate, GETDATE()) AS DaysOutstanding\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\n  AND DATEDIFF(day, ARTH.TransDate, GETDATE()) > 60\nORDER BY ARTH.TransDate\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find all unpaid AR invoices older than 60 days\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find unpaid invoices over 60 days:\n1. Join ARTH to ARCM for customer information\n2. Filter PayFullDate IS NULL (unpaid)\n3. Use DATEDIFF to calculate age and filter > 60 days\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Mth,\n  ARTH.ARTrans,\n  ARCM.Name AS CustomerName,\n  ARTH.TransDate,\n  ARTH.Amount,\n  DATEDIFF(day, ARTH.TransDate, GETDATE()) AS DaysOutstanding\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\n  AND DATEDIFF(day, ARTH.TransDate, GETDATE()) > 60\nORDER BY ARTH.TransDate\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Describe the WorkOrders table\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'WorkOrders' does not exist in Viewpoint Vista.\n\nUse SMWorkOrder for service management work orders.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM SMWorkOrder WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get customer balance summary by customer group\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Customer balance summary by group:\n1. Join ARTH to ARCM for customer details\n2. Use conditional SUM for open vs total balances\n3. Group by CustGroup for summary\n\n```sql\nSELECT \n  ARTH.CustGroup,\n  COUNT(DISTINCT ARTH.Customer) AS CustomerCount,\n  SUM(CASE WHEN ARTH.PayFullDate IS NULL THEN ARTH.Amount ELSE 0 END) AS OpenBalance,\n  SUM(ARTH.Amount) AS TotalBilled\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\nGROUP BY ARTH.CustGroup\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need to count records in slhd by company\n\nDatabase Schema:\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count SLHD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM SLHD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "SLHD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How do I count records in arth by company\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count ARTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM ARTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get job cost variance by phase comparing budget to actual\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Job cost variance by phase:\n1. Join JCJM (Job Master) to JCCP (Cost Phase)\n2. Calculate variance as CurrEstCost - ActualCost\n3. Calculate percent complete from actuals vs budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  JCCP.Phase,\n  JCCP.CostType,\n  JCCP.OrigEstCost AS OriginalBudget,\n  JCCP.CurrEstCost AS CurrentBudget,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS Variance,\n  CASE WHEN JCCP.CurrEstCost <> 0 \n       THEN (JCCP.ActualCost / JCCP.CurrEstCost) * 100 \n       ELSE 0 END AS PercentComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.Job = @Job\nORDER BY JCCP.Phase, JCCP.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from ARTH\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from ARTH ().\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging with customer contact information\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I can partially answer this query, but the schema is incomplete.\n\nThe query requires ARCM (AR Customer Master) for customer details, but only ARTH is provided in the schema.\n\nHere's what I can provide with the available schema:\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n-- Note: Additional joins for ARCM would be needed for complete results\n```\n\nTo get the complete data you requested, please provide the DDL for ARCM.",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find all unpaid AR invoices older than 60 days\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find unpaid invoices over 60 days:\n1. Join ARTH to ARCM for customer information\n2. Filter PayFullDate IS NULL (unpaid)\n3. Use DATEDIFF to calculate age and filter > 60 days\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Mth,\n  ARTH.ARTrans,\n  ARCM.Name AS CustomerName,\n  ARTH.TransDate,\n  ARTH.Amount,\n  DATEDIFF(day, ARTH.TransDate, GETDATE()) AS DaysOutstanding\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\n  AND DATEDIFF(day, ARTH.TransDate, GETDATE()) > 60\nORDER BY ARTH.TransDate\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get customer balance summary by customer group\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Customer balance summary by group:\n1. Join ARTH to ARCM for customer details\n2. Use conditional SUM for open vs total balances\n3. Group by CustGroup for summary\n\n```sql\nSELECT \n  ARTH.CustGroup,\n  COUNT(DISTINCT ARTH.Customer) AS CustomerCount,\n  SUM(CASE WHEN ARTH.PayFullDate IS NULL THEN ARTH.Amount ELSE 0 END) AS OpenBalance,\n  SUM(ARTH.Amount) AS TotalBilled\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\nGROUP BY ARTH.CustGroup\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to count records in apth by company\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count APTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM APTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from ARTH\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from ARTH ().\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find jobs over budget with remaining cost projection\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Find jobs over budget:\n1. Aggregate JCCP by job from JCJM\n2. Compare total ActualCost to CurrEstCost\n3. Use HAVING to filter only over-budget jobs\n4. Sort by amount over budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description,\n  SUM(JCCP.CurrEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.CurrEstCost) - SUM(JCCP.ActualCost) AS RemainingBudget,\n  CASE WHEN SUM(JCCP.CurrEstCost) < SUM(JCCP.ActualCost) \n       THEN 'OVER BUDGET' ELSE 'OK' END AS Status\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\nGROUP BY JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.CurrEstCost)\nORDER BY (SUM(JCCP.ActualCost) - SUM(JCCP.CurrEstCost)) DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCJM",
        "JCCD",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show job costs with GL account descriptions\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I can partially answer this query, but the schema is incomplete.\n\nThe query requires GLAC for GL account descriptions, which is not in the provided schema.\n\nHere's what I can provide with the available schema:\n\n```sql\nSELECT *\nFROM JCCD WITH (NOLOCK)\nWHERE Co = @Co\n-- Note: Additional joins for GLAC would be needed for complete results\n```\n\nTo get the complete data you requested, please provide the DDL for GLAC.",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need to track ap hold status distinguishing retainage vs non-retainage holds\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APCO (\n  APCo bcompany NOT NULL,\n  GLCo bcompany NOT NULL,\n  ExpJrnl bjrnl,\n  GLExpInterfaceLvl tinyint NOT NULL,\n  GLExpSummaryDesc varchar(60),\n  GLExpTransDesc varchar(60),\n  GLJobDetailDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLEquipDetailDesc varchar(60),\n  GLExpDetailDesc varchar(60),\n  PayJrnl bjrnl,\n  GLPayInterfaceLvl tinyint NOT NULL,\n  GLPayDetailDesc varchar(60),\n  GLPaySummaryDesc varchar(60),\n  DiscOffGLAcct bglacct,\n  DiscTakenGLAcct bglacct,\n  ExpPayType tinyint,\n  JobPayType tinyint,\n  SubPayType tinyint,\n  RetPayType tinyint,\n  -- ... 92 more columns,\n  PRIMARY KEY (APCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To distinguish retainage vs non-retainage holds:\n1. Join APTD to APHD for hold details\n2. Join APCO to get RetHoldCode setting\n3. Compare APHD.HoldCode to APCO.RetHoldCode\n4. If equal, it's a retainage hold; otherwise non-retainage\n\n```sql\nSELECT \n  APTD.APCo,\n  APTD.Vendor,\n  APTD.Mth,\n  APTD.APTrans,\n  APHD.HoldCode,\n  CASE WHEN APHD.HoldCode = APCO.RetHoldCode \n       THEN 'Retainage Hold' \n       ELSE 'Non-Retainage Hold' END AS HoldType,\n  APTD.Amount\nFROM APTD WITH (NOLOCK)\nINNER JOIN APHD WITH (NOLOCK) ON APTD.APCo = APHD.APCo \n  AND APTD.Mth = APHD.Mth \n  AND APTD.APTrans = APHD.APTrans \n  AND APTD.APLine = APHD.APLine\nINNER JOIN APCO WITH (NOLOCK) ON APTD.APCo = APCO.APCo\nWHERE APTD.APCo = @APCo\n  AND APHD.HoldCode IS NOT NULL\nORDER BY APTD.Vendor, APTD.Mth\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "basic",
      "tables_used": [
        "APTD",
        "APHD",
        "APCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from GLCO\n\nDatabase Schema:\nCREATE TABLE GLCO (\n  GLCo bcompany NOT NULL,\n  Consolid byn NOT NULL,\n  LastMthSubClsd bmonth NOT NULL,\n  LastMthGLClsd bmonth NOT NULL,\n  MaxOpen tinyint NOT NULL,\n  CashAccrual char(1) NOT NULL,\n  Unbal byn NOT NULL,\n  AuditCoParams byn NOT NULL,\n  AuditAccts byn NOT NULL,\n  AuditAutoJrnl byn NOT NULL,\n  AuditBals byn NOT NULL,\n  AuditBudgets byn NOT NULL,\n  AuditDetail byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  XCompJrnlEntryYN byn NOT NULL,\n  KeyID bigint NOT NULL,\n  LastMthAPClsd bmonth NOT NULL,\n  LastMthARClsd bmonth NOT NULL,\n  AttachBatchReportsYN byn NOT NULL,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from GLCO ().\n\n```sql\nSELECT *\nFROM GLCO WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "GLCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get job cost variance by phase comparing budget to actual\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Job cost variance by phase:\n1. Join JCJM (Job Master) to JCCP (Cost Phase)\n2. Calculate variance as CurrEstCost - ActualCost\n3. Calculate percent complete from actuals vs budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  JCCP.Phase,\n  JCCP.CostType,\n  JCCP.OrigEstCost AS OriginalBudget,\n  JCCP.CurrEstCost AS CurrentBudget,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS Variance,\n  CASE WHEN JCCP.CurrEstCost <> 0 \n       THEN (JCCP.ActualCost / JCCP.CurrEstCost) * 100 \n       ELSE 0 END AS PercentComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.Job = @Job\nORDER BY JCCP.Phase, JCCP.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate stored materials (Purchased - Installed) for SL billing\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Stored materials for SL billing:\n1. SLWI contains work item/billing details\n2. StoredMatls = Purchased - Installed (materials on-site but not yet used)\n3. WCCost = Work Completed Cost\n4. WCRetAmt and SMRetAmt = separate retainage for work vs materials\n5. Total billable = WCCost + StoredMatls\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description AS ItemDescription,\n  SLWI.StoredMatls,\n  SLWI.WCCost AS WorkCompletedCost,\n  SLWI.StoredMatls + SLWI.WCCost AS TotalBillable,\n  SLWI.WCRetAmt AS WorkRetainage,\n  SLWI.SMRetAmt AS MaterialsRetainage,\n  SLWI.WCRetAmt + SLWI.SMRetAmt AS TotalRetainage\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\n  AND SLWI.StoredMatls <> 0\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "basic",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need to count records in jccd by company\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count JCCD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM JCCD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to track ap hold status distinguishing retainage vs non-retainage holds\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APCO (\n  APCo bcompany NOT NULL,\n  GLCo bcompany NOT NULL,\n  ExpJrnl bjrnl,\n  GLExpInterfaceLvl tinyint NOT NULL,\n  GLExpSummaryDesc varchar(60),\n  GLExpTransDesc varchar(60),\n  GLJobDetailDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLEquipDetailDesc varchar(60),\n  GLExpDetailDesc varchar(60),\n  PayJrnl bjrnl,\n  GLPayInterfaceLvl tinyint NOT NULL,\n  GLPayDetailDesc varchar(60),\n  GLPaySummaryDesc varchar(60),\n  DiscOffGLAcct bglacct,\n  DiscTakenGLAcct bglacct,\n  ExpPayType tinyint,\n  JobPayType tinyint,\n  SubPayType tinyint,\n  RetPayType tinyint,\n  -- ... 92 more columns,\n  PRIMARY KEY (APCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To distinguish retainage vs non-retainage holds:\n1. Join APTD to APHD for hold details\n2. Join APCO to get RetHoldCode setting\n3. Compare APHD.HoldCode to APCO.RetHoldCode\n4. If equal, it's a retainage hold; otherwise non-retainage\n\n```sql\nSELECT \n  APTD.APCo,\n  APTD.Vendor,\n  APTD.Mth,\n  APTD.APTrans,\n  APHD.HoldCode,\n  CASE WHEN APHD.HoldCode = APCO.RetHoldCode \n       THEN 'Retainage Hold' \n       ELSE 'Non-Retainage Hold' END AS HoldType,\n  APTD.Amount\nFROM APTD WITH (NOLOCK)\nINNER JOIN APHD WITH (NOLOCK) ON APTD.APCo = APHD.APCo \n  AND APTD.Mth = APHD.Mth \n  AND APTD.APTrans = APHD.APTrans \n  AND APTD.APLine = APHD.APLine\nINNER JOIN APCO WITH (NOLOCK) ON APTD.APCo = APCO.APCo\nWHERE APTD.APCo = @APCo\n  AND APHD.HoldCode IS NOT NULL\nORDER BY APTD.Vendor, APTD.Mth\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "basic",
      "tables_used": [
        "APTD",
        "APHD",
        "APCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to join JCJM with the available tables\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'JCJM' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nARTH, ARCM\n\nTo include JCJM in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to count records in apth by company\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count APTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM APTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to count records in gldt by company\n\nDatabase Schema:\nCREATE TABLE GLDT (\n  GLCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  GLTrans btrans NOT NULL,\n  GLAcct bglacct NOT NULL,\n  Jrnl bjrnl NOT NULL,\n  GLRef bglref NOT NULL,\n  SourceCo bcompany NOT NULL,\n  Source bsource NOT NULL,\n  ActDate bdate NOT NULL,\n  DatePosted bdate NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid NOT NULL,\n  Amount bdollar NOT NULL,\n  RevStatus tinyint NOT NULL,\n  Adjust char(1) NOT NULL,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  UniqueAttchID uniqueidentifier,\n  SrcTable varchar(128),\n  SrcKeyID bigint,\n  PRIMARY KEY (GLCo, Mth, GLTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count GLDT records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM GLDT WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "GLDT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from ARTH\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from ARTH ().\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate stored materials (Purchased - Installed) for SL billing\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Stored materials for SL billing:\n1. SLWI contains work item/billing details\n2. StoredMatls = Purchased - Installed (materials on-site but not yet used)\n3. WCCost = Work Completed Cost\n4. WCRetAmt and SMRetAmt = separate retainage for work vs materials\n5. Total billable = WCCost + StoredMatls\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description AS ItemDescription,\n  SLWI.StoredMatls,\n  SLWI.WCCost AS WorkCompletedCost,\n  SLWI.StoredMatls + SLWI.WCCost AS TotalBillable,\n  SLWI.WCRetAmt AS WorkRetainage,\n  SLWI.SMRetAmt AS MaterialsRetainage,\n  SLWI.WCRetAmt + SLWI.SMRetAmt AS TotalRetainage\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\n  AND SLWI.StoredMatls <> 0\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate stored materials (Purchased - Installed) for SL billing\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Stored materials for SL billing:\n1. SLWI contains work item/billing details\n2. StoredMatls = Purchased - Installed (materials on-site but not yet used)\n3. WCCost = Work Completed Cost\n4. WCRetAmt and SMRetAmt = separate retainage for work vs materials\n5. Total billable = WCCost + StoredMatls\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description AS ItemDescription,\n  SLWI.StoredMatls,\n  SLWI.WCCost AS WorkCompletedCost,\n  SLWI.StoredMatls + SLWI.WCCost AS TotalBillable,\n  SLWI.WCRetAmt AS WorkRetainage,\n  SLWI.SMRetAmt AS MaterialsRetainage,\n  SLWI.WCRetAmt + SLWI.SMRetAmt AS TotalRetainage\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\n  AND SLWI.StoredMatls <> 0\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "basic",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from JCCD\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from JCCD ().\n\n```sql\nSELECT *\nFROM JCCD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show job costs with GL account descriptions\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I can partially answer this query, but the schema is incomplete.\n\nThe query requires GLAC for GL account descriptions, which is not in the provided schema.\n\nHere's what I can provide with the available schema:\n\n```sql\nSELECT *\nFROM JCCD WITH (NOLOCK)\nWHERE Co = @Co\n-- Note: Additional joins for GLAC would be needed for complete results\n```\n\nTo get the complete data you requested, please provide the DDL for GLAC.",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to count records in glco by company\n\nDatabase Schema:\nCREATE TABLE GLCO (\n  GLCo bcompany NOT NULL,\n  Consolid byn NOT NULL,\n  LastMthSubClsd bmonth NOT NULL,\n  LastMthGLClsd bmonth NOT NULL,\n  MaxOpen tinyint NOT NULL,\n  CashAccrual char(1) NOT NULL,\n  Unbal byn NOT NULL,\n  AuditCoParams byn NOT NULL,\n  AuditAccts byn NOT NULL,\n  AuditAutoJrnl byn NOT NULL,\n  AuditBals byn NOT NULL,\n  AuditBudgets byn NOT NULL,\n  AuditDetail byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  XCompJrnlEntryYN byn NOT NULL,\n  KeyID bigint NOT NULL,\n  LastMthAPClsd bmonth NOT NULL,\n  LastMthARClsd bmonth NOT NULL,\n  AttachBatchReportsYN byn NOT NULL,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count GLCO records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM GLCO WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "GLCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Join SubcontractHeader with other tables\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'SubcontractHeader' does not exist in Viewpoint Vista.\n\nUse SLHD (SL Header) for subcontract headers.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM SLHD WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from SLWI\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from SLWI ().\n\n```sql\nSELECT *\nFROM SLWI WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLWI"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get data from JCJM for analysis\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'JCJM' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nARTH, ARCM\n\nTo include JCJM in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging buckets (30/60/90+ days) for unpaid invoices by customer\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Use ARTH for transaction data and ARCM for customer names\n2. Filter PayFullDate IS NULL to get only unpaid invoices\n3. Use DATEDIFF and CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need to aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need to count records in prth by company\n\nDatabase Schema:\nCREATE TABLE PRTH (\n  PRCo bcompany NOT NULL,\n  PRGroup bgroup NOT NULL,\n  PREndDate bdate NOT NULL,\n  Employee bemployee NOT NULL,\n  PaySeq tinyint NOT NULL,\n  PostSeq smallint NOT NULL,\n  Type char(1) NOT NULL,\n  PostDate bdate NOT NULL,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCDept bdept,\n  GLCo bcompany NOT NULL,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equipment bequip,\n  EMGroup tinyint,\n  CostCode bcostcode,\n  -- ... 41 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count PRTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM PRTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "PRTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get customer balance summary by customer group\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Customer balance summary by group:\n1. Join ARTH to ARCM for customer details\n2. Use conditional SUM for open vs total balances\n3. Group by CustGroup for summary\n\n```sql\nSELECT \n  ARTH.CustGroup,\n  COUNT(DISTINCT ARTH.Customer) AS CustomerCount,\n  SUM(CASE WHEN ARTH.PayFullDate IS NULL THEN ARTH.Amount ELSE 0 END) AS OpenBalance,\n  SUM(ARTH.Amount) AS TotalBilled\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\nGROUP BY ARTH.CustGroup\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to count records in jccd by company\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count JCCD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM JCCD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need to count records in prco by company\n\nDatabase Schema:\nCREATE TABLE PRCO (\n  PRCo bcompany NOT NULL,\n  GLCo bcompany NOT NULL,\n  Jrnl bjrnl,\n  GLInterface byn NOT NULL,\n  CMCo bcompany NOT NULL,\n  APCo bcompany,\n  AutoOT byn NOT NULL,\n  OTEarnCode bedlcode,\n  JCCo bcompany NOT NULL,\n  AllowNoPhase byn NOT NULL,\n  JCInterface byn NOT NULL,\n  InsByPhase byn NOT NULL,\n  JCICraftClass byn NOT NULL,\n  JCICrew byn NOT NULL,\n  JCIEmployee byn NOT NULL,\n  JCIFactor byn NOT NULL,\n  JCIEarnType byn NOT NULL,\n  JCIShift byn NOT NULL,\n  JCIPostingDate byn NOT NULL,\n  JCILiabType byn NOT NULL,\n  -- ... 66 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count PRCO records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM PRCO WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "PRCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How do I count records in jccd by company\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count JCCD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM JCCD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need to count records in arth by company\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count ARTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM ARTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate stored materials (Purchased - Installed) for SL billing\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Stored materials for SL billing:\n1. SLWI contains work item/billing details\n2. StoredMatls = Purchased - Installed (materials on-site but not yet used)\n3. WCCost = Work Completed Cost\n4. WCRetAmt and SMRetAmt = separate retainage for work vs materials\n5. Total billable = WCCost + StoredMatls\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description AS ItemDescription,\n  SLWI.StoredMatls,\n  SLWI.WCCost AS WorkCompletedCost,\n  SLWI.StoredMatls + SLWI.WCCost AS TotalBillable,\n  SLWI.WCRetAmt AS WorkRetainage,\n  SLWI.SMRetAmt AS MaterialsRetainage,\n  SLWI.WCRetAmt + SLWI.SMRetAmt AS TotalRetainage\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\n  AND SLWI.StoredMatls <> 0\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoice totals with discounts and retainage\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Vendor invoice summary with discounts and retainage:\n1. Join APTH to APVM for vendor details\n2. Aggregate by vendor\n3. Include GrossAmt, DiscOffer, Retainage, and Balance\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(APTH.APTrans) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS GrossAmount,\n  SUM(APTH.DiscOffer) AS DiscountsOffered,\n  SUM(APTH.Retainage) AS RetainageHeld,\n  SUM(APTH.Balance) AS OpenBalance\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate stored materials (Purchased - Installed) for SL billing\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Stored materials for SL billing:\n1. SLWI contains work item/billing details\n2. StoredMatls = Purchased - Installed (materials on-site but not yet used)\n3. WCCost = Work Completed Cost\n4. WCRetAmt and SMRetAmt = separate retainage for work vs materials\n5. Total billable = WCCost + StoredMatls\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description AS ItemDescription,\n  SLWI.StoredMatls,\n  SLWI.WCCost AS WorkCompletedCost,\n  SLWI.StoredMatls + SLWI.WCCost AS TotalBillable,\n  SLWI.WCRetAmt AS WorkRetainage,\n  SLWI.SMRetAmt AS MaterialsRetainage,\n  SLWI.WCRetAmt + SLWI.SMRetAmt AS TotalRetainage\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\n  AND SLWI.StoredMatls <> 0\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "basic",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from PRCO\n\nDatabase Schema:\nCREATE TABLE PRCO (\n  PRCo bcompany NOT NULL,\n  GLCo bcompany NOT NULL,\n  Jrnl bjrnl,\n  GLInterface byn NOT NULL,\n  CMCo bcompany NOT NULL,\n  APCo bcompany,\n  AutoOT byn NOT NULL,\n  OTEarnCode bedlcode,\n  JCCo bcompany NOT NULL,\n  AllowNoPhase byn NOT NULL,\n  JCInterface byn NOT NULL,\n  InsByPhase byn NOT NULL,\n  JCICraftClass byn NOT NULL,\n  JCICrew byn NOT NULL,\n  JCIEmployee byn NOT NULL,\n  JCIFactor byn NOT NULL,\n  JCIEarnType byn NOT NULL,\n  JCIShift byn NOT NULL,\n  JCIPostingDate byn NOT NULL,\n  JCILiabType byn NOT NULL,\n  -- ... 66 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from PRCO ().\n\n```sql\nSELECT *\nFROM PRCO WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "PRCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get subcontractor costs with original, change orders, invoiced, paid, and retainage by vendor\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Subcontractor cost breakdown by vendor:\n1. Join SLHD (Header) to SLIT (Items) for subcontract details\n2. Join APVM for vendor names\n3. OrigCost = original contract amount\n4. CurCost - OrigCost = change order amounts\n5. InvCost = amounts invoiced\n6. Retainage = amounts held back\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  SLHD.SL AS SubcontractNum,\n  SLHD.Description AS SubcontractDesc,\n  SUM(SLIT.OrigCost) AS OriginalCost,\n  SUM(SLIT.CurCost - SLIT.OrigCost) AS ChangeOrderCost,\n  SUM(SLIT.CurCost) AS CurrentCost,\n  SUM(SLIT.InvCost) AS InvoicedCost,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost - SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nINNER JOIN APVM WITH (NOLOCK) ON SLHD.VendorGroup = APVM.VendorGroup AND SLHD.Vendor = APVM.Vendor\nWHERE SLHD.SLCo = @SLCo\nGROUP BY APVM.Vendor, APVM.Name, SLHD.SL, SLHD.Description\nORDER BY APVM.Name, SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLHD",
        "SLIT",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: track ap hold status distinguishing retainage vs non-retainage holds\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APCO (\n  APCo bcompany NOT NULL,\n  GLCo bcompany NOT NULL,\n  ExpJrnl bjrnl,\n  GLExpInterfaceLvl tinyint NOT NULL,\n  GLExpSummaryDesc varchar(60),\n  GLExpTransDesc varchar(60),\n  GLJobDetailDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLEquipDetailDesc varchar(60),\n  GLExpDetailDesc varchar(60),\n  PayJrnl bjrnl,\n  GLPayInterfaceLvl tinyint NOT NULL,\n  GLPayDetailDesc varchar(60),\n  GLPaySummaryDesc varchar(60),\n  DiscOffGLAcct bglacct,\n  DiscTakenGLAcct bglacct,\n  ExpPayType tinyint,\n  JobPayType tinyint,\n  SubPayType tinyint,\n  RetPayType tinyint,\n  -- ... 92 more columns,\n  PRIMARY KEY (APCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To distinguish retainage vs non-retainage holds:\n1. Join APTD to APHD for hold details\n2. Join APCO to get RetHoldCode setting\n3. Compare APHD.HoldCode to APCO.RetHoldCode\n4. If equal, it's a retainage hold; otherwise non-retainage\n\n```sql\nSELECT \n  APTD.APCo,\n  APTD.Vendor,\n  APTD.Mth,\n  APTD.APTrans,\n  APHD.HoldCode,\n  CASE WHEN APHD.HoldCode = APCO.RetHoldCode \n       THEN 'Retainage Hold' \n       ELSE 'Non-Retainage Hold' END AS HoldType,\n  APTD.Amount\nFROM APTD WITH (NOLOCK)\nINNER JOIN APHD WITH (NOLOCK) ON APTD.APCo = APHD.APCo \n  AND APTD.Mth = APHD.Mth \n  AND APTD.APTrans = APHD.APTrans \n  AND APTD.APLine = APHD.APLine\nINNER JOIN APCO WITH (NOLOCK) ON APTD.APCo = APCO.APCo\nWHERE APTD.APCo = @APCo\n  AND APHD.HoldCode IS NOT NULL\nORDER BY APTD.Vendor, APTD.Mth\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTD",
        "APHD",
        "APCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging buckets (30/60/90+ days) for unpaid invoices by customer\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Use ARTH for transaction data and ARCM for customer names\n2. Filter PayFullDate IS NULL to get only unpaid invoices\n3. Use DATEDIFF and CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate stored materials (Purchased - Installed) for SL billing\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Stored materials for SL billing:\n1. SLWI contains work item/billing details\n2. StoredMatls = Purchased - Installed (materials on-site but not yet used)\n3. WCCost = Work Completed Cost\n4. WCRetAmt and SMRetAmt = separate retainage for work vs materials\n5. Total billable = WCCost + StoredMatls\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description AS ItemDescription,\n  SLWI.StoredMatls,\n  SLWI.WCCost AS WorkCompletedCost,\n  SLWI.StoredMatls + SLWI.WCCost AS TotalBillable,\n  SLWI.WCRetAmt AS WorkRetainage,\n  SLWI.SMRetAmt AS MaterialsRetainage,\n  SLWI.WCRetAmt + SLWI.SMRetAmt AS TotalRetainage\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\n  AND SLWI.StoredMatls <> 0\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from JCCD\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from JCCD ().\n\n```sql\nSELECT *\nFROM JCCD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query to count records in arth by company\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count ARTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM ARTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from SLWI\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from SLWI ().\n\n```sql\nSELECT *\nFROM SLWI WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "SLWI"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate stored materials (Purchased - Installed) for SL billing\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Stored materials for SL billing:\n1. SLWI contains work item/billing details\n2. StoredMatls = Purchased - Installed (materials on-site but not yet used)\n3. WCCost = Work Completed Cost\n4. WCRetAmt and SMRetAmt = separate retainage for work vs materials\n5. Total billable = WCCost + StoredMatls\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description AS ItemDescription,\n  SLWI.StoredMatls,\n  SLWI.WCCost AS WorkCompletedCost,\n  SLWI.StoredMatls + SLWI.WCCost AS TotalBillable,\n  SLWI.WCRetAmt AS WorkRetainage,\n  SLWI.SMRetAmt AS MaterialsRetainage,\n  SLWI.WCRetAmt + SLWI.SMRetAmt AS TotalRetainage\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\n  AND SLWI.StoredMatls <> 0\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "intermediate",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoice totals with discounts and retainage\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Vendor invoice summary with discounts and retainage:\n1. Join APTH to APVM for vendor details\n2. Aggregate by vendor\n3. Include GrossAmt, DiscOffer, Retainage, and Balance\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(APTH.APTrans) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS GrossAmount,\n  SUM(APTH.DiscOffer) AS DiscountsOffered,\n  SUM(APTH.Retainage) AS RetainageHeld,\n  SUM(APTH.Balance) AS OpenBalance\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to count records in prth by company\n\nDatabase Schema:\nCREATE TABLE PRTH (\n  PRCo bcompany NOT NULL,\n  PRGroup bgroup NOT NULL,\n  PREndDate bdate NOT NULL,\n  Employee bemployee NOT NULL,\n  PaySeq tinyint NOT NULL,\n  PostSeq smallint NOT NULL,\n  Type char(1) NOT NULL,\n  PostDate bdate NOT NULL,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCDept bdept,\n  GLCo bcompany NOT NULL,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equipment bequip,\n  EMGroup tinyint,\n  CostCode bcostcode,\n  -- ... 41 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count PRTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM PRTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "PRTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get subcontractor costs with original, change orders, invoiced, paid, and retainage by vendor\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Subcontractor cost breakdown by vendor:\n1. Join SLHD (Header) to SLIT (Items) for subcontract details\n2. Join APVM for vendor names\n3. OrigCost = original contract amount\n4. CurCost - OrigCost = change order amounts\n5. InvCost = amounts invoiced\n6. Retainage = amounts held back\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  SLHD.SL AS SubcontractNum,\n  SLHD.Description AS SubcontractDesc,\n  SUM(SLIT.OrigCost) AS OriginalCost,\n  SUM(SLIT.CurCost - SLIT.OrigCost) AS ChangeOrderCost,\n  SUM(SLIT.CurCost) AS CurrentCost,\n  SUM(SLIT.InvCost) AS InvoicedCost,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost - SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nINNER JOIN APVM WITH (NOLOCK) ON SLHD.VendorGroup = APVM.VendorGroup AND SLHD.Vendor = APVM.Vendor\nWHERE SLHD.SLCo = @SLCo\nGROUP BY APVM.Vendor, APVM.Name, SLHD.SL, SLHD.Description\nORDER BY APVM.Name, SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "intermediate",
      "tables_used": [
        "SLHD",
        "SLIT",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to count records in jccd by company\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count JCCD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM JCCD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find jobs over budget with remaining cost projection\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Find jobs over budget:\n1. Aggregate JCCP by job from JCJM\n2. Compare total ActualCost to CurrEstCost\n3. Use HAVING to filter only over-budget jobs\n4. Sort by amount over budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description,\n  SUM(JCCP.CurrEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.CurrEstCost) - SUM(JCCP.ActualCost) AS RemainingBudget,\n  CASE WHEN SUM(JCCP.CurrEstCost) < SUM(JCCP.ActualCost) \n       THEN 'OVER BUDGET' ELSE 'OK' END AS Status\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\nGROUP BY JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.CurrEstCost)\nORDER BY (SUM(JCCP.ActualCost) - SUM(JCCP.CurrEstCost)) DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM",
        "JCCD",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find all unpaid AR invoices older than 60 days\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find unpaid invoices over 60 days:\n1. Join ARTH to ARCM for customer information\n2. Filter PayFullDate IS NULL (unpaid)\n3. Use DATEDIFF to calculate age and filter > 60 days\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Mth,\n  ARTH.ARTrans,\n  ARCM.Name AS CustomerName,\n  ARTH.TransDate,\n  ARTH.Amount,\n  DATEDIFF(day, ARTH.TransDate, GETDATE()) AS DaysOutstanding\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\n  AND DATEDIFF(day, ARTH.TransDate, GETDATE()) > 60\nORDER BY ARTH.TransDate\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from JCCD\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from JCCD ().\n\n```sql\nSELECT *\nFROM JCCD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from JCCD\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from JCCD ().\n\n```sql\nSELECT *\nFROM JCCD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get customer balance summary by customer group\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Customer balance summary by group:\n1. Join ARTH to ARCM for customer details\n2. Use conditional SUM for open vs total balances\n3. Group by CustGroup for summary\n\n```sql\nSELECT \n  ARTH.CustGroup,\n  COUNT(DISTINCT ARTH.Customer) AS CustomerCount,\n  SUM(CASE WHEN ARTH.PayFullDate IS NULL THEN ARTH.Amount ELSE 0 END) AS OpenBalance,\n  SUM(ARTH.Amount) AS TotalBilled\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\nGROUP BY ARTH.CustGroup\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find jobs over budget with remaining cost projection\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Find jobs over budget:\n1. Aggregate JCCP by job from JCJM\n2. Compare total ActualCost to CurrEstCost\n3. Use HAVING to filter only over-budget jobs\n4. Sort by amount over budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description,\n  SUM(JCCP.CurrEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.CurrEstCost) - SUM(JCCP.ActualCost) AS RemainingBudget,\n  CASE WHEN SUM(JCCP.CurrEstCost) < SUM(JCCP.ActualCost) \n       THEN 'OVER BUDGET' ELSE 'OK' END AS Status\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\nGROUP BY JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.CurrEstCost)\nORDER BY (SUM(JCCP.ActualCost) - SUM(JCCP.CurrEstCost)) DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCJM",
        "JCCD",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How do I count records in glac by company\n\nDatabase Schema:\nCREATE TABLE GLAC (\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  Description bdesc,\n  AcctType char(1) NOT NULL,\n  SubType char(1),\n  NormBal char(1),\n  InterfaceDetail byn NOT NULL,\n  Active byn NOT NULL,\n  SummaryAcct bglacct NOT NULL,\n  CashAccrual char(1) NOT NULL,\n  CashOffAcct bglacct,\n  Notes varchar,\n  Part1 varchar(20),\n  Part2 varchar(20),\n  Part3 varchar(20),\n  Part4 varchar(20),\n  Part5 varchar(20),\n  Part6 varchar(20),\n  AllParts varchar(20),\n  CrossRefMemAcct bglacct,\n  -- ... 3 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count GLAC records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM GLAC WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "GLAC"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from JCCD\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from JCCD ().\n\n```sql\nSELECT *\nFROM JCCD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from PRTH\n\nDatabase Schema:\nCREATE TABLE PRTH (\n  PRCo bcompany NOT NULL,\n  PRGroup bgroup NOT NULL,\n  PREndDate bdate NOT NULL,\n  Employee bemployee NOT NULL,\n  PaySeq tinyint NOT NULL,\n  PostSeq smallint NOT NULL,\n  Type char(1) NOT NULL,\n  PostDate bdate NOT NULL,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCDept bdept,\n  GLCo bcompany NOT NULL,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equipment bequip,\n  EMGroup tinyint,\n  CostCode bcostcode,\n  -- ... 41 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from PRTH ().\n\n```sql\nSELECT *\nFROM PRTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "PRTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find all unpaid AR invoices older than 60 days\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find unpaid invoices over 60 days:\n1. Join ARTH to ARCM for customer information\n2. Filter PayFullDate IS NULL (unpaid)\n3. Use DATEDIFF to calculate age and filter > 60 days\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Mth,\n  ARTH.ARTrans,\n  ARCM.Name AS CustomerName,\n  ARTH.TransDate,\n  ARTH.Amount,\n  DATEDIFF(day, ARTH.TransDate, GETDATE()) AS DaysOutstanding\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\n  AND DATEDIFF(day, ARTH.TransDate, GETDATE()) > 60\nORDER BY ARTH.TransDate\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to count records in jccd by company\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count JCCD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM JCCD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query to aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get subcontractor costs with original, change orders, invoiced, paid, and retainage by vendor\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Subcontractor cost breakdown by vendor:\n1. Join SLHD (Header) to SLIT (Items) for subcontract details\n2. Join APVM for vendor names\n3. OrigCost = original contract amount\n4. CurCost - OrigCost = change order amounts\n5. InvCost = amounts invoiced\n6. Retainage = amounts held back\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  SLHD.SL AS SubcontractNum,\n  SLHD.Description AS SubcontractDesc,\n  SUM(SLIT.OrigCost) AS OriginalCost,\n  SUM(SLIT.CurCost - SLIT.OrigCost) AS ChangeOrderCost,\n  SUM(SLIT.CurCost) AS CurrentCost,\n  SUM(SLIT.InvCost) AS InvoicedCost,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost - SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nINNER JOIN APVM WITH (NOLOCK) ON SLHD.VendorGroup = APVM.VendorGroup AND SLHD.Vendor = APVM.Vendor\nWHERE SLHD.SLCo = @SLCo\nGROUP BY APVM.Vendor, APVM.Name, SLHD.SL, SLHD.Description\nORDER BY APVM.Name, SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "basic",
      "tables_used": [
        "SLHD",
        "SLIT",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get subcontractor costs with original, change orders, invoiced, paid, and retainage by vendor\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Subcontractor cost breakdown by vendor:\n1. Join SLHD (Header) to SLIT (Items) for subcontract details\n2. Join APVM for vendor names\n3. OrigCost = original contract amount\n4. CurCost - OrigCost = change order amounts\n5. InvCost = amounts invoiced\n6. Retainage = amounts held back\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  SLHD.SL AS SubcontractNum,\n  SLHD.Description AS SubcontractDesc,\n  SUM(SLIT.OrigCost) AS OriginalCost,\n  SUM(SLIT.CurCost - SLIT.OrigCost) AS ChangeOrderCost,\n  SUM(SLIT.CurCost) AS CurrentCost,\n  SUM(SLIT.InvCost) AS InvoicedCost,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost - SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nINNER JOIN APVM WITH (NOLOCK) ON SLHD.VendorGroup = APVM.VendorGroup AND SLHD.Vendor = APVM.Vendor\nWHERE SLHD.SLCo = @SLCo\nGROUP BY APVM.Vendor, APVM.Name, SLHD.SL, SLHD.Description\nORDER BY APVM.Name, SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "intermediate",
      "tables_used": [
        "SLHD",
        "SLIT",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from JCCD\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from JCCD ().\n\n```sql\nSELECT *\nFROM JCCD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get customer balance summary by customer group\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Customer balance summary by group:\n1. Join ARTH to ARCM for customer details\n2. Use conditional SUM for open vs total balances\n3. Group by CustGroup for summary\n\n```sql\nSELECT \n  ARTH.CustGroup,\n  COUNT(DISTINCT ARTH.Customer) AS CustomerCount,\n  SUM(CASE WHEN ARTH.PayFullDate IS NULL THEN ARTH.Amount ELSE 0 END) AS OpenBalance,\n  SUM(ARTH.Amount) AS TotalBilled\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\nGROUP BY ARTH.CustGroup\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How do I reconcile ap oncost batch lines with original transactions\n\nDatabase Schema:\nCREATE TABLE APTL (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equip bequip,\n  EMGroup bgroup,\n  -- ... 56 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans, APLine)\n);\n\nCREATE TABLE APLB (\n  Co bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  BatchId bbatchid NOT NULL,\n  BatchSeq int NOT NULL,\n  APLine smallint NOT NULL,\n  BatchTransType char(1) NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  -- ... 120 more columns,\n  PRIMARY KEY (Co, Mth, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APHB (\n  Co bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  BatchId bbatchid NOT NULL,\n  BatchSeq int NOT NULL,\n  BatchTransType char(1) NOT NULL,\n  APTrans btrans,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  -- ... 88 more columns,\n  PRIMARY KEY (Co, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To reconcile AP oncost batches with original transactions:\n1. Join APLB (batch lines) to APTL (original lines) using ocApplyMth, ocApplyTrans, ocApplyLine\n2. Include APHB for batch header info\n3. Join to APTH and APVM for vendor context\n4. Compare batch vs original amounts\n\n```sql\nSELECT \n  APLB.Co AS BatchCo,\n  APLB.Mth AS BatchMth,\n  APLB.BatchId,\n  APLB.BatchSeq,\n  APLB.ocApplyMth,\n  APLB.ocApplyTrans,\n  APLB.ocApplyLine,\n  APTL.APCo AS OrigCo,\n  APTL.Mth AS OrigMth,\n  APTL.APTrans AS OrigTrans,\n  APTL.APLine AS OrigLine,\n  APTL.GrossAmt AS OrigAmount,\n  APLB.GrossAmt AS BatchAmount,\n  APVM.Name AS VendorName\nFROM APLB WITH (NOLOCK)\nINNER JOIN APHB WITH (NOLOCK) ON APLB.Co = APHB.Co AND APLB.Mth = APHB.Mth AND APLB.BatchId = APHB.BatchId\nINNER JOIN APTL WITH (NOLOCK) ON APLB.ocApplyMth = APTL.Mth \n  AND APLB.ocApplyTrans = APTL.APTrans \n  AND APLB.ocApplyLine = APTL.APLine\n  AND APLB.Co = APTL.APCo\nINNER JOIN APTH WITH (NOLOCK) ON APTL.APCo = APTH.APCo AND APTL.Mth = APTH.Mth AND APTL.APTrans = APTH.APTrans\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APLB.Co = @Co\nORDER BY APLB.BatchId, APLB.BatchSeq\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APLB",
        "APHB",
        "APTL",
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get subcontractor costs with original, change orders, invoiced, paid, and retainage by vendor\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Subcontractor cost breakdown by vendor:\n1. Join SLHD (Header) to SLIT (Items) for subcontract details\n2. Join APVM for vendor names\n3. OrigCost = original contract amount\n4. CurCost - OrigCost = change order amounts\n5. InvCost = amounts invoiced\n6. Retainage = amounts held back\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  SLHD.SL AS SubcontractNum,\n  SLHD.Description AS SubcontractDesc,\n  SUM(SLIT.OrigCost) AS OriginalCost,\n  SUM(SLIT.CurCost - SLIT.OrigCost) AS ChangeOrderCost,\n  SUM(SLIT.CurCost) AS CurrentCost,\n  SUM(SLIT.InvCost) AS InvoicedCost,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost - SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nINNER JOIN APVM WITH (NOLOCK) ON SLHD.VendorGroup = APVM.VendorGroup AND SLHD.Vendor = APVM.Vendor\nWHERE SLHD.SLCo = @SLCo\nGROUP BY APVM.Vendor, APVM.Name, SLHD.SL, SLHD.Description\nORDER BY APVM.Name, SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLHD",
        "SLIT",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get subcontractor costs with original, change orders, invoiced, paid, and retainage by vendor\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Subcontractor cost breakdown by vendor:\n1. Join SLHD (Header) to SLIT (Items) for subcontract details\n2. Join APVM for vendor names\n3. OrigCost = original contract amount\n4. CurCost - OrigCost = change order amounts\n5. InvCost = amounts invoiced\n6. Retainage = amounts held back\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  SLHD.SL AS SubcontractNum,\n  SLHD.Description AS SubcontractDesc,\n  SUM(SLIT.OrigCost) AS OriginalCost,\n  SUM(SLIT.CurCost - SLIT.OrigCost) AS ChangeOrderCost,\n  SUM(SLIT.CurCost) AS CurrentCost,\n  SUM(SLIT.InvCost) AS InvoicedCost,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost - SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nINNER JOIN APVM WITH (NOLOCK) ON SLHD.VendorGroup = APVM.VendorGroup AND SLHD.Vendor = APVM.Vendor\nWHERE SLHD.SLCo = @SLCo\nGROUP BY APVM.Vendor, APVM.Name, SLHD.SL, SLHD.Description\nORDER BY APVM.Name, SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "intermediate",
      "tables_used": [
        "SLHD",
        "SLIT",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to reconcile ap oncost batch lines with original transactions\n\nDatabase Schema:\nCREATE TABLE APTL (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equip bequip,\n  EMGroup bgroup,\n  -- ... 56 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans, APLine)\n);\n\nCREATE TABLE APLB (\n  Co bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  BatchId bbatchid NOT NULL,\n  BatchSeq int NOT NULL,\n  APLine smallint NOT NULL,\n  BatchTransType char(1) NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  -- ... 120 more columns,\n  PRIMARY KEY (Co, Mth, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APHB (\n  Co bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  BatchId bbatchid NOT NULL,\n  BatchSeq int NOT NULL,\n  BatchTransType char(1) NOT NULL,\n  APTrans btrans,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  -- ... 88 more columns,\n  PRIMARY KEY (Co, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To reconcile AP oncost batches with original transactions:\n1. Join APLB (batch lines) to APTL (original lines) using ocApplyMth, ocApplyTrans, ocApplyLine\n2. Include APHB for batch header info\n3. Join to APTH and APVM for vendor context\n4. Compare batch vs original amounts\n\n```sql\nSELECT \n  APLB.Co AS BatchCo,\n  APLB.Mth AS BatchMth,\n  APLB.BatchId,\n  APLB.BatchSeq,\n  APLB.ocApplyMth,\n  APLB.ocApplyTrans,\n  APLB.ocApplyLine,\n  APTL.APCo AS OrigCo,\n  APTL.Mth AS OrigMth,\n  APTL.APTrans AS OrigTrans,\n  APTL.APLine AS OrigLine,\n  APTL.GrossAmt AS OrigAmount,\n  APLB.GrossAmt AS BatchAmount,\n  APVM.Name AS VendorName\nFROM APLB WITH (NOLOCK)\nINNER JOIN APHB WITH (NOLOCK) ON APLB.Co = APHB.Co AND APLB.Mth = APHB.Mth AND APLB.BatchId = APHB.BatchId\nINNER JOIN APTL WITH (NOLOCK) ON APLB.ocApplyMth = APTL.Mth \n  AND APLB.ocApplyTrans = APTL.APTrans \n  AND APLB.ocApplyLine = APTL.APLine\n  AND APLB.Co = APTL.APCo\nINNER JOIN APTH WITH (NOLOCK) ON APTL.APCo = APTH.APCo AND APTL.Mth = APTH.Mth AND APTL.APTrans = APTH.APTrans\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APLB.Co = @Co\nORDER BY APLB.BatchId, APLB.BatchSeq\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APLB",
        "APHB",
        "APTL",
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from JCCD\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from JCCD ().\n\n```sql\nSELECT *\nFROM JCCD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from APTD\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from APTD ().\n\n```sql\nSELECT *\nFROM APTD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: count records in prpc by company\n\nDatabase Schema:\nCREATE TABLE PRPC (\n  PRCo bcompany NOT NULL,\n  PRGroup bgroup NOT NULL,\n  PREndDate bdate NOT NULL,\n  BeginDate bdate NOT NULL,\n  MultiMth byn NOT NULL,\n  BeginMth bmonth NOT NULL,\n  EndMth bmonth,\n  CutoffDate bdate,\n  LimitMth bmonth NOT NULL,\n  Hrs smallint NOT NULL,\n  Days tinyint NOT NULL,\n  Wks tinyint NOT NULL,\n  Status tinyint NOT NULL,\n  DateClosed smalldatetime,\n  JCInterface byn NOT NULL,\n  EMInterface byn NOT NULL,\n  GLInterface byn NOT NULL,\n  APInterface byn NOT NULL,\n  LeaveProcess byn NOT NULL,\n  InUseBy bvpusername,\n  -- ... 7 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count PRPC records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM PRPC WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "PRPC"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Query ARCM along with the schema tables\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'ARCM' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nAPTH, APVM\n\nTo include ARCM in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get subcontractor costs with original, change orders, invoiced, paid, and retainage by vendor\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Subcontractor cost breakdown by vendor:\n1. Join SLHD (Header) to SLIT (Items) for subcontract details\n2. Join APVM for vendor names\n3. OrigCost = original contract amount\n4. CurCost - OrigCost = change order amounts\n5. InvCost = amounts invoiced\n6. Retainage = amounts held back\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  SLHD.SL AS SubcontractNum,\n  SLHD.Description AS SubcontractDesc,\n  SUM(SLIT.OrigCost) AS OriginalCost,\n  SUM(SLIT.CurCost - SLIT.OrigCost) AS ChangeOrderCost,\n  SUM(SLIT.CurCost) AS CurrentCost,\n  SUM(SLIT.InvCost) AS InvoicedCost,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost - SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nINNER JOIN APVM WITH (NOLOCK) ON SLHD.VendorGroup = APVM.VendorGroup AND SLHD.Vendor = APVM.Vendor\nWHERE SLHD.SLCo = @SLCo\nGROUP BY APVM.Vendor, APVM.Name, SLHD.SL, SLHD.Description\nORDER BY APVM.Name, SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLHD",
        "SLIT",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from PRCO\n\nDatabase Schema:\nCREATE TABLE PRCO (\n  PRCo bcompany NOT NULL,\n  GLCo bcompany NOT NULL,\n  Jrnl bjrnl,\n  GLInterface byn NOT NULL,\n  CMCo bcompany NOT NULL,\n  APCo bcompany,\n  AutoOT byn NOT NULL,\n  OTEarnCode bedlcode,\n  JCCo bcompany NOT NULL,\n  AllowNoPhase byn NOT NULL,\n  JCInterface byn NOT NULL,\n  InsByPhase byn NOT NULL,\n  JCICraftClass byn NOT NULL,\n  JCICrew byn NOT NULL,\n  JCIEmployee byn NOT NULL,\n  JCIFactor byn NOT NULL,\n  JCIEarnType byn NOT NULL,\n  JCIShift byn NOT NULL,\n  JCIPostingDate byn NOT NULL,\n  JCILiabType byn NOT NULL,\n  -- ... 66 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from PRCO ().\n\n```sql\nSELECT *\nFROM PRCO WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "PRCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from GLAC\n\nDatabase Schema:\nCREATE TABLE GLAC (\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  Description bdesc,\n  AcctType char(1) NOT NULL,\n  SubType char(1),\n  NormBal char(1),\n  InterfaceDetail byn NOT NULL,\n  Active byn NOT NULL,\n  SummaryAcct bglacct NOT NULL,\n  CashAccrual char(1) NOT NULL,\n  CashOffAcct bglacct,\n  Notes varchar,\n  Part1 varchar(20),\n  Part2 varchar(20),\n  Part3 varchar(20),\n  Part4 varchar(20),\n  Part5 varchar(20),\n  Part6 varchar(20),\n  AllParts varchar(20),\n  CrossRefMemAcct bglacct,\n  -- ... 3 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from GLAC ().\n\n```sql\nSELECT *\nFROM GLAC WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "GLAC"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find all unpaid AR invoices older than 60 days\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find unpaid invoices over 60 days:\n1. Join ARTH to ARCM for customer information\n2. Filter PayFullDate IS NULL (unpaid)\n3. Use DATEDIFF to calculate age and filter > 60 days\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Mth,\n  ARTH.ARTrans,\n  ARCM.Name AS CustomerName,\n  ARTH.TransDate,\n  ARTH.Amount,\n  DATEDIFF(day, ARTH.TransDate, GETDATE()) AS DaysOutstanding\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\n  AND DATEDIFF(day, ARTH.TransDate, GETDATE()) > 60\nORDER BY ARTH.TransDate\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need to aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find jobs over budget with remaining cost projection\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Find jobs over budget:\n1. Aggregate JCCP by job from JCJM\n2. Compare total ActualCost to CurrEstCost\n3. Use HAVING to filter only over-budget jobs\n4. Sort by amount over budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description,\n  SUM(JCCP.CurrEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.CurrEstCost) - SUM(JCCP.ActualCost) AS RemainingBudget,\n  CASE WHEN SUM(JCCP.CurrEstCost) < SUM(JCCP.ActualCost) \n       THEN 'OVER BUDGET' ELSE 'OK' END AS Status\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\nGROUP BY JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.CurrEstCost)\nORDER BY (SUM(JCCP.ActualCost) - SUM(JCCP.CurrEstCost)) DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCJM",
        "JCCD",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How do I aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get subcontractor costs with original, change orders, invoiced, paid, and retainage by vendor\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Subcontractor cost breakdown by vendor:\n1. Join SLHD (Header) to SLIT (Items) for subcontract details\n2. Join APVM for vendor names\n3. OrigCost = original contract amount\n4. CurCost - OrigCost = change order amounts\n5. InvCost = amounts invoiced\n6. Retainage = amounts held back\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  SLHD.SL AS SubcontractNum,\n  SLHD.Description AS SubcontractDesc,\n  SUM(SLIT.OrigCost) AS OriginalCost,\n  SUM(SLIT.CurCost - SLIT.OrigCost) AS ChangeOrderCost,\n  SUM(SLIT.CurCost) AS CurrentCost,\n  SUM(SLIT.InvCost) AS InvoicedCost,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost - SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nINNER JOIN APVM WITH (NOLOCK) ON SLHD.VendorGroup = APVM.VendorGroup AND SLHD.Vendor = APVM.Vendor\nWHERE SLHD.SLCo = @SLCo\nGROUP BY APVM.Vendor, APVM.Name, SLHD.SL, SLHD.Description\nORDER BY APVM.Name, SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "basic",
      "tables_used": [
        "SLHD",
        "SLIT",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: count records in glac by company\n\nDatabase Schema:\nCREATE TABLE GLAC (\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  Description bdesc,\n  AcctType char(1) NOT NULL,\n  SubType char(1),\n  NormBal char(1),\n  InterfaceDetail byn NOT NULL,\n  Active byn NOT NULL,\n  SummaryAcct bglacct NOT NULL,\n  CashAccrual char(1) NOT NULL,\n  CashOffAcct bglacct,\n  Notes varchar,\n  Part1 varchar(20),\n  Part2 varchar(20),\n  Part3 varchar(20),\n  Part4 varchar(20),\n  Part5 varchar(20),\n  Part6 varchar(20),\n  AllParts varchar(20),\n  CrossRefMemAcct bglacct,\n  -- ... 3 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count GLAC records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM GLAC WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "GLAC"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoice totals with discounts and retainage\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Vendor invoice summary with discounts and retainage:\n1. Join APTH to APVM for vendor details\n2. Aggregate by vendor\n3. Include GrossAmt, DiscOffer, Retainage, and Balance\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(APTH.APTrans) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS GrossAmount,\n  SUM(APTH.DiscOffer) AS DiscountsOffered,\n  SUM(APTH.Retainage) AS RetainageHeld,\n  SUM(APTH.Balance) AS OpenBalance\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from SLWI\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from SLWI ().\n\n```sql\nSELECT *\nFROM SLWI WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "SLWI"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get job cost variance by phase comparing budget to actual\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Job cost variance by phase:\n1. Join JCJM (Job Master) to JCCP (Cost Phase)\n2. Calculate variance as CurrEstCost - ActualCost\n3. Calculate percent complete from actuals vs budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  JCCP.Phase,\n  JCCP.CostType,\n  JCCP.OrigEstCost AS OriginalBudget,\n  JCCP.CurrEstCost AS CurrentBudget,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS Variance,\n  CASE WHEN JCCP.CurrEstCost <> 0 \n       THEN (JCCP.ActualCost / JCCP.CurrEstCost) * 100 \n       ELSE 0 END AS PercentComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.Job = @Job\nORDER BY JCCP.Phase, JCCP.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoice totals with discounts and retainage\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Vendor invoice summary with discounts and retainage:\n1. Join APTH to APVM for vendor details\n2. Aggregate by vendor\n3. Include GrossAmt, DiscOffer, Retainage, and Balance\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(APTH.APTrans) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS GrossAmount,\n  SUM(APTH.DiscOffer) AS DiscountsOffered,\n  SUM(APTH.Retainage) AS RetainageHeld,\n  SUM(APTH.Balance) AS OpenBalance\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "basic",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: count records in prco by company\n\nDatabase Schema:\nCREATE TABLE PRCO (\n  PRCo bcompany NOT NULL,\n  GLCo bcompany NOT NULL,\n  Jrnl bjrnl,\n  GLInterface byn NOT NULL,\n  CMCo bcompany NOT NULL,\n  APCo bcompany,\n  AutoOT byn NOT NULL,\n  OTEarnCode bedlcode,\n  JCCo bcompany NOT NULL,\n  AllowNoPhase byn NOT NULL,\n  JCInterface byn NOT NULL,\n  InsByPhase byn NOT NULL,\n  JCICraftClass byn NOT NULL,\n  JCICrew byn NOT NULL,\n  JCIEmployee byn NOT NULL,\n  JCIFactor byn NOT NULL,\n  JCIEarnType byn NOT NULL,\n  JCIShift byn NOT NULL,\n  JCIPostingDate byn NOT NULL,\n  JCILiabType byn NOT NULL,\n  -- ... 66 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count PRCO records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM PRCO WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "PRCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from PREH\n\nDatabase Schema:\nCREATE TABLE PREH (\n  PRCo bcompany NOT NULL,\n  Employee bemployee NOT NULL,\n  LastName varchar(30) NOT NULL,\n  FirstName varchar(30),\n  MidName varchar(15),\n  SortName bsortname NOT NULL,\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  Phone bphone,\n  SSN char(11) NOT NULL,\n  Race char(2) NOT NULL,\n  Sex char(1) NOT NULL,\n  BirthDate smalldatetime,\n  HireDate bdate,\n  TermDate bdate,\n  PRGroup bgroup NOT NULL,\n  PRDept bdept NOT NULL,\n  -- ... 121 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from PREH ().\n\n```sql\nSELECT *\nFROM PREH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "PREH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: count records in prth by company\n\nDatabase Schema:\nCREATE TABLE PRTH (\n  PRCo bcompany NOT NULL,\n  PRGroup bgroup NOT NULL,\n  PREndDate bdate NOT NULL,\n  Employee bemployee NOT NULL,\n  PaySeq tinyint NOT NULL,\n  PostSeq smallint NOT NULL,\n  Type char(1) NOT NULL,\n  PostDate bdate NOT NULL,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCDept bdept,\n  GLCo bcompany NOT NULL,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equipment bequip,\n  EMGroup tinyint,\n  CostCode bcostcode,\n  -- ... 41 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count PRTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM PRTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "PRTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging buckets (30/60/90+ days) for unpaid invoices by customer\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Use ARTH for transaction data and ARCM for customer names\n2. Filter PayFullDate IS NULL to get only unpaid invoices\n3. Use DATEDIFF and CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoice totals with discounts and retainage\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Vendor invoice summary with discounts and retainage:\n1. Join APTH to APVM for vendor details\n2. Aggregate by vendor\n3. Include GrossAmt, DiscOffer, Retainage, and Balance\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(APTH.APTrans) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS GrossAmount,\n  SUM(APTH.DiscOffer) AS DiscountsOffered,\n  SUM(APTH.Retainage) AS RetainageHeld,\n  SUM(APTH.Balance) AS OpenBalance\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging with customer contact information\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I can partially answer this query, but the schema is incomplete.\n\nThe query requires ARCM (AR Customer Master) for customer details, but only ARTH is provided in the schema.\n\nHere's what I can provide with the available schema:\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n-- Note: Additional joins for ARCM would be needed for complete results\n```\n\nTo get the complete data you requested, please provide the DDL for ARCM.",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from PREH\n\nDatabase Schema:\nCREATE TABLE PREH (\n  PRCo bcompany NOT NULL,\n  Employee bemployee NOT NULL,\n  LastName varchar(30) NOT NULL,\n  FirstName varchar(30),\n  MidName varchar(15),\n  SortName bsortname NOT NULL,\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  Phone bphone,\n  SSN char(11) NOT NULL,\n  Race char(2) NOT NULL,\n  Sex char(1) NOT NULL,\n  BirthDate smalldatetime,\n  HireDate bdate,\n  TermDate bdate,\n  PRGroup bgroup NOT NULL,\n  PRDept bdept NOT NULL,\n  -- ... 121 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from PREH ().\n\n```sql\nSELECT *\nFROM PREH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "PREH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to count records in glco by company\n\nDatabase Schema:\nCREATE TABLE GLCO (\n  GLCo bcompany NOT NULL,\n  Consolid byn NOT NULL,\n  LastMthSubClsd bmonth NOT NULL,\n  LastMthGLClsd bmonth NOT NULL,\n  MaxOpen tinyint NOT NULL,\n  CashAccrual char(1) NOT NULL,\n  Unbal byn NOT NULL,\n  AuditCoParams byn NOT NULL,\n  AuditAccts byn NOT NULL,\n  AuditAutoJrnl byn NOT NULL,\n  AuditBals byn NOT NULL,\n  AuditBudgets byn NOT NULL,\n  AuditDetail byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  XCompJrnlEntryYN byn NOT NULL,\n  KeyID bigint NOT NULL,\n  LastMthAPClsd bmonth NOT NULL,\n  LastMthARClsd bmonth NOT NULL,\n  AttachBatchReportsYN byn NOT NULL,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count GLCO records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM GLCO WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "GLCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to count records in preh by company\n\nDatabase Schema:\nCREATE TABLE PREH (\n  PRCo bcompany NOT NULL,\n  Employee bemployee NOT NULL,\n  LastName varchar(30) NOT NULL,\n  FirstName varchar(30),\n  MidName varchar(15),\n  SortName bsortname NOT NULL,\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  Phone bphone,\n  SSN char(11) NOT NULL,\n  Race char(2) NOT NULL,\n  Sex char(1) NOT NULL,\n  BirthDate smalldatetime,\n  HireDate bdate,\n  TermDate bdate,\n  PRGroup bgroup NOT NULL,\n  PRDept bdept NOT NULL,\n  -- ... 121 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count PREH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM PREH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "PREH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get job cost variance by phase comparing budget to actual\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Job cost variance by phase:\n1. Join JCJM (Job Master) to JCCP (Cost Phase)\n2. Calculate variance as CurrEstCost - ActualCost\n3. Calculate percent complete from actuals vs budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  JCCP.Phase,\n  JCCP.CostType,\n  JCCP.OrigEstCost AS OriginalBudget,\n  JCCP.CurrEstCost AS CurrentBudget,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS Variance,\n  CASE WHEN JCCP.CurrEstCost <> 0 \n       THEN (JCCP.ActualCost / JCCP.CurrEstCost) * 100 \n       ELSE 0 END AS PercentComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.Job = @Job\nORDER BY JCCP.Phase, JCCP.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show job costs with GL account descriptions\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I can partially answer this query, but the schema is incomplete.\n\nThe query requires GLAC for GL account descriptions, which is not in the provided schema.\n\nHere's what I can provide with the available schema:\n\n```sql\nSELECT *\nFROM JCCD WITH (NOLOCK)\nWHERE Co = @Co\n-- Note: Additional joins for GLAC would be needed for complete results\n```\n\nTo get the complete data you requested, please provide the DDL for GLAC.",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from PRCO\n\nDatabase Schema:\nCREATE TABLE PRCO (\n  PRCo bcompany NOT NULL,\n  GLCo bcompany NOT NULL,\n  Jrnl bjrnl,\n  GLInterface byn NOT NULL,\n  CMCo bcompany NOT NULL,\n  APCo bcompany,\n  AutoOT byn NOT NULL,\n  OTEarnCode bedlcode,\n  JCCo bcompany NOT NULL,\n  AllowNoPhase byn NOT NULL,\n  JCInterface byn NOT NULL,\n  InsByPhase byn NOT NULL,\n  JCICraftClass byn NOT NULL,\n  JCICrew byn NOT NULL,\n  JCIEmployee byn NOT NULL,\n  JCIFactor byn NOT NULL,\n  JCIEarnType byn NOT NULL,\n  JCIShift byn NOT NULL,\n  JCIPostingDate byn NOT NULL,\n  JCILiabType byn NOT NULL,\n  -- ... 66 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from PRCO ().\n\n```sql\nSELECT *\nFROM PRCO WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "PRCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from PRTD\n\nDatabase Schema:\nCREATE TABLE PRTD (\n  PRCo bcompany NOT NULL,\n  Craft bcraft NOT NULL,\n  Class bclass NOT NULL,\n  Template smallint NOT NULL,\n  DLCode bedlcode NOT NULL,\n  Factor brate NOT NULL,\n  OldRate bunitcost NOT NULL,\n  NewRate bunitcost NOT NULL,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from PRTD ().\n\n```sql\nSELECT *\nFROM PRTD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "PRTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate stored materials (Purchased - Installed) for SL billing\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Stored materials for SL billing:\n1. SLWI contains work item/billing details\n2. StoredMatls = Purchased - Installed (materials on-site but not yet used)\n3. WCCost = Work Completed Cost\n4. WCRetAmt and SMRetAmt = separate retainage for work vs materials\n5. Total billable = WCCost + StoredMatls\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description AS ItemDescription,\n  SLWI.StoredMatls,\n  SLWI.WCCost AS WorkCompletedCost,\n  SLWI.StoredMatls + SLWI.WCCost AS TotalBillable,\n  SLWI.WCRetAmt AS WorkRetainage,\n  SLWI.SMRetAmt AS MaterialsRetainage,\n  SLWI.WCRetAmt + SLWI.SMRetAmt AS TotalRetainage\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\n  AND SLWI.StoredMatls <> 0\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "intermediate",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to count records in preh by company\n\nDatabase Schema:\nCREATE TABLE PREH (\n  PRCo bcompany NOT NULL,\n  Employee bemployee NOT NULL,\n  LastName varchar(30) NOT NULL,\n  FirstName varchar(30),\n  MidName varchar(15),\n  SortName bsortname NOT NULL,\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  Phone bphone,\n  SSN char(11) NOT NULL,\n  Race char(2) NOT NULL,\n  Sex char(1) NOT NULL,\n  BirthDate smalldatetime,\n  HireDate bdate,\n  TermDate bdate,\n  PRGroup bgroup NOT NULL,\n  PRDept bdept NOT NULL,\n  -- ... 121 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count PREH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM PREH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "PREH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: track ap hold status distinguishing retainage vs non-retainage holds\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APCO (\n  APCo bcompany NOT NULL,\n  GLCo bcompany NOT NULL,\n  ExpJrnl bjrnl,\n  GLExpInterfaceLvl tinyint NOT NULL,\n  GLExpSummaryDesc varchar(60),\n  GLExpTransDesc varchar(60),\n  GLJobDetailDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLEquipDetailDesc varchar(60),\n  GLExpDetailDesc varchar(60),\n  PayJrnl bjrnl,\n  GLPayInterfaceLvl tinyint NOT NULL,\n  GLPayDetailDesc varchar(60),\n  GLPaySummaryDesc varchar(60),\n  DiscOffGLAcct bglacct,\n  DiscTakenGLAcct bglacct,\n  ExpPayType tinyint,\n  JobPayType tinyint,\n  SubPayType tinyint,\n  RetPayType tinyint,\n  -- ... 92 more columns,\n  PRIMARY KEY (APCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To distinguish retainage vs non-retainage holds:\n1. Join APTD to APHD for hold details\n2. Join APCO to get RetHoldCode setting\n3. Compare APHD.HoldCode to APCO.RetHoldCode\n4. If equal, it's a retainage hold; otherwise non-retainage\n\n```sql\nSELECT \n  APTD.APCo,\n  APTD.Vendor,\n  APTD.Mth,\n  APTD.APTrans,\n  APHD.HoldCode,\n  CASE WHEN APHD.HoldCode = APCO.RetHoldCode \n       THEN 'Retainage Hold' \n       ELSE 'Non-Retainage Hold' END AS HoldType,\n  APTD.Amount\nFROM APTD WITH (NOLOCK)\nINNER JOIN APHD WITH (NOLOCK) ON APTD.APCo = APHD.APCo \n  AND APTD.Mth = APHD.Mth \n  AND APTD.APTrans = APHD.APTrans \n  AND APTD.APLine = APHD.APLine\nINNER JOIN APCO WITH (NOLOCK) ON APTD.APCo = APCO.APCo\nWHERE APTD.APCo = @APCo\n  AND APHD.HoldCode IS NOT NULL\nORDER BY APTD.Vendor, APTD.Mth\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "basic",
      "tables_used": [
        "APTD",
        "APHD",
        "APCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoice totals with discounts and retainage\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Vendor invoice summary with discounts and retainage:\n1. Join APTH to APVM for vendor details\n2. Aggregate by vendor\n3. Include GrossAmt, DiscOffer, Retainage, and Balance\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(APTH.APTrans) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS GrossAmount,\n  SUM(APTH.DiscOffer) AS DiscountsOffered,\n  SUM(APTH.Retainage) AS RetainageHeld,\n  SUM(APTH.Balance) AS OpenBalance\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging buckets (30/60/90+ days) for unpaid invoices by customer\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Use ARTH for transaction data and ARCM for customer names\n2. Filter PayFullDate IS NULL to get only unpaid invoices\n3. Use DATEDIFF and CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoice totals with discounts and retainage\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Vendor invoice summary with discounts and retainage:\n1. Join APTH to APVM for vendor details\n2. Aggregate by vendor\n3. Include GrossAmt, DiscOffer, Retainage, and Balance\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(APTH.APTrans) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS GrossAmount,\n  SUM(APTH.DiscOffer) AS DiscountsOffered,\n  SUM(APTH.Retainage) AS RetainageHeld,\n  SUM(APTH.Balance) AS OpenBalance\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate stored materials (Purchased - Installed) for SL billing\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Stored materials for SL billing:\n1. SLWI contains work item/billing details\n2. StoredMatls = Purchased - Installed (materials on-site but not yet used)\n3. WCCost = Work Completed Cost\n4. WCRetAmt and SMRetAmt = separate retainage for work vs materials\n5. Total billable = WCCost + StoredMatls\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description AS ItemDescription,\n  SLWI.StoredMatls,\n  SLWI.WCCost AS WorkCompletedCost,\n  SLWI.StoredMatls + SLWI.WCCost AS TotalBillable,\n  SLWI.WCRetAmt AS WorkRetainage,\n  SLWI.SMRetAmt AS MaterialsRetainage,\n  SLWI.WCRetAmt + SLWI.SMRetAmt AS TotalRetainage\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\n  AND SLWI.StoredMatls <> 0\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find jobs over budget with remaining cost projection\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Find jobs over budget:\n1. Aggregate JCCP by job from JCJM\n2. Compare total ActualCost to CurrEstCost\n3. Use HAVING to filter only over-budget jobs\n4. Sort by amount over budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description,\n  SUM(JCCP.CurrEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.CurrEstCost) - SUM(JCCP.ActualCost) AS RemainingBudget,\n  CASE WHEN SUM(JCCP.CurrEstCost) < SUM(JCCP.ActualCost) \n       THEN 'OVER BUDGET' ELSE 'OK' END AS Status\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\nGROUP BY JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.CurrEstCost)\nORDER BY (SUM(JCCP.ActualCost) - SUM(JCCP.CurrEstCost)) DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCJM",
        "JCCD",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: count records in gljr by company\n\nDatabase Schema:\nCREATE TABLE GLJR (\n  GLCo bcompany NOT NULL,\n  Jrnl bjrnl NOT NULL,\n  Description btransdesc,\n  Rev byn NOT NULL,\n  RevJrnl bjrnl,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count GLJR records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM GLJR WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "GLJR"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to count records in jccd by company\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count JCCD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM JCCD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need to aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need to aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need to count records in prth by company\n\nDatabase Schema:\nCREATE TABLE PRTH (\n  PRCo bcompany NOT NULL,\n  PRGroup bgroup NOT NULL,\n  PREndDate bdate NOT NULL,\n  Employee bemployee NOT NULL,\n  PaySeq tinyint NOT NULL,\n  PostSeq smallint NOT NULL,\n  Type char(1) NOT NULL,\n  PostDate bdate NOT NULL,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCDept bdept,\n  GLCo bcompany NOT NULL,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equipment bequip,\n  EMGroup tinyint,\n  CostCode bcostcode,\n  -- ... 41 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count PRTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM PRTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "PRTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How do I count records in prth by company\n\nDatabase Schema:\nCREATE TABLE PRTH (\n  PRCo bcompany NOT NULL,\n  PRGroup bgroup NOT NULL,\n  PREndDate bdate NOT NULL,\n  Employee bemployee NOT NULL,\n  PaySeq tinyint NOT NULL,\n  PostSeq smallint NOT NULL,\n  Type char(1) NOT NULL,\n  PostDate bdate NOT NULL,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCDept bdept,\n  GLCo bcompany NOT NULL,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equipment bequip,\n  EMGroup tinyint,\n  CostCode bcostcode,\n  -- ... 41 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count PRTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM PRTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "PRTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from SLWI\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from SLWI ().\n\n```sql\nSELECT *\nFROM SLWI WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "SLWI"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging buckets (30/60/90+ days) for unpaid invoices by customer\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Use ARTH for transaction data and ARCM for customer names\n2. Filter PayFullDate IS NULL to get only unpaid invoices\n3. Use DATEDIFF and CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoice totals with discounts and retainage\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Vendor invoice summary with discounts and retainage:\n1. Join APTH to APVM for vendor details\n2. Aggregate by vendor\n3. Include GrossAmt, DiscOffer, Retainage, and Balance\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(APTH.APTrans) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS GrossAmount,\n  SUM(APTH.DiscOffer) AS DiscountsOffered,\n  SUM(APTH.Retainage) AS RetainageHeld,\n  SUM(APTH.Balance) AS OpenBalance\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get subcontractor costs with original, change orders, invoiced, paid, and retainage by vendor\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Subcontractor cost breakdown by vendor:\n1. Join SLHD (Header) to SLIT (Items) for subcontract details\n2. Join APVM for vendor names\n3. OrigCost = original contract amount\n4. CurCost - OrigCost = change order amounts\n5. InvCost = amounts invoiced\n6. Retainage = amounts held back\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  SLHD.SL AS SubcontractNum,\n  SLHD.Description AS SubcontractDesc,\n  SUM(SLIT.OrigCost) AS OriginalCost,\n  SUM(SLIT.CurCost - SLIT.OrigCost) AS ChangeOrderCost,\n  SUM(SLIT.CurCost) AS CurrentCost,\n  SUM(SLIT.InvCost) AS InvoicedCost,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost - SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nINNER JOIN APVM WITH (NOLOCK) ON SLHD.VendorGroup = APVM.VendorGroup AND SLHD.Vendor = APVM.Vendor\nWHERE SLHD.SLCo = @SLCo\nGROUP BY APVM.Vendor, APVM.Name, SLHD.SL, SLHD.Description\nORDER BY APVM.Name, SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLHD",
        "SLIT",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get customer balance summary by customer group\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Customer balance summary by group:\n1. Join ARTH to ARCM for customer details\n2. Use conditional SUM for open vs total balances\n3. Group by CustGroup for summary\n\n```sql\nSELECT \n  ARTH.CustGroup,\n  COUNT(DISTINCT ARTH.Customer) AS CustomerCount,\n  SUM(CASE WHEN ARTH.PayFullDate IS NULL THEN ARTH.Amount ELSE 0 END) AS OpenBalance,\n  SUM(ARTH.Amount) AS TotalBilled\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\nGROUP BY ARTH.CustGroup\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from JCCD\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from JCCD ().\n\n```sql\nSELECT *\nFROM JCCD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from APTD\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from APTD ().\n\n```sql\nSELECT *\nFROM APTD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging buckets (30/60/90+ days) for unpaid invoices by customer\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Use ARTH for transaction data and ARCM for customer names\n2. Filter PayFullDate IS NULL to get only unpaid invoices\n3. Use DATEDIFF and CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging buckets (30/60/90+ days) for unpaid invoices by customer\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Use ARTH for transaction data and ARCM for customer names\n2. Filter PayFullDate IS NULL to get only unpaid invoices\n3. Use DATEDIFF and CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query to count records in arth by company\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count ARTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM ARTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from APTH\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from APTH ().\n\n```sql\nSELECT *\nFROM APTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "APTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find all unpaid AR invoices older than 60 days\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find unpaid invoices over 60 days:\n1. Join ARTH to ARCM for customer information\n2. Filter PayFullDate IS NULL (unpaid)\n3. Use DATEDIFF to calculate age and filter > 60 days\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Mth,\n  ARTH.ARTrans,\n  ARCM.Name AS CustomerName,\n  ARTH.TransDate,\n  ARTH.Amount,\n  DATEDIFF(day, ARTH.TransDate, GETDATE()) AS DaysOutstanding\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\n  AND DATEDIFF(day, ARTH.TransDate, GETDATE()) > 60\nORDER BY ARTH.TransDate\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query to aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query to count records in gljr by company\n\nDatabase Schema:\nCREATE TABLE GLJR (\n  GLCo bcompany NOT NULL,\n  Jrnl bjrnl NOT NULL,\n  Description btransdesc,\n  Rev byn NOT NULL,\n  RevJrnl bjrnl,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count GLJR records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM GLJR WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "GLJR"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: What columns are in the Subcontracts table?\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'Subcontracts' does not exist in Viewpoint Vista.\n\nUse SLHD (SL Header) for subcontract headers.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM SLHD WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoices with their subcontract details\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I can partially answer this query, but the schema is incomplete.\n\nTo include subcontract details, the SLHD table is needed but not provided in the schema.\n\nHere's what I can provide with the available schema:\n\n```sql\nSELECT *\nFROM APTH WITH (NOLOCK)\nWHERE Co = @Co\n-- Note: Additional joins for SLHD would be needed for complete results\n```\n\nTo get the complete data you requested, please provide the DDL for SLHD.",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": [
        "APTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoices with their subcontract details\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I can partially answer this query, but the schema is incomplete.\n\nTo include subcontract details, the SLHD table is needed but not provided in the schema.\n\nHere's what I can provide with the available schema:\n\n```sql\nSELECT *\nFROM APTH WITH (NOLOCK)\nWHERE Co = @Co\n-- Note: Additional joins for SLHD would be needed for complete results\n```\n\nTo get the complete data you requested, please provide the DDL for SLHD.",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": [
        "APTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get job cost variance by phase comparing budget to actual\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Job cost variance by phase:\n1. Join JCJM (Job Master) to JCCP (Cost Phase)\n2. Calculate variance as CurrEstCost - ActualCost\n3. Calculate percent complete from actuals vs budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  JCCP.Phase,\n  JCCP.CostType,\n  JCCP.OrigEstCost AS OriginalBudget,\n  JCCP.CurrEstCost AS CurrentBudget,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS Variance,\n  CASE WHEN JCCP.CurrEstCost <> 0 \n       THEN (JCCP.ActualCost / JCCP.CurrEstCost) * 100 \n       ELSE 0 END AS PercentComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.Job = @Job\nORDER BY JCCP.Phase, JCCP.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from SLWI\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from SLWI ().\n\n```sql\nSELECT *\nFROM SLWI WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "SLWI"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: count records in slhd by company\n\nDatabase Schema:\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count SLHD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM SLHD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLHD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find all unpaid AR invoices older than 60 days\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find unpaid invoices over 60 days:\n1. Join ARTH to ARCM for customer information\n2. Filter PayFullDate IS NULL (unpaid)\n3. Use DATEDIFF to calculate age and filter > 60 days\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Mth,\n  ARTH.ARTrans,\n  ARCM.Name AS CustomerName,\n  ARTH.TransDate,\n  ARTH.Amount,\n  DATEDIFF(day, ARTH.TransDate, GETDATE()) AS DaysOutstanding\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\n  AND DATEDIFF(day, ARTH.TransDate, GETDATE()) > 60\nORDER BY ARTH.TransDate\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from JCCD\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from JCCD ().\n\n```sql\nSELECT *\nFROM JCCD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from SLWI\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from SLWI ().\n\n```sql\nSELECT *\nFROM SLWI WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "SLWI"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoice totals with discounts and retainage\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Vendor invoice summary with discounts and retainage:\n1. Join APTH to APVM for vendor details\n2. Aggregate by vendor\n3. Include GrossAmt, DiscOffer, Retainage, and Balance\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(APTH.APTrans) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS GrossAmount,\n  SUM(APTH.DiscOffer) AS DiscountsOffered,\n  SUM(APTH.Retainage) AS RetainageHeld,\n  SUM(APTH.Balance) AS OpenBalance\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from SLWI\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from SLWI ().\n\n```sql\nSELECT *\nFROM SLWI WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "SLWI"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging buckets (30/60/90+ days) for unpaid invoices by customer\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Use ARTH for transaction data and ARCM for customer names\n2. Filter PayFullDate IS NULL to get only unpaid invoices\n3. Use DATEDIFF and CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get subcontractor costs with original, change orders, invoiced, paid, and retainage by vendor\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Subcontractor cost breakdown by vendor:\n1. Join SLHD (Header) to SLIT (Items) for subcontract details\n2. Join APVM for vendor names\n3. OrigCost = original contract amount\n4. CurCost - OrigCost = change order amounts\n5. InvCost = amounts invoiced\n6. Retainage = amounts held back\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  SLHD.SL AS SubcontractNum,\n  SLHD.Description AS SubcontractDesc,\n  SUM(SLIT.OrigCost) AS OriginalCost,\n  SUM(SLIT.CurCost - SLIT.OrigCost) AS ChangeOrderCost,\n  SUM(SLIT.CurCost) AS CurrentCost,\n  SUM(SLIT.InvCost) AS InvoicedCost,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost - SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nINNER JOIN APVM WITH (NOLOCK) ON SLHD.VendorGroup = APVM.VendorGroup AND SLHD.Vendor = APVM.Vendor\nWHERE SLHD.SLCo = @SLCo\nGROUP BY APVM.Vendor, APVM.Name, SLHD.SL, SLHD.Description\nORDER BY APVM.Name, SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLHD",
        "SLIT",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get subcontractor costs with original, change orders, invoiced, paid, and retainage by vendor\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Subcontractor cost breakdown by vendor:\n1. Join SLHD (Header) to SLIT (Items) for subcontract details\n2. Join APVM for vendor names\n3. OrigCost = original contract amount\n4. CurCost - OrigCost = change order amounts\n5. InvCost = amounts invoiced\n6. Retainage = amounts held back\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  SLHD.SL AS SubcontractNum,\n  SLHD.Description AS SubcontractDesc,\n  SUM(SLIT.OrigCost) AS OriginalCost,\n  SUM(SLIT.CurCost - SLIT.OrigCost) AS ChangeOrderCost,\n  SUM(SLIT.CurCost) AS CurrentCost,\n  SUM(SLIT.InvCost) AS InvoicedCost,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost - SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nINNER JOIN APVM WITH (NOLOCK) ON SLHD.VendorGroup = APVM.VendorGroup AND SLHD.Vendor = APVM.Vendor\nWHERE SLHD.SLCo = @SLCo\nGROUP BY APVM.Vendor, APVM.Name, SLHD.SL, SLHD.Description\nORDER BY APVM.Name, SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "basic",
      "tables_used": [
        "SLHD",
        "SLIT",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: count records in slwi by company\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count SLWI records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM SLWI WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "SLWI"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from PRTH\n\nDatabase Schema:\nCREATE TABLE PRTH (\n  PRCo bcompany NOT NULL,\n  PRGroup bgroup NOT NULL,\n  PREndDate bdate NOT NULL,\n  Employee bemployee NOT NULL,\n  PaySeq tinyint NOT NULL,\n  PostSeq smallint NOT NULL,\n  Type char(1) NOT NULL,\n  PostDate bdate NOT NULL,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCDept bdept,\n  GLCo bcompany NOT NULL,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equipment bequip,\n  EMGroup tinyint,\n  CostCode bcostcode,\n  -- ... 41 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from PRTH ().\n\n```sql\nSELECT *\nFROM PRTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "PRTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get data from PREH for analysis\n\nDatabase Schema:\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'PREH' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nSLHD, SLIT\n\nTo include PREH in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get job cost variance by phase comparing budget to actual\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Job cost variance by phase:\n1. Join JCJM (Job Master) to JCCP (Cost Phase)\n2. Calculate variance as CurrEstCost - ActualCost\n3. Calculate percent complete from actuals vs budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  JCCP.Phase,\n  JCCP.CostType,\n  JCCP.OrigEstCost AS OriginalBudget,\n  JCCP.CurrEstCost AS CurrentBudget,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS Variance,\n  CASE WHEN JCCP.CurrEstCost <> 0 \n       THEN (JCCP.ActualCost / JCCP.CurrEstCost) * 100 \n       ELSE 0 END AS PercentComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.Job = @Job\nORDER BY JCCP.Phase, JCCP.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate stored materials (Purchased - Installed) for SL billing\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Stored materials for SL billing:\n1. SLWI contains work item/billing details\n2. StoredMatls = Purchased - Installed (materials on-site but not yet used)\n3. WCCost = Work Completed Cost\n4. WCRetAmt and SMRetAmt = separate retainage for work vs materials\n5. Total billable = WCCost + StoredMatls\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description AS ItemDescription,\n  SLWI.StoredMatls,\n  SLWI.WCCost AS WorkCompletedCost,\n  SLWI.StoredMatls + SLWI.WCCost AS TotalBillable,\n  SLWI.WCRetAmt AS WorkRetainage,\n  SLWI.SMRetAmt AS MaterialsRetainage,\n  SLWI.WCRetAmt + SLWI.SMRetAmt AS TotalRetainage\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\n  AND SLWI.StoredMatls <> 0\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How do I count records in aptd by company\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count APTD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM APTD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query to count records in arth by company\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count ARTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM ARTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query to aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find all unpaid AR invoices older than 60 days\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find unpaid invoices over 60 days:\n1. Join ARTH to ARCM for customer information\n2. Filter PayFullDate IS NULL (unpaid)\n3. Use DATEDIFF to calculate age and filter > 60 days\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Mth,\n  ARTH.ARTrans,\n  ARCM.Name AS CustomerName,\n  ARTH.TransDate,\n  ARTH.Amount,\n  DATEDIFF(day, ARTH.TransDate, GETDATE()) AS DaysOutstanding\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\n  AND DATEDIFF(day, ARTH.TransDate, GETDATE()) > 60\nORDER BY ARTH.TransDate\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show job costs with GL account descriptions\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I can partially answer this query, but the schema is incomplete.\n\nThe query requires GLAC for GL account descriptions, which is not in the provided schema.\n\nHere's what I can provide with the available schema:\n\n```sql\nSELECT *\nFROM JCCD WITH (NOLOCK)\nWHERE Co = @Co\n-- Note: Additional joins for GLAC would be needed for complete results\n```\n\nTo get the complete data you requested, please provide the DDL for GLAC.",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query to count records in slhd by company\n\nDatabase Schema:\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count SLHD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM SLHD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLHD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from PRTH\n\nDatabase Schema:\nCREATE TABLE PRTH (\n  PRCo bcompany NOT NULL,\n  PRGroup bgroup NOT NULL,\n  PREndDate bdate NOT NULL,\n  Employee bemployee NOT NULL,\n  PaySeq tinyint NOT NULL,\n  PostSeq smallint NOT NULL,\n  Type char(1) NOT NULL,\n  PostDate bdate NOT NULL,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCDept bdept,\n  GLCo bcompany NOT NULL,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equipment bequip,\n  EMGroup tinyint,\n  CostCode bcostcode,\n  -- ... 41 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from PRTH ().\n\n```sql\nSELECT *\nFROM PRTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "PRTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from SLHD\n\nDatabase Schema:\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from SLHD ().\n\n```sql\nSELECT *\nFROM SLHD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLHD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging buckets (30/60/90+ days) for unpaid invoices by customer\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Use ARTH for transaction data and ARCM for customer names\n2. Filter PayFullDate IS NULL to get only unpaid invoices\n3. Use DATEDIFF and CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to count records in glco by company\n\nDatabase Schema:\nCREATE TABLE GLCO (\n  GLCo bcompany NOT NULL,\n  Consolid byn NOT NULL,\n  LastMthSubClsd bmonth NOT NULL,\n  LastMthGLClsd bmonth NOT NULL,\n  MaxOpen tinyint NOT NULL,\n  CashAccrual char(1) NOT NULL,\n  Unbal byn NOT NULL,\n  AuditCoParams byn NOT NULL,\n  AuditAccts byn NOT NULL,\n  AuditAutoJrnl byn NOT NULL,\n  AuditBals byn NOT NULL,\n  AuditBudgets byn NOT NULL,\n  AuditDetail byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  XCompJrnlEntryYN byn NOT NULL,\n  KeyID bigint NOT NULL,\n  LastMthAPClsd bmonth NOT NULL,\n  LastMthARClsd bmonth NOT NULL,\n  AttachBatchReportsYN byn NOT NULL,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count GLCO records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM GLCO WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "GLCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get data from JCJM for analysis\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'JCJM' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nARTH, ARCM\n\nTo include JCJM in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to reconcile ap oncost batch lines with original transactions\n\nDatabase Schema:\nCREATE TABLE APTL (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equip bequip,\n  EMGroup bgroup,\n  -- ... 56 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans, APLine)\n);\n\nCREATE TABLE APLB (\n  Co bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  BatchId bbatchid NOT NULL,\n  BatchSeq int NOT NULL,\n  APLine smallint NOT NULL,\n  BatchTransType char(1) NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  -- ... 120 more columns,\n  PRIMARY KEY (Co, Mth, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APHB (\n  Co bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  BatchId bbatchid NOT NULL,\n  BatchSeq int NOT NULL,\n  BatchTransType char(1) NOT NULL,\n  APTrans btrans,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  -- ... 88 more columns,\n  PRIMARY KEY (Co, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To reconcile AP oncost batches with original transactions:\n1. Join APLB (batch lines) to APTL (original lines) using ocApplyMth, ocApplyTrans, ocApplyLine\n2. Include APHB for batch header info\n3. Join to APTH and APVM for vendor context\n4. Compare batch vs original amounts\n\n```sql\nSELECT \n  APLB.Co AS BatchCo,\n  APLB.Mth AS BatchMth,\n  APLB.BatchId,\n  APLB.BatchSeq,\n  APLB.ocApplyMth,\n  APLB.ocApplyTrans,\n  APLB.ocApplyLine,\n  APTL.APCo AS OrigCo,\n  APTL.Mth AS OrigMth,\n  APTL.APTrans AS OrigTrans,\n  APTL.APLine AS OrigLine,\n  APTL.GrossAmt AS OrigAmount,\n  APLB.GrossAmt AS BatchAmount,\n  APVM.Name AS VendorName\nFROM APLB WITH (NOLOCK)\nINNER JOIN APHB WITH (NOLOCK) ON APLB.Co = APHB.Co AND APLB.Mth = APHB.Mth AND APLB.BatchId = APHB.BatchId\nINNER JOIN APTL WITH (NOLOCK) ON APLB.ocApplyMth = APTL.Mth \n  AND APLB.ocApplyTrans = APTL.APTrans \n  AND APLB.ocApplyLine = APTL.APLine\n  AND APLB.Co = APTL.APCo\nINNER JOIN APTH WITH (NOLOCK) ON APTL.APCo = APTH.APCo AND APTL.Mth = APTH.Mth AND APTL.APTrans = APTH.APTrans\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APLB.Co = @Co\nORDER BY APLB.BatchId, APLB.BatchSeq\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APLB",
        "APHB",
        "APTL",
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need to count records in gljr by company\n\nDatabase Schema:\nCREATE TABLE GLJR (\n  GLCo bcompany NOT NULL,\n  Jrnl bjrnl NOT NULL,\n  Description btransdesc,\n  Rev byn NOT NULL,\n  RevJrnl bjrnl,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count GLJR records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM GLJR WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "GLJR"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: count records in gldt by company\n\nDatabase Schema:\nCREATE TABLE GLDT (\n  GLCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  GLTrans btrans NOT NULL,\n  GLAcct bglacct NOT NULL,\n  Jrnl bjrnl NOT NULL,\n  GLRef bglref NOT NULL,\n  SourceCo bcompany NOT NULL,\n  Source bsource NOT NULL,\n  ActDate bdate NOT NULL,\n  DatePosted bdate NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid NOT NULL,\n  Amount bdollar NOT NULL,\n  RevStatus tinyint NOT NULL,\n  Adjust char(1) NOT NULL,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  UniqueAttchID uniqueidentifier,\n  SrcTable varchar(128),\n  SrcKeyID bigint,\n  PRIMARY KEY (GLCo, Mth, GLTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count GLDT records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM GLDT WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "GLDT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to query Phases\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'Phases' does not exist in Viewpoint Vista.\n\nUse JCJP (JC Job Phase) for phase definitions.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM JCJP WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from ARTH\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from ARTH ().\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from ARTH\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from ARTH ().\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How do I track ap hold status distinguishing retainage vs non-retainage holds\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APCO (\n  APCo bcompany NOT NULL,\n  GLCo bcompany NOT NULL,\n  ExpJrnl bjrnl,\n  GLExpInterfaceLvl tinyint NOT NULL,\n  GLExpSummaryDesc varchar(60),\n  GLExpTransDesc varchar(60),\n  GLJobDetailDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLEquipDetailDesc varchar(60),\n  GLExpDetailDesc varchar(60),\n  PayJrnl bjrnl,\n  GLPayInterfaceLvl tinyint NOT NULL,\n  GLPayDetailDesc varchar(60),\n  GLPaySummaryDesc varchar(60),\n  DiscOffGLAcct bglacct,\n  DiscTakenGLAcct bglacct,\n  ExpPayType tinyint,\n  JobPayType tinyint,\n  SubPayType tinyint,\n  RetPayType tinyint,\n  -- ... 92 more columns,\n  PRIMARY KEY (APCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To distinguish retainage vs non-retainage holds:\n1. Join APTD to APHD for hold details\n2. Join APCO to get RetHoldCode setting\n3. Compare APHD.HoldCode to APCO.RetHoldCode\n4. If equal, it's a retainage hold; otherwise non-retainage\n\n```sql\nSELECT \n  APTD.APCo,\n  APTD.Vendor,\n  APTD.Mth,\n  APTD.APTrans,\n  APHD.HoldCode,\n  CASE WHEN APHD.HoldCode = APCO.RetHoldCode \n       THEN 'Retainage Hold' \n       ELSE 'Non-Retainage Hold' END AS HoldType,\n  APTD.Amount\nFROM APTD WITH (NOLOCK)\nINNER JOIN APHD WITH (NOLOCK) ON APTD.APCo = APHD.APCo \n  AND APTD.Mth = APHD.Mth \n  AND APTD.APTrans = APHD.APTrans \n  AND APTD.APLine = APHD.APLine\nINNER JOIN APCO WITH (NOLOCK) ON APTD.APCo = APCO.APCo\nWHERE APTD.APCo = @APCo\n  AND APHD.HoldCode IS NOT NULL\nORDER BY APTD.Vendor, APTD.Mth\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTD",
        "APHD",
        "APCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Describe the Invoices table\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'Invoices' does not exist in Viewpoint Vista.\n\nFor AR invoices, use ARTH (AR Transaction Header). For AP invoices, use APTH (AP Transaction Header).\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate stored materials (Purchased - Installed) for SL billing\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Stored materials for SL billing:\n1. SLWI contains work item/billing details\n2. StoredMatls = Purchased - Installed (materials on-site but not yet used)\n3. WCCost = Work Completed Cost\n4. WCRetAmt and SMRetAmt = separate retainage for work vs materials\n5. Total billable = WCCost + StoredMatls\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description AS ItemDescription,\n  SLWI.StoredMatls,\n  SLWI.WCCost AS WorkCompletedCost,\n  SLWI.StoredMatls + SLWI.WCCost AS TotalBillable,\n  SLWI.WCRetAmt AS WorkRetainage,\n  SLWI.SMRetAmt AS MaterialsRetainage,\n  SLWI.WCRetAmt + SLWI.SMRetAmt AS TotalRetainage\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\n  AND SLWI.StoredMatls <> 0\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "basic",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging with customer contact information\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I can partially answer this query, but the schema is incomplete.\n\nThe query requires ARCM (AR Customer Master) for customer details, but only ARTH is provided in the schema.\n\nHere's what I can provide with the available schema:\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n-- Note: Additional joins for ARCM would be needed for complete results\n```\n\nTo get the complete data you requested, please provide the DDL for ARCM.",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get job cost variance by phase comparing budget to actual\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Job cost variance by phase:\n1. Join JCJM (Job Master) to JCCP (Cost Phase)\n2. Calculate variance as CurrEstCost - ActualCost\n3. Calculate percent complete from actuals vs budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  JCCP.Phase,\n  JCCP.CostType,\n  JCCP.OrigEstCost AS OriginalBudget,\n  JCCP.CurrEstCost AS CurrentBudget,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS Variance,\n  CASE WHEN JCCP.CurrEstCost <> 0 \n       THEN (JCCP.ActualCost / JCCP.CurrEstCost) * 100 \n       ELSE 0 END AS PercentComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.Job = @Job\nORDER BY JCCP.Phase, JCCP.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: reconcile ap oncost batch lines with original transactions\n\nDatabase Schema:\nCREATE TABLE APTL (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equip bequip,\n  EMGroup bgroup,\n  -- ... 56 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans, APLine)\n);\n\nCREATE TABLE APLB (\n  Co bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  BatchId bbatchid NOT NULL,\n  BatchSeq int NOT NULL,\n  APLine smallint NOT NULL,\n  BatchTransType char(1) NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  -- ... 120 more columns,\n  PRIMARY KEY (Co, Mth, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APHB (\n  Co bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  BatchId bbatchid NOT NULL,\n  BatchSeq int NOT NULL,\n  BatchTransType char(1) NOT NULL,\n  APTrans btrans,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  -- ... 88 more columns,\n  PRIMARY KEY (Co, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To reconcile AP oncost batches with original transactions:\n1. Join APLB (batch lines) to APTL (original lines) using ocApplyMth, ocApplyTrans, ocApplyLine\n2. Include APHB for batch header info\n3. Join to APTH and APVM for vendor context\n4. Compare batch vs original amounts\n\n```sql\nSELECT \n  APLB.Co AS BatchCo,\n  APLB.Mth AS BatchMth,\n  APLB.BatchId,\n  APLB.BatchSeq,\n  APLB.ocApplyMth,\n  APLB.ocApplyTrans,\n  APLB.ocApplyLine,\n  APTL.APCo AS OrigCo,\n  APTL.Mth AS OrigMth,\n  APTL.APTrans AS OrigTrans,\n  APTL.APLine AS OrigLine,\n  APTL.GrossAmt AS OrigAmount,\n  APLB.GrossAmt AS BatchAmount,\n  APVM.Name AS VendorName\nFROM APLB WITH (NOLOCK)\nINNER JOIN APHB WITH (NOLOCK) ON APLB.Co = APHB.Co AND APLB.Mth = APHB.Mth AND APLB.BatchId = APHB.BatchId\nINNER JOIN APTL WITH (NOLOCK) ON APLB.ocApplyMth = APTL.Mth \n  AND APLB.ocApplyTrans = APTL.APTrans \n  AND APLB.ocApplyLine = APTL.APLine\n  AND APLB.Co = APTL.APCo\nINNER JOIN APTH WITH (NOLOCK) ON APTL.APCo = APTH.APCo AND APTL.Mth = APTH.Mth AND APTL.APTrans = APTH.APTrans\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APLB.Co = @Co\nORDER BY APLB.BatchId, APLB.BatchSeq\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APLB",
        "APHB",
        "APTL",
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query to count records in aptd by company\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count APTD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM APTD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from JCCD\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from JCCD ().\n\n```sql\nSELECT *\nFROM JCCD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from APTH\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from APTH ().\n\n```sql\nSELECT *\nFROM APTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find jobs over budget with remaining cost projection\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Find jobs over budget:\n1. Aggregate JCCP by job from JCJM\n2. Compare total ActualCost to CurrEstCost\n3. Use HAVING to filter only over-budget jobs\n4. Sort by amount over budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description,\n  SUM(JCCP.CurrEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.CurrEstCost) - SUM(JCCP.ActualCost) AS RemainingBudget,\n  CASE WHEN SUM(JCCP.CurrEstCost) < SUM(JCCP.ActualCost) \n       THEN 'OVER BUDGET' ELSE 'OK' END AS Status\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\nGROUP BY JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.CurrEstCost)\nORDER BY (SUM(JCCP.ActualCost) - SUM(JCCP.CurrEstCost)) DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCJM",
        "JCCD",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from ARTH\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from ARTH ().\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoice totals with discounts and retainage\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Vendor invoice summary with discounts and retainage:\n1. Join APTH to APVM for vendor details\n2. Aggregate by vendor\n3. Include GrossAmt, DiscOffer, Retainage, and Balance\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(APTH.APTrans) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS GrossAmount,\n  SUM(APTH.DiscOffer) AS DiscountsOffered,\n  SUM(APTH.Retainage) AS RetainageHeld,\n  SUM(APTH.Balance) AS OpenBalance\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How do I count records in prtd by company\n\nDatabase Schema:\nCREATE TABLE PRTD (\n  PRCo bcompany NOT NULL,\n  Craft bcraft NOT NULL,\n  Class bclass NOT NULL,\n  Template smallint NOT NULL,\n  DLCode bedlcode NOT NULL,\n  Factor brate NOT NULL,\n  OldRate bunitcost NOT NULL,\n  NewRate bunitcost NOT NULL,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count PRTD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM PRTD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "PRTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from GLAC\n\nDatabase Schema:\nCREATE TABLE GLAC (\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  Description bdesc,\n  AcctType char(1) NOT NULL,\n  SubType char(1),\n  NormBal char(1),\n  InterfaceDetail byn NOT NULL,\n  Active byn NOT NULL,\n  SummaryAcct bglacct NOT NULL,\n  CashAccrual char(1) NOT NULL,\n  CashOffAcct bglacct,\n  Notes varchar,\n  Part1 varchar(20),\n  Part2 varchar(20),\n  Part3 varchar(20),\n  Part4 varchar(20),\n  Part5 varchar(20),\n  Part6 varchar(20),\n  AllParts varchar(20),\n  CrossRefMemAcct bglacct,\n  -- ... 3 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from GLAC ().\n\n```sql\nSELECT *\nFROM GLAC WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "GLAC"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get subcontractor costs with original, change orders, invoiced, paid, and retainage by vendor\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Subcontractor cost breakdown by vendor:\n1. Join SLHD (Header) to SLIT (Items) for subcontract details\n2. Join APVM for vendor names\n3. OrigCost = original contract amount\n4. CurCost - OrigCost = change order amounts\n5. InvCost = amounts invoiced\n6. Retainage = amounts held back\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  SLHD.SL AS SubcontractNum,\n  SLHD.Description AS SubcontractDesc,\n  SUM(SLIT.OrigCost) AS OriginalCost,\n  SUM(SLIT.CurCost - SLIT.OrigCost) AS ChangeOrderCost,\n  SUM(SLIT.CurCost) AS CurrentCost,\n  SUM(SLIT.InvCost) AS InvoicedCost,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost - SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nINNER JOIN APVM WITH (NOLOCK) ON SLHD.VendorGroup = APVM.VendorGroup AND SLHD.Vendor = APVM.Vendor\nWHERE SLHD.SLCo = @SLCo\nGROUP BY APVM.Vendor, APVM.Name, SLHD.SL, SLHD.Description\nORDER BY APVM.Name, SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "intermediate",
      "tables_used": [
        "SLHD",
        "SLIT",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get job cost variance by phase comparing budget to actual\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Job cost variance by phase:\n1. Join JCJM (Job Master) to JCCP (Cost Phase)\n2. Calculate variance as CurrEstCost - ActualCost\n3. Calculate percent complete from actuals vs budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  JCCP.Phase,\n  JCCP.CostType,\n  JCCP.OrigEstCost AS OriginalBudget,\n  JCCP.CurrEstCost AS CurrentBudget,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS Variance,\n  CASE WHEN JCCP.CurrEstCost <> 0 \n       THEN (JCCP.ActualCost / JCCP.CurrEstCost) * 100 \n       ELSE 0 END AS PercentComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.Job = @Job\nORDER BY JCCP.Phase, JCCP.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get subcontractor costs with original, change orders, invoiced, paid, and retainage by vendor\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Subcontractor cost breakdown by vendor:\n1. Join SLHD (Header) to SLIT (Items) for subcontract details\n2. Join APVM for vendor names\n3. OrigCost = original contract amount\n4. CurCost - OrigCost = change order amounts\n5. InvCost = amounts invoiced\n6. Retainage = amounts held back\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  SLHD.SL AS SubcontractNum,\n  SLHD.Description AS SubcontractDesc,\n  SUM(SLIT.OrigCost) AS OriginalCost,\n  SUM(SLIT.CurCost - SLIT.OrigCost) AS ChangeOrderCost,\n  SUM(SLIT.CurCost) AS CurrentCost,\n  SUM(SLIT.InvCost) AS InvoicedCost,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost - SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nINNER JOIN APVM WITH (NOLOCK) ON SLHD.VendorGroup = APVM.VendorGroup AND SLHD.Vendor = APVM.Vendor\nWHERE SLHD.SLCo = @SLCo\nGROUP BY APVM.Vendor, APVM.Name, SLHD.SL, SLHD.Description\nORDER BY APVM.Name, SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "basic",
      "tables_used": [
        "SLHD",
        "SLIT",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from GLDT\n\nDatabase Schema:\nCREATE TABLE GLDT (\n  GLCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  GLTrans btrans NOT NULL,\n  GLAcct bglacct NOT NULL,\n  Jrnl bjrnl NOT NULL,\n  GLRef bglref NOT NULL,\n  SourceCo bcompany NOT NULL,\n  Source bsource NOT NULL,\n  ActDate bdate NOT NULL,\n  DatePosted bdate NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid NOT NULL,\n  Amount bdollar NOT NULL,\n  RevStatus tinyint NOT NULL,\n  Adjust char(1) NOT NULL,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  UniqueAttchID uniqueidentifier,\n  SrcTable varchar(128),\n  SrcKeyID bigint,\n  PRIMARY KEY (GLCo, Mth, GLTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from GLDT ().\n\n```sql\nSELECT *\nFROM GLDT WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "GLDT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from APTD\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from APTD ().\n\n```sql\nSELECT *\nFROM APTD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need to count records in aptd by company\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count APTD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM APTD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate stored materials (Purchased - Installed) for SL billing\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Stored materials for SL billing:\n1. SLWI contains work item/billing details\n2. StoredMatls = Purchased - Installed (materials on-site but not yet used)\n3. WCCost = Work Completed Cost\n4. WCRetAmt and SMRetAmt = separate retainage for work vs materials\n5. Total billable = WCCost + StoredMatls\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description AS ItemDescription,\n  SLWI.StoredMatls,\n  SLWI.WCCost AS WorkCompletedCost,\n  SLWI.StoredMatls + SLWI.WCCost AS TotalBillable,\n  SLWI.WCRetAmt AS WorkRetainage,\n  SLWI.SMRetAmt AS MaterialsRetainage,\n  SLWI.WCRetAmt + SLWI.SMRetAmt AS TotalRetainage\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\n  AND SLWI.StoredMatls <> 0\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "basic",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoice totals with discounts and retainage\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Vendor invoice summary with discounts and retainage:\n1. Join APTH to APVM for vendor details\n2. Aggregate by vendor\n3. Include GrossAmt, DiscOffer, Retainage, and Balance\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(APTH.APTrans) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS GrossAmount,\n  SUM(APTH.DiscOffer) AS DiscountsOffered,\n  SUM(APTH.Retainage) AS RetainageHeld,\n  SUM(APTH.Balance) AS OpenBalance\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "basic",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get subcontractor costs with original, change orders, invoiced, paid, and retainage by vendor\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Subcontractor cost breakdown by vendor:\n1. Join SLHD (Header) to SLIT (Items) for subcontract details\n2. Join APVM for vendor names\n3. OrigCost = original contract amount\n4. CurCost - OrigCost = change order amounts\n5. InvCost = amounts invoiced\n6. Retainage = amounts held back\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  SLHD.SL AS SubcontractNum,\n  SLHD.Description AS SubcontractDesc,\n  SUM(SLIT.OrigCost) AS OriginalCost,\n  SUM(SLIT.CurCost - SLIT.OrigCost) AS ChangeOrderCost,\n  SUM(SLIT.CurCost) AS CurrentCost,\n  SUM(SLIT.InvCost) AS InvoicedCost,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost - SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nINNER JOIN APVM WITH (NOLOCK) ON SLHD.VendorGroup = APVM.VendorGroup AND SLHD.Vendor = APVM.Vendor\nWHERE SLHD.SLCo = @SLCo\nGROUP BY APVM.Vendor, APVM.Name, SLHD.SL, SLHD.Description\nORDER BY APVM.Name, SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLHD",
        "SLIT",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from SLHD\n\nDatabase Schema:\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from SLHD ().\n\n```sql\nSELECT *\nFROM SLHD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "SLHD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from SLWI\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from SLWI ().\n\n```sql\nSELECT *\nFROM SLWI WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "SLWI"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging buckets (30/60/90+ days) for unpaid invoices by customer\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Use ARTH for transaction data and ARCM for customer names\n2. Filter PayFullDate IS NULL to get only unpaid invoices\n3. Use DATEDIFF and CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging buckets (30/60/90+ days) for unpaid invoices by customer\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Use ARTH for transaction data and ARCM for customer names\n2. Filter PayFullDate IS NULL to get only unpaid invoices\n3. Use DATEDIFF and CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need to count records in arth by company\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count ARTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM ARTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need to reconcile ap oncost batch lines with original transactions\n\nDatabase Schema:\nCREATE TABLE APTL (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equip bequip,\n  EMGroup bgroup,\n  -- ... 56 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans, APLine)\n);\n\nCREATE TABLE APLB (\n  Co bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  BatchId bbatchid NOT NULL,\n  BatchSeq int NOT NULL,\n  APLine smallint NOT NULL,\n  BatchTransType char(1) NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  -- ... 120 more columns,\n  PRIMARY KEY (Co, Mth, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APHB (\n  Co bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  BatchId bbatchid NOT NULL,\n  BatchSeq int NOT NULL,\n  BatchTransType char(1) NOT NULL,\n  APTrans btrans,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  -- ... 88 more columns,\n  PRIMARY KEY (Co, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To reconcile AP oncost batches with original transactions:\n1. Join APLB (batch lines) to APTL (original lines) using ocApplyMth, ocApplyTrans, ocApplyLine\n2. Include APHB for batch header info\n3. Join to APTH and APVM for vendor context\n4. Compare batch vs original amounts\n\n```sql\nSELECT \n  APLB.Co AS BatchCo,\n  APLB.Mth AS BatchMth,\n  APLB.BatchId,\n  APLB.BatchSeq,\n  APLB.ocApplyMth,\n  APLB.ocApplyTrans,\n  APLB.ocApplyLine,\n  APTL.APCo AS OrigCo,\n  APTL.Mth AS OrigMth,\n  APTL.APTrans AS OrigTrans,\n  APTL.APLine AS OrigLine,\n  APTL.GrossAmt AS OrigAmount,\n  APLB.GrossAmt AS BatchAmount,\n  APVM.Name AS VendorName\nFROM APLB WITH (NOLOCK)\nINNER JOIN APHB WITH (NOLOCK) ON APLB.Co = APHB.Co AND APLB.Mth = APHB.Mth AND APLB.BatchId = APHB.BatchId\nINNER JOIN APTL WITH (NOLOCK) ON APLB.ocApplyMth = APTL.Mth \n  AND APLB.ocApplyTrans = APTL.APTrans \n  AND APLB.ocApplyLine = APTL.APLine\n  AND APLB.Co = APTL.APCo\nINNER JOIN APTH WITH (NOLOCK) ON APTL.APCo = APTH.APCo AND APTL.Mth = APTH.Mth AND APTL.APTrans = APTH.APTrans\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APLB.Co = @Co\nORDER BY APLB.BatchId, APLB.BatchSeq\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APLB",
        "APHB",
        "APTL",
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query to aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How do I count records in arth by company\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count ARTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM ARTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoices with their subcontract details\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I can partially answer this query, but the schema is incomplete.\n\nTo include subcontract details, the SLHD table is needed but not provided in the schema.\n\nHere's what I can provide with the available schema:\n\n```sql\nSELECT *\nFROM APTH WITH (NOLOCK)\nWHERE Co = @Co\n-- Note: Additional joins for SLHD would be needed for complete results\n```\n\nTo get the complete data you requested, please provide the DDL for SLHD.",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": [
        "APTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need to count records in glac by company\n\nDatabase Schema:\nCREATE TABLE GLAC (\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  Description bdesc,\n  AcctType char(1) NOT NULL,\n  SubType char(1),\n  NormBal char(1),\n  InterfaceDetail byn NOT NULL,\n  Active byn NOT NULL,\n  SummaryAcct bglacct NOT NULL,\n  CashAccrual char(1) NOT NULL,\n  CashOffAcct bglacct,\n  Notes varchar,\n  Part1 varchar(20),\n  Part2 varchar(20),\n  Part3 varchar(20),\n  Part4 varchar(20),\n  Part5 varchar(20),\n  Part6 varchar(20),\n  AllParts varchar(20),\n  CrossRefMemAcct bglacct,\n  -- ... 3 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count GLAC records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM GLAC WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "GLAC"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to count records in prth by company\n\nDatabase Schema:\nCREATE TABLE PRTH (\n  PRCo bcompany NOT NULL,\n  PRGroup bgroup NOT NULL,\n  PREndDate bdate NOT NULL,\n  Employee bemployee NOT NULL,\n  PaySeq tinyint NOT NULL,\n  PostSeq smallint NOT NULL,\n  Type char(1) NOT NULL,\n  PostDate bdate NOT NULL,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCDept bdept,\n  GLCo bcompany NOT NULL,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equipment bequip,\n  EMGroup tinyint,\n  CostCode bcostcode,\n  -- ... 41 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count PRTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM PRTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "PRTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find all unpaid AR invoices older than 60 days\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find unpaid invoices over 60 days:\n1. Join ARTH to ARCM for customer information\n2. Filter PayFullDate IS NULL (unpaid)\n3. Use DATEDIFF to calculate age and filter > 60 days\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Mth,\n  ARTH.ARTrans,\n  ARCM.Name AS CustomerName,\n  ARTH.TransDate,\n  ARTH.Amount,\n  DATEDIFF(day, ARTH.TransDate, GETDATE()) AS DaysOutstanding\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\n  AND DATEDIFF(day, ARTH.TransDate, GETDATE()) > 60\nORDER BY ARTH.TransDate\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: count records in arth by company\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count ARTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM ARTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from GLDT\n\nDatabase Schema:\nCREATE TABLE GLDT (\n  GLCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  GLTrans btrans NOT NULL,\n  GLAcct bglacct NOT NULL,\n  Jrnl bjrnl NOT NULL,\n  GLRef bglref NOT NULL,\n  SourceCo bcompany NOT NULL,\n  Source bsource NOT NULL,\n  ActDate bdate NOT NULL,\n  DatePosted bdate NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid NOT NULL,\n  Amount bdollar NOT NULL,\n  RevStatus tinyint NOT NULL,\n  Adjust char(1) NOT NULL,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  UniqueAttchID uniqueidentifier,\n  SrcTable varchar(128),\n  SrcKeyID bigint,\n  PRIMARY KEY (GLCo, Mth, GLTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from GLDT ().\n\n```sql\nSELECT *\nFROM GLDT WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "GLDT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query to count records in jccd by company\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count JCCD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM JCCD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate stored materials (Purchased - Installed) for SL billing\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Stored materials for SL billing:\n1. SLWI contains work item/billing details\n2. StoredMatls = Purchased - Installed (materials on-site but not yet used)\n3. WCCost = Work Completed Cost\n4. WCRetAmt and SMRetAmt = separate retainage for work vs materials\n5. Total billable = WCCost + StoredMatls\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description AS ItemDescription,\n  SLWI.StoredMatls,\n  SLWI.WCCost AS WorkCompletedCost,\n  SLWI.StoredMatls + SLWI.WCCost AS TotalBillable,\n  SLWI.WCRetAmt AS WorkRetainage,\n  SLWI.SMRetAmt AS MaterialsRetainage,\n  SLWI.WCRetAmt + SLWI.SMRetAmt AS TotalRetainage\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\n  AND SLWI.StoredMatls <> 0\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "intermediate",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from ARTH\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from ARTH ().\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need to count records in glac by company\n\nDatabase Schema:\nCREATE TABLE GLAC (\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  Description bdesc,\n  AcctType char(1) NOT NULL,\n  SubType char(1),\n  NormBal char(1),\n  InterfaceDetail byn NOT NULL,\n  Active byn NOT NULL,\n  SummaryAcct bglacct NOT NULL,\n  CashAccrual char(1) NOT NULL,\n  CashOffAcct bglacct,\n  Notes varchar,\n  Part1 varchar(20),\n  Part2 varchar(20),\n  Part3 varchar(20),\n  Part4 varchar(20),\n  Part5 varchar(20),\n  Part6 varchar(20),\n  AllParts varchar(20),\n  CrossRefMemAcct bglacct,\n  -- ... 3 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count GLAC records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM GLAC WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "GLAC"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate stored materials (Purchased - Installed) for SL billing\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Stored materials for SL billing:\n1. SLWI contains work item/billing details\n2. StoredMatls = Purchased - Installed (materials on-site but not yet used)\n3. WCCost = Work Completed Cost\n4. WCRetAmt and SMRetAmt = separate retainage for work vs materials\n5. Total billable = WCCost + StoredMatls\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description AS ItemDescription,\n  SLWI.StoredMatls,\n  SLWI.WCCost AS WorkCompletedCost,\n  SLWI.StoredMatls + SLWI.WCCost AS TotalBillable,\n  SLWI.WCRetAmt AS WorkRetainage,\n  SLWI.SMRetAmt AS MaterialsRetainage,\n  SLWI.WCRetAmt + SLWI.SMRetAmt AS TotalRetainage\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\n  AND SLWI.StoredMatls <> 0\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "intermediate",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from ARTH\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from ARTH ().\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get customer balance summary by customer group\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Customer balance summary by group:\n1. Join ARTH to ARCM for customer details\n2. Use conditional SUM for open vs total balances\n3. Group by CustGroup for summary\n\n```sql\nSELECT \n  ARTH.CustGroup,\n  COUNT(DISTINCT ARTH.Customer) AS CustomerCount,\n  SUM(CASE WHEN ARTH.PayFullDate IS NULL THEN ARTH.Amount ELSE 0 END) AS OpenBalance,\n  SUM(ARTH.Amount) AS TotalBilled\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\nGROUP BY ARTH.CustGroup\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query to count records in arth by company\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count ARTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM ARTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How do I count records in slwi by company\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count SLWI records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM SLWI WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "SLWI"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Join Subcontracts with other tables\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'Subcontracts' does not exist in Viewpoint Vista.\n\nUse SLHD (SL Header) for subcontract headers.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM SLHD WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to count records in glco by company\n\nDatabase Schema:\nCREATE TABLE GLCO (\n  GLCo bcompany NOT NULL,\n  Consolid byn NOT NULL,\n  LastMthSubClsd bmonth NOT NULL,\n  LastMthGLClsd bmonth NOT NULL,\n  MaxOpen tinyint NOT NULL,\n  CashAccrual char(1) NOT NULL,\n  Unbal byn NOT NULL,\n  AuditCoParams byn NOT NULL,\n  AuditAccts byn NOT NULL,\n  AuditAutoJrnl byn NOT NULL,\n  AuditBals byn NOT NULL,\n  AuditBudgets byn NOT NULL,\n  AuditDetail byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  XCompJrnlEntryYN byn NOT NULL,\n  KeyID bigint NOT NULL,\n  LastMthAPClsd bmonth NOT NULL,\n  LastMthARClsd bmonth NOT NULL,\n  AttachBatchReportsYN byn NOT NULL,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count GLCO records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM GLCO WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "GLCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get job cost variance by phase comparing budget to actual\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Job cost variance by phase:\n1. Join JCJM (Job Master) to JCCP (Cost Phase)\n2. Calculate variance as CurrEstCost - ActualCost\n3. Calculate percent complete from actuals vs budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  JCCP.Phase,\n  JCCP.CostType,\n  JCCP.OrigEstCost AS OriginalBudget,\n  JCCP.CurrEstCost AS CurrentBudget,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS Variance,\n  CASE WHEN JCCP.CurrEstCost <> 0 \n       THEN (JCCP.ActualCost / JCCP.CurrEstCost) * 100 \n       ELSE 0 END AS PercentComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.Job = @Job\nORDER BY JCCP.Phase, JCCP.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from SLWI\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from SLWI ().\n\n```sql\nSELECT *\nFROM SLWI WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "SLWI"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find all unpaid AR invoices older than 60 days\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find unpaid invoices over 60 days:\n1. Join ARTH to ARCM for customer information\n2. Filter PayFullDate IS NULL (unpaid)\n3. Use DATEDIFF to calculate age and filter > 60 days\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Mth,\n  ARTH.ARTrans,\n  ARCM.Name AS CustomerName,\n  ARTH.TransDate,\n  ARTH.Amount,\n  DATEDIFF(day, ARTH.TransDate, GETDATE()) AS DaysOutstanding\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\n  AND DATEDIFF(day, ARTH.TransDate, GETDATE()) > 60\nORDER BY ARTH.TransDate\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from JCCD\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from JCCD ().\n\n```sql\nSELECT *\nFROM JCCD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoice totals with discounts and retainage\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Vendor invoice summary with discounts and retainage:\n1. Join APTH to APVM for vendor details\n2. Aggregate by vendor\n3. Include GrossAmt, DiscOffer, Retainage, and Balance\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(APTH.APTrans) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS GrossAmount,\n  SUM(APTH.DiscOffer) AS DiscountsOffered,\n  SUM(APTH.Retainage) AS RetainageHeld,\n  SUM(APTH.Balance) AS OpenBalance\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find jobs over budget with remaining cost projection\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Find jobs over budget:\n1. Aggregate JCCP by job from JCJM\n2. Compare total ActualCost to CurrEstCost\n3. Use HAVING to filter only over-budget jobs\n4. Sort by amount over budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description,\n  SUM(JCCP.CurrEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.CurrEstCost) - SUM(JCCP.ActualCost) AS RemainingBudget,\n  CASE WHEN SUM(JCCP.CurrEstCost) < SUM(JCCP.ActualCost) \n       THEN 'OVER BUDGET' ELSE 'OK' END AS Status\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\nGROUP BY JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.CurrEstCost)\nORDER BY (SUM(JCCP.ActualCost) - SUM(JCCP.CurrEstCost)) DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM",
        "JCCD",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from GLCO\n\nDatabase Schema:\nCREATE TABLE GLCO (\n  GLCo bcompany NOT NULL,\n  Consolid byn NOT NULL,\n  LastMthSubClsd bmonth NOT NULL,\n  LastMthGLClsd bmonth NOT NULL,\n  MaxOpen tinyint NOT NULL,\n  CashAccrual char(1) NOT NULL,\n  Unbal byn NOT NULL,\n  AuditCoParams byn NOT NULL,\n  AuditAccts byn NOT NULL,\n  AuditAutoJrnl byn NOT NULL,\n  AuditBals byn NOT NULL,\n  AuditBudgets byn NOT NULL,\n  AuditDetail byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  XCompJrnlEntryYN byn NOT NULL,\n  KeyID bigint NOT NULL,\n  LastMthAPClsd bmonth NOT NULL,\n  LastMthARClsd bmonth NOT NULL,\n  AttachBatchReportsYN byn NOT NULL,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from GLCO ().\n\n```sql\nSELECT *\nFROM GLCO WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "GLCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate stored materials (Purchased - Installed) for SL billing\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Stored materials for SL billing:\n1. SLWI contains work item/billing details\n2. StoredMatls = Purchased - Installed (materials on-site but not yet used)\n3. WCCost = Work Completed Cost\n4. WCRetAmt and SMRetAmt = separate retainage for work vs materials\n5. Total billable = WCCost + StoredMatls\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description AS ItemDescription,\n  SLWI.StoredMatls,\n  SLWI.WCCost AS WorkCompletedCost,\n  SLWI.StoredMatls + SLWI.WCCost AS TotalBillable,\n  SLWI.WCRetAmt AS WorkRetainage,\n  SLWI.SMRetAmt AS MaterialsRetainage,\n  SLWI.WCRetAmt + SLWI.SMRetAmt AS TotalRetainage\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\n  AND SLWI.StoredMatls <> 0\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "basic",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging with customer contact information\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I can partially answer this query, but the schema is incomplete.\n\nThe query requires ARCM (AR Customer Master) for customer details, but only ARTH is provided in the schema.\n\nHere's what I can provide with the available schema:\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n-- Note: Additional joins for ARCM would be needed for complete results\n```\n\nTo get the complete data you requested, please provide the DDL for ARCM.",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from PRTH\n\nDatabase Schema:\nCREATE TABLE PRTH (\n  PRCo bcompany NOT NULL,\n  PRGroup bgroup NOT NULL,\n  PREndDate bdate NOT NULL,\n  Employee bemployee NOT NULL,\n  PaySeq tinyint NOT NULL,\n  PostSeq smallint NOT NULL,\n  Type char(1) NOT NULL,\n  PostDate bdate NOT NULL,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCDept bdept,\n  GLCo bcompany NOT NULL,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equipment bequip,\n  EMGroup tinyint,\n  CostCode bcostcode,\n  -- ... 41 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from PRTH ().\n\n```sql\nSELECT *\nFROM PRTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "PRTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: reconcile ap oncost batch lines with original transactions\n\nDatabase Schema:\nCREATE TABLE APTL (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equip bequip,\n  EMGroup bgroup,\n  -- ... 56 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans, APLine)\n);\n\nCREATE TABLE APLB (\n  Co bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  BatchId bbatchid NOT NULL,\n  BatchSeq int NOT NULL,\n  APLine smallint NOT NULL,\n  BatchTransType char(1) NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  -- ... 120 more columns,\n  PRIMARY KEY (Co, Mth, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APHB (\n  Co bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  BatchId bbatchid NOT NULL,\n  BatchSeq int NOT NULL,\n  BatchTransType char(1) NOT NULL,\n  APTrans btrans,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  -- ... 88 more columns,\n  PRIMARY KEY (Co, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To reconcile AP oncost batches with original transactions:\n1. Join APLB (batch lines) to APTL (original lines) using ocApplyMth, ocApplyTrans, ocApplyLine\n2. Include APHB for batch header info\n3. Join to APTH and APVM for vendor context\n4. Compare batch vs original amounts\n\n```sql\nSELECT \n  APLB.Co AS BatchCo,\n  APLB.Mth AS BatchMth,\n  APLB.BatchId,\n  APLB.BatchSeq,\n  APLB.ocApplyMth,\n  APLB.ocApplyTrans,\n  APLB.ocApplyLine,\n  APTL.APCo AS OrigCo,\n  APTL.Mth AS OrigMth,\n  APTL.APTrans AS OrigTrans,\n  APTL.APLine AS OrigLine,\n  APTL.GrossAmt AS OrigAmount,\n  APLB.GrossAmt AS BatchAmount,\n  APVM.Name AS VendorName\nFROM APLB WITH (NOLOCK)\nINNER JOIN APHB WITH (NOLOCK) ON APLB.Co = APHB.Co AND APLB.Mth = APHB.Mth AND APLB.BatchId = APHB.BatchId\nINNER JOIN APTL WITH (NOLOCK) ON APLB.ocApplyMth = APTL.Mth \n  AND APLB.ocApplyTrans = APTL.APTrans \n  AND APLB.ocApplyLine = APTL.APLine\n  AND APLB.Co = APTL.APCo\nINNER JOIN APTH WITH (NOLOCK) ON APTL.APCo = APTH.APCo AND APTL.Mth = APTH.Mth AND APTL.APTrans = APTH.APTrans\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APLB.Co = @Co\nORDER BY APLB.BatchId, APLB.BatchSeq\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APLB",
        "APHB",
        "APTL",
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How is Customer structured?\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'Customer' does not exist in Viewpoint Vista.\n\nUse ARCM (AR Customer Master) for customer information.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM ARCM WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How do I reconcile ap oncost batch lines with original transactions\n\nDatabase Schema:\nCREATE TABLE APTL (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equip bequip,\n  EMGroup bgroup,\n  -- ... 56 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans, APLine)\n);\n\nCREATE TABLE APLB (\n  Co bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  BatchId bbatchid NOT NULL,\n  BatchSeq int NOT NULL,\n  APLine smallint NOT NULL,\n  BatchTransType char(1) NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  -- ... 120 more columns,\n  PRIMARY KEY (Co, Mth, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APHB (\n  Co bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  BatchId bbatchid NOT NULL,\n  BatchSeq int NOT NULL,\n  BatchTransType char(1) NOT NULL,\n  APTrans btrans,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  -- ... 88 more columns,\n  PRIMARY KEY (Co, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To reconcile AP oncost batches with original transactions:\n1. Join APLB (batch lines) to APTL (original lines) using ocApplyMth, ocApplyTrans, ocApplyLine\n2. Include APHB for batch header info\n3. Join to APTH and APVM for vendor context\n4. Compare batch vs original amounts\n\n```sql\nSELECT \n  APLB.Co AS BatchCo,\n  APLB.Mth AS BatchMth,\n  APLB.BatchId,\n  APLB.BatchSeq,\n  APLB.ocApplyMth,\n  APLB.ocApplyTrans,\n  APLB.ocApplyLine,\n  APTL.APCo AS OrigCo,\n  APTL.Mth AS OrigMth,\n  APTL.APTrans AS OrigTrans,\n  APTL.APLine AS OrigLine,\n  APTL.GrossAmt AS OrigAmount,\n  APLB.GrossAmt AS BatchAmount,\n  APVM.Name AS VendorName\nFROM APLB WITH (NOLOCK)\nINNER JOIN APHB WITH (NOLOCK) ON APLB.Co = APHB.Co AND APLB.Mth = APHB.Mth AND APLB.BatchId = APHB.BatchId\nINNER JOIN APTL WITH (NOLOCK) ON APLB.ocApplyMth = APTL.Mth \n  AND APLB.ocApplyTrans = APTL.APTrans \n  AND APLB.ocApplyLine = APTL.APLine\n  AND APLB.Co = APTL.APCo\nINNER JOIN APTH WITH (NOLOCK) ON APTL.APCo = APTH.APCo AND APTL.Mth = APTH.Mth AND APTL.APTrans = APTH.APTrans\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APLB.Co = @Co\nORDER BY APLB.BatchId, APLB.BatchSeq\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "basic",
      "tables_used": [
        "APLB",
        "APHB",
        "APTL",
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to count records in gldt by company\n\nDatabase Schema:\nCREATE TABLE GLDT (\n  GLCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  GLTrans btrans NOT NULL,\n  GLAcct bglacct NOT NULL,\n  Jrnl bjrnl NOT NULL,\n  GLRef bglref NOT NULL,\n  SourceCo bcompany NOT NULL,\n  Source bsource NOT NULL,\n  ActDate bdate NOT NULL,\n  DatePosted bdate NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid NOT NULL,\n  Amount bdollar NOT NULL,\n  RevStatus tinyint NOT NULL,\n  Adjust char(1) NOT NULL,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  UniqueAttchID uniqueidentifier,\n  SrcTable varchar(128),\n  SrcKeyID bigint,\n  PRIMARY KEY (GLCo, Mth, GLTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count GLDT records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM GLDT WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "GLDT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: track ap hold status distinguishing retainage vs non-retainage holds\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APCO (\n  APCo bcompany NOT NULL,\n  GLCo bcompany NOT NULL,\n  ExpJrnl bjrnl,\n  GLExpInterfaceLvl tinyint NOT NULL,\n  GLExpSummaryDesc varchar(60),\n  GLExpTransDesc varchar(60),\n  GLJobDetailDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLEquipDetailDesc varchar(60),\n  GLExpDetailDesc varchar(60),\n  PayJrnl bjrnl,\n  GLPayInterfaceLvl tinyint NOT NULL,\n  GLPayDetailDesc varchar(60),\n  GLPaySummaryDesc varchar(60),\n  DiscOffGLAcct bglacct,\n  DiscTakenGLAcct bglacct,\n  ExpPayType tinyint,\n  JobPayType tinyint,\n  SubPayType tinyint,\n  RetPayType tinyint,\n  -- ... 92 more columns,\n  PRIMARY KEY (APCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To distinguish retainage vs non-retainage holds:\n1. Join APTD to APHD for hold details\n2. Join APCO to get RetHoldCode setting\n3. Compare APHD.HoldCode to APCO.RetHoldCode\n4. If equal, it's a retainage hold; otherwise non-retainage\n\n```sql\nSELECT \n  APTD.APCo,\n  APTD.Vendor,\n  APTD.Mth,\n  APTD.APTrans,\n  APHD.HoldCode,\n  CASE WHEN APHD.HoldCode = APCO.RetHoldCode \n       THEN 'Retainage Hold' \n       ELSE 'Non-Retainage Hold' END AS HoldType,\n  APTD.Amount\nFROM APTD WITH (NOLOCK)\nINNER JOIN APHD WITH (NOLOCK) ON APTD.APCo = APHD.APCo \n  AND APTD.Mth = APHD.Mth \n  AND APTD.APTrans = APHD.APTrans \n  AND APTD.APLine = APHD.APLine\nINNER JOIN APCO WITH (NOLOCK) ON APTD.APCo = APCO.APCo\nWHERE APTD.APCo = @APCo\n  AND APHD.HoldCode IS NOT NULL\nORDER BY APTD.Vendor, APTD.Mth\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTD",
        "APHD",
        "APCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get customer balance summary by customer group\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Customer balance summary by group:\n1. Join ARTH to ARCM for customer details\n2. Use conditional SUM for open vs total balances\n3. Group by CustGroup for summary\n\n```sql\nSELECT \n  ARTH.CustGroup,\n  COUNT(DISTINCT ARTH.Customer) AS CustomerCount,\n  SUM(CASE WHEN ARTH.PayFullDate IS NULL THEN ARTH.Amount ELSE 0 END) AS OpenBalance,\n  SUM(ARTH.Amount) AS TotalBilled\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\nGROUP BY ARTH.CustGroup\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from GLAC\n\nDatabase Schema:\nCREATE TABLE GLAC (\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  Description bdesc,\n  AcctType char(1) NOT NULL,\n  SubType char(1),\n  NormBal char(1),\n  InterfaceDetail byn NOT NULL,\n  Active byn NOT NULL,\n  SummaryAcct bglacct NOT NULL,\n  CashAccrual char(1) NOT NULL,\n  CashOffAcct bglacct,\n  Notes varchar,\n  Part1 varchar(20),\n  Part2 varchar(20),\n  Part3 varchar(20),\n  Part4 varchar(20),\n  Part5 varchar(20),\n  Part6 varchar(20),\n  AllParts varchar(20),\n  CrossRefMemAcct bglacct,\n  -- ... 3 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from GLAC ().\n\n```sql\nSELECT *\nFROM GLAC WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "GLAC"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to query Accounts\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'Accounts' does not exist in Viewpoint Vista.\n\nUse GLAC (GL Account) for chart of accounts.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM GLAC WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoice totals with discounts and retainage\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Vendor invoice summary with discounts and retainage:\n1. Join APTH to APVM for vendor details\n2. Aggregate by vendor\n3. Include GrossAmt, DiscOffer, Retainage, and Balance\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(APTH.APTrans) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS GrossAmount,\n  SUM(APTH.DiscOffer) AS DiscountsOffered,\n  SUM(APTH.Retainage) AS RetainageHeld,\n  SUM(APTH.Balance) AS OpenBalance\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "basic",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: track ap hold status distinguishing retainage vs non-retainage holds\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APCO (\n  APCo bcompany NOT NULL,\n  GLCo bcompany NOT NULL,\n  ExpJrnl bjrnl,\n  GLExpInterfaceLvl tinyint NOT NULL,\n  GLExpSummaryDesc varchar(60),\n  GLExpTransDesc varchar(60),\n  GLJobDetailDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLEquipDetailDesc varchar(60),\n  GLExpDetailDesc varchar(60),\n  PayJrnl bjrnl,\n  GLPayInterfaceLvl tinyint NOT NULL,\n  GLPayDetailDesc varchar(60),\n  GLPaySummaryDesc varchar(60),\n  DiscOffGLAcct bglacct,\n  DiscTakenGLAcct bglacct,\n  ExpPayType tinyint,\n  JobPayType tinyint,\n  SubPayType tinyint,\n  RetPayType tinyint,\n  -- ... 92 more columns,\n  PRIMARY KEY (APCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To distinguish retainage vs non-retainage holds:\n1. Join APTD to APHD for hold details\n2. Join APCO to get RetHoldCode setting\n3. Compare APHD.HoldCode to APCO.RetHoldCode\n4. If equal, it's a retainage hold; otherwise non-retainage\n\n```sql\nSELECT \n  APTD.APCo,\n  APTD.Vendor,\n  APTD.Mth,\n  APTD.APTrans,\n  APHD.HoldCode,\n  CASE WHEN APHD.HoldCode = APCO.RetHoldCode \n       THEN 'Retainage Hold' \n       ELSE 'Non-Retainage Hold' END AS HoldType,\n  APTD.Amount\nFROM APTD WITH (NOLOCK)\nINNER JOIN APHD WITH (NOLOCK) ON APTD.APCo = APHD.APCo \n  AND APTD.Mth = APHD.Mth \n  AND APTD.APTrans = APHD.APTrans \n  AND APTD.APLine = APHD.APLine\nINNER JOIN APCO WITH (NOLOCK) ON APTD.APCo = APCO.APCo\nWHERE APTD.APCo = @APCo\n  AND APHD.HoldCode IS NOT NULL\nORDER BY APTD.Vendor, APTD.Mth\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTD",
        "APHD",
        "APCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How do I count records in arth by company\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count ARTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM ARTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging buckets (30/60/90+ days) for unpaid invoices by customer\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Use ARTH for transaction data and ARCM for customer names\n2. Filter PayFullDate IS NULL to get only unpaid invoices\n3. Use DATEDIFF and CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging buckets (30/60/90+ days) for unpaid invoices by customer\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Use ARTH for transaction data and ARCM for customer names\n2. Filter PayFullDate IS NULL to get only unpaid invoices\n3. Use DATEDIFF and CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get subcontractor costs with original, change orders, invoiced, paid, and retainage by vendor\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Subcontractor cost breakdown by vendor:\n1. Join SLHD (Header) to SLIT (Items) for subcontract details\n2. Join APVM for vendor names\n3. OrigCost = original contract amount\n4. CurCost - OrigCost = change order amounts\n5. InvCost = amounts invoiced\n6. Retainage = amounts held back\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  SLHD.SL AS SubcontractNum,\n  SLHD.Description AS SubcontractDesc,\n  SUM(SLIT.OrigCost) AS OriginalCost,\n  SUM(SLIT.CurCost - SLIT.OrigCost) AS ChangeOrderCost,\n  SUM(SLIT.CurCost) AS CurrentCost,\n  SUM(SLIT.InvCost) AS InvoicedCost,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost - SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nINNER JOIN APVM WITH (NOLOCK) ON SLHD.VendorGroup = APVM.VendorGroup AND SLHD.Vendor = APVM.Vendor\nWHERE SLHD.SLCo = @SLCo\nGROUP BY APVM.Vendor, APVM.Name, SLHD.SL, SLHD.Description\nORDER BY APVM.Name, SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "intermediate",
      "tables_used": [
        "SLHD",
        "SLIT",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find all unpaid AR invoices older than 60 days\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find unpaid invoices over 60 days:\n1. Join ARTH to ARCM for customer information\n2. Filter PayFullDate IS NULL (unpaid)\n3. Use DATEDIFF to calculate age and filter > 60 days\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Mth,\n  ARTH.ARTrans,\n  ARCM.Name AS CustomerName,\n  ARTH.TransDate,\n  ARTH.Amount,\n  DATEDIFF(day, ARTH.TransDate, GETDATE()) AS DaysOutstanding\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\n  AND DATEDIFF(day, ARTH.TransDate, GETDATE()) > 60\nORDER BY ARTH.TransDate\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from GLAC\n\nDatabase Schema:\nCREATE TABLE GLAC (\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  Description bdesc,\n  AcctType char(1) NOT NULL,\n  SubType char(1),\n  NormBal char(1),\n  InterfaceDetail byn NOT NULL,\n  Active byn NOT NULL,\n  SummaryAcct bglacct NOT NULL,\n  CashAccrual char(1) NOT NULL,\n  CashOffAcct bglacct,\n  Notes varchar,\n  Part1 varchar(20),\n  Part2 varchar(20),\n  Part3 varchar(20),\n  Part4 varchar(20),\n  Part5 varchar(20),\n  Part6 varchar(20),\n  AllParts varchar(20),\n  CrossRefMemAcct bglacct,\n  -- ... 3 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from GLAC ().\n\n```sql\nSELECT *\nFROM GLAC WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "GLAC"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from ARTH\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from ARTH ().\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get job cost variance by phase comparing budget to actual\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Job cost variance by phase:\n1. Join JCJM (Job Master) to JCCP (Cost Phase)\n2. Calculate variance as CurrEstCost - ActualCost\n3. Calculate percent complete from actuals vs budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  JCCP.Phase,\n  JCCP.CostType,\n  JCCP.OrigEstCost AS OriginalBudget,\n  JCCP.CurrEstCost AS CurrentBudget,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS Variance,\n  CASE WHEN JCCP.CurrEstCost <> 0 \n       THEN (JCCP.ActualCost / JCCP.CurrEstCost) * 100 \n       ELSE 0 END AS PercentComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.Job = @Job\nORDER BY JCCP.Phase, JCCP.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find all unpaid AR invoices older than 60 days\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find unpaid invoices over 60 days:\n1. Join ARTH to ARCM for customer information\n2. Filter PayFullDate IS NULL (unpaid)\n3. Use DATEDIFF to calculate age and filter > 60 days\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Mth,\n  ARTH.ARTrans,\n  ARCM.Name AS CustomerName,\n  ARTH.TransDate,\n  ARTH.Amount,\n  DATEDIFF(day, ARTH.TransDate, GETDATE()) AS DaysOutstanding\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\n  AND DATEDIFF(day, ARTH.TransDate, GETDATE()) > 60\nORDER BY ARTH.TransDate\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from GLDT\n\nDatabase Schema:\nCREATE TABLE GLDT (\n  GLCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  GLTrans btrans NOT NULL,\n  GLAcct bglacct NOT NULL,\n  Jrnl bjrnl NOT NULL,\n  GLRef bglref NOT NULL,\n  SourceCo bcompany NOT NULL,\n  Source bsource NOT NULL,\n  ActDate bdate NOT NULL,\n  DatePosted bdate NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid NOT NULL,\n  Amount bdollar NOT NULL,\n  RevStatus tinyint NOT NULL,\n  Adjust char(1) NOT NULL,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  UniqueAttchID uniqueidentifier,\n  SrcTable varchar(128),\n  SrcKeyID bigint,\n  PRIMARY KEY (GLCo, Mth, GLTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from GLDT ().\n\n```sql\nSELECT *\nFROM GLDT WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "GLDT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find all unpaid AR invoices older than 60 days\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find unpaid invoices over 60 days:\n1. Join ARTH to ARCM for customer information\n2. Filter PayFullDate IS NULL (unpaid)\n3. Use DATEDIFF to calculate age and filter > 60 days\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Mth,\n  ARTH.ARTrans,\n  ARCM.Name AS CustomerName,\n  ARTH.TransDate,\n  ARTH.Amount,\n  DATEDIFF(day, ARTH.TransDate, GETDATE()) AS DaysOutstanding\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\n  AND DATEDIFF(day, ARTH.TransDate, GETDATE()) > 60\nORDER BY ARTH.TransDate\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from ARTH\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from ARTH ().\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoice totals with discounts and retainage\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Vendor invoice summary with discounts and retainage:\n1. Join APTH to APVM for vendor details\n2. Aggregate by vendor\n3. Include GrossAmt, DiscOffer, Retainage, and Balance\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(APTH.APTrans) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS GrossAmount,\n  SUM(APTH.DiscOffer) AS DiscountsOffered,\n  SUM(APTH.Retainage) AS RetainageHeld,\n  SUM(APTH.Balance) AS OpenBalance\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from JCCD\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from JCCD ().\n\n```sql\nSELECT *\nFROM JCCD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from JCCD\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from JCCD ().\n\n```sql\nSELECT *\nFROM JCCD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: count records in slwi by company\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count SLWI records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM SLWI WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLWI"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate stored materials (Purchased - Installed) for SL billing\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Stored materials for SL billing:\n1. SLWI contains work item/billing details\n2. StoredMatls = Purchased - Installed (materials on-site but not yet used)\n3. WCCost = Work Completed Cost\n4. WCRetAmt and SMRetAmt = separate retainage for work vs materials\n5. Total billable = WCCost + StoredMatls\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description AS ItemDescription,\n  SLWI.StoredMatls,\n  SLWI.WCCost AS WorkCompletedCost,\n  SLWI.StoredMatls + SLWI.WCCost AS TotalBillable,\n  SLWI.WCRetAmt AS WorkRetainage,\n  SLWI.SMRetAmt AS MaterialsRetainage,\n  SLWI.WCRetAmt + SLWI.SMRetAmt AS TotalRetainage\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\n  AND SLWI.StoredMatls <> 0\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "intermediate",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find jobs over budget with remaining cost projection\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Find jobs over budget:\n1. Aggregate JCCP by job from JCJM\n2. Compare total ActualCost to CurrEstCost\n3. Use HAVING to filter only over-budget jobs\n4. Sort by amount over budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description,\n  SUM(JCCP.CurrEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.CurrEstCost) - SUM(JCCP.ActualCost) AS RemainingBudget,\n  CASE WHEN SUM(JCCP.CurrEstCost) < SUM(JCCP.ActualCost) \n       THEN 'OVER BUDGET' ELSE 'OK' END AS Status\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\nGROUP BY JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.CurrEstCost)\nORDER BY (SUM(JCCP.ActualCost) - SUM(JCCP.CurrEstCost)) DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM",
        "JCCD",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from GLJR\n\nDatabase Schema:\nCREATE TABLE GLJR (\n  GLCo bcompany NOT NULL,\n  Jrnl bjrnl NOT NULL,\n  Description btransdesc,\n  Rev byn NOT NULL,\n  RevJrnl bjrnl,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from GLJR ().\n\n```sql\nSELECT *\nFROM GLJR WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "GLJR"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find jobs over budget with remaining cost projection\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Find jobs over budget:\n1. Aggregate JCCP by job from JCJM\n2. Compare total ActualCost to CurrEstCost\n3. Use HAVING to filter only over-budget jobs\n4. Sort by amount over budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description,\n  SUM(JCCP.CurrEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.CurrEstCost) - SUM(JCCP.ActualCost) AS RemainingBudget,\n  CASE WHEN SUM(JCCP.CurrEstCost) < SUM(JCCP.ActualCost) \n       THEN 'OVER BUDGET' ELSE 'OK' END AS Status\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\nGROUP BY JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.CurrEstCost)\nORDER BY (SUM(JCCP.ActualCost) - SUM(JCCP.CurrEstCost)) DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCJM",
        "JCCD",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get job cost variance by phase comparing budget to actual\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Job cost variance by phase:\n1. Join JCJM (Job Master) to JCCP (Cost Phase)\n2. Calculate variance as CurrEstCost - ActualCost\n3. Calculate percent complete from actuals vs budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  JCCP.Phase,\n  JCCP.CostType,\n  JCCP.OrigEstCost AS OriginalBudget,\n  JCCP.CurrEstCost AS CurrentBudget,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS Variance,\n  CASE WHEN JCCP.CurrEstCost <> 0 \n       THEN (JCCP.ActualCost / JCCP.CurrEstCost) * 100 \n       ELSE 0 END AS PercentComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.Job = @Job\nORDER BY JCCP.Phase, JCCP.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: count records in apth by company\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count APTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM APTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "APTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging with customer contact information\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I can partially answer this query, but the schema is incomplete.\n\nThe query requires ARCM (AR Customer Master) for customer details, but only ARTH is provided in the schema.\n\nHere's what I can provide with the available schema:\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n-- Note: Additional joins for ARCM would be needed for complete results\n```\n\nTo get the complete data you requested, please provide the DDL for ARCM.",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from PRPC\n\nDatabase Schema:\nCREATE TABLE PRPC (\n  PRCo bcompany NOT NULL,\n  PRGroup bgroup NOT NULL,\n  PREndDate bdate NOT NULL,\n  BeginDate bdate NOT NULL,\n  MultiMth byn NOT NULL,\n  BeginMth bmonth NOT NULL,\n  EndMth bmonth,\n  CutoffDate bdate,\n  LimitMth bmonth NOT NULL,\n  Hrs smallint NOT NULL,\n  Days tinyint NOT NULL,\n  Wks tinyint NOT NULL,\n  Status tinyint NOT NULL,\n  DateClosed smalldatetime,\n  JCInterface byn NOT NULL,\n  EMInterface byn NOT NULL,\n  GLInterface byn NOT NULL,\n  APInterface byn NOT NULL,\n  LeaveProcess byn NOT NULL,\n  InUseBy bvpusername,\n  -- ... 7 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from PRPC ().\n\n```sql\nSELECT *\nFROM PRPC WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "PRPC"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find jobs over budget with remaining cost projection\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Find jobs over budget:\n1. Aggregate JCCP by job from JCJM\n2. Compare total ActualCost to CurrEstCost\n3. Use HAVING to filter only over-budget jobs\n4. Sort by amount over budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description,\n  SUM(JCCP.CurrEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.CurrEstCost) - SUM(JCCP.ActualCost) AS RemainingBudget,\n  CASE WHEN SUM(JCCP.CurrEstCost) < SUM(JCCP.ActualCost) \n       THEN 'OVER BUDGET' ELSE 'OK' END AS Status\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\nGROUP BY JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.CurrEstCost)\nORDER BY (SUM(JCCP.ActualCost) - SUM(JCCP.CurrEstCost)) DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM",
        "JCCD",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find all unpaid AR invoices older than 60 days\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find unpaid invoices over 60 days:\n1. Join ARTH to ARCM for customer information\n2. Filter PayFullDate IS NULL (unpaid)\n3. Use DATEDIFF to calculate age and filter > 60 days\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Mth,\n  ARTH.ARTrans,\n  ARCM.Name AS CustomerName,\n  ARTH.TransDate,\n  ARTH.Amount,\n  DATEDIFF(day, ARTH.TransDate, GETDATE()) AS DaysOutstanding\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\n  AND DATEDIFF(day, ARTH.TransDate, GETDATE()) > 60\nORDER BY ARTH.TransDate\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query to aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to reconcile ap oncost batch lines with original transactions\n\nDatabase Schema:\nCREATE TABLE APTL (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equip bequip,\n  EMGroup bgroup,\n  -- ... 56 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans, APLine)\n);\n\nCREATE TABLE APLB (\n  Co bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  BatchId bbatchid NOT NULL,\n  BatchSeq int NOT NULL,\n  APLine smallint NOT NULL,\n  BatchTransType char(1) NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  -- ... 120 more columns,\n  PRIMARY KEY (Co, Mth, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APHB (\n  Co bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  BatchId bbatchid NOT NULL,\n  BatchSeq int NOT NULL,\n  BatchTransType char(1) NOT NULL,\n  APTrans btrans,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  -- ... 88 more columns,\n  PRIMARY KEY (Co, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To reconcile AP oncost batches with original transactions:\n1. Join APLB (batch lines) to APTL (original lines) using ocApplyMth, ocApplyTrans, ocApplyLine\n2. Include APHB for batch header info\n3. Join to APTH and APVM for vendor context\n4. Compare batch vs original amounts\n\n```sql\nSELECT \n  APLB.Co AS BatchCo,\n  APLB.Mth AS BatchMth,\n  APLB.BatchId,\n  APLB.BatchSeq,\n  APLB.ocApplyMth,\n  APLB.ocApplyTrans,\n  APLB.ocApplyLine,\n  APTL.APCo AS OrigCo,\n  APTL.Mth AS OrigMth,\n  APTL.APTrans AS OrigTrans,\n  APTL.APLine AS OrigLine,\n  APTL.GrossAmt AS OrigAmount,\n  APLB.GrossAmt AS BatchAmount,\n  APVM.Name AS VendorName\nFROM APLB WITH (NOLOCK)\nINNER JOIN APHB WITH (NOLOCK) ON APLB.Co = APHB.Co AND APLB.Mth = APHB.Mth AND APLB.BatchId = APHB.BatchId\nINNER JOIN APTL WITH (NOLOCK) ON APLB.ocApplyMth = APTL.Mth \n  AND APLB.ocApplyTrans = APTL.APTrans \n  AND APLB.ocApplyLine = APTL.APLine\n  AND APLB.Co = APTL.APCo\nINNER JOIN APTH WITH (NOLOCK) ON APTL.APCo = APTH.APCo AND APTL.Mth = APTH.Mth AND APTL.APTrans = APTH.APTrans\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APLB.Co = @Co\nORDER BY APLB.BatchId, APLB.BatchSeq\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APLB",
        "APHB",
        "APTL",
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get customer balance summary by customer group\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Customer balance summary by group:\n1. Join ARTH to ARCM for customer details\n2. Use conditional SUM for open vs total balances\n3. Group by CustGroup for summary\n\n```sql\nSELECT \n  ARTH.CustGroup,\n  COUNT(DISTINCT ARTH.Customer) AS CustomerCount,\n  SUM(CASE WHEN ARTH.PayFullDate IS NULL THEN ARTH.Amount ELSE 0 END) AS OpenBalance,\n  SUM(ARTH.Amount) AS TotalBilled\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\nGROUP BY ARTH.CustGroup\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get subcontractor costs with original, change orders, invoiced, paid, and retainage by vendor\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Subcontractor cost breakdown by vendor:\n1. Join SLHD (Header) to SLIT (Items) for subcontract details\n2. Join APVM for vendor names\n3. OrigCost = original contract amount\n4. CurCost - OrigCost = change order amounts\n5. InvCost = amounts invoiced\n6. Retainage = amounts held back\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  SLHD.SL AS SubcontractNum,\n  SLHD.Description AS SubcontractDesc,\n  SUM(SLIT.OrigCost) AS OriginalCost,\n  SUM(SLIT.CurCost - SLIT.OrigCost) AS ChangeOrderCost,\n  SUM(SLIT.CurCost) AS CurrentCost,\n  SUM(SLIT.InvCost) AS InvoicedCost,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost - SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nINNER JOIN APVM WITH (NOLOCK) ON SLHD.VendorGroup = APVM.VendorGroup AND SLHD.Vendor = APVM.Vendor\nWHERE SLHD.SLCo = @SLCo\nGROUP BY APVM.Vendor, APVM.Name, SLHD.SL, SLHD.Description\nORDER BY APVM.Name, SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "basic",
      "tables_used": [
        "SLHD",
        "SLIT",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoice totals with discounts and retainage\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Vendor invoice summary with discounts and retainage:\n1. Join APTH to APVM for vendor details\n2. Aggregate by vendor\n3. Include GrossAmt, DiscOffer, Retainage, and Balance\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(APTH.APTrans) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS GrossAmount,\n  SUM(APTH.DiscOffer) AS DiscountsOffered,\n  SUM(APTH.Retainage) AS RetainageHeld,\n  SUM(APTH.Balance) AS OpenBalance\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "basic",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from ARTH\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from ARTH ().\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show job costs with GL account descriptions\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I can partially answer this query, but the schema is incomplete.\n\nThe query requires GLAC for GL account descriptions, which is not in the provided schema.\n\nHere's what I can provide with the available schema:\n\n```sql\nSELECT *\nFROM JCCD WITH (NOLOCK)\nWHERE Co = @Co\n-- Note: Additional joins for GLAC would be needed for complete results\n```\n\nTo get the complete data you requested, please provide the DDL for GLAC.",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from APTH\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from APTH ().\n\n```sql\nSELECT *\nFROM APTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from PRPC\n\nDatabase Schema:\nCREATE TABLE PRPC (\n  PRCo bcompany NOT NULL,\n  PRGroup bgroup NOT NULL,\n  PREndDate bdate NOT NULL,\n  BeginDate bdate NOT NULL,\n  MultiMth byn NOT NULL,\n  BeginMth bmonth NOT NULL,\n  EndMth bmonth,\n  CutoffDate bdate,\n  LimitMth bmonth NOT NULL,\n  Hrs smallint NOT NULL,\n  Days tinyint NOT NULL,\n  Wks tinyint NOT NULL,\n  Status tinyint NOT NULL,\n  DateClosed smalldatetime,\n  JCInterface byn NOT NULL,\n  EMInterface byn NOT NULL,\n  GLInterface byn NOT NULL,\n  APInterface byn NOT NULL,\n  LeaveProcess byn NOT NULL,\n  InUseBy bvpusername,\n  -- ... 7 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from PRPC ().\n\n```sql\nSELECT *\nFROM PRPC WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "PRPC"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from APTH\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from APTH ().\n\n```sql\nSELECT *\nFROM APTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get job cost variance by phase comparing budget to actual\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Job cost variance by phase:\n1. Join JCJM (Job Master) to JCCP (Cost Phase)\n2. Calculate variance as CurrEstCost - ActualCost\n3. Calculate percent complete from actuals vs budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  JCCP.Phase,\n  JCCP.CostType,\n  JCCP.OrigEstCost AS OriginalBudget,\n  JCCP.CurrEstCost AS CurrentBudget,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS Variance,\n  CASE WHEN JCCP.CurrEstCost <> 0 \n       THEN (JCCP.ActualCost / JCCP.CurrEstCost) * 100 \n       ELSE 0 END AS PercentComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.Job = @Job\nORDER BY JCCP.Phase, JCCP.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need to count records in prpc by company\n\nDatabase Schema:\nCREATE TABLE PRPC (\n  PRCo bcompany NOT NULL,\n  PRGroup bgroup NOT NULL,\n  PREndDate bdate NOT NULL,\n  BeginDate bdate NOT NULL,\n  MultiMth byn NOT NULL,\n  BeginMth bmonth NOT NULL,\n  EndMth bmonth,\n  CutoffDate bdate,\n  LimitMth bmonth NOT NULL,\n  Hrs smallint NOT NULL,\n  Days tinyint NOT NULL,\n  Wks tinyint NOT NULL,\n  Status tinyint NOT NULL,\n  DateClosed smalldatetime,\n  JCInterface byn NOT NULL,\n  EMInterface byn NOT NULL,\n  GLInterface byn NOT NULL,\n  APInterface byn NOT NULL,\n  LeaveProcess byn NOT NULL,\n  InUseBy bvpusername,\n  -- ... 7 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count PRPC records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM PRPC WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "PRPC"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find all unpaid AR invoices older than 60 days\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find unpaid invoices over 60 days:\n1. Join ARTH to ARCM for customer information\n2. Filter PayFullDate IS NULL (unpaid)\n3. Use DATEDIFF to calculate age and filter > 60 days\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Mth,\n  ARTH.ARTrans,\n  ARCM.Name AS CustomerName,\n  ARTH.TransDate,\n  ARTH.Amount,\n  DATEDIFF(day, ARTH.TransDate, GETDATE()) AS DaysOutstanding\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\n  AND DATEDIFF(day, ARTH.TransDate, GETDATE()) > 60\nORDER BY ARTH.TransDate\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find all unpaid AR invoices older than 60 days\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find unpaid invoices over 60 days:\n1. Join ARTH to ARCM for customer information\n2. Filter PayFullDate IS NULL (unpaid)\n3. Use DATEDIFF to calculate age and filter > 60 days\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Mth,\n  ARTH.ARTrans,\n  ARCM.Name AS CustomerName,\n  ARTH.TransDate,\n  ARTH.Amount,\n  DATEDIFF(day, ARTH.TransDate, GETDATE()) AS DaysOutstanding\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\n  AND DATEDIFF(day, ARTH.TransDate, GETDATE()) > 60\nORDER BY ARTH.TransDate\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from JCCD\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from JCCD ().\n\n```sql\nSELECT *\nFROM JCCD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from JCCD\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from JCCD ().\n\n```sql\nSELECT *\nFROM JCCD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get job cost variance by phase comparing budget to actual\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Job cost variance by phase:\n1. Join JCJM (Job Master) to JCCP (Cost Phase)\n2. Calculate variance as CurrEstCost - ActualCost\n3. Calculate percent complete from actuals vs budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  JCCP.Phase,\n  JCCP.CostType,\n  JCCP.OrigEstCost AS OriginalBudget,\n  JCCP.CurrEstCost AS CurrentBudget,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS Variance,\n  CASE WHEN JCCP.CurrEstCost <> 0 \n       THEN (JCCP.ActualCost / JCCP.CurrEstCost) * 100 \n       ELSE 0 END AS PercentComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.Job = @Job\nORDER BY JCCP.Phase, JCCP.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get job cost variance by phase comparing budget to actual\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Job cost variance by phase:\n1. Join JCJM (Job Master) to JCCP (Cost Phase)\n2. Calculate variance as CurrEstCost - ActualCost\n3. Calculate percent complete from actuals vs budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  JCCP.Phase,\n  JCCP.CostType,\n  JCCP.OrigEstCost AS OriginalBudget,\n  JCCP.CurrEstCost AS CurrentBudget,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS Variance,\n  CASE WHEN JCCP.CurrEstCost <> 0 \n       THEN (JCCP.ActualCost / JCCP.CurrEstCost) * 100 \n       ELSE 0 END AS PercentComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.Job = @Job\nORDER BY JCCP.Phase, JCCP.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find jobs over budget with remaining cost projection\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Find jobs over budget:\n1. Aggregate JCCP by job from JCJM\n2. Compare total ActualCost to CurrEstCost\n3. Use HAVING to filter only over-budget jobs\n4. Sort by amount over budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description,\n  SUM(JCCP.CurrEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.CurrEstCost) - SUM(JCCP.ActualCost) AS RemainingBudget,\n  CASE WHEN SUM(JCCP.CurrEstCost) < SUM(JCCP.ActualCost) \n       THEN 'OVER BUDGET' ELSE 'OK' END AS Status\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\nGROUP BY JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.CurrEstCost)\nORDER BY (SUM(JCCP.ActualCost) - SUM(JCCP.CurrEstCost)) DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM",
        "JCCD",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query to count records in jccd by company\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count JCCD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM JCCD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from APTH\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from APTH ().\n\n```sql\nSELECT *\nFROM APTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "APTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Join Retainage with other tables\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'Retainage' does not exist in Viewpoint Vista.\n\nRetainage is stored in APTD (PayType column) for AP and SLWI (WCRetAmt, SMRetAmt) for subcontracts.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM APTD WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query to count records in gljr by company\n\nDatabase Schema:\nCREATE TABLE GLJR (\n  GLCo bcompany NOT NULL,\n  Jrnl bjrnl NOT NULL,\n  Description btransdesc,\n  Rev byn NOT NULL,\n  RevJrnl bjrnl,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count GLJR records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM GLJR WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "GLJR"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need to count records in jccd by company\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count JCCD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM JCCD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from PREH\n\nDatabase Schema:\nCREATE TABLE PREH (\n  PRCo bcompany NOT NULL,\n  Employee bemployee NOT NULL,\n  LastName varchar(30) NOT NULL,\n  FirstName varchar(30),\n  MidName varchar(15),\n  SortName bsortname NOT NULL,\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  Phone bphone,\n  SSN char(11) NOT NULL,\n  Race char(2) NOT NULL,\n  Sex char(1) NOT NULL,\n  BirthDate smalldatetime,\n  HireDate bdate,\n  TermDate bdate,\n  PRGroup bgroup NOT NULL,\n  PRDept bdept NOT NULL,\n  -- ... 121 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from PREH ().\n\n```sql\nSELECT *\nFROM PREH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "PREH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get subcontractor costs with original, change orders, invoiced, paid, and retainage by vendor\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Subcontractor cost breakdown by vendor:\n1. Join SLHD (Header) to SLIT (Items) for subcontract details\n2. Join APVM for vendor names\n3. OrigCost = original contract amount\n4. CurCost - OrigCost = change order amounts\n5. InvCost = amounts invoiced\n6. Retainage = amounts held back\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  SLHD.SL AS SubcontractNum,\n  SLHD.Description AS SubcontractDesc,\n  SUM(SLIT.OrigCost) AS OriginalCost,\n  SUM(SLIT.CurCost - SLIT.OrigCost) AS ChangeOrderCost,\n  SUM(SLIT.CurCost) AS CurrentCost,\n  SUM(SLIT.InvCost) AS InvoicedCost,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost - SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nINNER JOIN APVM WITH (NOLOCK) ON SLHD.VendorGroup = APVM.VendorGroup AND SLHD.Vendor = APVM.Vendor\nWHERE SLHD.SLCo = @SLCo\nGROUP BY APVM.Vendor, APVM.Name, SLHD.SL, SLHD.Description\nORDER BY APVM.Name, SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "basic",
      "tables_used": [
        "SLHD",
        "SLIT",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get customer balance summary by customer group\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Customer balance summary by group:\n1. Join ARTH to ARCM for customer details\n2. Use conditional SUM for open vs total balances\n3. Group by CustGroup for summary\n\n```sql\nSELECT \n  ARTH.CustGroup,\n  COUNT(DISTINCT ARTH.Customer) AS CustomerCount,\n  SUM(CASE WHEN ARTH.PayFullDate IS NULL THEN ARTH.Amount ELSE 0 END) AS OpenBalance,\n  SUM(ARTH.Amount) AS TotalBilled\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\nGROUP BY ARTH.CustGroup\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query to track ap hold status distinguishing retainage vs non-retainage holds\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APCO (\n  APCo bcompany NOT NULL,\n  GLCo bcompany NOT NULL,\n  ExpJrnl bjrnl,\n  GLExpInterfaceLvl tinyint NOT NULL,\n  GLExpSummaryDesc varchar(60),\n  GLExpTransDesc varchar(60),\n  GLJobDetailDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLEquipDetailDesc varchar(60),\n  GLExpDetailDesc varchar(60),\n  PayJrnl bjrnl,\n  GLPayInterfaceLvl tinyint NOT NULL,\n  GLPayDetailDesc varchar(60),\n  GLPaySummaryDesc varchar(60),\n  DiscOffGLAcct bglacct,\n  DiscTakenGLAcct bglacct,\n  ExpPayType tinyint,\n  JobPayType tinyint,\n  SubPayType tinyint,\n  RetPayType tinyint,\n  -- ... 92 more columns,\n  PRIMARY KEY (APCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To distinguish retainage vs non-retainage holds:\n1. Join APTD to APHD for hold details\n2. Join APCO to get RetHoldCode setting\n3. Compare APHD.HoldCode to APCO.RetHoldCode\n4. If equal, it's a retainage hold; otherwise non-retainage\n\n```sql\nSELECT \n  APTD.APCo,\n  APTD.Vendor,\n  APTD.Mth,\n  APTD.APTrans,\n  APHD.HoldCode,\n  CASE WHEN APHD.HoldCode = APCO.RetHoldCode \n       THEN 'Retainage Hold' \n       ELSE 'Non-Retainage Hold' END AS HoldType,\n  APTD.Amount\nFROM APTD WITH (NOLOCK)\nINNER JOIN APHD WITH (NOLOCK) ON APTD.APCo = APHD.APCo \n  AND APTD.Mth = APHD.Mth \n  AND APTD.APTrans = APHD.APTrans \n  AND APTD.APLine = APHD.APLine\nINNER JOIN APCO WITH (NOLOCK) ON APTD.APCo = APCO.APCo\nWHERE APTD.APCo = @APCo\n  AND APHD.HoldCode IS NOT NULL\nORDER BY APTD.Vendor, APTD.Mth\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTD",
        "APHD",
        "APCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from JCCD\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from JCCD ().\n\n```sql\nSELECT *\nFROM JCCD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from Contracts\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'Contracts' does not exist in Viewpoint Vista.\n\nUse JCCM (JC Contract Master) for contract information.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM JCCM WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get subcontractor costs with original, change orders, invoiced, paid, and retainage by vendor\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Subcontractor cost breakdown by vendor:\n1. Join SLHD (Header) to SLIT (Items) for subcontract details\n2. Join APVM for vendor names\n3. OrigCost = original contract amount\n4. CurCost - OrigCost = change order amounts\n5. InvCost = amounts invoiced\n6. Retainage = amounts held back\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  SLHD.SL AS SubcontractNum,\n  SLHD.Description AS SubcontractDesc,\n  SUM(SLIT.OrigCost) AS OriginalCost,\n  SUM(SLIT.CurCost - SLIT.OrigCost) AS ChangeOrderCost,\n  SUM(SLIT.CurCost) AS CurrentCost,\n  SUM(SLIT.InvCost) AS InvoicedCost,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost - SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nINNER JOIN APVM WITH (NOLOCK) ON SLHD.VendorGroup = APVM.VendorGroup AND SLHD.Vendor = APVM.Vendor\nWHERE SLHD.SLCo = @SLCo\nGROUP BY APVM.Vendor, APVM.Name, SLHD.SL, SLHD.Description\nORDER BY APVM.Name, SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "intermediate",
      "tables_used": [
        "SLHD",
        "SLIT",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find all unpaid AR invoices older than 60 days\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find unpaid invoices over 60 days:\n1. Join ARTH to ARCM for customer information\n2. Filter PayFullDate IS NULL (unpaid)\n3. Use DATEDIFF to calculate age and filter > 60 days\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Mth,\n  ARTH.ARTrans,\n  ARCM.Name AS CustomerName,\n  ARTH.TransDate,\n  ARTH.Amount,\n  DATEDIFF(day, ARTH.TransDate, GETDATE()) AS DaysOutstanding\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\n  AND DATEDIFF(day, ARTH.TransDate, GETDATE()) > 60\nORDER BY ARTH.TransDate\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get subcontractor costs with original, change orders, invoiced, paid, and retainage by vendor\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Subcontractor cost breakdown by vendor:\n1. Join SLHD (Header) to SLIT (Items) for subcontract details\n2. Join APVM for vendor names\n3. OrigCost = original contract amount\n4. CurCost - OrigCost = change order amounts\n5. InvCost = amounts invoiced\n6. Retainage = amounts held back\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  SLHD.SL AS SubcontractNum,\n  SLHD.Description AS SubcontractDesc,\n  SUM(SLIT.OrigCost) AS OriginalCost,\n  SUM(SLIT.CurCost - SLIT.OrigCost) AS ChangeOrderCost,\n  SUM(SLIT.CurCost) AS CurrentCost,\n  SUM(SLIT.InvCost) AS InvoicedCost,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost - SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nINNER JOIN APVM WITH (NOLOCK) ON SLHD.VendorGroup = APVM.VendorGroup AND SLHD.Vendor = APVM.Vendor\nWHERE SLHD.SLCo = @SLCo\nGROUP BY APVM.Vendor, APVM.Name, SLHD.SL, SLHD.Description\nORDER BY APVM.Name, SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "intermediate",
      "tables_used": [
        "SLHD",
        "SLIT",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate stored materials (Purchased - Installed) for SL billing\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Stored materials for SL billing:\n1. SLWI contains work item/billing details\n2. StoredMatls = Purchased - Installed (materials on-site but not yet used)\n3. WCCost = Work Completed Cost\n4. WCRetAmt and SMRetAmt = separate retainage for work vs materials\n5. Total billable = WCCost + StoredMatls\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description AS ItemDescription,\n  SLWI.StoredMatls,\n  SLWI.WCCost AS WorkCompletedCost,\n  SLWI.StoredMatls + SLWI.WCCost AS TotalBillable,\n  SLWI.WCRetAmt AS WorkRetainage,\n  SLWI.SMRetAmt AS MaterialsRetainage,\n  SLWI.WCRetAmt + SLWI.SMRetAmt AS TotalRetainage\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\n  AND SLWI.StoredMatls <> 0\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from JCCD\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from JCCD ().\n\n```sql\nSELECT *\nFROM JCCD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from APTD\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from APTD ().\n\n```sql\nSELECT *\nFROM APTD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need to count records in jccd by company\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count JCCD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM JCCD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How do I aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from JCCD\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from JCCD ().\n\n```sql\nSELECT *\nFROM JCCD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from JCCD\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from JCCD ().\n\n```sql\nSELECT *\nFROM JCCD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to track ap hold status distinguishing retainage vs non-retainage holds\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APCO (\n  APCo bcompany NOT NULL,\n  GLCo bcompany NOT NULL,\n  ExpJrnl bjrnl,\n  GLExpInterfaceLvl tinyint NOT NULL,\n  GLExpSummaryDesc varchar(60),\n  GLExpTransDesc varchar(60),\n  GLJobDetailDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLEquipDetailDesc varchar(60),\n  GLExpDetailDesc varchar(60),\n  PayJrnl bjrnl,\n  GLPayInterfaceLvl tinyint NOT NULL,\n  GLPayDetailDesc varchar(60),\n  GLPaySummaryDesc varchar(60),\n  DiscOffGLAcct bglacct,\n  DiscTakenGLAcct bglacct,\n  ExpPayType tinyint,\n  JobPayType tinyint,\n  SubPayType tinyint,\n  RetPayType tinyint,\n  -- ... 92 more columns,\n  PRIMARY KEY (APCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To distinguish retainage vs non-retainage holds:\n1. Join APTD to APHD for hold details\n2. Join APCO to get RetHoldCode setting\n3. Compare APHD.HoldCode to APCO.RetHoldCode\n4. If equal, it's a retainage hold; otherwise non-retainage\n\n```sql\nSELECT \n  APTD.APCo,\n  APTD.Vendor,\n  APTD.Mth,\n  APTD.APTrans,\n  APHD.HoldCode,\n  CASE WHEN APHD.HoldCode = APCO.RetHoldCode \n       THEN 'Retainage Hold' \n       ELSE 'Non-Retainage Hold' END AS HoldType,\n  APTD.Amount\nFROM APTD WITH (NOLOCK)\nINNER JOIN APHD WITH (NOLOCK) ON APTD.APCo = APHD.APCo \n  AND APTD.Mth = APHD.Mth \n  AND APTD.APTrans = APHD.APTrans \n  AND APTD.APLine = APHD.APLine\nINNER JOIN APCO WITH (NOLOCK) ON APTD.APCo = APCO.APCo\nWHERE APTD.APCo = @APCo\n  AND APHD.HoldCode IS NOT NULL\nORDER BY APTD.Vendor, APTD.Mth\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "basic",
      "tables_used": [
        "APTD",
        "APHD",
        "APCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from APTH\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from APTH ().\n\n```sql\nSELECT *\nFROM APTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging buckets (30/60/90+ days) for unpaid invoices by customer\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Use ARTH for transaction data and ARCM for customer names\n2. Filter PayFullDate IS NULL to get only unpaid invoices\n3. Use DATEDIFF and CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging with customer contact information\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I can partially answer this query, but the schema is incomplete.\n\nThe query requires ARCM (AR Customer Master) for customer details, but only ARTH is provided in the schema.\n\nHere's what I can provide with the available schema:\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n-- Note: Additional joins for ARCM would be needed for complete results\n```\n\nTo get the complete data you requested, please provide the DDL for ARCM.",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find all unpaid AR invoices older than 60 days\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find unpaid invoices over 60 days:\n1. Join ARTH to ARCM for customer information\n2. Filter PayFullDate IS NULL (unpaid)\n3. Use DATEDIFF to calculate age and filter > 60 days\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Mth,\n  ARTH.ARTrans,\n  ARCM.Name AS CustomerName,\n  ARTH.TransDate,\n  ARTH.Amount,\n  DATEDIFF(day, ARTH.TransDate, GETDATE()) AS DaysOutstanding\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\n  AND DATEDIFF(day, ARTH.TransDate, GETDATE()) > 60\nORDER BY ARTH.TransDate\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get job cost variance by phase comparing budget to actual\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Job cost variance by phase:\n1. Join JCJM (Job Master) to JCCP (Cost Phase)\n2. Calculate variance as CurrEstCost - ActualCost\n3. Calculate percent complete from actuals vs budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  JCCP.Phase,\n  JCCP.CostType,\n  JCCP.OrigEstCost AS OriginalBudget,\n  JCCP.CurrEstCost AS CurrentBudget,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS Variance,\n  CASE WHEN JCCP.CurrEstCost <> 0 \n       THEN (JCCP.ActualCost / JCCP.CurrEstCost) * 100 \n       ELSE 0 END AS PercentComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.Job = @Job\nORDER BY JCCP.Phase, JCCP.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: count records in slwi by company\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count SLWI records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM SLWI WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "SLWI"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate stored materials (Purchased - Installed) for SL billing\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Stored materials for SL billing:\n1. SLWI contains work item/billing details\n2. StoredMatls = Purchased - Installed (materials on-site but not yet used)\n3. WCCost = Work Completed Cost\n4. WCRetAmt and SMRetAmt = separate retainage for work vs materials\n5. Total billable = WCCost + StoredMatls\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description AS ItemDescription,\n  SLWI.StoredMatls,\n  SLWI.WCCost AS WorkCompletedCost,\n  SLWI.StoredMatls + SLWI.WCCost AS TotalBillable,\n  SLWI.WCRetAmt AS WorkRetainage,\n  SLWI.SMRetAmt AS MaterialsRetainage,\n  SLWI.WCRetAmt + SLWI.SMRetAmt AS TotalRetainage\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\n  AND SLWI.StoredMatls <> 0\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "basic",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Join Vendors with other tables\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'Vendors' does not exist in Viewpoint Vista.\n\nUse APVM (AP Vendor Master) for vendor information. Vista uses abbreviated table names.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM APVM WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get job cost variance by phase comparing budget to actual\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Job cost variance by phase:\n1. Join JCJM (Job Master) to JCCP (Cost Phase)\n2. Calculate variance as CurrEstCost - ActualCost\n3. Calculate percent complete from actuals vs budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  JCCP.Phase,\n  JCCP.CostType,\n  JCCP.OrigEstCost AS OriginalBudget,\n  JCCP.CurrEstCost AS CurrentBudget,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS Variance,\n  CASE WHEN JCCP.CurrEstCost <> 0 \n       THEN (JCCP.ActualCost / JCCP.CurrEstCost) * 100 \n       ELSE 0 END AS PercentComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.Job = @Job\nORDER BY JCCP.Phase, JCCP.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging buckets (30/60/90+ days) for unpaid invoices by customer\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Use ARTH for transaction data and ARCM for customer names\n2. Filter PayFullDate IS NULL to get only unpaid invoices\n3. Use DATEDIFF and CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: What is the schema for Jobs?\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'Jobs' does not exist in Viewpoint Vista.\n\nUse JCJM (JC Job Master) for job/project information.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM JCJM WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from SLWI\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from SLWI ().\n\n```sql\nSELECT *\nFROM SLWI WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLWI"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to count records in apth by company\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count APTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM APTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "APTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find jobs over budget with remaining cost projection\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Find jobs over budget:\n1. Aggregate JCCP by job from JCJM\n2. Compare total ActualCost to CurrEstCost\n3. Use HAVING to filter only over-budget jobs\n4. Sort by amount over budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description,\n  SUM(JCCP.CurrEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.CurrEstCost) - SUM(JCCP.ActualCost) AS RemainingBudget,\n  CASE WHEN SUM(JCCP.CurrEstCost) < SUM(JCCP.ActualCost) \n       THEN 'OVER BUDGET' ELSE 'OK' END AS Status\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\nGROUP BY JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.CurrEstCost)\nORDER BY (SUM(JCCP.ActualCost) - SUM(JCCP.CurrEstCost)) DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCJM",
        "JCCD",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from ARTH\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from ARTH ().\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from ARTH\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from ARTH ().\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find jobs over budget with remaining cost projection\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Find jobs over budget:\n1. Aggregate JCCP by job from JCJM\n2. Compare total ActualCost to CurrEstCost\n3. Use HAVING to filter only over-budget jobs\n4. Sort by amount over budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description,\n  SUM(JCCP.CurrEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.CurrEstCost) - SUM(JCCP.ActualCost) AS RemainingBudget,\n  CASE WHEN SUM(JCCP.CurrEstCost) < SUM(JCCP.ActualCost) \n       THEN 'OVER BUDGET' ELSE 'OK' END AS Status\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\nGROUP BY JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.CurrEstCost)\nORDER BY (SUM(JCCP.ActualCost) - SUM(JCCP.CurrEstCost)) DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCJM",
        "JCCD",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging with customer contact information\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I can partially answer this query, but the schema is incomplete.\n\nThe query requires ARCM (AR Customer Master) for customer details, but only ARTH is provided in the schema.\n\nHere's what I can provide with the available schema:\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n-- Note: Additional joins for ARCM would be needed for complete results\n```\n\nTo get the complete data you requested, please provide the DDL for ARCM.",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate stored materials (Purchased - Installed) for SL billing\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Stored materials for SL billing:\n1. SLWI contains work item/billing details\n2. StoredMatls = Purchased - Installed (materials on-site but not yet used)\n3. WCCost = Work Completed Cost\n4. WCRetAmt and SMRetAmt = separate retainage for work vs materials\n5. Total billable = WCCost + StoredMatls\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description AS ItemDescription,\n  SLWI.StoredMatls,\n  SLWI.WCCost AS WorkCompletedCost,\n  SLWI.StoredMatls + SLWI.WCCost AS TotalBillable,\n  SLWI.WCRetAmt AS WorkRetainage,\n  SLWI.SMRetAmt AS MaterialsRetainage,\n  SLWI.WCRetAmt + SLWI.SMRetAmt AS TotalRetainage\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\n  AND SLWI.StoredMatls <> 0\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from SLHD\n\nDatabase Schema:\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from SLHD ().\n\n```sql\nSELECT *\nFROM SLHD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "SLHD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging buckets (30/60/90+ days) for unpaid invoices by customer\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Use ARTH for transaction data and ARCM for customer names\n2. Filter PayFullDate IS NULL to get only unpaid invoices\n3. Use DATEDIFF and CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: track ap hold status distinguishing retainage vs non-retainage holds\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APCO (\n  APCo bcompany NOT NULL,\n  GLCo bcompany NOT NULL,\n  ExpJrnl bjrnl,\n  GLExpInterfaceLvl tinyint NOT NULL,\n  GLExpSummaryDesc varchar(60),\n  GLExpTransDesc varchar(60),\n  GLJobDetailDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLEquipDetailDesc varchar(60),\n  GLExpDetailDesc varchar(60),\n  PayJrnl bjrnl,\n  GLPayInterfaceLvl tinyint NOT NULL,\n  GLPayDetailDesc varchar(60),\n  GLPaySummaryDesc varchar(60),\n  DiscOffGLAcct bglacct,\n  DiscTakenGLAcct bglacct,\n  ExpPayType tinyint,\n  JobPayType tinyint,\n  SubPayType tinyint,\n  RetPayType tinyint,\n  -- ... 92 more columns,\n  PRIMARY KEY (APCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To distinguish retainage vs non-retainage holds:\n1. Join APTD to APHD for hold details\n2. Join APCO to get RetHoldCode setting\n3. Compare APHD.HoldCode to APCO.RetHoldCode\n4. If equal, it's a retainage hold; otherwise non-retainage\n\n```sql\nSELECT \n  APTD.APCo,\n  APTD.Vendor,\n  APTD.Mth,\n  APTD.APTrans,\n  APHD.HoldCode,\n  CASE WHEN APHD.HoldCode = APCO.RetHoldCode \n       THEN 'Retainage Hold' \n       ELSE 'Non-Retainage Hold' END AS HoldType,\n  APTD.Amount\nFROM APTD WITH (NOLOCK)\nINNER JOIN APHD WITH (NOLOCK) ON APTD.APCo = APHD.APCo \n  AND APTD.Mth = APHD.Mth \n  AND APTD.APTrans = APHD.APTrans \n  AND APTD.APLine = APHD.APLine\nINNER JOIN APCO WITH (NOLOCK) ON APTD.APCo = APCO.APCo\nWHERE APTD.APCo = @APCo\n  AND APHD.HoldCode IS NOT NULL\nORDER BY APTD.Vendor, APTD.Mth\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "basic",
      "tables_used": [
        "APTD",
        "APHD",
        "APCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from SLWI\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from SLWI ().\n\n```sql\nSELECT *\nFROM SLWI WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "SLWI"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query to aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from GLCO\n\nDatabase Schema:\nCREATE TABLE GLCO (\n  GLCo bcompany NOT NULL,\n  Consolid byn NOT NULL,\n  LastMthSubClsd bmonth NOT NULL,\n  LastMthGLClsd bmonth NOT NULL,\n  MaxOpen tinyint NOT NULL,\n  CashAccrual char(1) NOT NULL,\n  Unbal byn NOT NULL,\n  AuditCoParams byn NOT NULL,\n  AuditAccts byn NOT NULL,\n  AuditAutoJrnl byn NOT NULL,\n  AuditBals byn NOT NULL,\n  AuditBudgets byn NOT NULL,\n  AuditDetail byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  XCompJrnlEntryYN byn NOT NULL,\n  KeyID bigint NOT NULL,\n  LastMthAPClsd bmonth NOT NULL,\n  LastMthARClsd bmonth NOT NULL,\n  AttachBatchReportsYN byn NOT NULL,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from GLCO ().\n\n```sql\nSELECT *\nFROM GLCO WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "GLCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from JCCD\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from JCCD ().\n\n```sql\nSELECT *\nFROM JCCD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get data from GLDT for analysis\n\nDatabase Schema:\nCREATE TABLE PREH (\n  PRCo bcompany NOT NULL,\n  Employee bemployee NOT NULL,\n  LastName varchar(30) NOT NULL,\n  FirstName varchar(30),\n  MidName varchar(15),\n  SortName bsortname NOT NULL,\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  Phone bphone,\n  SSN char(11) NOT NULL,\n  Race char(2) NOT NULL,\n  Sex char(1) NOT NULL,\n  BirthDate smalldatetime,\n  HireDate bdate,\n  TermDate bdate,\n  PRGroup bgroup NOT NULL,\n  PRDept bdept NOT NULL,\n  -- ... 121 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nCREATE TABLE PRTH (\n  PRCo bcompany NOT NULL,\n  PRGroup bgroup NOT NULL,\n  PREndDate bdate NOT NULL,\n  Employee bemployee NOT NULL,\n  PaySeq tinyint NOT NULL,\n  PostSeq smallint NOT NULL,\n  Type char(1) NOT NULL,\n  PostDate bdate NOT NULL,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCDept bdept,\n  GLCo bcompany NOT NULL,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equipment bequip,\n  EMGroup tinyint,\n  CostCode bcostcode,\n  -- ... 41 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'GLDT' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nPREH, PRTH\n\nTo include GLDT in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from Locations\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'Locations' does not exist in Viewpoint Vista.\n\nUse HQLC (HQ Location) for location information.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM HQLC WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get job cost variance by phase comparing budget to actual\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Job cost variance by phase:\n1. Join JCJM (Job Master) to JCCP (Cost Phase)\n2. Calculate variance as CurrEstCost - ActualCost\n3. Calculate percent complete from actuals vs budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  JCCP.Phase,\n  JCCP.CostType,\n  JCCP.OrigEstCost AS OriginalBudget,\n  JCCP.CurrEstCost AS CurrentBudget,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS Variance,\n  CASE WHEN JCCP.CurrEstCost <> 0 \n       THEN (JCCP.ActualCost / JCCP.CurrEstCost) * 100 \n       ELSE 0 END AS PercentComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.Job = @Job\nORDER BY JCCP.Phase, JCCP.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: count records in prth by company\n\nDatabase Schema:\nCREATE TABLE PRTH (\n  PRCo bcompany NOT NULL,\n  PRGroup bgroup NOT NULL,\n  PREndDate bdate NOT NULL,\n  Employee bemployee NOT NULL,\n  PaySeq tinyint NOT NULL,\n  PostSeq smallint NOT NULL,\n  Type char(1) NOT NULL,\n  PostDate bdate NOT NULL,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCDept bdept,\n  GLCo bcompany NOT NULL,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equipment bequip,\n  EMGroup tinyint,\n  CostCode bcostcode,\n  -- ... 41 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count PRTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM PRTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "PRTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from APTH\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from APTH ().\n\n```sql\nSELECT *\nFROM APTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "APTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find jobs over budget with remaining cost projection\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Find jobs over budget:\n1. Aggregate JCCP by job from JCJM\n2. Compare total ActualCost to CurrEstCost\n3. Use HAVING to filter only over-budget jobs\n4. Sort by amount over budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description,\n  SUM(JCCP.CurrEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.CurrEstCost) - SUM(JCCP.ActualCost) AS RemainingBudget,\n  CASE WHEN SUM(JCCP.CurrEstCost) < SUM(JCCP.ActualCost) \n       THEN 'OVER BUDGET' ELSE 'OK' END AS Status\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\nGROUP BY JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.CurrEstCost)\nORDER BY (SUM(JCCP.ActualCost) - SUM(JCCP.CurrEstCost)) DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCJM",
        "JCCD",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How do I count records in gldt by company\n\nDatabase Schema:\nCREATE TABLE GLDT (\n  GLCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  GLTrans btrans NOT NULL,\n  GLAcct bglacct NOT NULL,\n  Jrnl bjrnl NOT NULL,\n  GLRef bglref NOT NULL,\n  SourceCo bcompany NOT NULL,\n  Source bsource NOT NULL,\n  ActDate bdate NOT NULL,\n  DatePosted bdate NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid NOT NULL,\n  Amount bdollar NOT NULL,\n  RevStatus tinyint NOT NULL,\n  Adjust char(1) NOT NULL,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  UniqueAttchID uniqueidentifier,\n  SrcTable varchar(128),\n  SrcKeyID bigint,\n  PRIMARY KEY (GLCo, Mth, GLTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count GLDT records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM GLDT WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "GLDT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate stored materials (Purchased - Installed) for SL billing\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Stored materials for SL billing:\n1. SLWI contains work item/billing details\n2. StoredMatls = Purchased - Installed (materials on-site but not yet used)\n3. WCCost = Work Completed Cost\n4. WCRetAmt and SMRetAmt = separate retainage for work vs materials\n5. Total billable = WCCost + StoredMatls\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description AS ItemDescription,\n  SLWI.StoredMatls,\n  SLWI.WCCost AS WorkCompletedCost,\n  SLWI.StoredMatls + SLWI.WCCost AS TotalBillable,\n  SLWI.WCRetAmt AS WorkRetainage,\n  SLWI.SMRetAmt AS MaterialsRetainage,\n  SLWI.WCRetAmt + SLWI.SMRetAmt AS TotalRetainage\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\n  AND SLWI.StoredMatls <> 0\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "intermediate",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from JCCD\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from JCCD ().\n\n```sql\nSELECT *\nFROM JCCD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get subcontractor costs with original, change orders, invoiced, paid, and retainage by vendor\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Subcontractor cost breakdown by vendor:\n1. Join SLHD (Header) to SLIT (Items) for subcontract details\n2. Join APVM for vendor names\n3. OrigCost = original contract amount\n4. CurCost - OrigCost = change order amounts\n5. InvCost = amounts invoiced\n6. Retainage = amounts held back\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  SLHD.SL AS SubcontractNum,\n  SLHD.Description AS SubcontractDesc,\n  SUM(SLIT.OrigCost) AS OriginalCost,\n  SUM(SLIT.CurCost - SLIT.OrigCost) AS ChangeOrderCost,\n  SUM(SLIT.CurCost) AS CurrentCost,\n  SUM(SLIT.InvCost) AS InvoicedCost,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost - SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nINNER JOIN APVM WITH (NOLOCK) ON SLHD.VendorGroup = APVM.VendorGroup AND SLHD.Vendor = APVM.Vendor\nWHERE SLHD.SLCo = @SLCo\nGROUP BY APVM.Vendor, APVM.Name, SLHD.SL, SLHD.Description\nORDER BY APVM.Name, SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "basic",
      "tables_used": [
        "SLHD",
        "SLIT",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get job cost variance by phase comparing budget to actual\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Job cost variance by phase:\n1. Join JCJM (Job Master) to JCCP (Cost Phase)\n2. Calculate variance as CurrEstCost - ActualCost\n3. Calculate percent complete from actuals vs budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  JCCP.Phase,\n  JCCP.CostType,\n  JCCP.OrigEstCost AS OriginalBudget,\n  JCCP.CurrEstCost AS CurrentBudget,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS Variance,\n  CASE WHEN JCCP.CurrEstCost <> 0 \n       THEN (JCCP.ActualCost / JCCP.CurrEstCost) * 100 \n       ELSE 0 END AS PercentComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.Job = @Job\nORDER BY JCCP.Phase, JCCP.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need to count records in prtd by company\n\nDatabase Schema:\nCREATE TABLE PRTD (\n  PRCo bcompany NOT NULL,\n  Craft bcraft NOT NULL,\n  Class bclass NOT NULL,\n  Template smallint NOT NULL,\n  DLCode bedlcode NOT NULL,\n  Factor brate NOT NULL,\n  OldRate bunitcost NOT NULL,\n  NewRate bunitcost NOT NULL,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count PRTD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM PRTD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "PRTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate stored materials (Purchased - Installed) for SL billing\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Stored materials for SL billing:\n1. SLWI contains work item/billing details\n2. StoredMatls = Purchased - Installed (materials on-site but not yet used)\n3. WCCost = Work Completed Cost\n4. WCRetAmt and SMRetAmt = separate retainage for work vs materials\n5. Total billable = WCCost + StoredMatls\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description AS ItemDescription,\n  SLWI.StoredMatls,\n  SLWI.WCCost AS WorkCompletedCost,\n  SLWI.StoredMatls + SLWI.WCCost AS TotalBillable,\n  SLWI.WCRetAmt AS WorkRetainage,\n  SLWI.SMRetAmt AS MaterialsRetainage,\n  SLWI.WCRetAmt + SLWI.SMRetAmt AS TotalRetainage\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\n  AND SLWI.StoredMatls <> 0\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "basic",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find jobs over budget with remaining cost projection\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Find jobs over budget:\n1. Aggregate JCCP by job from JCJM\n2. Compare total ActualCost to CurrEstCost\n3. Use HAVING to filter only over-budget jobs\n4. Sort by amount over budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description,\n  SUM(JCCP.CurrEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.CurrEstCost) - SUM(JCCP.ActualCost) AS RemainingBudget,\n  CASE WHEN SUM(JCCP.CurrEstCost) < SUM(JCCP.ActualCost) \n       THEN 'OVER BUDGET' ELSE 'OK' END AS Status\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\nGROUP BY JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.CurrEstCost)\nORDER BY (SUM(JCCP.ActualCost) - SUM(JCCP.CurrEstCost)) DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM",
        "JCCD",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to count records in prpc by company\n\nDatabase Schema:\nCREATE TABLE PRPC (\n  PRCo bcompany NOT NULL,\n  PRGroup bgroup NOT NULL,\n  PREndDate bdate NOT NULL,\n  BeginDate bdate NOT NULL,\n  MultiMth byn NOT NULL,\n  BeginMth bmonth NOT NULL,\n  EndMth bmonth,\n  CutoffDate bdate,\n  LimitMth bmonth NOT NULL,\n  Hrs smallint NOT NULL,\n  Days tinyint NOT NULL,\n  Wks tinyint NOT NULL,\n  Status tinyint NOT NULL,\n  DateClosed smalldatetime,\n  JCInterface byn NOT NULL,\n  EMInterface byn NOT NULL,\n  GLInterface byn NOT NULL,\n  APInterface byn NOT NULL,\n  LeaveProcess byn NOT NULL,\n  InUseBy bvpusername,\n  -- ... 7 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count PRPC records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM PRPC WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "PRPC"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query to reconcile ap oncost batch lines with original transactions\n\nDatabase Schema:\nCREATE TABLE APTL (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equip bequip,\n  EMGroup bgroup,\n  -- ... 56 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans, APLine)\n);\n\nCREATE TABLE APLB (\n  Co bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  BatchId bbatchid NOT NULL,\n  BatchSeq int NOT NULL,\n  APLine smallint NOT NULL,\n  BatchTransType char(1) NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  -- ... 120 more columns,\n  PRIMARY KEY (Co, Mth, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APHB (\n  Co bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  BatchId bbatchid NOT NULL,\n  BatchSeq int NOT NULL,\n  BatchTransType char(1) NOT NULL,\n  APTrans btrans,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  -- ... 88 more columns,\n  PRIMARY KEY (Co, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To reconcile AP oncost batches with original transactions:\n1. Join APLB (batch lines) to APTL (original lines) using ocApplyMth, ocApplyTrans, ocApplyLine\n2. Include APHB for batch header info\n3. Join to APTH and APVM for vendor context\n4. Compare batch vs original amounts\n\n```sql\nSELECT \n  APLB.Co AS BatchCo,\n  APLB.Mth AS BatchMth,\n  APLB.BatchId,\n  APLB.BatchSeq,\n  APLB.ocApplyMth,\n  APLB.ocApplyTrans,\n  APLB.ocApplyLine,\n  APTL.APCo AS OrigCo,\n  APTL.Mth AS OrigMth,\n  APTL.APTrans AS OrigTrans,\n  APTL.APLine AS OrigLine,\n  APTL.GrossAmt AS OrigAmount,\n  APLB.GrossAmt AS BatchAmount,\n  APVM.Name AS VendorName\nFROM APLB WITH (NOLOCK)\nINNER JOIN APHB WITH (NOLOCK) ON APLB.Co = APHB.Co AND APLB.Mth = APHB.Mth AND APLB.BatchId = APHB.BatchId\nINNER JOIN APTL WITH (NOLOCK) ON APLB.ocApplyMth = APTL.Mth \n  AND APLB.ocApplyTrans = APTL.APTrans \n  AND APLB.ocApplyLine = APTL.APLine\n  AND APLB.Co = APTL.APCo\nINNER JOIN APTH WITH (NOLOCK) ON APTL.APCo = APTH.APCo AND APTL.Mth = APTH.Mth AND APTL.APTrans = APTH.APTrans\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APLB.Co = @Co\nORDER BY APLB.BatchId, APLB.BatchSeq\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APLB",
        "APHB",
        "APTL",
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query to aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How do I count records in arth by company\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count ARTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM ARTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query to aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need to count records in slwi by company\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count SLWI records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM SLWI WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLWI"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get subcontractor costs with original, change orders, invoiced, paid, and retainage by vendor\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Subcontractor cost breakdown by vendor:\n1. Join SLHD (Header) to SLIT (Items) for subcontract details\n2. Join APVM for vendor names\n3. OrigCost = original contract amount\n4. CurCost - OrigCost = change order amounts\n5. InvCost = amounts invoiced\n6. Retainage = amounts held back\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  SLHD.SL AS SubcontractNum,\n  SLHD.Description AS SubcontractDesc,\n  SUM(SLIT.OrigCost) AS OriginalCost,\n  SUM(SLIT.CurCost - SLIT.OrigCost) AS ChangeOrderCost,\n  SUM(SLIT.CurCost) AS CurrentCost,\n  SUM(SLIT.InvCost) AS InvoicedCost,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost - SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nINNER JOIN APVM WITH (NOLOCK) ON SLHD.VendorGroup = APVM.VendorGroup AND SLHD.Vendor = APVM.Vendor\nWHERE SLHD.SLCo = @SLCo\nGROUP BY APVM.Vendor, APVM.Name, SLHD.SL, SLHD.Description\nORDER BY APVM.Name, SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "basic",
      "tables_used": [
        "SLHD",
        "SLIT",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from GLJR\n\nDatabase Schema:\nCREATE TABLE GLJR (\n  GLCo bcompany NOT NULL,\n  Jrnl bjrnl NOT NULL,\n  Description btransdesc,\n  Rev byn NOT NULL,\n  RevJrnl bjrnl,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from GLJR ().\n\n```sql\nSELECT *\nFROM GLJR WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "GLJR"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query to aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from PRPC\n\nDatabase Schema:\nCREATE TABLE PRPC (\n  PRCo bcompany NOT NULL,\n  PRGroup bgroup NOT NULL,\n  PREndDate bdate NOT NULL,\n  BeginDate bdate NOT NULL,\n  MultiMth byn NOT NULL,\n  BeginMth bmonth NOT NULL,\n  EndMth bmonth,\n  CutoffDate bdate,\n  LimitMth bmonth NOT NULL,\n  Hrs smallint NOT NULL,\n  Days tinyint NOT NULL,\n  Wks tinyint NOT NULL,\n  Status tinyint NOT NULL,\n  DateClosed smalldatetime,\n  JCInterface byn NOT NULL,\n  EMInterface byn NOT NULL,\n  GLInterface byn NOT NULL,\n  APInterface byn NOT NULL,\n  LeaveProcess byn NOT NULL,\n  InUseBy bvpusername,\n  -- ... 7 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from PRPC ().\n\n```sql\nSELECT *\nFROM PRPC WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "PRPC"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from PRTH\n\nDatabase Schema:\nCREATE TABLE PRTH (\n  PRCo bcompany NOT NULL,\n  PRGroup bgroup NOT NULL,\n  PREndDate bdate NOT NULL,\n  Employee bemployee NOT NULL,\n  PaySeq tinyint NOT NULL,\n  PostSeq smallint NOT NULL,\n  Type char(1) NOT NULL,\n  PostDate bdate NOT NULL,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCDept bdept,\n  GLCo bcompany NOT NULL,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equipment bequip,\n  EMGroup tinyint,\n  CostCode bcostcode,\n  -- ... 41 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from PRTH ().\n\n```sql\nSELECT *\nFROM PRTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "PRTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get job cost variance by phase comparing budget to actual\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Job cost variance by phase:\n1. Join JCJM (Job Master) to JCCP (Cost Phase)\n2. Calculate variance as CurrEstCost - ActualCost\n3. Calculate percent complete from actuals vs budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  JCCP.Phase,\n  JCCP.CostType,\n  JCCP.OrigEstCost AS OriginalBudget,\n  JCCP.CurrEstCost AS CurrentBudget,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS Variance,\n  CASE WHEN JCCP.CurrEstCost <> 0 \n       THEN (JCCP.ActualCost / JCCP.CurrEstCost) * 100 \n       ELSE 0 END AS PercentComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.Job = @Job\nORDER BY JCCP.Phase, JCCP.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Describe the Employees table\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'Employees' does not exist in Viewpoint Vista.\n\nUse PREH (PR Employee Header) for employee information.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM PREH WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging buckets (30/60/90+ days) for unpaid invoices by customer\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Use ARTH for transaction data and ARCM for customer names\n2. Filter PayFullDate IS NULL to get only unpaid invoices\n3. Use DATEDIFF and CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate stored materials (Purchased - Installed) for SL billing\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Stored materials for SL billing:\n1. SLWI contains work item/billing details\n2. StoredMatls = Purchased - Installed (materials on-site but not yet used)\n3. WCCost = Work Completed Cost\n4. WCRetAmt and SMRetAmt = separate retainage for work vs materials\n5. Total billable = WCCost + StoredMatls\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description AS ItemDescription,\n  SLWI.StoredMatls,\n  SLWI.WCCost AS WorkCompletedCost,\n  SLWI.StoredMatls + SLWI.WCCost AS TotalBillable,\n  SLWI.WCRetAmt AS WorkRetainage,\n  SLWI.SMRetAmt AS MaterialsRetainage,\n  SLWI.WCRetAmt + SLWI.SMRetAmt AS TotalRetainage\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\n  AND SLWI.StoredMatls <> 0\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "basic",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need to count records in gldt by company\n\nDatabase Schema:\nCREATE TABLE GLDT (\n  GLCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  GLTrans btrans NOT NULL,\n  GLAcct bglacct NOT NULL,\n  Jrnl bjrnl NOT NULL,\n  GLRef bglref NOT NULL,\n  SourceCo bcompany NOT NULL,\n  Source bsource NOT NULL,\n  ActDate bdate NOT NULL,\n  DatePosted bdate NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid NOT NULL,\n  Amount bdollar NOT NULL,\n  RevStatus tinyint NOT NULL,\n  Adjust char(1) NOT NULL,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  UniqueAttchID uniqueidentifier,\n  SrcTable varchar(128),\n  SrcKeyID bigint,\n  PRIMARY KEY (GLCo, Mth, GLTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count GLDT records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM GLDT WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "GLDT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging buckets (30/60/90+ days) for unpaid invoices by customer\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Use ARTH for transaction data and ARCM for customer names\n2. Filter PayFullDate IS NULL to get only unpaid invoices\n3. Use DATEDIFF and CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from APTD\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from APTD ().\n\n```sql\nSELECT *\nFROM APTD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from ARTH\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from ARTH ().\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from SLWI\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from SLWI ().\n\n```sql\nSELECT *\nFROM SLWI WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLWI"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Include SLHD in the query\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'SLHD' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nJCJM, JCCD\n\nTo include SLHD in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How do I count records in arth by company\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count ARTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM ARTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging buckets (30/60/90+ days) for unpaid invoices by customer\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Use ARTH for transaction data and ARCM for customer names\n2. Filter PayFullDate IS NULL to get only unpaid invoices\n3. Use DATEDIFF and CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from GLDT\n\nDatabase Schema:\nCREATE TABLE GLDT (\n  GLCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  GLTrans btrans NOT NULL,\n  GLAcct bglacct NOT NULL,\n  Jrnl bjrnl NOT NULL,\n  GLRef bglref NOT NULL,\n  SourceCo bcompany NOT NULL,\n  Source bsource NOT NULL,\n  ActDate bdate NOT NULL,\n  DatePosted bdate NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid NOT NULL,\n  Amount bdollar NOT NULL,\n  RevStatus tinyint NOT NULL,\n  Adjust char(1) NOT NULL,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  UniqueAttchID uniqueidentifier,\n  SrcTable varchar(128),\n  SrcKeyID bigint,\n  PRIMARY KEY (GLCo, Mth, GLTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from GLDT ().\n\n```sql\nSELECT *\nFROM GLDT WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "GLDT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to count records in glco by company\n\nDatabase Schema:\nCREATE TABLE GLCO (\n  GLCo bcompany NOT NULL,\n  Consolid byn NOT NULL,\n  LastMthSubClsd bmonth NOT NULL,\n  LastMthGLClsd bmonth NOT NULL,\n  MaxOpen tinyint NOT NULL,\n  CashAccrual char(1) NOT NULL,\n  Unbal byn NOT NULL,\n  AuditCoParams byn NOT NULL,\n  AuditAccts byn NOT NULL,\n  AuditAutoJrnl byn NOT NULL,\n  AuditBals byn NOT NULL,\n  AuditBudgets byn NOT NULL,\n  AuditDetail byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  XCompJrnlEntryYN byn NOT NULL,\n  KeyID bigint NOT NULL,\n  LastMthAPClsd bmonth NOT NULL,\n  LastMthARClsd bmonth NOT NULL,\n  AttachBatchReportsYN byn NOT NULL,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count GLCO records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM GLCO WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "GLCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How do I aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query to count records in gljr by company\n\nDatabase Schema:\nCREATE TABLE GLJR (\n  GLCo bcompany NOT NULL,\n  Jrnl bjrnl NOT NULL,\n  Description btransdesc,\n  Rev byn NOT NULL,\n  RevJrnl bjrnl,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count GLJR records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM GLJR WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "GLJR"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from JCCD\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from JCCD ().\n\n```sql\nSELECT *\nFROM JCCD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get job cost variance by phase comparing budget to actual\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Job cost variance by phase:\n1. Join JCJM (Job Master) to JCCP (Cost Phase)\n2. Calculate variance as CurrEstCost - ActualCost\n3. Calculate percent complete from actuals vs budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  JCCP.Phase,\n  JCCP.CostType,\n  JCCP.OrigEstCost AS OriginalBudget,\n  JCCP.CurrEstCost AS CurrentBudget,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS Variance,\n  CASE WHEN JCCP.CurrEstCost <> 0 \n       THEN (JCCP.ActualCost / JCCP.CurrEstCost) * 100 \n       ELSE 0 END AS PercentComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.Job = @Job\nORDER BY JCCP.Phase, JCCP.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get subcontractor costs with original, change orders, invoiced, paid, and retainage by vendor\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Subcontractor cost breakdown by vendor:\n1. Join SLHD (Header) to SLIT (Items) for subcontract details\n2. Join APVM for vendor names\n3. OrigCost = original contract amount\n4. CurCost - OrigCost = change order amounts\n5. InvCost = amounts invoiced\n6. Retainage = amounts held back\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  SLHD.SL AS SubcontractNum,\n  SLHD.Description AS SubcontractDesc,\n  SUM(SLIT.OrigCost) AS OriginalCost,\n  SUM(SLIT.CurCost - SLIT.OrigCost) AS ChangeOrderCost,\n  SUM(SLIT.CurCost) AS CurrentCost,\n  SUM(SLIT.InvCost) AS InvoicedCost,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost - SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nINNER JOIN APVM WITH (NOLOCK) ON SLHD.VendorGroup = APVM.VendorGroup AND SLHD.Vendor = APVM.Vendor\nWHERE SLHD.SLCo = @SLCo\nGROUP BY APVM.Vendor, APVM.Name, SLHD.SL, SLHD.Description\nORDER BY APVM.Name, SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "basic",
      "tables_used": [
        "SLHD",
        "SLIT",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find jobs over budget with remaining cost projection\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Find jobs over budget:\n1. Aggregate JCCP by job from JCJM\n2. Compare total ActualCost to CurrEstCost\n3. Use HAVING to filter only over-budget jobs\n4. Sort by amount over budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description,\n  SUM(JCCP.CurrEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.CurrEstCost) - SUM(JCCP.ActualCost) AS RemainingBudget,\n  CASE WHEN SUM(JCCP.CurrEstCost) < SUM(JCCP.ActualCost) \n       THEN 'OVER BUDGET' ELSE 'OK' END AS Status\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\nGROUP BY JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.CurrEstCost)\nORDER BY (SUM(JCCP.ActualCost) - SUM(JCCP.CurrEstCost)) DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCJM",
        "JCCD",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from ARTH\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from ARTH ().\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoice totals with discounts and retainage\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Vendor invoice summary with discounts and retainage:\n1. Join APTH to APVM for vendor details\n2. Aggregate by vendor\n3. Include GrossAmt, DiscOffer, Retainage, and Balance\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(APTH.APTrans) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS GrossAmount,\n  SUM(APTH.DiscOffer) AS DiscountsOffered,\n  SUM(APTH.Retainage) AS RetainageHeld,\n  SUM(APTH.Balance) AS OpenBalance\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get data from ARCM for analysis\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'ARCM' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nAPTH, APVM\n\nTo include ARCM in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from ARTH\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from ARTH ().\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query to count records in arth by company\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count ARTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM ARTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: track ap hold status distinguishing retainage vs non-retainage holds\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APCO (\n  APCo bcompany NOT NULL,\n  GLCo bcompany NOT NULL,\n  ExpJrnl bjrnl,\n  GLExpInterfaceLvl tinyint NOT NULL,\n  GLExpSummaryDesc varchar(60),\n  GLExpTransDesc varchar(60),\n  GLJobDetailDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLEquipDetailDesc varchar(60),\n  GLExpDetailDesc varchar(60),\n  PayJrnl bjrnl,\n  GLPayInterfaceLvl tinyint NOT NULL,\n  GLPayDetailDesc varchar(60),\n  GLPaySummaryDesc varchar(60),\n  DiscOffGLAcct bglacct,\n  DiscTakenGLAcct bglacct,\n  ExpPayType tinyint,\n  JobPayType tinyint,\n  SubPayType tinyint,\n  RetPayType tinyint,\n  -- ... 92 more columns,\n  PRIMARY KEY (APCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To distinguish retainage vs non-retainage holds:\n1. Join APTD to APHD for hold details\n2. Join APCO to get RetHoldCode setting\n3. Compare APHD.HoldCode to APCO.RetHoldCode\n4. If equal, it's a retainage hold; otherwise non-retainage\n\n```sql\nSELECT \n  APTD.APCo,\n  APTD.Vendor,\n  APTD.Mth,\n  APTD.APTrans,\n  APHD.HoldCode,\n  CASE WHEN APHD.HoldCode = APCO.RetHoldCode \n       THEN 'Retainage Hold' \n       ELSE 'Non-Retainage Hold' END AS HoldType,\n  APTD.Amount\nFROM APTD WITH (NOLOCK)\nINNER JOIN APHD WITH (NOLOCK) ON APTD.APCo = APHD.APCo \n  AND APTD.Mth = APHD.Mth \n  AND APTD.APTrans = APHD.APTrans \n  AND APTD.APLine = APHD.APLine\nINNER JOIN APCO WITH (NOLOCK) ON APTD.APCo = APCO.APCo\nWHERE APTD.APCo = @APCo\n  AND APHD.HoldCode IS NOT NULL\nORDER BY APTD.Vendor, APTD.Mth\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTD",
        "APHD",
        "APCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find jobs over budget with remaining cost projection\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Find jobs over budget:\n1. Aggregate JCCP by job from JCJM\n2. Compare total ActualCost to CurrEstCost\n3. Use HAVING to filter only over-budget jobs\n4. Sort by amount over budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description,\n  SUM(JCCP.CurrEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.CurrEstCost) - SUM(JCCP.ActualCost) AS RemainingBudget,\n  CASE WHEN SUM(JCCP.CurrEstCost) < SUM(JCCP.ActualCost) \n       THEN 'OVER BUDGET' ELSE 'OK' END AS Status\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\nGROUP BY JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.CurrEstCost)\nORDER BY (SUM(JCCP.ActualCost) - SUM(JCCP.CurrEstCost)) DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM",
        "JCCD",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from JCCD\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from JCCD ().\n\n```sql\nSELECT *\nFROM JCCD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find jobs over budget with remaining cost projection\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Find jobs over budget:\n1. Aggregate JCCP by job from JCJM\n2. Compare total ActualCost to CurrEstCost\n3. Use HAVING to filter only over-budget jobs\n4. Sort by amount over budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description,\n  SUM(JCCP.CurrEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.CurrEstCost) - SUM(JCCP.ActualCost) AS RemainingBudget,\n  CASE WHEN SUM(JCCP.CurrEstCost) < SUM(JCCP.ActualCost) \n       THEN 'OVER BUDGET' ELSE 'OK' END AS Status\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\nGROUP BY JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.CurrEstCost)\nORDER BY (SUM(JCCP.ActualCost) - SUM(JCCP.CurrEstCost)) DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCJM",
        "JCCD",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from APTH\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from APTH ().\n\n```sql\nSELECT *\nFROM APTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to reconcile ap oncost batch lines with original transactions\n\nDatabase Schema:\nCREATE TABLE APTL (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equip bequip,\n  EMGroup bgroup,\n  -- ... 56 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans, APLine)\n);\n\nCREATE TABLE APLB (\n  Co bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  BatchId bbatchid NOT NULL,\n  BatchSeq int NOT NULL,\n  APLine smallint NOT NULL,\n  BatchTransType char(1) NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  -- ... 120 more columns,\n  PRIMARY KEY (Co, Mth, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APHB (\n  Co bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  BatchId bbatchid NOT NULL,\n  BatchSeq int NOT NULL,\n  BatchTransType char(1) NOT NULL,\n  APTrans btrans,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  -- ... 88 more columns,\n  PRIMARY KEY (Co, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To reconcile AP oncost batches with original transactions:\n1. Join APLB (batch lines) to APTL (original lines) using ocApplyMth, ocApplyTrans, ocApplyLine\n2. Include APHB for batch header info\n3. Join to APTH and APVM for vendor context\n4. Compare batch vs original amounts\n\n```sql\nSELECT \n  APLB.Co AS BatchCo,\n  APLB.Mth AS BatchMth,\n  APLB.BatchId,\n  APLB.BatchSeq,\n  APLB.ocApplyMth,\n  APLB.ocApplyTrans,\n  APLB.ocApplyLine,\n  APTL.APCo AS OrigCo,\n  APTL.Mth AS OrigMth,\n  APTL.APTrans AS OrigTrans,\n  APTL.APLine AS OrigLine,\n  APTL.GrossAmt AS OrigAmount,\n  APLB.GrossAmt AS BatchAmount,\n  APVM.Name AS VendorName\nFROM APLB WITH (NOLOCK)\nINNER JOIN APHB WITH (NOLOCK) ON APLB.Co = APHB.Co AND APLB.Mth = APHB.Mth AND APLB.BatchId = APHB.BatchId\nINNER JOIN APTL WITH (NOLOCK) ON APLB.ocApplyMth = APTL.Mth \n  AND APLB.ocApplyTrans = APTL.APTrans \n  AND APLB.ocApplyLine = APTL.APLine\n  AND APLB.Co = APTL.APCo\nINNER JOIN APTH WITH (NOLOCK) ON APTL.APCo = APTH.APCo AND APTL.Mth = APTH.Mth AND APTL.APTrans = APTH.APTrans\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APLB.Co = @Co\nORDER BY APLB.BatchId, APLB.BatchSeq\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APLB",
        "APHB",
        "APTL",
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get data from ARCM for analysis\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'ARCM' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nAPTH, APVM\n\nTo include ARCM in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How do I aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate stored materials (Purchased - Installed) for SL billing\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Stored materials for SL billing:\n1. SLWI contains work item/billing details\n2. StoredMatls = Purchased - Installed (materials on-site but not yet used)\n3. WCCost = Work Completed Cost\n4. WCRetAmt and SMRetAmt = separate retainage for work vs materials\n5. Total billable = WCCost + StoredMatls\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description AS ItemDescription,\n  SLWI.StoredMatls,\n  SLWI.WCCost AS WorkCompletedCost,\n  SLWI.StoredMatls + SLWI.WCCost AS TotalBillable,\n  SLWI.WCRetAmt AS WorkRetainage,\n  SLWI.SMRetAmt AS MaterialsRetainage,\n  SLWI.WCRetAmt + SLWI.SMRetAmt AS TotalRetainage\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\n  AND SLWI.StoredMatls <> 0\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "intermediate",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get job cost variance by phase comparing budget to actual\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Job cost variance by phase:\n1. Join JCJM (Job Master) to JCCP (Cost Phase)\n2. Calculate variance as CurrEstCost - ActualCost\n3. Calculate percent complete from actuals vs budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  JCCP.Phase,\n  JCCP.CostType,\n  JCCP.OrigEstCost AS OriginalBudget,\n  JCCP.CurrEstCost AS CurrentBudget,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS Variance,\n  CASE WHEN JCCP.CurrEstCost <> 0 \n       THEN (JCCP.ActualCost / JCCP.CurrEstCost) * 100 \n       ELSE 0 END AS PercentComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.Job = @Job\nORDER BY JCCP.Phase, JCCP.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to count records in prpc by company\n\nDatabase Schema:\nCREATE TABLE PRPC (\n  PRCo bcompany NOT NULL,\n  PRGroup bgroup NOT NULL,\n  PREndDate bdate NOT NULL,\n  BeginDate bdate NOT NULL,\n  MultiMth byn NOT NULL,\n  BeginMth bmonth NOT NULL,\n  EndMth bmonth,\n  CutoffDate bdate,\n  LimitMth bmonth NOT NULL,\n  Hrs smallint NOT NULL,\n  Days tinyint NOT NULL,\n  Wks tinyint NOT NULL,\n  Status tinyint NOT NULL,\n  DateClosed smalldatetime,\n  JCInterface byn NOT NULL,\n  EMInterface byn NOT NULL,\n  GLInterface byn NOT NULL,\n  APInterface byn NOT NULL,\n  LeaveProcess byn NOT NULL,\n  InUseBy bvpusername,\n  -- ... 7 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count PRPC records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM PRPC WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "PRPC"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find all unpaid AR invoices older than 60 days\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find unpaid invoices over 60 days:\n1. Join ARTH to ARCM for customer information\n2. Filter PayFullDate IS NULL (unpaid)\n3. Use DATEDIFF to calculate age and filter > 60 days\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Mth,\n  ARTH.ARTrans,\n  ARCM.Name AS CustomerName,\n  ARTH.TransDate,\n  ARTH.Amount,\n  DATEDIFF(day, ARTH.TransDate, GETDATE()) AS DaysOutstanding\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\n  AND DATEDIFF(day, ARTH.TransDate, GETDATE()) > 60\nORDER BY ARTH.TransDate\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from SLWI\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from SLWI ().\n\n```sql\nSELECT *\nFROM SLWI WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "SLWI"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find jobs over budget with remaining cost projection\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Find jobs over budget:\n1. Aggregate JCCP by job from JCJM\n2. Compare total ActualCost to CurrEstCost\n3. Use HAVING to filter only over-budget jobs\n4. Sort by amount over budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description,\n  SUM(JCCP.CurrEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.CurrEstCost) - SUM(JCCP.ActualCost) AS RemainingBudget,\n  CASE WHEN SUM(JCCP.CurrEstCost) < SUM(JCCP.ActualCost) \n       THEN 'OVER BUDGET' ELSE 'OK' END AS Status\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\nGROUP BY JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.CurrEstCost)\nORDER BY (SUM(JCCP.ActualCost) - SUM(JCCP.CurrEstCost)) DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCJM",
        "JCCD",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from PRTD\n\nDatabase Schema:\nCREATE TABLE PRTD (\n  PRCo bcompany NOT NULL,\n  Craft bcraft NOT NULL,\n  Class bclass NOT NULL,\n  Template smallint NOT NULL,\n  DLCode bedlcode NOT NULL,\n  Factor brate NOT NULL,\n  OldRate bunitcost NOT NULL,\n  NewRate bunitcost NOT NULL,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from PRTD ().\n\n```sql\nSELECT *\nFROM PRTD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "PRTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from ARTH\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from ARTH ().\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate stored materials (Purchased - Installed) for SL billing\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Stored materials for SL billing:\n1. SLWI contains work item/billing details\n2. StoredMatls = Purchased - Installed (materials on-site but not yet used)\n3. WCCost = Work Completed Cost\n4. WCRetAmt and SMRetAmt = separate retainage for work vs materials\n5. Total billable = WCCost + StoredMatls\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description AS ItemDescription,\n  SLWI.StoredMatls,\n  SLWI.WCCost AS WorkCompletedCost,\n  SLWI.StoredMatls + SLWI.WCCost AS TotalBillable,\n  SLWI.WCRetAmt AS WorkRetainage,\n  SLWI.SMRetAmt AS MaterialsRetainage,\n  SLWI.WCRetAmt + SLWI.SMRetAmt AS TotalRetainage\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\n  AND SLWI.StoredMatls <> 0\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get customer balance summary by customer group\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Customer balance summary by group:\n1. Join ARTH to ARCM for customer details\n2. Use conditional SUM for open vs total balances\n3. Group by CustGroup for summary\n\n```sql\nSELECT \n  ARTH.CustGroup,\n  COUNT(DISTINCT ARTH.Customer) AS CustomerCount,\n  SUM(CASE WHEN ARTH.PayFullDate IS NULL THEN ARTH.Amount ELSE 0 END) AS OpenBalance,\n  SUM(ARTH.Amount) AS TotalBilled\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\nGROUP BY ARTH.CustGroup\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get job cost variance by phase comparing budget to actual\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Job cost variance by phase:\n1. Join JCJM (Job Master) to JCCP (Cost Phase)\n2. Calculate variance as CurrEstCost - ActualCost\n3. Calculate percent complete from actuals vs budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  JCCP.Phase,\n  JCCP.CostType,\n  JCCP.OrigEstCost AS OriginalBudget,\n  JCCP.CurrEstCost AS CurrentBudget,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS Variance,\n  CASE WHEN JCCP.CurrEstCost <> 0 \n       THEN (JCCP.ActualCost / JCCP.CurrEstCost) * 100 \n       ELSE 0 END AS PercentComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.Job = @Job\nORDER BY JCCP.Phase, JCCP.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging with customer contact information\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I can partially answer this query, but the schema is incomplete.\n\nThe query requires ARCM (AR Customer Master) for customer details, but only ARTH is provided in the schema.\n\nHere's what I can provide with the available schema:\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n-- Note: Additional joins for ARCM would be needed for complete results\n```\n\nTo get the complete data you requested, please provide the DDL for ARCM.",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get data from ARCM for analysis\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'ARCM' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nAPTH, APVM\n\nTo include ARCM in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get job cost variance by phase comparing budget to actual\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Job cost variance by phase:\n1. Join JCJM (Job Master) to JCCP (Cost Phase)\n2. Calculate variance as CurrEstCost - ActualCost\n3. Calculate percent complete from actuals vs budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  JCCP.Phase,\n  JCCP.CostType,\n  JCCP.OrigEstCost AS OriginalBudget,\n  JCCP.CurrEstCost AS CurrentBudget,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS Variance,\n  CASE WHEN JCCP.CurrEstCost <> 0 \n       THEN (JCCP.ActualCost / JCCP.CurrEstCost) * 100 \n       ELSE 0 END AS PercentComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.Job = @Job\nORDER BY JCCP.Phase, JCCP.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate stored materials (Purchased - Installed) for SL billing\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Stored materials for SL billing:\n1. SLWI contains work item/billing details\n2. StoredMatls = Purchased - Installed (materials on-site but not yet used)\n3. WCCost = Work Completed Cost\n4. WCRetAmt and SMRetAmt = separate retainage for work vs materials\n5. Total billable = WCCost + StoredMatls\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description AS ItemDescription,\n  SLWI.StoredMatls,\n  SLWI.WCCost AS WorkCompletedCost,\n  SLWI.StoredMatls + SLWI.WCCost AS TotalBillable,\n  SLWI.WCRetAmt AS WorkRetainage,\n  SLWI.SMRetAmt AS MaterialsRetainage,\n  SLWI.WCRetAmt + SLWI.SMRetAmt AS TotalRetainage\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\n  AND SLWI.StoredMatls <> 0\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show job costs with GL account descriptions\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I can partially answer this query, but the schema is incomplete.\n\nThe query requires GLAC for GL account descriptions, which is not in the provided schema.\n\nHere's what I can provide with the available schema:\n\n```sql\nSELECT *\nFROM JCCD WITH (NOLOCK)\nWHERE Co = @Co\n-- Note: Additional joins for GLAC would be needed for complete results\n```\n\nTo get the complete data you requested, please provide the DDL for GLAC.",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate stored materials (Purchased - Installed) for SL billing\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Stored materials for SL billing:\n1. SLWI contains work item/billing details\n2. StoredMatls = Purchased - Installed (materials on-site but not yet used)\n3. WCCost = Work Completed Cost\n4. WCRetAmt and SMRetAmt = separate retainage for work vs materials\n5. Total billable = WCCost + StoredMatls\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description AS ItemDescription,\n  SLWI.StoredMatls,\n  SLWI.WCCost AS WorkCompletedCost,\n  SLWI.StoredMatls + SLWI.WCCost AS TotalBillable,\n  SLWI.WCRetAmt AS WorkRetainage,\n  SLWI.SMRetAmt AS MaterialsRetainage,\n  SLWI.WCRetAmt + SLWI.SMRetAmt AS TotalRetainage\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\n  AND SLWI.StoredMatls <> 0\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from GLCO\n\nDatabase Schema:\nCREATE TABLE GLCO (\n  GLCo bcompany NOT NULL,\n  Consolid byn NOT NULL,\n  LastMthSubClsd bmonth NOT NULL,\n  LastMthGLClsd bmonth NOT NULL,\n  MaxOpen tinyint NOT NULL,\n  CashAccrual char(1) NOT NULL,\n  Unbal byn NOT NULL,\n  AuditCoParams byn NOT NULL,\n  AuditAccts byn NOT NULL,\n  AuditAutoJrnl byn NOT NULL,\n  AuditBals byn NOT NULL,\n  AuditBudgets byn NOT NULL,\n  AuditDetail byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  XCompJrnlEntryYN byn NOT NULL,\n  KeyID bigint NOT NULL,\n  LastMthAPClsd bmonth NOT NULL,\n  LastMthARClsd bmonth NOT NULL,\n  AttachBatchReportsYN byn NOT NULL,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from GLCO ().\n\n```sql\nSELECT *\nFROM GLCO WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "GLCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query to aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get job cost variance by phase comparing budget to actual\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Job cost variance by phase:\n1. Join JCJM (Job Master) to JCCP (Cost Phase)\n2. Calculate variance as CurrEstCost - ActualCost\n3. Calculate percent complete from actuals vs budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  JCCP.Phase,\n  JCCP.CostType,\n  JCCP.OrigEstCost AS OriginalBudget,\n  JCCP.CurrEstCost AS CurrentBudget,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS Variance,\n  CASE WHEN JCCP.CurrEstCost <> 0 \n       THEN (JCCP.ActualCost / JCCP.CurrEstCost) * 100 \n       ELSE 0 END AS PercentComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.Job = @Job\nORDER BY JCCP.Phase, JCCP.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How do I count records in preh by company\n\nDatabase Schema:\nCREATE TABLE PREH (\n  PRCo bcompany NOT NULL,\n  Employee bemployee NOT NULL,\n  LastName varchar(30) NOT NULL,\n  FirstName varchar(30),\n  MidName varchar(15),\n  SortName bsortname NOT NULL,\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  Phone bphone,\n  SSN char(11) NOT NULL,\n  Race char(2) NOT NULL,\n  Sex char(1) NOT NULL,\n  BirthDate smalldatetime,\n  HireDate bdate,\n  TermDate bdate,\n  PRGroup bgroup NOT NULL,\n  PRDept bdept NOT NULL,\n  -- ... 121 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count PREH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM PREH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "PREH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from ARTH\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from ARTH ().\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from ARTH\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from ARTH ().\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging with customer contact information\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I can partially answer this query, but the schema is incomplete.\n\nThe query requires ARCM (AR Customer Master) for customer details, but only ARTH is provided in the schema.\n\nHere's what I can provide with the available schema:\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n-- Note: Additional joins for ARCM would be needed for complete results\n```\n\nTo get the complete data you requested, please provide the DDL for ARCM.",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate stored materials (Purchased - Installed) for SL billing\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Stored materials for SL billing:\n1. SLWI contains work item/billing details\n2. StoredMatls = Purchased - Installed (materials on-site but not yet used)\n3. WCCost = Work Completed Cost\n4. WCRetAmt and SMRetAmt = separate retainage for work vs materials\n5. Total billable = WCCost + StoredMatls\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description AS ItemDescription,\n  SLWI.StoredMatls,\n  SLWI.WCCost AS WorkCompletedCost,\n  SLWI.StoredMatls + SLWI.WCCost AS TotalBillable,\n  SLWI.WCRetAmt AS WorkRetainage,\n  SLWI.SMRetAmt AS MaterialsRetainage,\n  SLWI.WCRetAmt + SLWI.SMRetAmt AS TotalRetainage\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\n  AND SLWI.StoredMatls <> 0\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: count records in gljr by company\n\nDatabase Schema:\nCREATE TABLE GLJR (\n  GLCo bcompany NOT NULL,\n  Jrnl bjrnl NOT NULL,\n  Description btransdesc,\n  Rev byn NOT NULL,\n  RevJrnl bjrnl,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count GLJR records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM GLJR WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "GLJR"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoice totals with discounts and retainage\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Vendor invoice summary with discounts and retainage:\n1. Join APTH to APVM for vendor details\n2. Aggregate by vendor\n3. Include GrossAmt, DiscOffer, Retainage, and Balance\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(APTH.APTrans) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS GrossAmount,\n  SUM(APTH.DiscOffer) AS DiscountsOffered,\n  SUM(APTH.Retainage) AS RetainageHeld,\n  SUM(APTH.Balance) AS OpenBalance\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: List all fields in ARAgingReport\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'ARAgingReport' does not exist in Viewpoint Vista.\n\nUse ARTH (AR Transaction Header) with DATEDIFF calculations for aging. There is no pre-built ARAgingReport table in Vista.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get subcontractor costs with original, change orders, invoiced, paid, and retainage by vendor\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Subcontractor cost breakdown by vendor:\n1. Join SLHD (Header) to SLIT (Items) for subcontract details\n2. Join APVM for vendor names\n3. OrigCost = original contract amount\n4. CurCost - OrigCost = change order amounts\n5. InvCost = amounts invoiced\n6. Retainage = amounts held back\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  SLHD.SL AS SubcontractNum,\n  SLHD.Description AS SubcontractDesc,\n  SUM(SLIT.OrigCost) AS OriginalCost,\n  SUM(SLIT.CurCost - SLIT.OrigCost) AS ChangeOrderCost,\n  SUM(SLIT.CurCost) AS CurrentCost,\n  SUM(SLIT.InvCost) AS InvoicedCost,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost - SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nINNER JOIN APVM WITH (NOLOCK) ON SLHD.VendorGroup = APVM.VendorGroup AND SLHD.Vendor = APVM.Vendor\nWHERE SLHD.SLCo = @SLCo\nGROUP BY APVM.Vendor, APVM.Name, SLHD.SL, SLHD.Description\nORDER BY APVM.Name, SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLHD",
        "SLIT",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find jobs over budget with remaining cost projection\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Find jobs over budget:\n1. Aggregate JCCP by job from JCJM\n2. Compare total ActualCost to CurrEstCost\n3. Use HAVING to filter only over-budget jobs\n4. Sort by amount over budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description,\n  SUM(JCCP.CurrEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.CurrEstCost) - SUM(JCCP.ActualCost) AS RemainingBudget,\n  CASE WHEN SUM(JCCP.CurrEstCost) < SUM(JCCP.ActualCost) \n       THEN 'OVER BUDGET' ELSE 'OK' END AS Status\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\nGROUP BY JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.CurrEstCost)\nORDER BY (SUM(JCCP.ActualCost) - SUM(JCCP.CurrEstCost)) DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCJM",
        "JCCD",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from PRTD\n\nDatabase Schema:\nCREATE TABLE PRTD (\n  PRCo bcompany NOT NULL,\n  Craft bcraft NOT NULL,\n  Class bclass NOT NULL,\n  Template smallint NOT NULL,\n  DLCode bedlcode NOT NULL,\n  Factor brate NOT NULL,\n  OldRate bunitcost NOT NULL,\n  NewRate bunitcost NOT NULL,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from PRTD ().\n\n```sql\nSELECT *\nFROM PRTD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "PRTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoice totals with discounts and retainage\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Vendor invoice summary with discounts and retainage:\n1. Join APTH to APVM for vendor details\n2. Aggregate by vendor\n3. Include GrossAmt, DiscOffer, Retainage, and Balance\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(APTH.APTrans) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS GrossAmount,\n  SUM(APTH.DiscOffer) AS DiscountsOffered,\n  SUM(APTH.Retainage) AS RetainageHeld,\n  SUM(APTH.Balance) AS OpenBalance\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "basic",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging buckets (30/60/90+ days) for unpaid invoices by customer\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Use ARTH for transaction data and ARCM for customer names\n2. Filter PayFullDate IS NULL to get only unpaid invoices\n3. Use DATEDIFF and CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How do I aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find all unpaid AR invoices older than 60 days\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find unpaid invoices over 60 days:\n1. Join ARTH to ARCM for customer information\n2. Filter PayFullDate IS NULL (unpaid)\n3. Use DATEDIFF to calculate age and filter > 60 days\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Mth,\n  ARTH.ARTrans,\n  ARCM.Name AS CustomerName,\n  ARTH.TransDate,\n  ARTH.Amount,\n  DATEDIFF(day, ARTH.TransDate, GETDATE()) AS DaysOutstanding\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\n  AND DATEDIFF(day, ARTH.TransDate, GETDATE()) > 60\nORDER BY ARTH.TransDate\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from JCCD\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from JCCD ().\n\n```sql\nSELECT *\nFROM JCCD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from PRCO\n\nDatabase Schema:\nCREATE TABLE PRCO (\n  PRCo bcompany NOT NULL,\n  GLCo bcompany NOT NULL,\n  Jrnl bjrnl,\n  GLInterface byn NOT NULL,\n  CMCo bcompany NOT NULL,\n  APCo bcompany,\n  AutoOT byn NOT NULL,\n  OTEarnCode bedlcode,\n  JCCo bcompany NOT NULL,\n  AllowNoPhase byn NOT NULL,\n  JCInterface byn NOT NULL,\n  InsByPhase byn NOT NULL,\n  JCICraftClass byn NOT NULL,\n  JCICrew byn NOT NULL,\n  JCIEmployee byn NOT NULL,\n  JCIFactor byn NOT NULL,\n  JCIEarnType byn NOT NULL,\n  JCIShift byn NOT NULL,\n  JCIPostingDate byn NOT NULL,\n  JCILiabType byn NOT NULL,\n  -- ... 66 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from PRCO ().\n\n```sql\nSELECT *\nFROM PRCO WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "PRCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to count records in prtd by company\n\nDatabase Schema:\nCREATE TABLE PRTD (\n  PRCo bcompany NOT NULL,\n  Craft bcraft NOT NULL,\n  Class bclass NOT NULL,\n  Template smallint NOT NULL,\n  DLCode bedlcode NOT NULL,\n  Factor brate NOT NULL,\n  OldRate bunitcost NOT NULL,\n  NewRate bunitcost NOT NULL,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count PRTD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM PRTD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "PRTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How is Invoices structured?\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'Invoices' does not exist in Viewpoint Vista.\n\nFor AR invoices, use ARTH (AR Transaction Header). For AP invoices, use APTH (AP Transaction Header).\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get customer balance summary by customer group\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Customer balance summary by group:\n1. Join ARTH to ARCM for customer details\n2. Use conditional SUM for open vs total balances\n3. Group by CustGroup for summary\n\n```sql\nSELECT \n  ARTH.CustGroup,\n  COUNT(DISTINCT ARTH.Customer) AS CustomerCount,\n  SUM(CASE WHEN ARTH.PayFullDate IS NULL THEN ARTH.Amount ELSE 0 END) AS OpenBalance,\n  SUM(ARTH.Amount) AS TotalBilled\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\nGROUP BY ARTH.CustGroup\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate stored materials (Purchased - Installed) for SL billing\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Stored materials for SL billing:\n1. SLWI contains work item/billing details\n2. StoredMatls = Purchased - Installed (materials on-site but not yet used)\n3. WCCost = Work Completed Cost\n4. WCRetAmt and SMRetAmt = separate retainage for work vs materials\n5. Total billable = WCCost + StoredMatls\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description AS ItemDescription,\n  SLWI.StoredMatls,\n  SLWI.WCCost AS WorkCompletedCost,\n  SLWI.StoredMatls + SLWI.WCCost AS TotalBillable,\n  SLWI.WCRetAmt AS WorkRetainage,\n  SLWI.SMRetAmt AS MaterialsRetainage,\n  SLWI.WCRetAmt + SLWI.SMRetAmt AS TotalRetainage\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\n  AND SLWI.StoredMatls <> 0\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "basic",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need to count records in slhd by company\n\nDatabase Schema:\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count SLHD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM SLHD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "SLHD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show job costs with GL account descriptions\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I can partially answer this query, but the schema is incomplete.\n\nThe query requires GLAC for GL account descriptions, which is not in the provided schema.\n\nHere's what I can provide with the available schema:\n\n```sql\nSELECT *\nFROM JCCD WITH (NOLOCK)\nWHERE Co = @Co\n-- Note: Additional joins for GLAC would be needed for complete results\n```\n\nTo get the complete data you requested, please provide the DDL for GLAC.",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find jobs over budget with remaining cost projection\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Find jobs over budget:\n1. Aggregate JCCP by job from JCJM\n2. Compare total ActualCost to CurrEstCost\n3. Use HAVING to filter only over-budget jobs\n4. Sort by amount over budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description,\n  SUM(JCCP.CurrEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.CurrEstCost) - SUM(JCCP.ActualCost) AS RemainingBudget,\n  CASE WHEN SUM(JCCP.CurrEstCost) < SUM(JCCP.ActualCost) \n       THEN 'OVER BUDGET' ELSE 'OK' END AS Status\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\nGROUP BY JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.CurrEstCost)\nORDER BY (SUM(JCCP.ActualCost) - SUM(JCCP.CurrEstCost)) DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCJM",
        "JCCD",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from GLCO\n\nDatabase Schema:\nCREATE TABLE GLCO (\n  GLCo bcompany NOT NULL,\n  Consolid byn NOT NULL,\n  LastMthSubClsd bmonth NOT NULL,\n  LastMthGLClsd bmonth NOT NULL,\n  MaxOpen tinyint NOT NULL,\n  CashAccrual char(1) NOT NULL,\n  Unbal byn NOT NULL,\n  AuditCoParams byn NOT NULL,\n  AuditAccts byn NOT NULL,\n  AuditAutoJrnl byn NOT NULL,\n  AuditBals byn NOT NULL,\n  AuditBudgets byn NOT NULL,\n  AuditDetail byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  XCompJrnlEntryYN byn NOT NULL,\n  KeyID bigint NOT NULL,\n  LastMthAPClsd bmonth NOT NULL,\n  LastMthARClsd bmonth NOT NULL,\n  AttachBatchReportsYN byn NOT NULL,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from GLCO ().\n\n```sql\nSELECT *\nFROM GLCO WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "GLCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find jobs over budget with remaining cost projection\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Find jobs over budget:\n1. Aggregate JCCP by job from JCJM\n2. Compare total ActualCost to CurrEstCost\n3. Use HAVING to filter only over-budget jobs\n4. Sort by amount over budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description,\n  SUM(JCCP.CurrEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.CurrEstCost) - SUM(JCCP.ActualCost) AS RemainingBudget,\n  CASE WHEN SUM(JCCP.CurrEstCost) < SUM(JCCP.ActualCost) \n       THEN 'OVER BUDGET' ELSE 'OK' END AS Status\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\nGROUP BY JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.CurrEstCost)\nORDER BY (SUM(JCCP.ActualCost) - SUM(JCCP.CurrEstCost)) DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM",
        "JCCD",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging buckets (30/60/90+ days) for unpaid invoices by customer\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Use ARTH for transaction data and ARCM for customer names\n2. Filter PayFullDate IS NULL to get only unpaid invoices\n3. Use DATEDIFF and CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to count records in slwi by company\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count SLWI records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM SLWI WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "SLWI"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get customer balance summary by customer group\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Customer balance summary by group:\n1. Join ARTH to ARCM for customer details\n2. Use conditional SUM for open vs total balances\n3. Group by CustGroup for summary\n\n```sql\nSELECT \n  ARTH.CustGroup,\n  COUNT(DISTINCT ARTH.Customer) AS CustomerCount,\n  SUM(CASE WHEN ARTH.PayFullDate IS NULL THEN ARTH.Amount ELSE 0 END) AS OpenBalance,\n  SUM(ARTH.Amount) AS TotalBilled\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\nGROUP BY ARTH.CustGroup\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query to count records in slwi by company\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count SLWI records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM SLWI WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "SLWI"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from PREH\n\nDatabase Schema:\nCREATE TABLE PREH (\n  PRCo bcompany NOT NULL,\n  Employee bemployee NOT NULL,\n  LastName varchar(30) NOT NULL,\n  FirstName varchar(30),\n  MidName varchar(15),\n  SortName bsortname NOT NULL,\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  Phone bphone,\n  SSN char(11) NOT NULL,\n  Race char(2) NOT NULL,\n  Sex char(1) NOT NULL,\n  BirthDate smalldatetime,\n  HireDate bdate,\n  TermDate bdate,\n  PRGroup bgroup NOT NULL,\n  PRDept bdept NOT NULL,\n  -- ... 121 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from PREH ().\n\n```sql\nSELECT *\nFROM PREH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "PREH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from APTD\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from APTD ().\n\n```sql\nSELECT *\nFROM APTD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query to aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from SLWI\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from SLWI ().\n\n```sql\nSELECT *\nFROM SLWI WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "SLWI"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query to track ap hold status distinguishing retainage vs non-retainage holds\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APCO (\n  APCo bcompany NOT NULL,\n  GLCo bcompany NOT NULL,\n  ExpJrnl bjrnl,\n  GLExpInterfaceLvl tinyint NOT NULL,\n  GLExpSummaryDesc varchar(60),\n  GLExpTransDesc varchar(60),\n  GLJobDetailDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLEquipDetailDesc varchar(60),\n  GLExpDetailDesc varchar(60),\n  PayJrnl bjrnl,\n  GLPayInterfaceLvl tinyint NOT NULL,\n  GLPayDetailDesc varchar(60),\n  GLPaySummaryDesc varchar(60),\n  DiscOffGLAcct bglacct,\n  DiscTakenGLAcct bglacct,\n  ExpPayType tinyint,\n  JobPayType tinyint,\n  SubPayType tinyint,\n  RetPayType tinyint,\n  -- ... 92 more columns,\n  PRIMARY KEY (APCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To distinguish retainage vs non-retainage holds:\n1. Join APTD to APHD for hold details\n2. Join APCO to get RetHoldCode setting\n3. Compare APHD.HoldCode to APCO.RetHoldCode\n4. If equal, it's a retainage hold; otherwise non-retainage\n\n```sql\nSELECT \n  APTD.APCo,\n  APTD.Vendor,\n  APTD.Mth,\n  APTD.APTrans,\n  APHD.HoldCode,\n  CASE WHEN APHD.HoldCode = APCO.RetHoldCode \n       THEN 'Retainage Hold' \n       ELSE 'Non-Retainage Hold' END AS HoldType,\n  APTD.Amount\nFROM APTD WITH (NOLOCK)\nINNER JOIN APHD WITH (NOLOCK) ON APTD.APCo = APHD.APCo \n  AND APTD.Mth = APHD.Mth \n  AND APTD.APTrans = APHD.APTrans \n  AND APTD.APLine = APHD.APLine\nINNER JOIN APCO WITH (NOLOCK) ON APTD.APCo = APCO.APCo\nWHERE APTD.APCo = @APCo\n  AND APHD.HoldCode IS NOT NULL\nORDER BY APTD.Vendor, APTD.Mth\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTD",
        "APHD",
        "APCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query to count records in arth by company\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count ARTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM ARTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from APTH\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from APTH ().\n\n```sql\nSELECT *\nFROM APTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get subcontractor costs with original, change orders, invoiced, paid, and retainage by vendor\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Subcontractor cost breakdown by vendor:\n1. Join SLHD (Header) to SLIT (Items) for subcontract details\n2. Join APVM for vendor names\n3. OrigCost = original contract amount\n4. CurCost - OrigCost = change order amounts\n5. InvCost = amounts invoiced\n6. Retainage = amounts held back\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  SLHD.SL AS SubcontractNum,\n  SLHD.Description AS SubcontractDesc,\n  SUM(SLIT.OrigCost) AS OriginalCost,\n  SUM(SLIT.CurCost - SLIT.OrigCost) AS ChangeOrderCost,\n  SUM(SLIT.CurCost) AS CurrentCost,\n  SUM(SLIT.InvCost) AS InvoicedCost,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost - SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nINNER JOIN APVM WITH (NOLOCK) ON SLHD.VendorGroup = APVM.VendorGroup AND SLHD.Vendor = APVM.Vendor\nWHERE SLHD.SLCo = @SLCo\nGROUP BY APVM.Vendor, APVM.Name, SLHD.SL, SLHD.Description\nORDER BY APVM.Name, SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLHD",
        "SLIT",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate stored materials (Purchased - Installed) for SL billing\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Stored materials for SL billing:\n1. SLWI contains work item/billing details\n2. StoredMatls = Purchased - Installed (materials on-site but not yet used)\n3. WCCost = Work Completed Cost\n4. WCRetAmt and SMRetAmt = separate retainage for work vs materials\n5. Total billable = WCCost + StoredMatls\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description AS ItemDescription,\n  SLWI.StoredMatls,\n  SLWI.WCCost AS WorkCompletedCost,\n  SLWI.StoredMatls + SLWI.WCCost AS TotalBillable,\n  SLWI.WCRetAmt AS WorkRetainage,\n  SLWI.SMRetAmt AS MaterialsRetainage,\n  SLWI.WCRetAmt + SLWI.SMRetAmt AS TotalRetainage\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\n  AND SLWI.StoredMatls <> 0\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "basic",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query to track ap hold status distinguishing retainage vs non-retainage holds\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APCO (\n  APCo bcompany NOT NULL,\n  GLCo bcompany NOT NULL,\n  ExpJrnl bjrnl,\n  GLExpInterfaceLvl tinyint NOT NULL,\n  GLExpSummaryDesc varchar(60),\n  GLExpTransDesc varchar(60),\n  GLJobDetailDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLEquipDetailDesc varchar(60),\n  GLExpDetailDesc varchar(60),\n  PayJrnl bjrnl,\n  GLPayInterfaceLvl tinyint NOT NULL,\n  GLPayDetailDesc varchar(60),\n  GLPaySummaryDesc varchar(60),\n  DiscOffGLAcct bglacct,\n  DiscTakenGLAcct bglacct,\n  ExpPayType tinyint,\n  JobPayType tinyint,\n  SubPayType tinyint,\n  RetPayType tinyint,\n  -- ... 92 more columns,\n  PRIMARY KEY (APCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To distinguish retainage vs non-retainage holds:\n1. Join APTD to APHD for hold details\n2. Join APCO to get RetHoldCode setting\n3. Compare APHD.HoldCode to APCO.RetHoldCode\n4. If equal, it's a retainage hold; otherwise non-retainage\n\n```sql\nSELECT \n  APTD.APCo,\n  APTD.Vendor,\n  APTD.Mth,\n  APTD.APTrans,\n  APHD.HoldCode,\n  CASE WHEN APHD.HoldCode = APCO.RetHoldCode \n       THEN 'Retainage Hold' \n       ELSE 'Non-Retainage Hold' END AS HoldType,\n  APTD.Amount\nFROM APTD WITH (NOLOCK)\nINNER JOIN APHD WITH (NOLOCK) ON APTD.APCo = APHD.APCo \n  AND APTD.Mth = APHD.Mth \n  AND APTD.APTrans = APHD.APTrans \n  AND APTD.APLine = APHD.APLine\nINNER JOIN APCO WITH (NOLOCK) ON APTD.APCo = APCO.APCo\nWHERE APTD.APCo = @APCo\n  AND APHD.HoldCode IS NOT NULL\nORDER BY APTD.Vendor, APTD.Mth\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTD",
        "APHD",
        "APCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Describe the VendorMaster table\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'VendorMaster' does not exist in Viewpoint Vista.\n\nUse APVM (AP Vendor Master) for vendor information.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM APVM WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need to aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How do I count records in apth by company\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count APTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM APTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get job cost variance by phase comparing budget to actual\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Job cost variance by phase:\n1. Join JCJM (Job Master) to JCCP (Cost Phase)\n2. Calculate variance as CurrEstCost - ActualCost\n3. Calculate percent complete from actuals vs budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  JCCP.Phase,\n  JCCP.CostType,\n  JCCP.OrigEstCost AS OriginalBudget,\n  JCCP.CurrEstCost AS CurrentBudget,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS Variance,\n  CASE WHEN JCCP.CurrEstCost <> 0 \n       THEN (JCCP.ActualCost / JCCP.CurrEstCost) * 100 \n       ELSE 0 END AS PercentComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.Job = @Job\nORDER BY JCCP.Phase, JCCP.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Include GLDT in the query\n\nDatabase Schema:\nCREATE TABLE PREH (\n  PRCo bcompany NOT NULL,\n  Employee bemployee NOT NULL,\n  LastName varchar(30) NOT NULL,\n  FirstName varchar(30),\n  MidName varchar(15),\n  SortName bsortname NOT NULL,\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  Phone bphone,\n  SSN char(11) NOT NULL,\n  Race char(2) NOT NULL,\n  Sex char(1) NOT NULL,\n  BirthDate smalldatetime,\n  HireDate bdate,\n  TermDate bdate,\n  PRGroup bgroup NOT NULL,\n  PRDept bdept NOT NULL,\n  -- ... 121 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nCREATE TABLE PRTH (\n  PRCo bcompany NOT NULL,\n  PRGroup bgroup NOT NULL,\n  PREndDate bdate NOT NULL,\n  Employee bemployee NOT NULL,\n  PaySeq tinyint NOT NULL,\n  PostSeq smallint NOT NULL,\n  Type char(1) NOT NULL,\n  PostDate bdate NOT NULL,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCDept bdept,\n  GLCo bcompany NOT NULL,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equipment bequip,\n  EMGroup tinyint,\n  CostCode bcostcode,\n  -- ... 41 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'GLDT' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nPREH, PRTH\n\nTo include GLDT in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoice totals with discounts and retainage\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Vendor invoice summary with discounts and retainage:\n1. Join APTH to APVM for vendor details\n2. Aggregate by vendor\n3. Include GrossAmt, DiscOffer, Retainage, and Balance\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(APTH.APTrans) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS GrossAmount,\n  SUM(APTH.DiscOffer) AS DiscountsOffered,\n  SUM(APTH.Retainage) AS RetainageHeld,\n  SUM(APTH.Balance) AS OpenBalance\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need to count records in jccd by company\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count JCCD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM JCCD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query to track ap hold status distinguishing retainage vs non-retainage holds\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APCO (\n  APCo bcompany NOT NULL,\n  GLCo bcompany NOT NULL,\n  ExpJrnl bjrnl,\n  GLExpInterfaceLvl tinyint NOT NULL,\n  GLExpSummaryDesc varchar(60),\n  GLExpTransDesc varchar(60),\n  GLJobDetailDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLEquipDetailDesc varchar(60),\n  GLExpDetailDesc varchar(60),\n  PayJrnl bjrnl,\n  GLPayInterfaceLvl tinyint NOT NULL,\n  GLPayDetailDesc varchar(60),\n  GLPaySummaryDesc varchar(60),\n  DiscOffGLAcct bglacct,\n  DiscTakenGLAcct bglacct,\n  ExpPayType tinyint,\n  JobPayType tinyint,\n  SubPayType tinyint,\n  RetPayType tinyint,\n  -- ... 92 more columns,\n  PRIMARY KEY (APCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To distinguish retainage vs non-retainage holds:\n1. Join APTD to APHD for hold details\n2. Join APCO to get RetHoldCode setting\n3. Compare APHD.HoldCode to APCO.RetHoldCode\n4. If equal, it's a retainage hold; otherwise non-retainage\n\n```sql\nSELECT \n  APTD.APCo,\n  APTD.Vendor,\n  APTD.Mth,\n  APTD.APTrans,\n  APHD.HoldCode,\n  CASE WHEN APHD.HoldCode = APCO.RetHoldCode \n       THEN 'Retainage Hold' \n       ELSE 'Non-Retainage Hold' END AS HoldType,\n  APTD.Amount\nFROM APTD WITH (NOLOCK)\nINNER JOIN APHD WITH (NOLOCK) ON APTD.APCo = APHD.APCo \n  AND APTD.Mth = APHD.Mth \n  AND APTD.APTrans = APHD.APTrans \n  AND APTD.APLine = APHD.APLine\nINNER JOIN APCO WITH (NOLOCK) ON APTD.APCo = APCO.APCo\nWHERE APTD.APCo = @APCo\n  AND APHD.HoldCode IS NOT NULL\nORDER BY APTD.Vendor, APTD.Mth\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTD",
        "APHD",
        "APCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from ARTH\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from ARTH ().\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get subcontractor costs with original, change orders, invoiced, paid, and retainage by vendor\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Subcontractor cost breakdown by vendor:\n1. Join SLHD (Header) to SLIT (Items) for subcontract details\n2. Join APVM for vendor names\n3. OrigCost = original contract amount\n4. CurCost - OrigCost = change order amounts\n5. InvCost = amounts invoiced\n6. Retainage = amounts held back\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  SLHD.SL AS SubcontractNum,\n  SLHD.Description AS SubcontractDesc,\n  SUM(SLIT.OrigCost) AS OriginalCost,\n  SUM(SLIT.CurCost - SLIT.OrigCost) AS ChangeOrderCost,\n  SUM(SLIT.CurCost) AS CurrentCost,\n  SUM(SLIT.InvCost) AS InvoicedCost,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost - SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nINNER JOIN APVM WITH (NOLOCK) ON SLHD.VendorGroup = APVM.VendorGroup AND SLHD.Vendor = APVM.Vendor\nWHERE SLHD.SLCo = @SLCo\nGROUP BY APVM.Vendor, APVM.Name, SLHD.SL, SLHD.Description\nORDER BY APVM.Name, SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "intermediate",
      "tables_used": [
        "SLHD",
        "SLIT",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate stored materials (Purchased - Installed) for SL billing\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Stored materials for SL billing:\n1. SLWI contains work item/billing details\n2. StoredMatls = Purchased - Installed (materials on-site but not yet used)\n3. WCCost = Work Completed Cost\n4. WCRetAmt and SMRetAmt = separate retainage for work vs materials\n5. Total billable = WCCost + StoredMatls\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description AS ItemDescription,\n  SLWI.StoredMatls,\n  SLWI.WCCost AS WorkCompletedCost,\n  SLWI.StoredMatls + SLWI.WCCost AS TotalBillable,\n  SLWI.WCRetAmt AS WorkRetainage,\n  SLWI.SMRetAmt AS MaterialsRetainage,\n  SLWI.WCRetAmt + SLWI.SMRetAmt AS TotalRetainage\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\n  AND SLWI.StoredMatls <> 0\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoice totals with discounts and retainage\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Vendor invoice summary with discounts and retainage:\n1. Join APTH to APVM for vendor details\n2. Aggregate by vendor\n3. Include GrossAmt, DiscOffer, Retainage, and Balance\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(APTH.APTrans) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS GrossAmount,\n  SUM(APTH.DiscOffer) AS DiscountsOffered,\n  SUM(APTH.Retainage) AS RetainageHeld,\n  SUM(APTH.Balance) AS OpenBalance\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from ARTH\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from ARTH ().\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find all unpaid AR invoices older than 60 days\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find unpaid invoices over 60 days:\n1. Join ARTH to ARCM for customer information\n2. Filter PayFullDate IS NULL (unpaid)\n3. Use DATEDIFF to calculate age and filter > 60 days\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Mth,\n  ARTH.ARTrans,\n  ARCM.Name AS CustomerName,\n  ARTH.TransDate,\n  ARTH.Amount,\n  DATEDIFF(day, ARTH.TransDate, GETDATE()) AS DaysOutstanding\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\n  AND DATEDIFF(day, ARTH.TransDate, GETDATE()) > 60\nORDER BY ARTH.TransDate\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to count records in glco by company\n\nDatabase Schema:\nCREATE TABLE GLCO (\n  GLCo bcompany NOT NULL,\n  Consolid byn NOT NULL,\n  LastMthSubClsd bmonth NOT NULL,\n  LastMthGLClsd bmonth NOT NULL,\n  MaxOpen tinyint NOT NULL,\n  CashAccrual char(1) NOT NULL,\n  Unbal byn NOT NULL,\n  AuditCoParams byn NOT NULL,\n  AuditAccts byn NOT NULL,\n  AuditAutoJrnl byn NOT NULL,\n  AuditBals byn NOT NULL,\n  AuditBudgets byn NOT NULL,\n  AuditDetail byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  XCompJrnlEntryYN byn NOT NULL,\n  KeyID bigint NOT NULL,\n  LastMthAPClsd bmonth NOT NULL,\n  LastMthARClsd bmonth NOT NULL,\n  AttachBatchReportsYN byn NOT NULL,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count GLCO records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM GLCO WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "GLCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Query GLDT along with the schema tables\n\nDatabase Schema:\nCREATE TABLE PREH (\n  PRCo bcompany NOT NULL,\n  Employee bemployee NOT NULL,\n  LastName varchar(30) NOT NULL,\n  FirstName varchar(30),\n  MidName varchar(15),\n  SortName bsortname NOT NULL,\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  Phone bphone,\n  SSN char(11) NOT NULL,\n  Race char(2) NOT NULL,\n  Sex char(1) NOT NULL,\n  BirthDate smalldatetime,\n  HireDate bdate,\n  TermDate bdate,\n  PRGroup bgroup NOT NULL,\n  PRDept bdept NOT NULL,\n  -- ... 121 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nCREATE TABLE PRTH (\n  PRCo bcompany NOT NULL,\n  PRGroup bgroup NOT NULL,\n  PREndDate bdate NOT NULL,\n  Employee bemployee NOT NULL,\n  PaySeq tinyint NOT NULL,\n  PostSeq smallint NOT NULL,\n  Type char(1) NOT NULL,\n  PostDate bdate NOT NULL,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCDept bdept,\n  GLCo bcompany NOT NULL,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equipment bequip,\n  EMGroup tinyint,\n  CostCode bcostcode,\n  -- ... 41 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'GLDT' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nPREH, PRTH\n\nTo include GLDT in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to count records in prpc by company\n\nDatabase Schema:\nCREATE TABLE PRPC (\n  PRCo bcompany NOT NULL,\n  PRGroup bgroup NOT NULL,\n  PREndDate bdate NOT NULL,\n  BeginDate bdate NOT NULL,\n  MultiMth byn NOT NULL,\n  BeginMth bmonth NOT NULL,\n  EndMth bmonth,\n  CutoffDate bdate,\n  LimitMth bmonth NOT NULL,\n  Hrs smallint NOT NULL,\n  Days tinyint NOT NULL,\n  Wks tinyint NOT NULL,\n  Status tinyint NOT NULL,\n  DateClosed smalldatetime,\n  JCInterface byn NOT NULL,\n  EMInterface byn NOT NULL,\n  GLInterface byn NOT NULL,\n  APInterface byn NOT NULL,\n  LeaveProcess byn NOT NULL,\n  InUseBy bvpusername,\n  -- ... 7 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count PRPC records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM PRPC WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "PRPC"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to join GLDT with the available tables\n\nDatabase Schema:\nCREATE TABLE PREH (\n  PRCo bcompany NOT NULL,\n  Employee bemployee NOT NULL,\n  LastName varchar(30) NOT NULL,\n  FirstName varchar(30),\n  MidName varchar(15),\n  SortName bsortname NOT NULL,\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  Phone bphone,\n  SSN char(11) NOT NULL,\n  Race char(2) NOT NULL,\n  Sex char(1) NOT NULL,\n  BirthDate smalldatetime,\n  HireDate bdate,\n  TermDate bdate,\n  PRGroup bgroup NOT NULL,\n  PRDept bdept NOT NULL,\n  -- ... 121 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nCREATE TABLE PRTH (\n  PRCo bcompany NOT NULL,\n  PRGroup bgroup NOT NULL,\n  PREndDate bdate NOT NULL,\n  Employee bemployee NOT NULL,\n  PaySeq tinyint NOT NULL,\n  PostSeq smallint NOT NULL,\n  Type char(1) NOT NULL,\n  PostDate bdate NOT NULL,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCDept bdept,\n  GLCo bcompany NOT NULL,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equipment bequip,\n  EMGroup tinyint,\n  CostCode bcostcode,\n  -- ... 41 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'GLDT' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nPREH, PRTH\n\nTo include GLDT in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to count records in prtd by company\n\nDatabase Schema:\nCREATE TABLE PRTD (\n  PRCo bcompany NOT NULL,\n  Craft bcraft NOT NULL,\n  Class bclass NOT NULL,\n  Template smallint NOT NULL,\n  DLCode bedlcode NOT NULL,\n  Factor brate NOT NULL,\n  OldRate bunitcost NOT NULL,\n  NewRate bunitcost NOT NULL,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count PRTD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM PRTD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "PRTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: count records in prtd by company\n\nDatabase Schema:\nCREATE TABLE PRTD (\n  PRCo bcompany NOT NULL,\n  Craft bcraft NOT NULL,\n  Class bclass NOT NULL,\n  Template smallint NOT NULL,\n  DLCode bedlcode NOT NULL,\n  Factor brate NOT NULL,\n  OldRate bunitcost NOT NULL,\n  NewRate bunitcost NOT NULL,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count PRTD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM PRTD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "PRTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from ARTH\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from ARTH ().\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from APTH\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from APTH ().\n\n```sql\nSELECT *\nFROM APTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get job cost variance by phase comparing budget to actual\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Job cost variance by phase:\n1. Join JCJM (Job Master) to JCCP (Cost Phase)\n2. Calculate variance as CurrEstCost - ActualCost\n3. Calculate percent complete from actuals vs budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  JCCP.Phase,\n  JCCP.CostType,\n  JCCP.OrigEstCost AS OriginalBudget,\n  JCCP.CurrEstCost AS CurrentBudget,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS Variance,\n  CASE WHEN JCCP.CurrEstCost <> 0 \n       THEN (JCCP.ActualCost / JCCP.CurrEstCost) * 100 \n       ELSE 0 END AS PercentComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.Job = @Job\nORDER BY JCCP.Phase, JCCP.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to count records in prth by company\n\nDatabase Schema:\nCREATE TABLE PRTH (\n  PRCo bcompany NOT NULL,\n  PRGroup bgroup NOT NULL,\n  PREndDate bdate NOT NULL,\n  Employee bemployee NOT NULL,\n  PaySeq tinyint NOT NULL,\n  PostSeq smallint NOT NULL,\n  Type char(1) NOT NULL,\n  PostDate bdate NOT NULL,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCDept bdept,\n  GLCo bcompany NOT NULL,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equipment bequip,\n  EMGroup tinyint,\n  CostCode bcostcode,\n  -- ... 41 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count PRTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM PRTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "PRTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from JCCD\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from JCCD ().\n\n```sql\nSELECT *\nFROM JCCD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from GLCO\n\nDatabase Schema:\nCREATE TABLE GLCO (\n  GLCo bcompany NOT NULL,\n  Consolid byn NOT NULL,\n  LastMthSubClsd bmonth NOT NULL,\n  LastMthGLClsd bmonth NOT NULL,\n  MaxOpen tinyint NOT NULL,\n  CashAccrual char(1) NOT NULL,\n  Unbal byn NOT NULL,\n  AuditCoParams byn NOT NULL,\n  AuditAccts byn NOT NULL,\n  AuditAutoJrnl byn NOT NULL,\n  AuditBals byn NOT NULL,\n  AuditBudgets byn NOT NULL,\n  AuditDetail byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  XCompJrnlEntryYN byn NOT NULL,\n  KeyID bigint NOT NULL,\n  LastMthAPClsd bmonth NOT NULL,\n  LastMthARClsd bmonth NOT NULL,\n  AttachBatchReportsYN byn NOT NULL,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from GLCO ().\n\n```sql\nSELECT *\nFROM GLCO WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "GLCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: count records in arth by company\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count ARTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM ARTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to count records in glco by company\n\nDatabase Schema:\nCREATE TABLE GLCO (\n  GLCo bcompany NOT NULL,\n  Consolid byn NOT NULL,\n  LastMthSubClsd bmonth NOT NULL,\n  LastMthGLClsd bmonth NOT NULL,\n  MaxOpen tinyint NOT NULL,\n  CashAccrual char(1) NOT NULL,\n  Unbal byn NOT NULL,\n  AuditCoParams byn NOT NULL,\n  AuditAccts byn NOT NULL,\n  AuditAutoJrnl byn NOT NULL,\n  AuditBals byn NOT NULL,\n  AuditBudgets byn NOT NULL,\n  AuditDetail byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  XCompJrnlEntryYN byn NOT NULL,\n  KeyID bigint NOT NULL,\n  LastMthAPClsd bmonth NOT NULL,\n  LastMthARClsd bmonth NOT NULL,\n  AttachBatchReportsYN byn NOT NULL,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count GLCO records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM GLCO WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "GLCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from ARTH\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from ARTH ().\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get job cost variance by phase comparing budget to actual\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Job cost variance by phase:\n1. Join JCJM (Job Master) to JCCP (Cost Phase)\n2. Calculate variance as CurrEstCost - ActualCost\n3. Calculate percent complete from actuals vs budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  JCCP.Phase,\n  JCCP.CostType,\n  JCCP.OrigEstCost AS OriginalBudget,\n  JCCP.CurrEstCost AS CurrentBudget,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS Variance,\n  CASE WHEN JCCP.CurrEstCost <> 0 \n       THEN (JCCP.ActualCost / JCCP.CurrEstCost) * 100 \n       ELSE 0 END AS PercentComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.Job = @Job\nORDER BY JCCP.Phase, JCCP.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find jobs over budget with remaining cost projection\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Find jobs over budget:\n1. Aggregate JCCP by job from JCJM\n2. Compare total ActualCost to CurrEstCost\n3. Use HAVING to filter only over-budget jobs\n4. Sort by amount over budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description,\n  SUM(JCCP.CurrEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.CurrEstCost) - SUM(JCCP.ActualCost) AS RemainingBudget,\n  CASE WHEN SUM(JCCP.CurrEstCost) < SUM(JCCP.ActualCost) \n       THEN 'OVER BUDGET' ELSE 'OK' END AS Status\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\nGROUP BY JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.CurrEstCost)\nORDER BY (SUM(JCCP.ActualCost) - SUM(JCCP.CurrEstCost)) DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCJM",
        "JCCD",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get job cost variance by phase comparing budget to actual\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Job cost variance by phase:\n1. Join JCJM (Job Master) to JCCP (Cost Phase)\n2. Calculate variance as CurrEstCost - ActualCost\n3. Calculate percent complete from actuals vs budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  JCCP.Phase,\n  JCCP.CostType,\n  JCCP.OrigEstCost AS OriginalBudget,\n  JCCP.CurrEstCost AS CurrentBudget,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS Variance,\n  CASE WHEN JCCP.CurrEstCost <> 0 \n       THEN (JCCP.ActualCost / JCCP.CurrEstCost) * 100 \n       ELSE 0 END AS PercentComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.Job = @Job\nORDER BY JCCP.Phase, JCCP.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging buckets (30/60/90+ days) for unpaid invoices by customer\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Use ARTH for transaction data and ARCM for customer names\n2. Filter PayFullDate IS NULL to get only unpaid invoices\n3. Use DATEDIFF and CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How do I count records in gljr by company\n\nDatabase Schema:\nCREATE TABLE GLJR (\n  GLCo bcompany NOT NULL,\n  Jrnl bjrnl NOT NULL,\n  Description btransdesc,\n  Rev byn NOT NULL,\n  RevJrnl bjrnl,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count GLJR records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM GLJR WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "GLJR"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from JCCD\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from JCCD ().\n\n```sql\nSELECT *\nFROM JCCD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get job cost variance by phase comparing budget to actual\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Job cost variance by phase:\n1. Join JCJM (Job Master) to JCCP (Cost Phase)\n2. Calculate variance as CurrEstCost - ActualCost\n3. Calculate percent complete from actuals vs budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  JCCP.Phase,\n  JCCP.CostType,\n  JCCP.OrigEstCost AS OriginalBudget,\n  JCCP.CurrEstCost AS CurrentBudget,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS Variance,\n  CASE WHEN JCCP.CurrEstCost <> 0 \n       THEN (JCCP.ActualCost / JCCP.CurrEstCost) * 100 \n       ELSE 0 END AS PercentComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.Job = @Job\nORDER BY JCCP.Phase, JCCP.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query to count records in jccd by company\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count JCCD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM JCCD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find jobs over budget with remaining cost projection\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Find jobs over budget:\n1. Aggregate JCCP by job from JCJM\n2. Compare total ActualCost to CurrEstCost\n3. Use HAVING to filter only over-budget jobs\n4. Sort by amount over budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description,\n  SUM(JCCP.CurrEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.CurrEstCost) - SUM(JCCP.ActualCost) AS RemainingBudget,\n  CASE WHEN SUM(JCCP.CurrEstCost) < SUM(JCCP.ActualCost) \n       THEN 'OVER BUDGET' ELSE 'OK' END AS Status\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\nGROUP BY JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.CurrEstCost)\nORDER BY (SUM(JCCP.ActualCost) - SUM(JCCP.CurrEstCost)) DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCJM",
        "JCCD",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: count records in gldt by company\n\nDatabase Schema:\nCREATE TABLE GLDT (\n  GLCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  GLTrans btrans NOT NULL,\n  GLAcct bglacct NOT NULL,\n  Jrnl bjrnl NOT NULL,\n  GLRef bglref NOT NULL,\n  SourceCo bcompany NOT NULL,\n  Source bsource NOT NULL,\n  ActDate bdate NOT NULL,\n  DatePosted bdate NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid NOT NULL,\n  Amount bdollar NOT NULL,\n  RevStatus tinyint NOT NULL,\n  Adjust char(1) NOT NULL,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  UniqueAttchID uniqueidentifier,\n  SrcTable varchar(128),\n  SrcKeyID bigint,\n  PRIMARY KEY (GLCo, Mth, GLTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count GLDT records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM GLDT WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "GLDT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from GLCO\n\nDatabase Schema:\nCREATE TABLE GLCO (\n  GLCo bcompany NOT NULL,\n  Consolid byn NOT NULL,\n  LastMthSubClsd bmonth NOT NULL,\n  LastMthGLClsd bmonth NOT NULL,\n  MaxOpen tinyint NOT NULL,\n  CashAccrual char(1) NOT NULL,\n  Unbal byn NOT NULL,\n  AuditCoParams byn NOT NULL,\n  AuditAccts byn NOT NULL,\n  AuditAutoJrnl byn NOT NULL,\n  AuditBals byn NOT NULL,\n  AuditBudgets byn NOT NULL,\n  AuditDetail byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  XCompJrnlEntryYN byn NOT NULL,\n  KeyID bigint NOT NULL,\n  LastMthAPClsd bmonth NOT NULL,\n  LastMthARClsd bmonth NOT NULL,\n  AttachBatchReportsYN byn NOT NULL,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from GLCO ().\n\n```sql\nSELECT *\nFROM GLCO WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "GLCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging buckets (30/60/90+ days) for unpaid invoices by customer\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Use ARTH for transaction data and ARCM for customer names\n2. Filter PayFullDate IS NULL to get only unpaid invoices\n3. Use DATEDIFF and CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find jobs over budget with remaining cost projection\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Find jobs over budget:\n1. Aggregate JCCP by job from JCJM\n2. Compare total ActualCost to CurrEstCost\n3. Use HAVING to filter only over-budget jobs\n4. Sort by amount over budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description,\n  SUM(JCCP.CurrEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.CurrEstCost) - SUM(JCCP.ActualCost) AS RemainingBudget,\n  CASE WHEN SUM(JCCP.CurrEstCost) < SUM(JCCP.ActualCost) \n       THEN 'OVER BUDGET' ELSE 'OK' END AS Status\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\nGROUP BY JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.CurrEstCost)\nORDER BY (SUM(JCCP.ActualCost) - SUM(JCCP.CurrEstCost)) DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCJM",
        "JCCD",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query to count records in slwi by company\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count SLWI records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM SLWI WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "SLWI"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from APTD\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from APTD ().\n\n```sql\nSELECT *\nFROM APTD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Query JCJM along with the schema tables\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'JCJM' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nARTH, ARCM\n\nTo include JCJM in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to reconcile ap oncost batch lines with original transactions\n\nDatabase Schema:\nCREATE TABLE APTL (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equip bequip,\n  EMGroup bgroup,\n  -- ... 56 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans, APLine)\n);\n\nCREATE TABLE APLB (\n  Co bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  BatchId bbatchid NOT NULL,\n  BatchSeq int NOT NULL,\n  APLine smallint NOT NULL,\n  BatchTransType char(1) NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  -- ... 120 more columns,\n  PRIMARY KEY (Co, Mth, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APHB (\n  Co bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  BatchId bbatchid NOT NULL,\n  BatchSeq int NOT NULL,\n  BatchTransType char(1) NOT NULL,\n  APTrans btrans,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  -- ... 88 more columns,\n  PRIMARY KEY (Co, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To reconcile AP oncost batches with original transactions:\n1. Join APLB (batch lines) to APTL (original lines) using ocApplyMth, ocApplyTrans, ocApplyLine\n2. Include APHB for batch header info\n3. Join to APTH and APVM for vendor context\n4. Compare batch vs original amounts\n\n```sql\nSELECT \n  APLB.Co AS BatchCo,\n  APLB.Mth AS BatchMth,\n  APLB.BatchId,\n  APLB.BatchSeq,\n  APLB.ocApplyMth,\n  APLB.ocApplyTrans,\n  APLB.ocApplyLine,\n  APTL.APCo AS OrigCo,\n  APTL.Mth AS OrigMth,\n  APTL.APTrans AS OrigTrans,\n  APTL.APLine AS OrigLine,\n  APTL.GrossAmt AS OrigAmount,\n  APLB.GrossAmt AS BatchAmount,\n  APVM.Name AS VendorName\nFROM APLB WITH (NOLOCK)\nINNER JOIN APHB WITH (NOLOCK) ON APLB.Co = APHB.Co AND APLB.Mth = APHB.Mth AND APLB.BatchId = APHB.BatchId\nINNER JOIN APTL WITH (NOLOCK) ON APLB.ocApplyMth = APTL.Mth \n  AND APLB.ocApplyTrans = APTL.APTrans \n  AND APLB.ocApplyLine = APTL.APLine\n  AND APLB.Co = APTL.APCo\nINNER JOIN APTH WITH (NOLOCK) ON APTL.APCo = APTH.APCo AND APTL.Mth = APTH.Mth AND APTL.APTrans = APTH.APTrans\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APLB.Co = @Co\nORDER BY APLB.BatchId, APLB.BatchSeq\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APLB",
        "APHB",
        "APTL",
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get data from PREH for analysis\n\nDatabase Schema:\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'PREH' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nSLHD, SLIT\n\nTo include PREH in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get job cost variance by phase comparing budget to actual\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Job cost variance by phase:\n1. Join JCJM (Job Master) to JCCP (Cost Phase)\n2. Calculate variance as CurrEstCost - ActualCost\n3. Calculate percent complete from actuals vs budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  JCCP.Phase,\n  JCCP.CostType,\n  JCCP.OrigEstCost AS OriginalBudget,\n  JCCP.CurrEstCost AS CurrentBudget,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS Variance,\n  CASE WHEN JCCP.CurrEstCost <> 0 \n       THEN (JCCP.ActualCost / JCCP.CurrEstCost) * 100 \n       ELSE 0 END AS PercentComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.Job = @Job\nORDER BY JCCP.Phase, JCCP.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from SLHD\n\nDatabase Schema:\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from SLHD ().\n\n```sql\nSELECT *\nFROM SLHD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "SLHD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from PRTD\n\nDatabase Schema:\nCREATE TABLE PRTD (\n  PRCo bcompany NOT NULL,\n  Craft bcraft NOT NULL,\n  Class bclass NOT NULL,\n  Template smallint NOT NULL,\n  DLCode bedlcode NOT NULL,\n  Factor brate NOT NULL,\n  OldRate bunitcost NOT NULL,\n  NewRate bunitcost NOT NULL,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from PRTD ().\n\n```sql\nSELECT *\nFROM PRTD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "PRTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How do I reconcile ap oncost batch lines with original transactions\n\nDatabase Schema:\nCREATE TABLE APTL (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equip bequip,\n  EMGroup bgroup,\n  -- ... 56 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans, APLine)\n);\n\nCREATE TABLE APLB (\n  Co bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  BatchId bbatchid NOT NULL,\n  BatchSeq int NOT NULL,\n  APLine smallint NOT NULL,\n  BatchTransType char(1) NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  -- ... 120 more columns,\n  PRIMARY KEY (Co, Mth, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APHB (\n  Co bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  BatchId bbatchid NOT NULL,\n  BatchSeq int NOT NULL,\n  BatchTransType char(1) NOT NULL,\n  APTrans btrans,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  -- ... 88 more columns,\n  PRIMARY KEY (Co, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To reconcile AP oncost batches with original transactions:\n1. Join APLB (batch lines) to APTL (original lines) using ocApplyMth, ocApplyTrans, ocApplyLine\n2. Include APHB for batch header info\n3. Join to APTH and APVM for vendor context\n4. Compare batch vs original amounts\n\n```sql\nSELECT \n  APLB.Co AS BatchCo,\n  APLB.Mth AS BatchMth,\n  APLB.BatchId,\n  APLB.BatchSeq,\n  APLB.ocApplyMth,\n  APLB.ocApplyTrans,\n  APLB.ocApplyLine,\n  APTL.APCo AS OrigCo,\n  APTL.Mth AS OrigMth,\n  APTL.APTrans AS OrigTrans,\n  APTL.APLine AS OrigLine,\n  APTL.GrossAmt AS OrigAmount,\n  APLB.GrossAmt AS BatchAmount,\n  APVM.Name AS VendorName\nFROM APLB WITH (NOLOCK)\nINNER JOIN APHB WITH (NOLOCK) ON APLB.Co = APHB.Co AND APLB.Mth = APHB.Mth AND APLB.BatchId = APHB.BatchId\nINNER JOIN APTL WITH (NOLOCK) ON APLB.ocApplyMth = APTL.Mth \n  AND APLB.ocApplyTrans = APTL.APTrans \n  AND APLB.ocApplyLine = APTL.APLine\n  AND APLB.Co = APTL.APCo\nINNER JOIN APTH WITH (NOLOCK) ON APTL.APCo = APTH.APCo AND APTL.Mth = APTH.Mth AND APTL.APTrans = APTH.APTrans\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APLB.Co = @Co\nORDER BY APLB.BatchId, APLB.BatchSeq\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APLB",
        "APHB",
        "APTL",
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoice totals with discounts and retainage\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Vendor invoice summary with discounts and retainage:\n1. Join APTH to APVM for vendor details\n2. Aggregate by vendor\n3. Include GrossAmt, DiscOffer, Retainage, and Balance\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(APTH.APTrans) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS GrossAmount,\n  SUM(APTH.DiscOffer) AS DiscountsOffered,\n  SUM(APTH.Retainage) AS RetainageHeld,\n  SUM(APTH.Balance) AS OpenBalance\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find jobs over budget with remaining cost projection\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Find jobs over budget:\n1. Aggregate JCCP by job from JCJM\n2. Compare total ActualCost to CurrEstCost\n3. Use HAVING to filter only over-budget jobs\n4. Sort by amount over budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description,\n  SUM(JCCP.CurrEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.CurrEstCost) - SUM(JCCP.ActualCost) AS RemainingBudget,\n  CASE WHEN SUM(JCCP.CurrEstCost) < SUM(JCCP.ActualCost) \n       THEN 'OVER BUDGET' ELSE 'OK' END AS Status\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\nGROUP BY JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.CurrEstCost)\nORDER BY (SUM(JCCP.ActualCost) - SUM(JCCP.CurrEstCost)) DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCJM",
        "JCCD",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: count records in gldt by company\n\nDatabase Schema:\nCREATE TABLE GLDT (\n  GLCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  GLTrans btrans NOT NULL,\n  GLAcct bglacct NOT NULL,\n  Jrnl bjrnl NOT NULL,\n  GLRef bglref NOT NULL,\n  SourceCo bcompany NOT NULL,\n  Source bsource NOT NULL,\n  ActDate bdate NOT NULL,\n  DatePosted bdate NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid NOT NULL,\n  Amount bdollar NOT NULL,\n  RevStatus tinyint NOT NULL,\n  Adjust char(1) NOT NULL,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  UniqueAttchID uniqueidentifier,\n  SrcTable varchar(128),\n  SrcKeyID bigint,\n  PRIMARY KEY (GLCo, Mth, GLTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count GLDT records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM GLDT WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "GLDT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get customer balance summary by customer group\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Customer balance summary by group:\n1. Join ARTH to ARCM for customer details\n2. Use conditional SUM for open vs total balances\n3. Group by CustGroup for summary\n\n```sql\nSELECT \n  ARTH.CustGroup,\n  COUNT(DISTINCT ARTH.Customer) AS CustomerCount,\n  SUM(CASE WHEN ARTH.PayFullDate IS NULL THEN ARTH.Amount ELSE 0 END) AS OpenBalance,\n  SUM(ARTH.Amount) AS TotalBilled\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\nGROUP BY ARTH.CustGroup\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Include JCJM in the query\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'JCJM' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nARTH, ARCM\n\nTo include JCJM in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging buckets (30/60/90+ days) for unpaid invoices by customer\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Use ARTH for transaction data and ARCM for customer names\n2. Filter PayFullDate IS NULL to get only unpaid invoices\n3. Use DATEDIFF and CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need to count records in preh by company\n\nDatabase Schema:\nCREATE TABLE PREH (\n  PRCo bcompany NOT NULL,\n  Employee bemployee NOT NULL,\n  LastName varchar(30) NOT NULL,\n  FirstName varchar(30),\n  MidName varchar(15),\n  SortName bsortname NOT NULL,\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  Phone bphone,\n  SSN char(11) NOT NULL,\n  Race char(2) NOT NULL,\n  Sex char(1) NOT NULL,\n  BirthDate smalldatetime,\n  HireDate bdate,\n  TermDate bdate,\n  PRGroup bgroup NOT NULL,\n  PRDept bdept NOT NULL,\n  -- ... 121 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count PREH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM PREH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "PREH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query to count records in arth by company\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count ARTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM ARTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: List all fields in Employee\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'Employee' does not exist in Viewpoint Vista.\n\nUse PREH (PR Employee Header) for employee information.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM PREH WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: track ap hold status distinguishing retainage vs non-retainage holds\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APCO (\n  APCo bcompany NOT NULL,\n  GLCo bcompany NOT NULL,\n  ExpJrnl bjrnl,\n  GLExpInterfaceLvl tinyint NOT NULL,\n  GLExpSummaryDesc varchar(60),\n  GLExpTransDesc varchar(60),\n  GLJobDetailDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLEquipDetailDesc varchar(60),\n  GLExpDetailDesc varchar(60),\n  PayJrnl bjrnl,\n  GLPayInterfaceLvl tinyint NOT NULL,\n  GLPayDetailDesc varchar(60),\n  GLPaySummaryDesc varchar(60),\n  DiscOffGLAcct bglacct,\n  DiscTakenGLAcct bglacct,\n  ExpPayType tinyint,\n  JobPayType tinyint,\n  SubPayType tinyint,\n  RetPayType tinyint,\n  -- ... 92 more columns,\n  PRIMARY KEY (APCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To distinguish retainage vs non-retainage holds:\n1. Join APTD to APHD for hold details\n2. Join APCO to get RetHoldCode setting\n3. Compare APHD.HoldCode to APCO.RetHoldCode\n4. If equal, it's a retainage hold; otherwise non-retainage\n\n```sql\nSELECT \n  APTD.APCo,\n  APTD.Vendor,\n  APTD.Mth,\n  APTD.APTrans,\n  APHD.HoldCode,\n  CASE WHEN APHD.HoldCode = APCO.RetHoldCode \n       THEN 'Retainage Hold' \n       ELSE 'Non-Retainage Hold' END AS HoldType,\n  APTD.Amount\nFROM APTD WITH (NOLOCK)\nINNER JOIN APHD WITH (NOLOCK) ON APTD.APCo = APHD.APCo \n  AND APTD.Mth = APHD.Mth \n  AND APTD.APTrans = APHD.APTrans \n  AND APTD.APLine = APHD.APLine\nINNER JOIN APCO WITH (NOLOCK) ON APTD.APCo = APCO.APCo\nWHERE APTD.APCo = @APCo\n  AND APHD.HoldCode IS NOT NULL\nORDER BY APTD.Vendor, APTD.Mth\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTD",
        "APHD",
        "APCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from JCCD\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from JCCD ().\n\n```sql\nSELECT *\nFROM JCCD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How do I aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from JCCD\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from JCCD ().\n\n```sql\nSELECT *\nFROM JCCD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate stored materials (Purchased - Installed) for SL billing\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Stored materials for SL billing:\n1. SLWI contains work item/billing details\n2. StoredMatls = Purchased - Installed (materials on-site but not yet used)\n3. WCCost = Work Completed Cost\n4. WCRetAmt and SMRetAmt = separate retainage for work vs materials\n5. Total billable = WCCost + StoredMatls\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description AS ItemDescription,\n  SLWI.StoredMatls,\n  SLWI.WCCost AS WorkCompletedCost,\n  SLWI.StoredMatls + SLWI.WCCost AS TotalBillable,\n  SLWI.WCRetAmt AS WorkRetainage,\n  SLWI.SMRetAmt AS MaterialsRetainage,\n  SLWI.WCRetAmt + SLWI.SMRetAmt AS TotalRetainage\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\n  AND SLWI.StoredMatls <> 0\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "basic",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to join JCJM with the available tables\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'JCJM' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nARTH, ARCM\n\nTo include JCJM in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to count records in gljr by company\n\nDatabase Schema:\nCREATE TABLE GLJR (\n  GLCo bcompany NOT NULL,\n  Jrnl bjrnl NOT NULL,\n  Description btransdesc,\n  Rev byn NOT NULL,\n  RevJrnl bjrnl,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count GLJR records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM GLJR WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "GLJR"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get job cost variance by phase comparing budget to actual\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Job cost variance by phase:\n1. Join JCJM (Job Master) to JCCP (Cost Phase)\n2. Calculate variance as CurrEstCost - ActualCost\n3. Calculate percent complete from actuals vs budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  JCCP.Phase,\n  JCCP.CostType,\n  JCCP.OrigEstCost AS OriginalBudget,\n  JCCP.CurrEstCost AS CurrentBudget,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS Variance,\n  CASE WHEN JCCP.CurrEstCost <> 0 \n       THEN (JCCP.ActualCost / JCCP.CurrEstCost) * 100 \n       ELSE 0 END AS PercentComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.Job = @Job\nORDER BY JCCP.Phase, JCCP.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging buckets (30/60/90+ days) for unpaid invoices by customer\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Use ARTH for transaction data and ARCM for customer names\n2. Filter PayFullDate IS NULL to get only unpaid invoices\n3. Use DATEDIFF and CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query to count records in jccd by company\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count JCCD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM JCCD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to track ap hold status distinguishing retainage vs non-retainage holds\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APCO (\n  APCo bcompany NOT NULL,\n  GLCo bcompany NOT NULL,\n  ExpJrnl bjrnl,\n  GLExpInterfaceLvl tinyint NOT NULL,\n  GLExpSummaryDesc varchar(60),\n  GLExpTransDesc varchar(60),\n  GLJobDetailDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLEquipDetailDesc varchar(60),\n  GLExpDetailDesc varchar(60),\n  PayJrnl bjrnl,\n  GLPayInterfaceLvl tinyint NOT NULL,\n  GLPayDetailDesc varchar(60),\n  GLPaySummaryDesc varchar(60),\n  DiscOffGLAcct bglacct,\n  DiscTakenGLAcct bglacct,\n  ExpPayType tinyint,\n  JobPayType tinyint,\n  SubPayType tinyint,\n  RetPayType tinyint,\n  -- ... 92 more columns,\n  PRIMARY KEY (APCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To distinguish retainage vs non-retainage holds:\n1. Join APTD to APHD for hold details\n2. Join APCO to get RetHoldCode setting\n3. Compare APHD.HoldCode to APCO.RetHoldCode\n4. If equal, it's a retainage hold; otherwise non-retainage\n\n```sql\nSELECT \n  APTD.APCo,\n  APTD.Vendor,\n  APTD.Mth,\n  APTD.APTrans,\n  APHD.HoldCode,\n  CASE WHEN APHD.HoldCode = APCO.RetHoldCode \n       THEN 'Retainage Hold' \n       ELSE 'Non-Retainage Hold' END AS HoldType,\n  APTD.Amount\nFROM APTD WITH (NOLOCK)\nINNER JOIN APHD WITH (NOLOCK) ON APTD.APCo = APHD.APCo \n  AND APTD.Mth = APHD.Mth \n  AND APTD.APTrans = APHD.APTrans \n  AND APTD.APLine = APHD.APLine\nINNER JOIN APCO WITH (NOLOCK) ON APTD.APCo = APCO.APCo\nWHERE APTD.APCo = @APCo\n  AND APHD.HoldCode IS NOT NULL\nORDER BY APTD.Vendor, APTD.Mth\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "basic",
      "tables_used": [
        "APTD",
        "APHD",
        "APCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: count records in slhd by company\n\nDatabase Schema:\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count SLHD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM SLHD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "SLHD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from SLWI\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from SLWI ().\n\n```sql\nSELECT *\nFROM SLWI WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "SLWI"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from ARTH\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from ARTH ().\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need to count records in aptd by company\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count APTD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM APTD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate stored materials (Purchased - Installed) for SL billing\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Stored materials for SL billing:\n1. SLWI contains work item/billing details\n2. StoredMatls = Purchased - Installed (materials on-site but not yet used)\n3. WCCost = Work Completed Cost\n4. WCRetAmt and SMRetAmt = separate retainage for work vs materials\n5. Total billable = WCCost + StoredMatls\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description AS ItemDescription,\n  SLWI.StoredMatls,\n  SLWI.WCCost AS WorkCompletedCost,\n  SLWI.StoredMatls + SLWI.WCCost AS TotalBillable,\n  SLWI.WCRetAmt AS WorkRetainage,\n  SLWI.SMRetAmt AS MaterialsRetainage,\n  SLWI.WCRetAmt + SLWI.SMRetAmt AS TotalRetainage\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\n  AND SLWI.StoredMatls <> 0\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to track ap hold status distinguishing retainage vs non-retainage holds\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APCO (\n  APCo bcompany NOT NULL,\n  GLCo bcompany NOT NULL,\n  ExpJrnl bjrnl,\n  GLExpInterfaceLvl tinyint NOT NULL,\n  GLExpSummaryDesc varchar(60),\n  GLExpTransDesc varchar(60),\n  GLJobDetailDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLEquipDetailDesc varchar(60),\n  GLExpDetailDesc varchar(60),\n  PayJrnl bjrnl,\n  GLPayInterfaceLvl tinyint NOT NULL,\n  GLPayDetailDesc varchar(60),\n  GLPaySummaryDesc varchar(60),\n  DiscOffGLAcct bglacct,\n  DiscTakenGLAcct bglacct,\n  ExpPayType tinyint,\n  JobPayType tinyint,\n  SubPayType tinyint,\n  RetPayType tinyint,\n  -- ... 92 more columns,\n  PRIMARY KEY (APCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To distinguish retainage vs non-retainage holds:\n1. Join APTD to APHD for hold details\n2. Join APCO to get RetHoldCode setting\n3. Compare APHD.HoldCode to APCO.RetHoldCode\n4. If equal, it's a retainage hold; otherwise non-retainage\n\n```sql\nSELECT \n  APTD.APCo,\n  APTD.Vendor,\n  APTD.Mth,\n  APTD.APTrans,\n  APHD.HoldCode,\n  CASE WHEN APHD.HoldCode = APCO.RetHoldCode \n       THEN 'Retainage Hold' \n       ELSE 'Non-Retainage Hold' END AS HoldType,\n  APTD.Amount\nFROM APTD WITH (NOLOCK)\nINNER JOIN APHD WITH (NOLOCK) ON APTD.APCo = APHD.APCo \n  AND APTD.Mth = APHD.Mth \n  AND APTD.APTrans = APHD.APTrans \n  AND APTD.APLine = APHD.APLine\nINNER JOIN APCO WITH (NOLOCK) ON APTD.APCo = APCO.APCo\nWHERE APTD.APCo = @APCo\n  AND APHD.HoldCode IS NOT NULL\nORDER BY APTD.Vendor, APTD.Mth\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTD",
        "APHD",
        "APCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get data from PREH for analysis\n\nDatabase Schema:\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'PREH' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nSLHD, SLIT\n\nTo include PREH in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How do I aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from JCCD\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from JCCD ().\n\n```sql\nSELECT *\nFROM JCCD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: count records in jccd by company\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count JCCD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM JCCD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query to count records in jccd by company\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count JCCD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM JCCD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to track ap hold status distinguishing retainage vs non-retainage holds\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APCO (\n  APCo bcompany NOT NULL,\n  GLCo bcompany NOT NULL,\n  ExpJrnl bjrnl,\n  GLExpInterfaceLvl tinyint NOT NULL,\n  GLExpSummaryDesc varchar(60),\n  GLExpTransDesc varchar(60),\n  GLJobDetailDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLEquipDetailDesc varchar(60),\n  GLExpDetailDesc varchar(60),\n  PayJrnl bjrnl,\n  GLPayInterfaceLvl tinyint NOT NULL,\n  GLPayDetailDesc varchar(60),\n  GLPaySummaryDesc varchar(60),\n  DiscOffGLAcct bglacct,\n  DiscTakenGLAcct bglacct,\n  ExpPayType tinyint,\n  JobPayType tinyint,\n  SubPayType tinyint,\n  RetPayType tinyint,\n  -- ... 92 more columns,\n  PRIMARY KEY (APCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To distinguish retainage vs non-retainage holds:\n1. Join APTD to APHD for hold details\n2. Join APCO to get RetHoldCode setting\n3. Compare APHD.HoldCode to APCO.RetHoldCode\n4. If equal, it's a retainage hold; otherwise non-retainage\n\n```sql\nSELECT \n  APTD.APCo,\n  APTD.Vendor,\n  APTD.Mth,\n  APTD.APTrans,\n  APHD.HoldCode,\n  CASE WHEN APHD.HoldCode = APCO.RetHoldCode \n       THEN 'Retainage Hold' \n       ELSE 'Non-Retainage Hold' END AS HoldType,\n  APTD.Amount\nFROM APTD WITH (NOLOCK)\nINNER JOIN APHD WITH (NOLOCK) ON APTD.APCo = APHD.APCo \n  AND APTD.Mth = APHD.Mth \n  AND APTD.APTrans = APHD.APTrans \n  AND APTD.APLine = APHD.APLine\nINNER JOIN APCO WITH (NOLOCK) ON APTD.APCo = APCO.APCo\nWHERE APTD.APCo = @APCo\n  AND APHD.HoldCode IS NOT NULL\nORDER BY APTD.Vendor, APTD.Mth\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTD",
        "APHD",
        "APCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoice totals with discounts and retainage\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Vendor invoice summary with discounts and retainage:\n1. Join APTH to APVM for vendor details\n2. Aggregate by vendor\n3. Include GrossAmt, DiscOffer, Retainage, and Balance\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(APTH.APTrans) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS GrossAmount,\n  SUM(APTH.DiscOffer) AS DiscountsOffered,\n  SUM(APTH.Retainage) AS RetainageHeld,\n  SUM(APTH.Balance) AS OpenBalance\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from ARTH\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from ARTH ().\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from SLWI\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from SLWI ().\n\n```sql\nSELECT *\nFROM SLWI WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "SLWI"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How do I track ap hold status distinguishing retainage vs non-retainage holds\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APCO (\n  APCo bcompany NOT NULL,\n  GLCo bcompany NOT NULL,\n  ExpJrnl bjrnl,\n  GLExpInterfaceLvl tinyint NOT NULL,\n  GLExpSummaryDesc varchar(60),\n  GLExpTransDesc varchar(60),\n  GLJobDetailDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLEquipDetailDesc varchar(60),\n  GLExpDetailDesc varchar(60),\n  PayJrnl bjrnl,\n  GLPayInterfaceLvl tinyint NOT NULL,\n  GLPayDetailDesc varchar(60),\n  GLPaySummaryDesc varchar(60),\n  DiscOffGLAcct bglacct,\n  DiscTakenGLAcct bglacct,\n  ExpPayType tinyint,\n  JobPayType tinyint,\n  SubPayType tinyint,\n  RetPayType tinyint,\n  -- ... 92 more columns,\n  PRIMARY KEY (APCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To distinguish retainage vs non-retainage holds:\n1. Join APTD to APHD for hold details\n2. Join APCO to get RetHoldCode setting\n3. Compare APHD.HoldCode to APCO.RetHoldCode\n4. If equal, it's a retainage hold; otherwise non-retainage\n\n```sql\nSELECT \n  APTD.APCo,\n  APTD.Vendor,\n  APTD.Mth,\n  APTD.APTrans,\n  APHD.HoldCode,\n  CASE WHEN APHD.HoldCode = APCO.RetHoldCode \n       THEN 'Retainage Hold' \n       ELSE 'Non-Retainage Hold' END AS HoldType,\n  APTD.Amount\nFROM APTD WITH (NOLOCK)\nINNER JOIN APHD WITH (NOLOCK) ON APTD.APCo = APHD.APCo \n  AND APTD.Mth = APHD.Mth \n  AND APTD.APTrans = APHD.APTrans \n  AND APTD.APLine = APHD.APLine\nINNER JOIN APCO WITH (NOLOCK) ON APTD.APCo = APCO.APCo\nWHERE APTD.APCo = @APCo\n  AND APHD.HoldCode IS NOT NULL\nORDER BY APTD.Vendor, APTD.Mth\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "basic",
      "tables_used": [
        "APTD",
        "APHD",
        "APCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get job cost variance by phase comparing budget to actual\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Job cost variance by phase:\n1. Join JCJM (Job Master) to JCCP (Cost Phase)\n2. Calculate variance as CurrEstCost - ActualCost\n3. Calculate percent complete from actuals vs budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  JCCP.Phase,\n  JCCP.CostType,\n  JCCP.OrigEstCost AS OriginalBudget,\n  JCCP.CurrEstCost AS CurrentBudget,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS Variance,\n  CASE WHEN JCCP.CurrEstCost <> 0 \n       THEN (JCCP.ActualCost / JCCP.CurrEstCost) * 100 \n       ELSE 0 END AS PercentComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.Job = @Job\nORDER BY JCCP.Phase, JCCP.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoice totals with discounts and retainage\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Vendor invoice summary with discounts and retainage:\n1. Join APTH to APVM for vendor details\n2. Aggregate by vendor\n3. Include GrossAmt, DiscOffer, Retainage, and Balance\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(APTH.APTrans) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS GrossAmount,\n  SUM(APTH.DiscOffer) AS DiscountsOffered,\n  SUM(APTH.Retainage) AS RetainageHeld,\n  SUM(APTH.Balance) AS OpenBalance\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "basic",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging with customer contact information\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I can partially answer this query, but the schema is incomplete.\n\nThe query requires ARCM (AR Customer Master) for customer details, but only ARTH is provided in the schema.\n\nHere's what I can provide with the available schema:\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n-- Note: Additional joins for ARCM would be needed for complete results\n```\n\nTo get the complete data you requested, please provide the DDL for ARCM.",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Query JCJM along with the schema tables\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'JCJM' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nARTH, ARCM\n\nTo include JCJM in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoices with their subcontract details\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I can partially answer this query, but the schema is incomplete.\n\nTo include subcontract details, the SLHD table is needed but not provided in the schema.\n\nHere's what I can provide with the available schema:\n\n```sql\nSELECT *\nFROM APTH WITH (NOLOCK)\nWHERE Co = @Co\n-- Note: Additional joins for SLHD would be needed for complete results\n```\n\nTo get the complete data you requested, please provide the DDL for SLHD.",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": [
        "APTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to track ap hold status distinguishing retainage vs non-retainage holds\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APCO (\n  APCo bcompany NOT NULL,\n  GLCo bcompany NOT NULL,\n  ExpJrnl bjrnl,\n  GLExpInterfaceLvl tinyint NOT NULL,\n  GLExpSummaryDesc varchar(60),\n  GLExpTransDesc varchar(60),\n  GLJobDetailDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLEquipDetailDesc varchar(60),\n  GLExpDetailDesc varchar(60),\n  PayJrnl bjrnl,\n  GLPayInterfaceLvl tinyint NOT NULL,\n  GLPayDetailDesc varchar(60),\n  GLPaySummaryDesc varchar(60),\n  DiscOffGLAcct bglacct,\n  DiscTakenGLAcct bglacct,\n  ExpPayType tinyint,\n  JobPayType tinyint,\n  SubPayType tinyint,\n  RetPayType tinyint,\n  -- ... 92 more columns,\n  PRIMARY KEY (APCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To distinguish retainage vs non-retainage holds:\n1. Join APTD to APHD for hold details\n2. Join APCO to get RetHoldCode setting\n3. Compare APHD.HoldCode to APCO.RetHoldCode\n4. If equal, it's a retainage hold; otherwise non-retainage\n\n```sql\nSELECT \n  APTD.APCo,\n  APTD.Vendor,\n  APTD.Mth,\n  APTD.APTrans,\n  APHD.HoldCode,\n  CASE WHEN APHD.HoldCode = APCO.RetHoldCode \n       THEN 'Retainage Hold' \n       ELSE 'Non-Retainage Hold' END AS HoldType,\n  APTD.Amount\nFROM APTD WITH (NOLOCK)\nINNER JOIN APHD WITH (NOLOCK) ON APTD.APCo = APHD.APCo \n  AND APTD.Mth = APHD.Mth \n  AND APTD.APTrans = APHD.APTrans \n  AND APTD.APLine = APHD.APLine\nINNER JOIN APCO WITH (NOLOCK) ON APTD.APCo = APCO.APCo\nWHERE APTD.APCo = @APCo\n  AND APHD.HoldCode IS NOT NULL\nORDER BY APTD.Vendor, APTD.Mth\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTD",
        "APHD",
        "APCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate stored materials (Purchased - Installed) for SL billing\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Stored materials for SL billing:\n1. SLWI contains work item/billing details\n2. StoredMatls = Purchased - Installed (materials on-site but not yet used)\n3. WCCost = Work Completed Cost\n4. WCRetAmt and SMRetAmt = separate retainage for work vs materials\n5. Total billable = WCCost + StoredMatls\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description AS ItemDescription,\n  SLWI.StoredMatls,\n  SLWI.WCCost AS WorkCompletedCost,\n  SLWI.StoredMatls + SLWI.WCCost AS TotalBillable,\n  SLWI.WCRetAmt AS WorkRetainage,\n  SLWI.SMRetAmt AS MaterialsRetainage,\n  SLWI.WCRetAmt + SLWI.SMRetAmt AS TotalRetainage\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\n  AND SLWI.StoredMatls <> 0\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How do I reconcile ap oncost batch lines with original transactions\n\nDatabase Schema:\nCREATE TABLE APTL (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equip bequip,\n  EMGroup bgroup,\n  -- ... 56 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans, APLine)\n);\n\nCREATE TABLE APLB (\n  Co bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  BatchId bbatchid NOT NULL,\n  BatchSeq int NOT NULL,\n  APLine smallint NOT NULL,\n  BatchTransType char(1) NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  -- ... 120 more columns,\n  PRIMARY KEY (Co, Mth, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APHB (\n  Co bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  BatchId bbatchid NOT NULL,\n  BatchSeq int NOT NULL,\n  BatchTransType char(1) NOT NULL,\n  APTrans btrans,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  -- ... 88 more columns,\n  PRIMARY KEY (Co, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To reconcile AP oncost batches with original transactions:\n1. Join APLB (batch lines) to APTL (original lines) using ocApplyMth, ocApplyTrans, ocApplyLine\n2. Include APHB for batch header info\n3. Join to APTH and APVM for vendor context\n4. Compare batch vs original amounts\n\n```sql\nSELECT \n  APLB.Co AS BatchCo,\n  APLB.Mth AS BatchMth,\n  APLB.BatchId,\n  APLB.BatchSeq,\n  APLB.ocApplyMth,\n  APLB.ocApplyTrans,\n  APLB.ocApplyLine,\n  APTL.APCo AS OrigCo,\n  APTL.Mth AS OrigMth,\n  APTL.APTrans AS OrigTrans,\n  APTL.APLine AS OrigLine,\n  APTL.GrossAmt AS OrigAmount,\n  APLB.GrossAmt AS BatchAmount,\n  APVM.Name AS VendorName\nFROM APLB WITH (NOLOCK)\nINNER JOIN APHB WITH (NOLOCK) ON APLB.Co = APHB.Co AND APLB.Mth = APHB.Mth AND APLB.BatchId = APHB.BatchId\nINNER JOIN APTL WITH (NOLOCK) ON APLB.ocApplyMth = APTL.Mth \n  AND APLB.ocApplyTrans = APTL.APTrans \n  AND APLB.ocApplyLine = APTL.APLine\n  AND APLB.Co = APTL.APCo\nINNER JOIN APTH WITH (NOLOCK) ON APTL.APCo = APTH.APCo AND APTL.Mth = APTH.Mth AND APTL.APTrans = APTH.APTrans\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APLB.Co = @Co\nORDER BY APLB.BatchId, APLB.BatchSeq\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "basic",
      "tables_used": [
        "APLB",
        "APHB",
        "APTL",
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find jobs over budget with remaining cost projection\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Find jobs over budget:\n1. Aggregate JCCP by job from JCJM\n2. Compare total ActualCost to CurrEstCost\n3. Use HAVING to filter only over-budget jobs\n4. Sort by amount over budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description,\n  SUM(JCCP.CurrEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.CurrEstCost) - SUM(JCCP.ActualCost) AS RemainingBudget,\n  CASE WHEN SUM(JCCP.CurrEstCost) < SUM(JCCP.ActualCost) \n       THEN 'OVER BUDGET' ELSE 'OK' END AS Status\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\nGROUP BY JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.CurrEstCost)\nORDER BY (SUM(JCCP.ActualCost) - SUM(JCCP.CurrEstCost)) DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM",
        "JCCD",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from SLHD\n\nDatabase Schema:\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from SLHD ().\n\n```sql\nSELECT *\nFROM SLHD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "SLHD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging buckets (30/60/90+ days) for unpaid invoices by customer\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Use ARTH for transaction data and ARCM for customer names\n2. Filter PayFullDate IS NULL to get only unpaid invoices\n3. Use DATEDIFF and CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need to count records in apth by company\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count APTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM APTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from GLCO\n\nDatabase Schema:\nCREATE TABLE GLCO (\n  GLCo bcompany NOT NULL,\n  Consolid byn NOT NULL,\n  LastMthSubClsd bmonth NOT NULL,\n  LastMthGLClsd bmonth NOT NULL,\n  MaxOpen tinyint NOT NULL,\n  CashAccrual char(1) NOT NULL,\n  Unbal byn NOT NULL,\n  AuditCoParams byn NOT NULL,\n  AuditAccts byn NOT NULL,\n  AuditAutoJrnl byn NOT NULL,\n  AuditBals byn NOT NULL,\n  AuditBudgets byn NOT NULL,\n  AuditDetail byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  XCompJrnlEntryYN byn NOT NULL,\n  KeyID bigint NOT NULL,\n  LastMthAPClsd bmonth NOT NULL,\n  LastMthARClsd bmonth NOT NULL,\n  AttachBatchReportsYN byn NOT NULL,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from GLCO ().\n\n```sql\nSELECT *\nFROM GLCO WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "GLCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Query GLDT along with the schema tables\n\nDatabase Schema:\nCREATE TABLE PREH (\n  PRCo bcompany NOT NULL,\n  Employee bemployee NOT NULL,\n  LastName varchar(30) NOT NULL,\n  FirstName varchar(30),\n  MidName varchar(15),\n  SortName bsortname NOT NULL,\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  Phone bphone,\n  SSN char(11) NOT NULL,\n  Race char(2) NOT NULL,\n  Sex char(1) NOT NULL,\n  BirthDate smalldatetime,\n  HireDate bdate,\n  TermDate bdate,\n  PRGroup bgroup NOT NULL,\n  PRDept bdept NOT NULL,\n  -- ... 121 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nCREATE TABLE PRTH (\n  PRCo bcompany NOT NULL,\n  PRGroup bgroup NOT NULL,\n  PREndDate bdate NOT NULL,\n  Employee bemployee NOT NULL,\n  PaySeq tinyint NOT NULL,\n  PostSeq smallint NOT NULL,\n  Type char(1) NOT NULL,\n  PostDate bdate NOT NULL,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCDept bdept,\n  GLCo bcompany NOT NULL,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equipment bequip,\n  EMGroup tinyint,\n  CostCode bcostcode,\n  -- ... 41 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'GLDT' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nPREH, PRTH\n\nTo include GLDT in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate stored materials (Purchased - Installed) for SL billing\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Stored materials for SL billing:\n1. SLWI contains work item/billing details\n2. StoredMatls = Purchased - Installed (materials on-site but not yet used)\n3. WCCost = Work Completed Cost\n4. WCRetAmt and SMRetAmt = separate retainage for work vs materials\n5. Total billable = WCCost + StoredMatls\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description AS ItemDescription,\n  SLWI.StoredMatls,\n  SLWI.WCCost AS WorkCompletedCost,\n  SLWI.StoredMatls + SLWI.WCCost AS TotalBillable,\n  SLWI.WCRetAmt AS WorkRetainage,\n  SLWI.SMRetAmt AS MaterialsRetainage,\n  SLWI.WCRetAmt + SLWI.SMRetAmt AS TotalRetainage\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\n  AND SLWI.StoredMatls <> 0\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "intermediate",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: count records in prtd by company\n\nDatabase Schema:\nCREATE TABLE PRTD (\n  PRCo bcompany NOT NULL,\n  Craft bcraft NOT NULL,\n  Class bclass NOT NULL,\n  Template smallint NOT NULL,\n  DLCode bedlcode NOT NULL,\n  Factor brate NOT NULL,\n  OldRate bunitcost NOT NULL,\n  NewRate bunitcost NOT NULL,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count PRTD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM PRTD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "PRTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get job cost variance by phase comparing budget to actual\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Job cost variance by phase:\n1. Join JCJM (Job Master) to JCCP (Cost Phase)\n2. Calculate variance as CurrEstCost - ActualCost\n3. Calculate percent complete from actuals vs budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  JCCP.Phase,\n  JCCP.CostType,\n  JCCP.OrigEstCost AS OriginalBudget,\n  JCCP.CurrEstCost AS CurrentBudget,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS Variance,\n  CASE WHEN JCCP.CurrEstCost <> 0 \n       THEN (JCCP.ActualCost / JCCP.CurrEstCost) * 100 \n       ELSE 0 END AS PercentComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.Job = @Job\nORDER BY JCCP.Phase, JCCP.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging buckets (30/60/90+ days) for unpaid invoices by customer\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Use ARTH for transaction data and ARCM for customer names\n2. Filter PayFullDate IS NULL to get only unpaid invoices\n3. Use DATEDIFF and CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging buckets (30/60/90+ days) for unpaid invoices by customer\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Use ARTH for transaction data and ARCM for customer names\n2. Filter PayFullDate IS NULL to get only unpaid invoices\n3. Use DATEDIFF and CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from APTD\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from APTD ().\n\n```sql\nSELECT *\nFROM APTD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How do I count records in arth by company\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count ARTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM ARTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoice totals with discounts and retainage\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Vendor invoice summary with discounts and retainage:\n1. Join APTH to APVM for vendor details\n2. Aggregate by vendor\n3. Include GrossAmt, DiscOffer, Retainage, and Balance\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(APTH.APTrans) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS GrossAmount,\n  SUM(APTH.DiscOffer) AS DiscountsOffered,\n  SUM(APTH.Retainage) AS RetainageHeld,\n  SUM(APTH.Balance) AS OpenBalance\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "basic",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get subcontractor costs with original, change orders, invoiced, paid, and retainage by vendor\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Subcontractor cost breakdown by vendor:\n1. Join SLHD (Header) to SLIT (Items) for subcontract details\n2. Join APVM for vendor names\n3. OrigCost = original contract amount\n4. CurCost - OrigCost = change order amounts\n5. InvCost = amounts invoiced\n6. Retainage = amounts held back\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  SLHD.SL AS SubcontractNum,\n  SLHD.Description AS SubcontractDesc,\n  SUM(SLIT.OrigCost) AS OriginalCost,\n  SUM(SLIT.CurCost - SLIT.OrigCost) AS ChangeOrderCost,\n  SUM(SLIT.CurCost) AS CurrentCost,\n  SUM(SLIT.InvCost) AS InvoicedCost,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost - SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nINNER JOIN APVM WITH (NOLOCK) ON SLHD.VendorGroup = APVM.VendorGroup AND SLHD.Vendor = APVM.Vendor\nWHERE SLHD.SLCo = @SLCo\nGROUP BY APVM.Vendor, APVM.Name, SLHD.SL, SLHD.Description\nORDER BY APVM.Name, SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "intermediate",
      "tables_used": [
        "SLHD",
        "SLIT",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate stored materials (Purchased - Installed) for SL billing\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Stored materials for SL billing:\n1. SLWI contains work item/billing details\n2. StoredMatls = Purchased - Installed (materials on-site but not yet used)\n3. WCCost = Work Completed Cost\n4. WCRetAmt and SMRetAmt = separate retainage for work vs materials\n5. Total billable = WCCost + StoredMatls\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description AS ItemDescription,\n  SLWI.StoredMatls,\n  SLWI.WCCost AS WorkCompletedCost,\n  SLWI.StoredMatls + SLWI.WCCost AS TotalBillable,\n  SLWI.WCRetAmt AS WorkRetainage,\n  SLWI.SMRetAmt AS MaterialsRetainage,\n  SLWI.WCRetAmt + SLWI.SMRetAmt AS TotalRetainage\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\n  AND SLWI.StoredMatls <> 0\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "intermediate",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How do I count records in arth by company\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count ARTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM ARTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from ARTH\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from ARTH ().\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get subcontractor costs with original, change orders, invoiced, paid, and retainage by vendor\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Subcontractor cost breakdown by vendor:\n1. Join SLHD (Header) to SLIT (Items) for subcontract details\n2. Join APVM for vendor names\n3. OrigCost = original contract amount\n4. CurCost - OrigCost = change order amounts\n5. InvCost = amounts invoiced\n6. Retainage = amounts held back\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  SLHD.SL AS SubcontractNum,\n  SLHD.Description AS SubcontractDesc,\n  SUM(SLIT.OrigCost) AS OriginalCost,\n  SUM(SLIT.CurCost - SLIT.OrigCost) AS ChangeOrderCost,\n  SUM(SLIT.CurCost) AS CurrentCost,\n  SUM(SLIT.InvCost) AS InvoicedCost,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost - SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nINNER JOIN APVM WITH (NOLOCK) ON SLHD.VendorGroup = APVM.VendorGroup AND SLHD.Vendor = APVM.Vendor\nWHERE SLHD.SLCo = @SLCo\nGROUP BY APVM.Vendor, APVM.Name, SLHD.SL, SLHD.Description\nORDER BY APVM.Name, SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "intermediate",
      "tables_used": [
        "SLHD",
        "SLIT",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find jobs over budget with remaining cost projection\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Find jobs over budget:\n1. Aggregate JCCP by job from JCJM\n2. Compare total ActualCost to CurrEstCost\n3. Use HAVING to filter only over-budget jobs\n4. Sort by amount over budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description,\n  SUM(JCCP.CurrEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.CurrEstCost) - SUM(JCCP.ActualCost) AS RemainingBudget,\n  CASE WHEN SUM(JCCP.CurrEstCost) < SUM(JCCP.ActualCost) \n       THEN 'OVER BUDGET' ELSE 'OK' END AS Status\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\nGROUP BY JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.CurrEstCost)\nORDER BY (SUM(JCCP.ActualCost) - SUM(JCCP.CurrEstCost)) DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM",
        "JCCD",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find all unpaid AR invoices older than 60 days\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find unpaid invoices over 60 days:\n1. Join ARTH to ARCM for customer information\n2. Filter PayFullDate IS NULL (unpaid)\n3. Use DATEDIFF to calculate age and filter > 60 days\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Mth,\n  ARTH.ARTrans,\n  ARCM.Name AS CustomerName,\n  ARTH.TransDate,\n  ARTH.Amount,\n  DATEDIFF(day, ARTH.TransDate, GETDATE()) AS DaysOutstanding\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\n  AND DATEDIFF(day, ARTH.TransDate, GETDATE()) > 60\nORDER BY ARTH.TransDate\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoice totals with discounts and retainage\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Vendor invoice summary with discounts and retainage:\n1. Join APTH to APVM for vendor details\n2. Aggregate by vendor\n3. Include GrossAmt, DiscOffer, Retainage, and Balance\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(APTH.APTrans) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS GrossAmount,\n  SUM(APTH.DiscOffer) AS DiscountsOffered,\n  SUM(APTH.Retainage) AS RetainageHeld,\n  SUM(APTH.Balance) AS OpenBalance\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get subcontractor costs with original, change orders, invoiced, paid, and retainage by vendor\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Subcontractor cost breakdown by vendor:\n1. Join SLHD (Header) to SLIT (Items) for subcontract details\n2. Join APVM for vendor names\n3. OrigCost = original contract amount\n4. CurCost - OrigCost = change order amounts\n5. InvCost = amounts invoiced\n6. Retainage = amounts held back\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  SLHD.SL AS SubcontractNum,\n  SLHD.Description AS SubcontractDesc,\n  SUM(SLIT.OrigCost) AS OriginalCost,\n  SUM(SLIT.CurCost - SLIT.OrigCost) AS ChangeOrderCost,\n  SUM(SLIT.CurCost) AS CurrentCost,\n  SUM(SLIT.InvCost) AS InvoicedCost,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost - SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nINNER JOIN APVM WITH (NOLOCK) ON SLHD.VendorGroup = APVM.VendorGroup AND SLHD.Vendor = APVM.Vendor\nWHERE SLHD.SLCo = @SLCo\nGROUP BY APVM.Vendor, APVM.Name, SLHD.SL, SLHD.Description\nORDER BY APVM.Name, SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "basic",
      "tables_used": [
        "SLHD",
        "SLIT",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How do I count records in jccd by company\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count JCCD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM JCCD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: SELECT * FROM TimeCard\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'TimeCard' does not exist in Viewpoint Vista.\n\nUse PRTH (PR Timecard Header) for timecard information.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM PRTH WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from PRTD\n\nDatabase Schema:\nCREATE TABLE PRTD (\n  PRCo bcompany NOT NULL,\n  Craft bcraft NOT NULL,\n  Class bclass NOT NULL,\n  Template smallint NOT NULL,\n  DLCode bedlcode NOT NULL,\n  Factor brate NOT NULL,\n  OldRate bunitcost NOT NULL,\n  NewRate bunitcost NOT NULL,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from PRTD ().\n\n```sql\nSELECT *\nFROM PRTD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "PRTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoice totals with discounts and retainage\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Vendor invoice summary with discounts and retainage:\n1. Join APTH to APVM for vendor details\n2. Aggregate by vendor\n3. Include GrossAmt, DiscOffer, Retainage, and Balance\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(APTH.APTrans) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS GrossAmount,\n  SUM(APTH.DiscOffer) AS DiscountsOffered,\n  SUM(APTH.Retainage) AS RetainageHeld,\n  SUM(APTH.Balance) AS OpenBalance\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: count records in slwi by company\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count SLWI records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM SLWI WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "SLWI"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from ARTH\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from ARTH ().\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from APTD\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from APTD ().\n\n```sql\nSELECT *\nFROM APTD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get subcontractor costs with original, change orders, invoiced, paid, and retainage by vendor\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Subcontractor cost breakdown by vendor:\n1. Join SLHD (Header) to SLIT (Items) for subcontract details\n2. Join APVM for vendor names\n3. OrigCost = original contract amount\n4. CurCost - OrigCost = change order amounts\n5. InvCost = amounts invoiced\n6. Retainage = amounts held back\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  SLHD.SL AS SubcontractNum,\n  SLHD.Description AS SubcontractDesc,\n  SUM(SLIT.OrigCost) AS OriginalCost,\n  SUM(SLIT.CurCost - SLIT.OrigCost) AS ChangeOrderCost,\n  SUM(SLIT.CurCost) AS CurrentCost,\n  SUM(SLIT.InvCost) AS InvoicedCost,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost - SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nINNER JOIN APVM WITH (NOLOCK) ON SLHD.VendorGroup = APVM.VendorGroup AND SLHD.Vendor = APVM.Vendor\nWHERE SLHD.SLCo = @SLCo\nGROUP BY APVM.Vendor, APVM.Name, SLHD.SL, SLHD.Description\nORDER BY APVM.Name, SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "intermediate",
      "tables_used": [
        "SLHD",
        "SLIT",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Describe the Employee table\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'Employee' does not exist in Viewpoint Vista.\n\nUse PREH (PR Employee Header) for employee information.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM PREH WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from GLCO\n\nDatabase Schema:\nCREATE TABLE GLCO (\n  GLCo bcompany NOT NULL,\n  Consolid byn NOT NULL,\n  LastMthSubClsd bmonth NOT NULL,\n  LastMthGLClsd bmonth NOT NULL,\n  MaxOpen tinyint NOT NULL,\n  CashAccrual char(1) NOT NULL,\n  Unbal byn NOT NULL,\n  AuditCoParams byn NOT NULL,\n  AuditAccts byn NOT NULL,\n  AuditAutoJrnl byn NOT NULL,\n  AuditBals byn NOT NULL,\n  AuditBudgets byn NOT NULL,\n  AuditDetail byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  XCompJrnlEntryYN byn NOT NULL,\n  KeyID bigint NOT NULL,\n  LastMthAPClsd bmonth NOT NULL,\n  LastMthARClsd bmonth NOT NULL,\n  AttachBatchReportsYN byn NOT NULL,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from GLCO ().\n\n```sql\nSELECT *\nFROM GLCO WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "GLCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get job cost variance by phase comparing budget to actual\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Job cost variance by phase:\n1. Join JCJM (Job Master) to JCCP (Cost Phase)\n2. Calculate variance as CurrEstCost - ActualCost\n3. Calculate percent complete from actuals vs budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  JCCP.Phase,\n  JCCP.CostType,\n  JCCP.OrigEstCost AS OriginalBudget,\n  JCCP.CurrEstCost AS CurrentBudget,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS Variance,\n  CASE WHEN JCCP.CurrEstCost <> 0 \n       THEN (JCCP.ActualCost / JCCP.CurrEstCost) * 100 \n       ELSE 0 END AS PercentComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.Job = @Job\nORDER BY JCCP.Phase, JCCP.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoice totals with discounts and retainage\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Vendor invoice summary with discounts and retainage:\n1. Join APTH to APVM for vendor details\n2. Aggregate by vendor\n3. Include GrossAmt, DiscOffer, Retainage, and Balance\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(APTH.APTrans) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS GrossAmount,\n  SUM(APTH.DiscOffer) AS DiscountsOffered,\n  SUM(APTH.Retainage) AS RetainageHeld,\n  SUM(APTH.Balance) AS OpenBalance\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate stored materials (Purchased - Installed) for SL billing\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Stored materials for SL billing:\n1. SLWI contains work item/billing details\n2. StoredMatls = Purchased - Installed (materials on-site but not yet used)\n3. WCCost = Work Completed Cost\n4. WCRetAmt and SMRetAmt = separate retainage for work vs materials\n5. Total billable = WCCost + StoredMatls\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description AS ItemDescription,\n  SLWI.StoredMatls,\n  SLWI.WCCost AS WorkCompletedCost,\n  SLWI.StoredMatls + SLWI.WCCost AS TotalBillable,\n  SLWI.WCRetAmt AS WorkRetainage,\n  SLWI.SMRetAmt AS MaterialsRetainage,\n  SLWI.WCRetAmt + SLWI.SMRetAmt AS TotalRetainage\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\n  AND SLWI.StoredMatls <> 0\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "basic",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from PRTD\n\nDatabase Schema:\nCREATE TABLE PRTD (\n  PRCo bcompany NOT NULL,\n  Craft bcraft NOT NULL,\n  Class bclass NOT NULL,\n  Template smallint NOT NULL,\n  DLCode bedlcode NOT NULL,\n  Factor brate NOT NULL,\n  OldRate bunitcost NOT NULL,\n  NewRate bunitcost NOT NULL,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from PRTD ().\n\n```sql\nSELECT *\nFROM PRTD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "PRTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: What columns are in the ARInvoice table?\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'ARInvoice' does not exist in Viewpoint Vista.\n\nUse ARTH (AR Transaction Header) for AR invoices.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging buckets (30/60/90+ days) for unpaid invoices by customer\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Use ARTH for transaction data and ARCM for customer names\n2. Filter PayFullDate IS NULL to get only unpaid invoices\n3. Use DATEDIFF and CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need to reconcile ap oncost batch lines with original transactions\n\nDatabase Schema:\nCREATE TABLE APTL (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equip bequip,\n  EMGroup bgroup,\n  -- ... 56 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans, APLine)\n);\n\nCREATE TABLE APLB (\n  Co bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  BatchId bbatchid NOT NULL,\n  BatchSeq int NOT NULL,\n  APLine smallint NOT NULL,\n  BatchTransType char(1) NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  -- ... 120 more columns,\n  PRIMARY KEY (Co, Mth, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APHB (\n  Co bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  BatchId bbatchid NOT NULL,\n  BatchSeq int NOT NULL,\n  BatchTransType char(1) NOT NULL,\n  APTrans btrans,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  -- ... 88 more columns,\n  PRIMARY KEY (Co, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To reconcile AP oncost batches with original transactions:\n1. Join APLB (batch lines) to APTL (original lines) using ocApplyMth, ocApplyTrans, ocApplyLine\n2. Include APHB for batch header info\n3. Join to APTH and APVM for vendor context\n4. Compare batch vs original amounts\n\n```sql\nSELECT \n  APLB.Co AS BatchCo,\n  APLB.Mth AS BatchMth,\n  APLB.BatchId,\n  APLB.BatchSeq,\n  APLB.ocApplyMth,\n  APLB.ocApplyTrans,\n  APLB.ocApplyLine,\n  APTL.APCo AS OrigCo,\n  APTL.Mth AS OrigMth,\n  APTL.APTrans AS OrigTrans,\n  APTL.APLine AS OrigLine,\n  APTL.GrossAmt AS OrigAmount,\n  APLB.GrossAmt AS BatchAmount,\n  APVM.Name AS VendorName\nFROM APLB WITH (NOLOCK)\nINNER JOIN APHB WITH (NOLOCK) ON APLB.Co = APHB.Co AND APLB.Mth = APHB.Mth AND APLB.BatchId = APHB.BatchId\nINNER JOIN APTL WITH (NOLOCK) ON APLB.ocApplyMth = APTL.Mth \n  AND APLB.ocApplyTrans = APTL.APTrans \n  AND APLB.ocApplyLine = APTL.APLine\n  AND APLB.Co = APTL.APCo\nINNER JOIN APTH WITH (NOLOCK) ON APTL.APCo = APTH.APCo AND APTL.Mth = APTH.Mth AND APTL.APTrans = APTH.APTrans\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APLB.Co = @Co\nORDER BY APLB.BatchId, APLB.BatchSeq\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APLB",
        "APHB",
        "APTL",
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need to count records in prco by company\n\nDatabase Schema:\nCREATE TABLE PRCO (\n  PRCo bcompany NOT NULL,\n  GLCo bcompany NOT NULL,\n  Jrnl bjrnl,\n  GLInterface byn NOT NULL,\n  CMCo bcompany NOT NULL,\n  APCo bcompany,\n  AutoOT byn NOT NULL,\n  OTEarnCode bedlcode,\n  JCCo bcompany NOT NULL,\n  AllowNoPhase byn NOT NULL,\n  JCInterface byn NOT NULL,\n  InsByPhase byn NOT NULL,\n  JCICraftClass byn NOT NULL,\n  JCICrew byn NOT NULL,\n  JCIEmployee byn NOT NULL,\n  JCIFactor byn NOT NULL,\n  JCIEarnType byn NOT NULL,\n  JCIShift byn NOT NULL,\n  JCIPostingDate byn NOT NULL,\n  JCILiabType byn NOT NULL,\n  -- ... 66 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count PRCO records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM PRCO WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "PRCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoice totals with discounts and retainage\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Vendor invoice summary with discounts and retainage:\n1. Join APTH to APVM for vendor details\n2. Aggregate by vendor\n3. Include GrossAmt, DiscOffer, Retainage, and Balance\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(APTH.APTrans) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS GrossAmount,\n  SUM(APTH.DiscOffer) AS DiscountsOffered,\n  SUM(APTH.Retainage) AS RetainageHeld,\n  SUM(APTH.Balance) AS OpenBalance\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need to count records in arth by company\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count ARTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM ARTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need to count records in arth by company\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count ARTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM ARTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from PRTH\n\nDatabase Schema:\nCREATE TABLE PRTH (\n  PRCo bcompany NOT NULL,\n  PRGroup bgroup NOT NULL,\n  PREndDate bdate NOT NULL,\n  Employee bemployee NOT NULL,\n  PaySeq tinyint NOT NULL,\n  PostSeq smallint NOT NULL,\n  Type char(1) NOT NULL,\n  PostDate bdate NOT NULL,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCDept bdept,\n  GLCo bcompany NOT NULL,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equipment bequip,\n  EMGroup tinyint,\n  CostCode bcostcode,\n  -- ... 41 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from PRTH ().\n\n```sql\nSELECT *\nFROM PRTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "PRTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging buckets (30/60/90+ days) for unpaid invoices by customer\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Use ARTH for transaction data and ARCM for customer names\n2. Filter PayFullDate IS NULL to get only unpaid invoices\n3. Use DATEDIFF and CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from JCCD\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from JCCD ().\n\n```sql\nSELECT *\nFROM JCCD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to count records in arth by company\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count ARTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM ARTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need to count records in slwi by company\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count SLWI records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM SLWI WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "SLWI"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging with customer contact information\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I can partially answer this query, but the schema is incomplete.\n\nThe query requires ARCM (AR Customer Master) for customer details, but only ARTH is provided in the schema.\n\nHere's what I can provide with the available schema:\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n-- Note: Additional joins for ARCM would be needed for complete results\n```\n\nTo get the complete data you requested, please provide the DDL for ARCM.",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get customer balance summary by customer group\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Customer balance summary by group:\n1. Join ARTH to ARCM for customer details\n2. Use conditional SUM for open vs total balances\n3. Group by CustGroup for summary\n\n```sql\nSELECT \n  ARTH.CustGroup,\n  COUNT(DISTINCT ARTH.Customer) AS CustomerCount,\n  SUM(CASE WHEN ARTH.PayFullDate IS NULL THEN ARTH.Amount ELSE 0 END) AS OpenBalance,\n  SUM(ARTH.Amount) AS TotalBilled\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\nGROUP BY ARTH.CustGroup\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How do I count records in arth by company\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count ARTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM ARTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get job cost variance by phase comparing budget to actual\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Job cost variance by phase:\n1. Join JCJM (Job Master) to JCCP (Cost Phase)\n2. Calculate variance as CurrEstCost - ActualCost\n3. Calculate percent complete from actuals vs budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  JCCP.Phase,\n  JCCP.CostType,\n  JCCP.OrigEstCost AS OriginalBudget,\n  JCCP.CurrEstCost AS CurrentBudget,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS Variance,\n  CASE WHEN JCCP.CurrEstCost <> 0 \n       THEN (JCCP.ActualCost / JCCP.CurrEstCost) * 100 \n       ELSE 0 END AS PercentComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.Job = @Job\nORDER BY JCCP.Phase, JCCP.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find jobs over budget with remaining cost projection\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Find jobs over budget:\n1. Aggregate JCCP by job from JCJM\n2. Compare total ActualCost to CurrEstCost\n3. Use HAVING to filter only over-budget jobs\n4. Sort by amount over budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description,\n  SUM(JCCP.CurrEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.CurrEstCost) - SUM(JCCP.ActualCost) AS RemainingBudget,\n  CASE WHEN SUM(JCCP.CurrEstCost) < SUM(JCCP.ActualCost) \n       THEN 'OVER BUDGET' ELSE 'OK' END AS Status\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\nGROUP BY JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.CurrEstCost)\nORDER BY (SUM(JCCP.ActualCost) - SUM(JCCP.CurrEstCost)) DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCJM",
        "JCCD",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from PREH\n\nDatabase Schema:\nCREATE TABLE PREH (\n  PRCo bcompany NOT NULL,\n  Employee bemployee NOT NULL,\n  LastName varchar(30) NOT NULL,\n  FirstName varchar(30),\n  MidName varchar(15),\n  SortName bsortname NOT NULL,\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  Phone bphone,\n  SSN char(11) NOT NULL,\n  Race char(2) NOT NULL,\n  Sex char(1) NOT NULL,\n  BirthDate smalldatetime,\n  HireDate bdate,\n  TermDate bdate,\n  PRGroup bgroup NOT NULL,\n  PRDept bdept NOT NULL,\n  -- ... 121 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from PREH ().\n\n```sql\nSELECT *\nFROM PREH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "PREH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Join ContractMaster with other tables\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'ContractMaster' does not exist in Viewpoint Vista.\n\nUse JCCM (JC Contract Master) for contract master information.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM JCCM WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get job cost variance by phase comparing budget to actual\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Job cost variance by phase:\n1. Join JCJM (Job Master) to JCCP (Cost Phase)\n2. Calculate variance as CurrEstCost - ActualCost\n3. Calculate percent complete from actuals vs budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  JCCP.Phase,\n  JCCP.CostType,\n  JCCP.OrigEstCost AS OriginalBudget,\n  JCCP.CurrEstCost AS CurrentBudget,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS Variance,\n  CASE WHEN JCCP.CurrEstCost <> 0 \n       THEN (JCCP.ActualCost / JCCP.CurrEstCost) * 100 \n       ELSE 0 END AS PercentComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.Job = @Job\nORDER BY JCCP.Phase, JCCP.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from SLHD\n\nDatabase Schema:\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from SLHD ().\n\n```sql\nSELECT *\nFROM SLHD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "SLHD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from ARTH\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from ARTH ().\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need to count records in glco by company\n\nDatabase Schema:\nCREATE TABLE GLCO (\n  GLCo bcompany NOT NULL,\n  Consolid byn NOT NULL,\n  LastMthSubClsd bmonth NOT NULL,\n  LastMthGLClsd bmonth NOT NULL,\n  MaxOpen tinyint NOT NULL,\n  CashAccrual char(1) NOT NULL,\n  Unbal byn NOT NULL,\n  AuditCoParams byn NOT NULL,\n  AuditAccts byn NOT NULL,\n  AuditAutoJrnl byn NOT NULL,\n  AuditBals byn NOT NULL,\n  AuditBudgets byn NOT NULL,\n  AuditDetail byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  XCompJrnlEntryYN byn NOT NULL,\n  KeyID bigint NOT NULL,\n  LastMthAPClsd bmonth NOT NULL,\n  LastMthARClsd bmonth NOT NULL,\n  AttachBatchReportsYN byn NOT NULL,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count GLCO records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM GLCO WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "GLCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from GLJR\n\nDatabase Schema:\nCREATE TABLE GLJR (\n  GLCo bcompany NOT NULL,\n  Jrnl bjrnl NOT NULL,\n  Description btransdesc,\n  Rev byn NOT NULL,\n  RevJrnl bjrnl,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from GLJR ().\n\n```sql\nSELECT *\nFROM GLJR WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "GLJR"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from PRCO\n\nDatabase Schema:\nCREATE TABLE PRCO (\n  PRCo bcompany NOT NULL,\n  GLCo bcompany NOT NULL,\n  Jrnl bjrnl,\n  GLInterface byn NOT NULL,\n  CMCo bcompany NOT NULL,\n  APCo bcompany,\n  AutoOT byn NOT NULL,\n  OTEarnCode bedlcode,\n  JCCo bcompany NOT NULL,\n  AllowNoPhase byn NOT NULL,\n  JCInterface byn NOT NULL,\n  InsByPhase byn NOT NULL,\n  JCICraftClass byn NOT NULL,\n  JCICrew byn NOT NULL,\n  JCIEmployee byn NOT NULL,\n  JCIFactor byn NOT NULL,\n  JCIEarnType byn NOT NULL,\n  JCIShift byn NOT NULL,\n  JCIPostingDate byn NOT NULL,\n  JCILiabType byn NOT NULL,\n  -- ... 66 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from PRCO ().\n\n```sql\nSELECT *\nFROM PRCO WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "PRCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to join ARCM with the available tables\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'ARCM' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nAPTH, APVM\n\nTo include ARCM in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find jobs over budget with remaining cost projection\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Find jobs over budget:\n1. Aggregate JCCP by job from JCJM\n2. Compare total ActualCost to CurrEstCost\n3. Use HAVING to filter only over-budget jobs\n4. Sort by amount over budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description,\n  SUM(JCCP.CurrEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.CurrEstCost) - SUM(JCCP.ActualCost) AS RemainingBudget,\n  CASE WHEN SUM(JCCP.CurrEstCost) < SUM(JCCP.ActualCost) \n       THEN 'OVER BUDGET' ELSE 'OK' END AS Status\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\nGROUP BY JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.CurrEstCost)\nORDER BY (SUM(JCCP.ActualCost) - SUM(JCCP.CurrEstCost)) DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM",
        "JCCD",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get customer balance summary by customer group\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Customer balance summary by group:\n1. Join ARTH to ARCM for customer details\n2. Use conditional SUM for open vs total balances\n3. Group by CustGroup for summary\n\n```sql\nSELECT \n  ARTH.CustGroup,\n  COUNT(DISTINCT ARTH.Customer) AS CustomerCount,\n  SUM(CASE WHEN ARTH.PayFullDate IS NULL THEN ARTH.Amount ELSE 0 END) AS OpenBalance,\n  SUM(ARTH.Amount) AS TotalBilled\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\nGROUP BY ARTH.CustGroup\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from APTD\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from APTD ().\n\n```sql\nSELECT *\nFROM APTD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging buckets (30/60/90+ days) for unpaid invoices by customer\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Use ARTH for transaction data and ARCM for customer names\n2. Filter PayFullDate IS NULL to get only unpaid invoices\n3. Use DATEDIFF and CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: count records in arth by company\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count ARTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM ARTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoice totals with discounts and retainage\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Vendor invoice summary with discounts and retainage:\n1. Join APTH to APVM for vendor details\n2. Aggregate by vendor\n3. Include GrossAmt, DiscOffer, Retainage, and Balance\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(APTH.APTrans) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS GrossAmount,\n  SUM(APTH.DiscOffer) AS DiscountsOffered,\n  SUM(APTH.Retainage) AS RetainageHeld,\n  SUM(APTH.Balance) AS OpenBalance\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get job cost variance by phase comparing budget to actual\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Job cost variance by phase:\n1. Join JCJM (Job Master) to JCCP (Cost Phase)\n2. Calculate variance as CurrEstCost - ActualCost\n3. Calculate percent complete from actuals vs budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  JCCP.Phase,\n  JCCP.CostType,\n  JCCP.OrigEstCost AS OriginalBudget,\n  JCCP.CurrEstCost AS CurrentBudget,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS Variance,\n  CASE WHEN JCCP.CurrEstCost <> 0 \n       THEN (JCCP.ActualCost / JCCP.CurrEstCost) * 100 \n       ELSE 0 END AS PercentComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.Job = @Job\nORDER BY JCCP.Phase, JCCP.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get customer balance summary by customer group\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Customer balance summary by group:\n1. Join ARTH to ARCM for customer details\n2. Use conditional SUM for open vs total balances\n3. Group by CustGroup for summary\n\n```sql\nSELECT \n  ARTH.CustGroup,\n  COUNT(DISTINCT ARTH.Customer) AS CustomerCount,\n  SUM(CASE WHEN ARTH.PayFullDate IS NULL THEN ARTH.Amount ELSE 0 END) AS OpenBalance,\n  SUM(ARTH.Amount) AS TotalBilled\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\nGROUP BY ARTH.CustGroup\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from Vendor\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'Vendor' does not exist in Viewpoint Vista.\n\nUse APVM (AP Vendor Master) for vendor information.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM APVM WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How do I count records in glac by company\n\nDatabase Schema:\nCREATE TABLE GLAC (\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  Description bdesc,\n  AcctType char(1) NOT NULL,\n  SubType char(1),\n  NormBal char(1),\n  InterfaceDetail byn NOT NULL,\n  Active byn NOT NULL,\n  SummaryAcct bglacct NOT NULL,\n  CashAccrual char(1) NOT NULL,\n  CashOffAcct bglacct,\n  Notes varchar,\n  Part1 varchar(20),\n  Part2 varchar(20),\n  Part3 varchar(20),\n  Part4 varchar(20),\n  Part5 varchar(20),\n  Part6 varchar(20),\n  AllParts varchar(20),\n  CrossRefMemAcct bglacct,\n  -- ... 3 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count GLAC records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM GLAC WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "GLAC"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need to count records in prpc by company\n\nDatabase Schema:\nCREATE TABLE PRPC (\n  PRCo bcompany NOT NULL,\n  PRGroup bgroup NOT NULL,\n  PREndDate bdate NOT NULL,\n  BeginDate bdate NOT NULL,\n  MultiMth byn NOT NULL,\n  BeginMth bmonth NOT NULL,\n  EndMth bmonth,\n  CutoffDate bdate,\n  LimitMth bmonth NOT NULL,\n  Hrs smallint NOT NULL,\n  Days tinyint NOT NULL,\n  Wks tinyint NOT NULL,\n  Status tinyint NOT NULL,\n  DateClosed smalldatetime,\n  JCInterface byn NOT NULL,\n  EMInterface byn NOT NULL,\n  GLInterface byn NOT NULL,\n  APInterface byn NOT NULL,\n  LeaveProcess byn NOT NULL,\n  InUseBy bvpusername,\n  -- ... 7 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count PRPC records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM PRPC WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "PRPC"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from SLWI\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from SLWI ().\n\n```sql\nSELECT *\nFROM SLWI WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "SLWI"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to join SLHD with the available tables\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'SLHD' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nJCJM, JCCD\n\nTo include SLHD in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Join Retainage with other tables\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'Retainage' does not exist in Viewpoint Vista.\n\nRetainage is stored in APTD (PayType column) for AP and SLWI (WCRetAmt, SMRetAmt) for subcontracts.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM APTD WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query to count records in prth by company\n\nDatabase Schema:\nCREATE TABLE PRTH (\n  PRCo bcompany NOT NULL,\n  PRGroup bgroup NOT NULL,\n  PREndDate bdate NOT NULL,\n  Employee bemployee NOT NULL,\n  PaySeq tinyint NOT NULL,\n  PostSeq smallint NOT NULL,\n  Type char(1) NOT NULL,\n  PostDate bdate NOT NULL,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCDept bdept,\n  GLCo bcompany NOT NULL,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equipment bequip,\n  EMGroup tinyint,\n  CostCode bcostcode,\n  -- ... 41 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count PRTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM PRTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "PRTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query to count records in arth by company\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count ARTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM ARTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from GLCO\n\nDatabase Schema:\nCREATE TABLE GLCO (\n  GLCo bcompany NOT NULL,\n  Consolid byn NOT NULL,\n  LastMthSubClsd bmonth NOT NULL,\n  LastMthGLClsd bmonth NOT NULL,\n  MaxOpen tinyint NOT NULL,\n  CashAccrual char(1) NOT NULL,\n  Unbal byn NOT NULL,\n  AuditCoParams byn NOT NULL,\n  AuditAccts byn NOT NULL,\n  AuditAutoJrnl byn NOT NULL,\n  AuditBals byn NOT NULL,\n  AuditBudgets byn NOT NULL,\n  AuditDetail byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  XCompJrnlEntryYN byn NOT NULL,\n  KeyID bigint NOT NULL,\n  LastMthAPClsd bmonth NOT NULL,\n  LastMthARClsd bmonth NOT NULL,\n  AttachBatchReportsYN byn NOT NULL,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from GLCO ().\n\n```sql\nSELECT *\nFROM GLCO WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "GLCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from ARTH\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from ARTH ().\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to track ap hold status distinguishing retainage vs non-retainage holds\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APCO (\n  APCo bcompany NOT NULL,\n  GLCo bcompany NOT NULL,\n  ExpJrnl bjrnl,\n  GLExpInterfaceLvl tinyint NOT NULL,\n  GLExpSummaryDesc varchar(60),\n  GLExpTransDesc varchar(60),\n  GLJobDetailDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLEquipDetailDesc varchar(60),\n  GLExpDetailDesc varchar(60),\n  PayJrnl bjrnl,\n  GLPayInterfaceLvl tinyint NOT NULL,\n  GLPayDetailDesc varchar(60),\n  GLPaySummaryDesc varchar(60),\n  DiscOffGLAcct bglacct,\n  DiscTakenGLAcct bglacct,\n  ExpPayType tinyint,\n  JobPayType tinyint,\n  SubPayType tinyint,\n  RetPayType tinyint,\n  -- ... 92 more columns,\n  PRIMARY KEY (APCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To distinguish retainage vs non-retainage holds:\n1. Join APTD to APHD for hold details\n2. Join APCO to get RetHoldCode setting\n3. Compare APHD.HoldCode to APCO.RetHoldCode\n4. If equal, it's a retainage hold; otherwise non-retainage\n\n```sql\nSELECT \n  APTD.APCo,\n  APTD.Vendor,\n  APTD.Mth,\n  APTD.APTrans,\n  APHD.HoldCode,\n  CASE WHEN APHD.HoldCode = APCO.RetHoldCode \n       THEN 'Retainage Hold' \n       ELSE 'Non-Retainage Hold' END AS HoldType,\n  APTD.Amount\nFROM APTD WITH (NOLOCK)\nINNER JOIN APHD WITH (NOLOCK) ON APTD.APCo = APHD.APCo \n  AND APTD.Mth = APHD.Mth \n  AND APTD.APTrans = APHD.APTrans \n  AND APTD.APLine = APHD.APLine\nINNER JOIN APCO WITH (NOLOCK) ON APTD.APCo = APCO.APCo\nWHERE APTD.APCo = @APCo\n  AND APHD.HoldCode IS NOT NULL\nORDER BY APTD.Vendor, APTD.Mth\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTD",
        "APHD",
        "APCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from GLDT\n\nDatabase Schema:\nCREATE TABLE GLDT (\n  GLCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  GLTrans btrans NOT NULL,\n  GLAcct bglacct NOT NULL,\n  Jrnl bjrnl NOT NULL,\n  GLRef bglref NOT NULL,\n  SourceCo bcompany NOT NULL,\n  Source bsource NOT NULL,\n  ActDate bdate NOT NULL,\n  DatePosted bdate NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid NOT NULL,\n  Amount bdollar NOT NULL,\n  RevStatus tinyint NOT NULL,\n  Adjust char(1) NOT NULL,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  UniqueAttchID uniqueidentifier,\n  SrcTable varchar(128),\n  SrcKeyID bigint,\n  PRIMARY KEY (GLCo, Mth, GLTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from GLDT ().\n\n```sql\nSELECT *\nFROM GLDT WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "GLDT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query to aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to track ap hold status distinguishing retainage vs non-retainage holds\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APCO (\n  APCo bcompany NOT NULL,\n  GLCo bcompany NOT NULL,\n  ExpJrnl bjrnl,\n  GLExpInterfaceLvl tinyint NOT NULL,\n  GLExpSummaryDesc varchar(60),\n  GLExpTransDesc varchar(60),\n  GLJobDetailDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLEquipDetailDesc varchar(60),\n  GLExpDetailDesc varchar(60),\n  PayJrnl bjrnl,\n  GLPayInterfaceLvl tinyint NOT NULL,\n  GLPayDetailDesc varchar(60),\n  GLPaySummaryDesc varchar(60),\n  DiscOffGLAcct bglacct,\n  DiscTakenGLAcct bglacct,\n  ExpPayType tinyint,\n  JobPayType tinyint,\n  SubPayType tinyint,\n  RetPayType tinyint,\n  -- ... 92 more columns,\n  PRIMARY KEY (APCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To distinguish retainage vs non-retainage holds:\n1. Join APTD to APHD for hold details\n2. Join APCO to get RetHoldCode setting\n3. Compare APHD.HoldCode to APCO.RetHoldCode\n4. If equal, it's a retainage hold; otherwise non-retainage\n\n```sql\nSELECT \n  APTD.APCo,\n  APTD.Vendor,\n  APTD.Mth,\n  APTD.APTrans,\n  APHD.HoldCode,\n  CASE WHEN APHD.HoldCode = APCO.RetHoldCode \n       THEN 'Retainage Hold' \n       ELSE 'Non-Retainage Hold' END AS HoldType,\n  APTD.Amount\nFROM APTD WITH (NOLOCK)\nINNER JOIN APHD WITH (NOLOCK) ON APTD.APCo = APHD.APCo \n  AND APTD.Mth = APHD.Mth \n  AND APTD.APTrans = APHD.APTrans \n  AND APTD.APLine = APHD.APLine\nINNER JOIN APCO WITH (NOLOCK) ON APTD.APCo = APCO.APCo\nWHERE APTD.APCo = @APCo\n  AND APHD.HoldCode IS NOT NULL\nORDER BY APTD.Vendor, APTD.Mth\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTD",
        "APHD",
        "APCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoices with their subcontract details\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I can partially answer this query, but the schema is incomplete.\n\nTo include subcontract details, the SLHD table is needed but not provided in the schema.\n\nHere's what I can provide with the available schema:\n\n```sql\nSELECT *\nFROM APTH WITH (NOLOCK)\nWHERE Co = @Co\n-- Note: Additional joins for SLHD would be needed for complete results\n```\n\nTo get the complete data you requested, please provide the DDL for SLHD.",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": [
        "APTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How do I count records in slwi by company\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count SLWI records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM SLWI WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "SLWI"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from APTH\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from APTH ().\n\n```sql\nSELECT *\nFROM APTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get job cost variance by phase comparing budget to actual\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Job cost variance by phase:\n1. Join JCJM (Job Master) to JCCP (Cost Phase)\n2. Calculate variance as CurrEstCost - ActualCost\n3. Calculate percent complete from actuals vs budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  JCCP.Phase,\n  JCCP.CostType,\n  JCCP.OrigEstCost AS OriginalBudget,\n  JCCP.CurrEstCost AS CurrentBudget,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS Variance,\n  CASE WHEN JCCP.CurrEstCost <> 0 \n       THEN (JCCP.ActualCost / JCCP.CurrEstCost) * 100 \n       ELSE 0 END AS PercentComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.Job = @Job\nORDER BY JCCP.Phase, JCCP.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from SLWI\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from SLWI ().\n\n```sql\nSELECT *\nFROM SLWI WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "SLWI"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from ARTH\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from ARTH ().\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to count records in apth by company\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count APTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM APTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "APTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to track ap hold status distinguishing retainage vs non-retainage holds\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APCO (\n  APCo bcompany NOT NULL,\n  GLCo bcompany NOT NULL,\n  ExpJrnl bjrnl,\n  GLExpInterfaceLvl tinyint NOT NULL,\n  GLExpSummaryDesc varchar(60),\n  GLExpTransDesc varchar(60),\n  GLJobDetailDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLEquipDetailDesc varchar(60),\n  GLExpDetailDesc varchar(60),\n  PayJrnl bjrnl,\n  GLPayInterfaceLvl tinyint NOT NULL,\n  GLPayDetailDesc varchar(60),\n  GLPaySummaryDesc varchar(60),\n  DiscOffGLAcct bglacct,\n  DiscTakenGLAcct bglacct,\n  ExpPayType tinyint,\n  JobPayType tinyint,\n  SubPayType tinyint,\n  RetPayType tinyint,\n  -- ... 92 more columns,\n  PRIMARY KEY (APCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To distinguish retainage vs non-retainage holds:\n1. Join APTD to APHD for hold details\n2. Join APCO to get RetHoldCode setting\n3. Compare APHD.HoldCode to APCO.RetHoldCode\n4. If equal, it's a retainage hold; otherwise non-retainage\n\n```sql\nSELECT \n  APTD.APCo,\n  APTD.Vendor,\n  APTD.Mth,\n  APTD.APTrans,\n  APHD.HoldCode,\n  CASE WHEN APHD.HoldCode = APCO.RetHoldCode \n       THEN 'Retainage Hold' \n       ELSE 'Non-Retainage Hold' END AS HoldType,\n  APTD.Amount\nFROM APTD WITH (NOLOCK)\nINNER JOIN APHD WITH (NOLOCK) ON APTD.APCo = APHD.APCo \n  AND APTD.Mth = APHD.Mth \n  AND APTD.APTrans = APHD.APTrans \n  AND APTD.APLine = APHD.APLine\nINNER JOIN APCO WITH (NOLOCK) ON APTD.APCo = APCO.APCo\nWHERE APTD.APCo = @APCo\n  AND APHD.HoldCode IS NOT NULL\nORDER BY APTD.Vendor, APTD.Mth\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "basic",
      "tables_used": [
        "APTD",
        "APHD",
        "APCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How do I count records in apth by company\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count APTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM APTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "APTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoice totals with discounts and retainage\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Vendor invoice summary with discounts and retainage:\n1. Join APTH to APVM for vendor details\n2. Aggregate by vendor\n3. Include GrossAmt, DiscOffer, Retainage, and Balance\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(APTH.APTrans) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS GrossAmount,\n  SUM(APTH.DiscOffer) AS DiscountsOffered,\n  SUM(APTH.Retainage) AS RetainageHeld,\n  SUM(APTH.Balance) AS OpenBalance\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "basic",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from ClientMaster\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'ClientMaster' does not exist in Viewpoint Vista.\n\nUse ARCM (AR Customer Master) for client/customer information.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM ARCM WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from JCCD\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from JCCD ().\n\n```sql\nSELECT *\nFROM JCCD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find jobs over budget with remaining cost projection\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Find jobs over budget:\n1. Aggregate JCCP by job from JCJM\n2. Compare total ActualCost to CurrEstCost\n3. Use HAVING to filter only over-budget jobs\n4. Sort by amount over budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description,\n  SUM(JCCP.CurrEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.CurrEstCost) - SUM(JCCP.ActualCost) AS RemainingBudget,\n  CASE WHEN SUM(JCCP.CurrEstCost) < SUM(JCCP.ActualCost) \n       THEN 'OVER BUDGET' ELSE 'OK' END AS Status\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\nGROUP BY JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.CurrEstCost)\nORDER BY (SUM(JCCP.ActualCost) - SUM(JCCP.CurrEstCost)) DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCJM",
        "JCCD",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from ARTH\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from ARTH ().\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from GLDT\n\nDatabase Schema:\nCREATE TABLE GLDT (\n  GLCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  GLTrans btrans NOT NULL,\n  GLAcct bglacct NOT NULL,\n  Jrnl bjrnl NOT NULL,\n  GLRef bglref NOT NULL,\n  SourceCo bcompany NOT NULL,\n  Source bsource NOT NULL,\n  ActDate bdate NOT NULL,\n  DatePosted bdate NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid NOT NULL,\n  Amount bdollar NOT NULL,\n  RevStatus tinyint NOT NULL,\n  Adjust char(1) NOT NULL,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  UniqueAttchID uniqueidentifier,\n  SrcTable varchar(128),\n  SrcKeyID bigint,\n  PRIMARY KEY (GLCo, Mth, GLTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from GLDT ().\n\n```sql\nSELECT *\nFROM GLDT WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "GLDT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoice totals with discounts and retainage\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Vendor invoice summary with discounts and retainage:\n1. Join APTH to APVM for vendor details\n2. Aggregate by vendor\n3. Include GrossAmt, DiscOffer, Retainage, and Balance\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(APTH.APTrans) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS GrossAmount,\n  SUM(APTH.DiscOffer) AS DiscountsOffered,\n  SUM(APTH.Retainage) AS RetainageHeld,\n  SUM(APTH.Balance) AS OpenBalance\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "basic",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from PRCO\n\nDatabase Schema:\nCREATE TABLE PRCO (\n  PRCo bcompany NOT NULL,\n  GLCo bcompany NOT NULL,\n  Jrnl bjrnl,\n  GLInterface byn NOT NULL,\n  CMCo bcompany NOT NULL,\n  APCo bcompany,\n  AutoOT byn NOT NULL,\n  OTEarnCode bedlcode,\n  JCCo bcompany NOT NULL,\n  AllowNoPhase byn NOT NULL,\n  JCInterface byn NOT NULL,\n  InsByPhase byn NOT NULL,\n  JCICraftClass byn NOT NULL,\n  JCICrew byn NOT NULL,\n  JCIEmployee byn NOT NULL,\n  JCIFactor byn NOT NULL,\n  JCIEarnType byn NOT NULL,\n  JCIShift byn NOT NULL,\n  JCIPostingDate byn NOT NULL,\n  JCILiabType byn NOT NULL,\n  -- ... 66 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from PRCO ().\n\n```sql\nSELECT *\nFROM PRCO WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "PRCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to count records in slwi by company\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count SLWI records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM SLWI WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLWI"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate stored materials (Purchased - Installed) for SL billing\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Stored materials for SL billing:\n1. SLWI contains work item/billing details\n2. StoredMatls = Purchased - Installed (materials on-site but not yet used)\n3. WCCost = Work Completed Cost\n4. WCRetAmt and SMRetAmt = separate retainage for work vs materials\n5. Total billable = WCCost + StoredMatls\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description AS ItemDescription,\n  SLWI.StoredMatls,\n  SLWI.WCCost AS WorkCompletedCost,\n  SLWI.StoredMatls + SLWI.WCCost AS TotalBillable,\n  SLWI.WCRetAmt AS WorkRetainage,\n  SLWI.SMRetAmt AS MaterialsRetainage,\n  SLWI.WCRetAmt + SLWI.SMRetAmt AS TotalRetainage\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\n  AND SLWI.StoredMatls <> 0\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "basic",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get customer balance summary by customer group\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Customer balance summary by group:\n1. Join ARTH to ARCM for customer details\n2. Use conditional SUM for open vs total balances\n3. Group by CustGroup for summary\n\n```sql\nSELECT \n  ARTH.CustGroup,\n  COUNT(DISTINCT ARTH.Customer) AS CustomerCount,\n  SUM(CASE WHEN ARTH.PayFullDate IS NULL THEN ARTH.Amount ELSE 0 END) AS OpenBalance,\n  SUM(ARTH.Amount) AS TotalBilled\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\nGROUP BY ARTH.CustGroup\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How do I count records in slwi by company\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count SLWI records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM SLWI WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "SLWI"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to count records in preh by company\n\nDatabase Schema:\nCREATE TABLE PREH (\n  PRCo bcompany NOT NULL,\n  Employee bemployee NOT NULL,\n  LastName varchar(30) NOT NULL,\n  FirstName varchar(30),\n  MidName varchar(15),\n  SortName bsortname NOT NULL,\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  Phone bphone,\n  SSN char(11) NOT NULL,\n  Race char(2) NOT NULL,\n  Sex char(1) NOT NULL,\n  BirthDate smalldatetime,\n  HireDate bdate,\n  TermDate bdate,\n  PRGroup bgroup NOT NULL,\n  PRDept bdept NOT NULL,\n  -- ... 121 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count PREH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM PREH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "PREH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get customer balance summary by customer group\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Customer balance summary by group:\n1. Join ARTH to ARCM for customer details\n2. Use conditional SUM for open vs total balances\n3. Group by CustGroup for summary\n\n```sql\nSELECT \n  ARTH.CustGroup,\n  COUNT(DISTINCT ARTH.Customer) AS CustomerCount,\n  SUM(CASE WHEN ARTH.PayFullDate IS NULL THEN ARTH.Amount ELSE 0 END) AS OpenBalance,\n  SUM(ARTH.Amount) AS TotalBilled\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\nGROUP BY ARTH.CustGroup\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Join Projects with other tables\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'Projects' does not exist in Viewpoint Vista.\n\nUse JCJM (JC Job Master) for project information. Vista calls projects 'Jobs'.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM JCJM WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Include SLHD in the query\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'SLHD' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nJCJM, JCCD\n\nTo include SLHD in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need to count records in prpc by company\n\nDatabase Schema:\nCREATE TABLE PRPC (\n  PRCo bcompany NOT NULL,\n  PRGroup bgroup NOT NULL,\n  PREndDate bdate NOT NULL,\n  BeginDate bdate NOT NULL,\n  MultiMth byn NOT NULL,\n  BeginMth bmonth NOT NULL,\n  EndMth bmonth,\n  CutoffDate bdate,\n  LimitMth bmonth NOT NULL,\n  Hrs smallint NOT NULL,\n  Days tinyint NOT NULL,\n  Wks tinyint NOT NULL,\n  Status tinyint NOT NULL,\n  DateClosed smalldatetime,\n  JCInterface byn NOT NULL,\n  EMInterface byn NOT NULL,\n  GLInterface byn NOT NULL,\n  APInterface byn NOT NULL,\n  LeaveProcess byn NOT NULL,\n  InUseBy bvpusername,\n  -- ... 7 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count PRPC records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM PRPC WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "PRPC"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from APTD\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from APTD ().\n\n```sql\nSELECT *\nFROM APTD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get job cost variance by phase comparing budget to actual\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Job cost variance by phase:\n1. Join JCJM (Job Master) to JCCP (Cost Phase)\n2. Calculate variance as CurrEstCost - ActualCost\n3. Calculate percent complete from actuals vs budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  JCCP.Phase,\n  JCCP.CostType,\n  JCCP.OrigEstCost AS OriginalBudget,\n  JCCP.CurrEstCost AS CurrentBudget,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS Variance,\n  CASE WHEN JCCP.CurrEstCost <> 0 \n       THEN (JCCP.ActualCost / JCCP.CurrEstCost) * 100 \n       ELSE 0 END AS PercentComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.Job = @Job\nORDER BY JCCP.Phase, JCCP.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need to count records in gldt by company\n\nDatabase Schema:\nCREATE TABLE GLDT (\n  GLCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  GLTrans btrans NOT NULL,\n  GLAcct bglacct NOT NULL,\n  Jrnl bjrnl NOT NULL,\n  GLRef bglref NOT NULL,\n  SourceCo bcompany NOT NULL,\n  Source bsource NOT NULL,\n  ActDate bdate NOT NULL,\n  DatePosted bdate NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid NOT NULL,\n  Amount bdollar NOT NULL,\n  RevStatus tinyint NOT NULL,\n  Adjust char(1) NOT NULL,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  UniqueAttchID uniqueidentifier,\n  SrcTable varchar(128),\n  SrcKeyID bigint,\n  PRIMARY KEY (GLCo, Mth, GLTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count GLDT records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM GLDT WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "GLDT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging buckets (30/60/90+ days) for unpaid invoices by customer\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Use ARTH for transaction data and ARCM for customer names\n2. Filter PayFullDate IS NULL to get only unpaid invoices\n3. Use DATEDIFF and CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get subcontractor costs with original, change orders, invoiced, paid, and retainage by vendor\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Subcontractor cost breakdown by vendor:\n1. Join SLHD (Header) to SLIT (Items) for subcontract details\n2. Join APVM for vendor names\n3. OrigCost = original contract amount\n4. CurCost - OrigCost = change order amounts\n5. InvCost = amounts invoiced\n6. Retainage = amounts held back\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  SLHD.SL AS SubcontractNum,\n  SLHD.Description AS SubcontractDesc,\n  SUM(SLIT.OrigCost) AS OriginalCost,\n  SUM(SLIT.CurCost - SLIT.OrigCost) AS ChangeOrderCost,\n  SUM(SLIT.CurCost) AS CurrentCost,\n  SUM(SLIT.InvCost) AS InvoicedCost,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost - SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nINNER JOIN APVM WITH (NOLOCK) ON SLHD.VendorGroup = APVM.VendorGroup AND SLHD.Vendor = APVM.Vendor\nWHERE SLHD.SLCo = @SLCo\nGROUP BY APVM.Vendor, APVM.Name, SLHD.SL, SLHD.Description\nORDER BY APVM.Name, SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLHD",
        "SLIT",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging buckets (30/60/90+ days) for unpaid invoices by customer\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Use ARTH for transaction data and ARCM for customer names\n2. Filter PayFullDate IS NULL to get only unpaid invoices\n3. Use DATEDIFF and CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How do I aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from GLAC\n\nDatabase Schema:\nCREATE TABLE GLAC (\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  Description bdesc,\n  AcctType char(1) NOT NULL,\n  SubType char(1),\n  NormBal char(1),\n  InterfaceDetail byn NOT NULL,\n  Active byn NOT NULL,\n  SummaryAcct bglacct NOT NULL,\n  CashAccrual char(1) NOT NULL,\n  CashOffAcct bglacct,\n  Notes varchar,\n  Part1 varchar(20),\n  Part2 varchar(20),\n  Part3 varchar(20),\n  Part4 varchar(20),\n  Part5 varchar(20),\n  Part6 varchar(20),\n  AllParts varchar(20),\n  CrossRefMemAcct bglacct,\n  -- ... 3 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from GLAC ().\n\n```sql\nSELECT *\nFROM GLAC WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "GLAC"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from PRCO\n\nDatabase Schema:\nCREATE TABLE PRCO (\n  PRCo bcompany NOT NULL,\n  GLCo bcompany NOT NULL,\n  Jrnl bjrnl,\n  GLInterface byn NOT NULL,\n  CMCo bcompany NOT NULL,\n  APCo bcompany,\n  AutoOT byn NOT NULL,\n  OTEarnCode bedlcode,\n  JCCo bcompany NOT NULL,\n  AllowNoPhase byn NOT NULL,\n  JCInterface byn NOT NULL,\n  InsByPhase byn NOT NULL,\n  JCICraftClass byn NOT NULL,\n  JCICrew byn NOT NULL,\n  JCIEmployee byn NOT NULL,\n  JCIFactor byn NOT NULL,\n  JCIEarnType byn NOT NULL,\n  JCIShift byn NOT NULL,\n  JCIPostingDate byn NOT NULL,\n  JCILiabType byn NOT NULL,\n  -- ... 66 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from PRCO ().\n\n```sql\nSELECT *\nFROM PRCO WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "PRCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get job cost variance by phase comparing budget to actual\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Job cost variance by phase:\n1. Join JCJM (Job Master) to JCCP (Cost Phase)\n2. Calculate variance as CurrEstCost - ActualCost\n3. Calculate percent complete from actuals vs budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  JCCP.Phase,\n  JCCP.CostType,\n  JCCP.OrigEstCost AS OriginalBudget,\n  JCCP.CurrEstCost AS CurrentBudget,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS Variance,\n  CASE WHEN JCCP.CurrEstCost <> 0 \n       THEN (JCCP.ActualCost / JCCP.CurrEstCost) * 100 \n       ELSE 0 END AS PercentComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.Job = @Job\nORDER BY JCCP.Phase, JCCP.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from APTD\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from APTD ().\n\n```sql\nSELECT *\nFROM APTD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: count records in jccd by company\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count JCCD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM JCCD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from GLJR\n\nDatabase Schema:\nCREATE TABLE GLJR (\n  GLCo bcompany NOT NULL,\n  Jrnl bjrnl NOT NULL,\n  Description btransdesc,\n  Rev byn NOT NULL,\n  RevJrnl bjrnl,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from GLJR ().\n\n```sql\nSELECT *\nFROM GLJR WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "GLJR"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get job cost variance by phase comparing budget to actual\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Job cost variance by phase:\n1. Join JCJM (Job Master) to JCCP (Cost Phase)\n2. Calculate variance as CurrEstCost - ActualCost\n3. Calculate percent complete from actuals vs budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  JCCP.Phase,\n  JCCP.CostType,\n  JCCP.OrigEstCost AS OriginalBudget,\n  JCCP.CurrEstCost AS CurrentBudget,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS Variance,\n  CASE WHEN JCCP.CurrEstCost <> 0 \n       THEN (JCCP.ActualCost / JCCP.CurrEstCost) * 100 \n       ELSE 0 END AS PercentComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.Job = @Job\nORDER BY JCCP.Phase, JCCP.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get job cost variance by phase comparing budget to actual\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Job cost variance by phase:\n1. Join JCJM (Job Master) to JCCP (Cost Phase)\n2. Calculate variance as CurrEstCost - ActualCost\n3. Calculate percent complete from actuals vs budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  JCCP.Phase,\n  JCCP.CostType,\n  JCCP.OrigEstCost AS OriginalBudget,\n  JCCP.CurrEstCost AS CurrentBudget,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS Variance,\n  CASE WHEN JCCP.CurrEstCost <> 0 \n       THEN (JCCP.ActualCost / JCCP.CurrEstCost) * 100 \n       ELSE 0 END AS PercentComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.Job = @Job\nORDER BY JCCP.Phase, JCCP.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How do I count records in arth by company\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count ARTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM ARTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from APTD\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from APTD ().\n\n```sql\nSELECT *\nFROM APTD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need to track ap hold status distinguishing retainage vs non-retainage holds\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APCO (\n  APCo bcompany NOT NULL,\n  GLCo bcompany NOT NULL,\n  ExpJrnl bjrnl,\n  GLExpInterfaceLvl tinyint NOT NULL,\n  GLExpSummaryDesc varchar(60),\n  GLExpTransDesc varchar(60),\n  GLJobDetailDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLEquipDetailDesc varchar(60),\n  GLExpDetailDesc varchar(60),\n  PayJrnl bjrnl,\n  GLPayInterfaceLvl tinyint NOT NULL,\n  GLPayDetailDesc varchar(60),\n  GLPaySummaryDesc varchar(60),\n  DiscOffGLAcct bglacct,\n  DiscTakenGLAcct bglacct,\n  ExpPayType tinyint,\n  JobPayType tinyint,\n  SubPayType tinyint,\n  RetPayType tinyint,\n  -- ... 92 more columns,\n  PRIMARY KEY (APCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To distinguish retainage vs non-retainage holds:\n1. Join APTD to APHD for hold details\n2. Join APCO to get RetHoldCode setting\n3. Compare APHD.HoldCode to APCO.RetHoldCode\n4. If equal, it's a retainage hold; otherwise non-retainage\n\n```sql\nSELECT \n  APTD.APCo,\n  APTD.Vendor,\n  APTD.Mth,\n  APTD.APTrans,\n  APHD.HoldCode,\n  CASE WHEN APHD.HoldCode = APCO.RetHoldCode \n       THEN 'Retainage Hold' \n       ELSE 'Non-Retainage Hold' END AS HoldType,\n  APTD.Amount\nFROM APTD WITH (NOLOCK)\nINNER JOIN APHD WITH (NOLOCK) ON APTD.APCo = APHD.APCo \n  AND APTD.Mth = APHD.Mth \n  AND APTD.APTrans = APHD.APTrans \n  AND APTD.APLine = APHD.APLine\nINNER JOIN APCO WITH (NOLOCK) ON APTD.APCo = APCO.APCo\nWHERE APTD.APCo = @APCo\n  AND APHD.HoldCode IS NOT NULL\nORDER BY APTD.Vendor, APTD.Mth\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTD",
        "APHD",
        "APCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from GLDT\n\nDatabase Schema:\nCREATE TABLE GLDT (\n  GLCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  GLTrans btrans NOT NULL,\n  GLAcct bglacct NOT NULL,\n  Jrnl bjrnl NOT NULL,\n  GLRef bglref NOT NULL,\n  SourceCo bcompany NOT NULL,\n  Source bsource NOT NULL,\n  ActDate bdate NOT NULL,\n  DatePosted bdate NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid NOT NULL,\n  Amount bdollar NOT NULL,\n  RevStatus tinyint NOT NULL,\n  Adjust char(1) NOT NULL,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  UniqueAttchID uniqueidentifier,\n  SrcTable varchar(128),\n  SrcKeyID bigint,\n  PRIMARY KEY (GLCo, Mth, GLTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from GLDT ().\n\n```sql\nSELECT *\nFROM GLDT WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "GLDT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get customer balance summary by customer group\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Customer balance summary by group:\n1. Join ARTH to ARCM for customer details\n2. Use conditional SUM for open vs total balances\n3. Group by CustGroup for summary\n\n```sql\nSELECT \n  ARTH.CustGroup,\n  COUNT(DISTINCT ARTH.Customer) AS CustomerCount,\n  SUM(CASE WHEN ARTH.PayFullDate IS NULL THEN ARTH.Amount ELSE 0 END) AS OpenBalance,\n  SUM(ARTH.Amount) AS TotalBilled\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\nGROUP BY ARTH.CustGroup\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to count records in prtd by company\n\nDatabase Schema:\nCREATE TABLE PRTD (\n  PRCo bcompany NOT NULL,\n  Craft bcraft NOT NULL,\n  Class bclass NOT NULL,\n  Template smallint NOT NULL,\n  DLCode bedlcode NOT NULL,\n  Factor brate NOT NULL,\n  OldRate bunitcost NOT NULL,\n  NewRate bunitcost NOT NULL,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count PRTD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM PRTD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "PRTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: count records in slhd by company\n\nDatabase Schema:\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count SLHD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM SLHD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLHD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: count records in arth by company\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count ARTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM ARTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get subcontractor costs with original, change orders, invoiced, paid, and retainage by vendor\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Subcontractor cost breakdown by vendor:\n1. Join SLHD (Header) to SLIT (Items) for subcontract details\n2. Join APVM for vendor names\n3. OrigCost = original contract amount\n4. CurCost - OrigCost = change order amounts\n5. InvCost = amounts invoiced\n6. Retainage = amounts held back\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  SLHD.SL AS SubcontractNum,\n  SLHD.Description AS SubcontractDesc,\n  SUM(SLIT.OrigCost) AS OriginalCost,\n  SUM(SLIT.CurCost - SLIT.OrigCost) AS ChangeOrderCost,\n  SUM(SLIT.CurCost) AS CurrentCost,\n  SUM(SLIT.InvCost) AS InvoicedCost,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost - SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nINNER JOIN APVM WITH (NOLOCK) ON SLHD.VendorGroup = APVM.VendorGroup AND SLHD.Vendor = APVM.Vendor\nWHERE SLHD.SLCo = @SLCo\nGROUP BY APVM.Vendor, APVM.Name, SLHD.SL, SLHD.Description\nORDER BY APVM.Name, SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "intermediate",
      "tables_used": [
        "SLHD",
        "SLIT",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query to aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How do I count records in preh by company\n\nDatabase Schema:\nCREATE TABLE PREH (\n  PRCo bcompany NOT NULL,\n  Employee bemployee NOT NULL,\n  LastName varchar(30) NOT NULL,\n  FirstName varchar(30),\n  MidName varchar(15),\n  SortName bsortname NOT NULL,\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  Phone bphone,\n  SSN char(11) NOT NULL,\n  Race char(2) NOT NULL,\n  Sex char(1) NOT NULL,\n  BirthDate smalldatetime,\n  HireDate bdate,\n  TermDate bdate,\n  PRGroup bgroup NOT NULL,\n  PRDept bdept NOT NULL,\n  -- ... 121 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count PREH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM PREH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "PREH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to count records in apth by company\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count APTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM APTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from ARTH\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from ARTH ().\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query to aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to count records in aptd by company\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count APTD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM APTD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: count records in arth by company\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count ARTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM ARTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate stored materials (Purchased - Installed) for SL billing\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Stored materials for SL billing:\n1. SLWI contains work item/billing details\n2. StoredMatls = Purchased - Installed (materials on-site but not yet used)\n3. WCCost = Work Completed Cost\n4. WCRetAmt and SMRetAmt = separate retainage for work vs materials\n5. Total billable = WCCost + StoredMatls\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description AS ItemDescription,\n  SLWI.StoredMatls,\n  SLWI.WCCost AS WorkCompletedCost,\n  SLWI.StoredMatls + SLWI.WCCost AS TotalBillable,\n  SLWI.WCRetAmt AS WorkRetainage,\n  SLWI.SMRetAmt AS MaterialsRetainage,\n  SLWI.WCRetAmt + SLWI.SMRetAmt AS TotalRetainage\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\n  AND SLWI.StoredMatls <> 0\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "basic",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoice totals with discounts and retainage\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Vendor invoice summary with discounts and retainage:\n1. Join APTH to APVM for vendor details\n2. Aggregate by vendor\n3. Include GrossAmt, DiscOffer, Retainage, and Balance\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(APTH.APTrans) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS GrossAmount,\n  SUM(APTH.DiscOffer) AS DiscountsOffered,\n  SUM(APTH.Retainage) AS RetainageHeld,\n  SUM(APTH.Balance) AS OpenBalance\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find jobs over budget with remaining cost projection\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Find jobs over budget:\n1. Aggregate JCCP by job from JCJM\n2. Compare total ActualCost to CurrEstCost\n3. Use HAVING to filter only over-budget jobs\n4. Sort by amount over budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description,\n  SUM(JCCP.CurrEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.CurrEstCost) - SUM(JCCP.ActualCost) AS RemainingBudget,\n  CASE WHEN SUM(JCCP.CurrEstCost) < SUM(JCCP.ActualCost) \n       THEN 'OVER BUDGET' ELSE 'OK' END AS Status\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\nGROUP BY JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.CurrEstCost)\nORDER BY (SUM(JCCP.ActualCost) - SUM(JCCP.CurrEstCost)) DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCJM",
        "JCCD",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate stored materials (Purchased - Installed) for SL billing\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Stored materials for SL billing:\n1. SLWI contains work item/billing details\n2. StoredMatls = Purchased - Installed (materials on-site but not yet used)\n3. WCCost = Work Completed Cost\n4. WCRetAmt and SMRetAmt = separate retainage for work vs materials\n5. Total billable = WCCost + StoredMatls\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description AS ItemDescription,\n  SLWI.StoredMatls,\n  SLWI.WCCost AS WorkCompletedCost,\n  SLWI.StoredMatls + SLWI.WCCost AS TotalBillable,\n  SLWI.WCRetAmt AS WorkRetainage,\n  SLWI.SMRetAmt AS MaterialsRetainage,\n  SLWI.WCRetAmt + SLWI.SMRetAmt AS TotalRetainage\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\n  AND SLWI.StoredMatls <> 0\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "basic",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to count records in arth by company\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count ARTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM ARTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get subcontractor costs with original, change orders, invoiced, paid, and retainage by vendor\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Subcontractor cost breakdown by vendor:\n1. Join SLHD (Header) to SLIT (Items) for subcontract details\n2. Join APVM for vendor names\n3. OrigCost = original contract amount\n4. CurCost - OrigCost = change order amounts\n5. InvCost = amounts invoiced\n6. Retainage = amounts held back\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  SLHD.SL AS SubcontractNum,\n  SLHD.Description AS SubcontractDesc,\n  SUM(SLIT.OrigCost) AS OriginalCost,\n  SUM(SLIT.CurCost - SLIT.OrigCost) AS ChangeOrderCost,\n  SUM(SLIT.CurCost) AS CurrentCost,\n  SUM(SLIT.InvCost) AS InvoicedCost,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost - SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nINNER JOIN APVM WITH (NOLOCK) ON SLHD.VendorGroup = APVM.VendorGroup AND SLHD.Vendor = APVM.Vendor\nWHERE SLHD.SLCo = @SLCo\nGROUP BY APVM.Vendor, APVM.Name, SLHD.SL, SLHD.Description\nORDER BY APVM.Name, SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "intermediate",
      "tables_used": [
        "SLHD",
        "SLIT",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging buckets (30/60/90+ days) for unpaid invoices by customer\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Use ARTH for transaction data and ARCM for customer names\n2. Filter PayFullDate IS NULL to get only unpaid invoices\n3. Use DATEDIFF and CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need to count records in preh by company\n\nDatabase Schema:\nCREATE TABLE PREH (\n  PRCo bcompany NOT NULL,\n  Employee bemployee NOT NULL,\n  LastName varchar(30) NOT NULL,\n  FirstName varchar(30),\n  MidName varchar(15),\n  SortName bsortname NOT NULL,\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  Phone bphone,\n  SSN char(11) NOT NULL,\n  Race char(2) NOT NULL,\n  Sex char(1) NOT NULL,\n  BirthDate smalldatetime,\n  HireDate bdate,\n  TermDate bdate,\n  PRGroup bgroup NOT NULL,\n  PRDept bdept NOT NULL,\n  -- ... 121 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count PREH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM PREH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "PREH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoice totals with discounts and retainage\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Vendor invoice summary with discounts and retainage:\n1. Join APTH to APVM for vendor details\n2. Aggregate by vendor\n3. Include GrossAmt, DiscOffer, Retainage, and Balance\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(APTH.APTrans) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS GrossAmount,\n  SUM(APTH.DiscOffer) AS DiscountsOffered,\n  SUM(APTH.Retainage) AS RetainageHeld,\n  SUM(APTH.Balance) AS OpenBalance\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find all unpaid AR invoices older than 60 days\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find unpaid invoices over 60 days:\n1. Join ARTH to ARCM for customer information\n2. Filter PayFullDate IS NULL (unpaid)\n3. Use DATEDIFF to calculate age and filter > 60 days\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Mth,\n  ARTH.ARTrans,\n  ARCM.Name AS CustomerName,\n  ARTH.TransDate,\n  ARTH.Amount,\n  DATEDIFF(day, ARTH.TransDate, GETDATE()) AS DaysOutstanding\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\n  AND DATEDIFF(day, ARTH.TransDate, GETDATE()) > 60\nORDER BY ARTH.TransDate\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get job cost variance by phase comparing budget to actual\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Job cost variance by phase:\n1. Join JCJM (Job Master) to JCCP (Cost Phase)\n2. Calculate variance as CurrEstCost - ActualCost\n3. Calculate percent complete from actuals vs budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  JCCP.Phase,\n  JCCP.CostType,\n  JCCP.OrigEstCost AS OriginalBudget,\n  JCCP.CurrEstCost AS CurrentBudget,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS Variance,\n  CASE WHEN JCCP.CurrEstCost <> 0 \n       THEN (JCCP.ActualCost / JCCP.CurrEstCost) * 100 \n       ELSE 0 END AS PercentComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.Job = @Job\nORDER BY JCCP.Phase, JCCP.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoice totals with discounts and retainage\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Vendor invoice summary with discounts and retainage:\n1. Join APTH to APVM for vendor details\n2. Aggregate by vendor\n3. Include GrossAmt, DiscOffer, Retainage, and Balance\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(APTH.APTrans) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS GrossAmount,\n  SUM(APTH.DiscOffer) AS DiscountsOffered,\n  SUM(APTH.Retainage) AS RetainageHeld,\n  SUM(APTH.Balance) AS OpenBalance\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Include PREH in the query\n\nDatabase Schema:\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'PREH' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nSLHD, SLIT\n\nTo include PREH in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from GLDT\n\nDatabase Schema:\nCREATE TABLE GLDT (\n  GLCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  GLTrans btrans NOT NULL,\n  GLAcct bglacct NOT NULL,\n  Jrnl bjrnl NOT NULL,\n  GLRef bglref NOT NULL,\n  SourceCo bcompany NOT NULL,\n  Source bsource NOT NULL,\n  ActDate bdate NOT NULL,\n  DatePosted bdate NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid NOT NULL,\n  Amount bdollar NOT NULL,\n  RevStatus tinyint NOT NULL,\n  Adjust char(1) NOT NULL,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  UniqueAttchID uniqueidentifier,\n  SrcTable varchar(128),\n  SrcKeyID bigint,\n  PRIMARY KEY (GLCo, Mth, GLTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from GLDT ().\n\n```sql\nSELECT *\nFROM GLDT WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "GLDT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get job cost variance by phase comparing budget to actual\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Job cost variance by phase:\n1. Join JCJM (Job Master) to JCCP (Cost Phase)\n2. Calculate variance as CurrEstCost - ActualCost\n3. Calculate percent complete from actuals vs budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  JCCP.Phase,\n  JCCP.CostType,\n  JCCP.OrigEstCost AS OriginalBudget,\n  JCCP.CurrEstCost AS CurrentBudget,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS Variance,\n  CASE WHEN JCCP.CurrEstCost <> 0 \n       THEN (JCCP.ActualCost / JCCP.CurrEstCost) * 100 \n       ELSE 0 END AS PercentComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.Job = @Job\nORDER BY JCCP.Phase, JCCP.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Include JCJM in the query\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'JCJM' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nARTH, ARCM\n\nTo include JCJM in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from JCCD\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from JCCD ().\n\n```sql\nSELECT *\nFROM JCCD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query to count records in arth by company\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count ARTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM ARTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoice totals with discounts and retainage\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Vendor invoice summary with discounts and retainage:\n1. Join APTH to APVM for vendor details\n2. Aggregate by vendor\n3. Include GrossAmt, DiscOffer, Retainage, and Balance\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(APTH.APTrans) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS GrossAmount,\n  SUM(APTH.DiscOffer) AS DiscountsOffered,\n  SUM(APTH.Retainage) AS RetainageHeld,\n  SUM(APTH.Balance) AS OpenBalance\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "basic",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging with customer contact information\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I can partially answer this query, but the schema is incomplete.\n\nThe query requires ARCM (AR Customer Master) for customer details, but only ARTH is provided in the schema.\n\nHere's what I can provide with the available schema:\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n-- Note: Additional joins for ARCM would be needed for complete results\n```\n\nTo get the complete data you requested, please provide the DDL for ARCM.",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from APTD\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from APTD ().\n\n```sql\nSELECT *\nFROM APTD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from SLWI\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from SLWI ().\n\n```sql\nSELECT *\nFROM SLWI WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "SLWI"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to reconcile ap oncost batch lines with original transactions\n\nDatabase Schema:\nCREATE TABLE APTL (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equip bequip,\n  EMGroup bgroup,\n  -- ... 56 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans, APLine)\n);\n\nCREATE TABLE APLB (\n  Co bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  BatchId bbatchid NOT NULL,\n  BatchSeq int NOT NULL,\n  APLine smallint NOT NULL,\n  BatchTransType char(1) NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  -- ... 120 more columns,\n  PRIMARY KEY (Co, Mth, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APHB (\n  Co bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  BatchId bbatchid NOT NULL,\n  BatchSeq int NOT NULL,\n  BatchTransType char(1) NOT NULL,\n  APTrans btrans,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  -- ... 88 more columns,\n  PRIMARY KEY (Co, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To reconcile AP oncost batches with original transactions:\n1. Join APLB (batch lines) to APTL (original lines) using ocApplyMth, ocApplyTrans, ocApplyLine\n2. Include APHB for batch header info\n3. Join to APTH and APVM for vendor context\n4. Compare batch vs original amounts\n\n```sql\nSELECT \n  APLB.Co AS BatchCo,\n  APLB.Mth AS BatchMth,\n  APLB.BatchId,\n  APLB.BatchSeq,\n  APLB.ocApplyMth,\n  APLB.ocApplyTrans,\n  APLB.ocApplyLine,\n  APTL.APCo AS OrigCo,\n  APTL.Mth AS OrigMth,\n  APTL.APTrans AS OrigTrans,\n  APTL.APLine AS OrigLine,\n  APTL.GrossAmt AS OrigAmount,\n  APLB.GrossAmt AS BatchAmount,\n  APVM.Name AS VendorName\nFROM APLB WITH (NOLOCK)\nINNER JOIN APHB WITH (NOLOCK) ON APLB.Co = APHB.Co AND APLB.Mth = APHB.Mth AND APLB.BatchId = APHB.BatchId\nINNER JOIN APTL WITH (NOLOCK) ON APLB.ocApplyMth = APTL.Mth \n  AND APLB.ocApplyTrans = APTL.APTrans \n  AND APLB.ocApplyLine = APTL.APLine\n  AND APLB.Co = APTL.APCo\nINNER JOIN APTH WITH (NOLOCK) ON APTL.APCo = APTH.APCo AND APTL.Mth = APTH.Mth AND APTL.APTrans = APTH.APTrans\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APLB.Co = @Co\nORDER BY APLB.BatchId, APLB.BatchSeq\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "basic",
      "tables_used": [
        "APLB",
        "APHB",
        "APTL",
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from ARTH\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from ARTH ().\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from PRPC\n\nDatabase Schema:\nCREATE TABLE PRPC (\n  PRCo bcompany NOT NULL,\n  PRGroup bgroup NOT NULL,\n  PREndDate bdate NOT NULL,\n  BeginDate bdate NOT NULL,\n  MultiMth byn NOT NULL,\n  BeginMth bmonth NOT NULL,\n  EndMth bmonth,\n  CutoffDate bdate,\n  LimitMth bmonth NOT NULL,\n  Hrs smallint NOT NULL,\n  Days tinyint NOT NULL,\n  Wks tinyint NOT NULL,\n  Status tinyint NOT NULL,\n  DateClosed smalldatetime,\n  JCInterface byn NOT NULL,\n  EMInterface byn NOT NULL,\n  GLInterface byn NOT NULL,\n  APInterface byn NOT NULL,\n  LeaveProcess byn NOT NULL,\n  InUseBy bvpusername,\n  -- ... 7 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from PRPC ().\n\n```sql\nSELECT *\nFROM PRPC WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "PRPC"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate stored materials (Purchased - Installed) for SL billing\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Stored materials for SL billing:\n1. SLWI contains work item/billing details\n2. StoredMatls = Purchased - Installed (materials on-site but not yet used)\n3. WCCost = Work Completed Cost\n4. WCRetAmt and SMRetAmt = separate retainage for work vs materials\n5. Total billable = WCCost + StoredMatls\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description AS ItemDescription,\n  SLWI.StoredMatls,\n  SLWI.WCCost AS WorkCompletedCost,\n  SLWI.StoredMatls + SLWI.WCCost AS TotalBillable,\n  SLWI.WCRetAmt AS WorkRetainage,\n  SLWI.SMRetAmt AS MaterialsRetainage,\n  SLWI.WCRetAmt + SLWI.SMRetAmt AS TotalRetainage\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\n  AND SLWI.StoredMatls <> 0\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "basic",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from GLAC\n\nDatabase Schema:\nCREATE TABLE GLAC (\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  Description bdesc,\n  AcctType char(1) NOT NULL,\n  SubType char(1),\n  NormBal char(1),\n  InterfaceDetail byn NOT NULL,\n  Active byn NOT NULL,\n  SummaryAcct bglacct NOT NULL,\n  CashAccrual char(1) NOT NULL,\n  CashOffAcct bglacct,\n  Notes varchar,\n  Part1 varchar(20),\n  Part2 varchar(20),\n  Part3 varchar(20),\n  Part4 varchar(20),\n  Part5 varchar(20),\n  Part6 varchar(20),\n  AllParts varchar(20),\n  CrossRefMemAcct bglacct,\n  -- ... 3 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from GLAC ().\n\n```sql\nSELECT *\nFROM GLAC WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "GLAC"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How do I count records in gljr by company\n\nDatabase Schema:\nCREATE TABLE GLJR (\n  GLCo bcompany NOT NULL,\n  Jrnl bjrnl NOT NULL,\n  Description btransdesc,\n  Rev byn NOT NULL,\n  RevJrnl bjrnl,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count GLJR records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM GLJR WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "GLJR"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need to track ap hold status distinguishing retainage vs non-retainage holds\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APCO (\n  APCo bcompany NOT NULL,\n  GLCo bcompany NOT NULL,\n  ExpJrnl bjrnl,\n  GLExpInterfaceLvl tinyint NOT NULL,\n  GLExpSummaryDesc varchar(60),\n  GLExpTransDesc varchar(60),\n  GLJobDetailDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLEquipDetailDesc varchar(60),\n  GLExpDetailDesc varchar(60),\n  PayJrnl bjrnl,\n  GLPayInterfaceLvl tinyint NOT NULL,\n  GLPayDetailDesc varchar(60),\n  GLPaySummaryDesc varchar(60),\n  DiscOffGLAcct bglacct,\n  DiscTakenGLAcct bglacct,\n  ExpPayType tinyint,\n  JobPayType tinyint,\n  SubPayType tinyint,\n  RetPayType tinyint,\n  -- ... 92 more columns,\n  PRIMARY KEY (APCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To distinguish retainage vs non-retainage holds:\n1. Join APTD to APHD for hold details\n2. Join APCO to get RetHoldCode setting\n3. Compare APHD.HoldCode to APCO.RetHoldCode\n4. If equal, it's a retainage hold; otherwise non-retainage\n\n```sql\nSELECT \n  APTD.APCo,\n  APTD.Vendor,\n  APTD.Mth,\n  APTD.APTrans,\n  APHD.HoldCode,\n  CASE WHEN APHD.HoldCode = APCO.RetHoldCode \n       THEN 'Retainage Hold' \n       ELSE 'Non-Retainage Hold' END AS HoldType,\n  APTD.Amount\nFROM APTD WITH (NOLOCK)\nINNER JOIN APHD WITH (NOLOCK) ON APTD.APCo = APHD.APCo \n  AND APTD.Mth = APHD.Mth \n  AND APTD.APTrans = APHD.APTrans \n  AND APTD.APLine = APHD.APLine\nINNER JOIN APCO WITH (NOLOCK) ON APTD.APCo = APCO.APCo\nWHERE APTD.APCo = @APCo\n  AND APHD.HoldCode IS NOT NULL\nORDER BY APTD.Vendor, APTD.Mth\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTD",
        "APHD",
        "APCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get job cost variance by phase comparing budget to actual\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Job cost variance by phase:\n1. Join JCJM (Job Master) to JCCP (Cost Phase)\n2. Calculate variance as CurrEstCost - ActualCost\n3. Calculate percent complete from actuals vs budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  JCCP.Phase,\n  JCCP.CostType,\n  JCCP.OrigEstCost AS OriginalBudget,\n  JCCP.CurrEstCost AS CurrentBudget,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS Variance,\n  CASE WHEN JCCP.CurrEstCost <> 0 \n       THEN (JCCP.ActualCost / JCCP.CurrEstCost) * 100 \n       ELSE 0 END AS PercentComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.Job = @Job\nORDER BY JCCP.Phase, JCCP.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to join JCJM with the available tables\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'JCJM' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nARTH, ARCM\n\nTo include JCJM in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to count records in slhd by company\n\nDatabase Schema:\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count SLHD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM SLHD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLHD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoice totals with discounts and retainage\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Vendor invoice summary with discounts and retainage:\n1. Join APTH to APVM for vendor details\n2. Aggregate by vendor\n3. Include GrossAmt, DiscOffer, Retainage, and Balance\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(APTH.APTrans) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS GrossAmount,\n  SUM(APTH.DiscOffer) AS DiscountsOffered,\n  SUM(APTH.Retainage) AS RetainageHeld,\n  SUM(APTH.Balance) AS OpenBalance\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from APTH\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from APTH ().\n\n```sql\nSELECT *\nFROM APTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from ARTH\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from ARTH ().\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from SLWI\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from SLWI ().\n\n```sql\nSELECT *\nFROM SLWI WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "SLWI"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query to count records in prpc by company\n\nDatabase Schema:\nCREATE TABLE PRPC (\n  PRCo bcompany NOT NULL,\n  PRGroup bgroup NOT NULL,\n  PREndDate bdate NOT NULL,\n  BeginDate bdate NOT NULL,\n  MultiMth byn NOT NULL,\n  BeginMth bmonth NOT NULL,\n  EndMth bmonth,\n  CutoffDate bdate,\n  LimitMth bmonth NOT NULL,\n  Hrs smallint NOT NULL,\n  Days tinyint NOT NULL,\n  Wks tinyint NOT NULL,\n  Status tinyint NOT NULL,\n  DateClosed smalldatetime,\n  JCInterface byn NOT NULL,\n  EMInterface byn NOT NULL,\n  GLInterface byn NOT NULL,\n  APInterface byn NOT NULL,\n  LeaveProcess byn NOT NULL,\n  InUseBy bvpusername,\n  -- ... 7 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count PRPC records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM PRPC WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "PRPC"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find jobs over budget with remaining cost projection\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Find jobs over budget:\n1. Aggregate JCCP by job from JCJM\n2. Compare total ActualCost to CurrEstCost\n3. Use HAVING to filter only over-budget jobs\n4. Sort by amount over budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description,\n  SUM(JCCP.CurrEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.CurrEstCost) - SUM(JCCP.ActualCost) AS RemainingBudget,\n  CASE WHEN SUM(JCCP.CurrEstCost) < SUM(JCCP.ActualCost) \n       THEN 'OVER BUDGET' ELSE 'OK' END AS Status\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\nGROUP BY JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.CurrEstCost)\nORDER BY (SUM(JCCP.ActualCost) - SUM(JCCP.CurrEstCost)) DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCJM",
        "JCCD",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get job cost variance by phase comparing budget to actual\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Job cost variance by phase:\n1. Join JCJM (Job Master) to JCCP (Cost Phase)\n2. Calculate variance as CurrEstCost - ActualCost\n3. Calculate percent complete from actuals vs budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  JCCP.Phase,\n  JCCP.CostType,\n  JCCP.OrigEstCost AS OriginalBudget,\n  JCCP.CurrEstCost AS CurrentBudget,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS Variance,\n  CASE WHEN JCCP.CurrEstCost <> 0 \n       THEN (JCCP.ActualCost / JCCP.CurrEstCost) * 100 \n       ELSE 0 END AS PercentComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.Job = @Job\nORDER BY JCCP.Phase, JCCP.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find jobs over budget with remaining cost projection\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Find jobs over budget:\n1. Aggregate JCCP by job from JCJM\n2. Compare total ActualCost to CurrEstCost\n3. Use HAVING to filter only over-budget jobs\n4. Sort by amount over budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description,\n  SUM(JCCP.CurrEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.CurrEstCost) - SUM(JCCP.ActualCost) AS RemainingBudget,\n  CASE WHEN SUM(JCCP.CurrEstCost) < SUM(JCCP.ActualCost) \n       THEN 'OVER BUDGET' ELSE 'OK' END AS Status\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\nGROUP BY JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.CurrEstCost)\nORDER BY (SUM(JCCP.ActualCost) - SUM(JCCP.CurrEstCost)) DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM",
        "JCCD",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging with customer contact information\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I can partially answer this query, but the schema is incomplete.\n\nThe query requires ARCM (AR Customer Master) for customer details, but only ARTH is provided in the schema.\n\nHere's what I can provide with the available schema:\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n-- Note: Additional joins for ARCM would be needed for complete results\n```\n\nTo get the complete data you requested, please provide the DDL for ARCM.",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find all unpaid AR invoices older than 60 days\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find unpaid invoices over 60 days:\n1. Join ARTH to ARCM for customer information\n2. Filter PayFullDate IS NULL (unpaid)\n3. Use DATEDIFF to calculate age and filter > 60 days\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Mth,\n  ARTH.ARTrans,\n  ARCM.Name AS CustomerName,\n  ARTH.TransDate,\n  ARTH.Amount,\n  DATEDIFF(day, ARTH.TransDate, GETDATE()) AS DaysOutstanding\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\n  AND DATEDIFF(day, ARTH.TransDate, GETDATE()) > 60\nORDER BY ARTH.TransDate\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query to track ap hold status distinguishing retainage vs non-retainage holds\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APCO (\n  APCo bcompany NOT NULL,\n  GLCo bcompany NOT NULL,\n  ExpJrnl bjrnl,\n  GLExpInterfaceLvl tinyint NOT NULL,\n  GLExpSummaryDesc varchar(60),\n  GLExpTransDesc varchar(60),\n  GLJobDetailDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLEquipDetailDesc varchar(60),\n  GLExpDetailDesc varchar(60),\n  PayJrnl bjrnl,\n  GLPayInterfaceLvl tinyint NOT NULL,\n  GLPayDetailDesc varchar(60),\n  GLPaySummaryDesc varchar(60),\n  DiscOffGLAcct bglacct,\n  DiscTakenGLAcct bglacct,\n  ExpPayType tinyint,\n  JobPayType tinyint,\n  SubPayType tinyint,\n  RetPayType tinyint,\n  -- ... 92 more columns,\n  PRIMARY KEY (APCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To distinguish retainage vs non-retainage holds:\n1. Join APTD to APHD for hold details\n2. Join APCO to get RetHoldCode setting\n3. Compare APHD.HoldCode to APCO.RetHoldCode\n4. If equal, it's a retainage hold; otherwise non-retainage\n\n```sql\nSELECT \n  APTD.APCo,\n  APTD.Vendor,\n  APTD.Mth,\n  APTD.APTrans,\n  APHD.HoldCode,\n  CASE WHEN APHD.HoldCode = APCO.RetHoldCode \n       THEN 'Retainage Hold' \n       ELSE 'Non-Retainage Hold' END AS HoldType,\n  APTD.Amount\nFROM APTD WITH (NOLOCK)\nINNER JOIN APHD WITH (NOLOCK) ON APTD.APCo = APHD.APCo \n  AND APTD.Mth = APHD.Mth \n  AND APTD.APTrans = APHD.APTrans \n  AND APTD.APLine = APHD.APLine\nINNER JOIN APCO WITH (NOLOCK) ON APTD.APCo = APCO.APCo\nWHERE APTD.APCo = @APCo\n  AND APHD.HoldCode IS NOT NULL\nORDER BY APTD.Vendor, APTD.Mth\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTD",
        "APHD",
        "APCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate stored materials (Purchased - Installed) for SL billing\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Stored materials for SL billing:\n1. SLWI contains work item/billing details\n2. StoredMatls = Purchased - Installed (materials on-site but not yet used)\n3. WCCost = Work Completed Cost\n4. WCRetAmt and SMRetAmt = separate retainage for work vs materials\n5. Total billable = WCCost + StoredMatls\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description AS ItemDescription,\n  SLWI.StoredMatls,\n  SLWI.WCCost AS WorkCompletedCost,\n  SLWI.StoredMatls + SLWI.WCCost AS TotalBillable,\n  SLWI.WCRetAmt AS WorkRetainage,\n  SLWI.SMRetAmt AS MaterialsRetainage,\n  SLWI.WCRetAmt + SLWI.SMRetAmt AS TotalRetainage\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\n  AND SLWI.StoredMatls <> 0\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "basic",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from APTD\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from APTD ().\n\n```sql\nSELECT *\nFROM APTD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find jobs over budget with remaining cost projection\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Find jobs over budget:\n1. Aggregate JCCP by job from JCJM\n2. Compare total ActualCost to CurrEstCost\n3. Use HAVING to filter only over-budget jobs\n4. Sort by amount over budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description,\n  SUM(JCCP.CurrEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.CurrEstCost) - SUM(JCCP.ActualCost) AS RemainingBudget,\n  CASE WHEN SUM(JCCP.CurrEstCost) < SUM(JCCP.ActualCost) \n       THEN 'OVER BUDGET' ELSE 'OK' END AS Status\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\nGROUP BY JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.CurrEstCost)\nORDER BY (SUM(JCCP.ActualCost) - SUM(JCCP.CurrEstCost)) DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCJM",
        "JCCD",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoices with their subcontract details\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I can partially answer this query, but the schema is incomplete.\n\nTo include subcontract details, the SLHD table is needed but not provided in the schema.\n\nHere's what I can provide with the available schema:\n\n```sql\nSELECT *\nFROM APTH WITH (NOLOCK)\nWHERE Co = @Co\n-- Note: Additional joins for SLHD would be needed for complete results\n```\n\nTo get the complete data you requested, please provide the DDL for SLHD.",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": [
        "APTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate stored materials (Purchased - Installed) for SL billing\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Stored materials for SL billing:\n1. SLWI contains work item/billing details\n2. StoredMatls = Purchased - Installed (materials on-site but not yet used)\n3. WCCost = Work Completed Cost\n4. WCRetAmt and SMRetAmt = separate retainage for work vs materials\n5. Total billable = WCCost + StoredMatls\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description AS ItemDescription,\n  SLWI.StoredMatls,\n  SLWI.WCCost AS WorkCompletedCost,\n  SLWI.StoredMatls + SLWI.WCCost AS TotalBillable,\n  SLWI.WCRetAmt AS WorkRetainage,\n  SLWI.SMRetAmt AS MaterialsRetainage,\n  SLWI.WCRetAmt + SLWI.SMRetAmt AS TotalRetainage\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\n  AND SLWI.StoredMatls <> 0\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "intermediate",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging buckets (30/60/90+ days) for unpaid invoices by customer\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Use ARTH for transaction data and ARCM for customer names\n2. Filter PayFullDate IS NULL to get only unpaid invoices\n3. Use DATEDIFF and CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from GLDT\n\nDatabase Schema:\nCREATE TABLE GLDT (\n  GLCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  GLTrans btrans NOT NULL,\n  GLAcct bglacct NOT NULL,\n  Jrnl bjrnl NOT NULL,\n  GLRef bglref NOT NULL,\n  SourceCo bcompany NOT NULL,\n  Source bsource NOT NULL,\n  ActDate bdate NOT NULL,\n  DatePosted bdate NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid NOT NULL,\n  Amount bdollar NOT NULL,\n  RevStatus tinyint NOT NULL,\n  Adjust char(1) NOT NULL,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  UniqueAttchID uniqueidentifier,\n  SrcTable varchar(128),\n  SrcKeyID bigint,\n  PRIMARY KEY (GLCo, Mth, GLTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from GLDT ().\n\n```sql\nSELECT *\nFROM GLDT WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "GLDT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to count records in jccd by company\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count JCCD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM JCCD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging buckets (30/60/90+ days) for unpaid invoices by customer\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Use ARTH for transaction data and ARCM for customer names\n2. Filter PayFullDate IS NULL to get only unpaid invoices\n3. Use DATEDIFF and CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How do I aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from PREH\n\nDatabase Schema:\nCREATE TABLE PREH (\n  PRCo bcompany NOT NULL,\n  Employee bemployee NOT NULL,\n  LastName varchar(30) NOT NULL,\n  FirstName varchar(30),\n  MidName varchar(15),\n  SortName bsortname NOT NULL,\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  Phone bphone,\n  SSN char(11) NOT NULL,\n  Race char(2) NOT NULL,\n  Sex char(1) NOT NULL,\n  BirthDate smalldatetime,\n  HireDate bdate,\n  TermDate bdate,\n  PRGroup bgroup NOT NULL,\n  PRDept bdept NOT NULL,\n  -- ... 121 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from PREH ().\n\n```sql\nSELECT *\nFROM PREH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "PREH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to join GLDT with the available tables\n\nDatabase Schema:\nCREATE TABLE PREH (\n  PRCo bcompany NOT NULL,\n  Employee bemployee NOT NULL,\n  LastName varchar(30) NOT NULL,\n  FirstName varchar(30),\n  MidName varchar(15),\n  SortName bsortname NOT NULL,\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  Phone bphone,\n  SSN char(11) NOT NULL,\n  Race char(2) NOT NULL,\n  Sex char(1) NOT NULL,\n  BirthDate smalldatetime,\n  HireDate bdate,\n  TermDate bdate,\n  PRGroup bgroup NOT NULL,\n  PRDept bdept NOT NULL,\n  -- ... 121 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nCREATE TABLE PRTH (\n  PRCo bcompany NOT NULL,\n  PRGroup bgroup NOT NULL,\n  PREndDate bdate NOT NULL,\n  Employee bemployee NOT NULL,\n  PaySeq tinyint NOT NULL,\n  PostSeq smallint NOT NULL,\n  Type char(1) NOT NULL,\n  PostDate bdate NOT NULL,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCDept bdept,\n  GLCo bcompany NOT NULL,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equipment bequip,\n  EMGroup tinyint,\n  CostCode bcostcode,\n  -- ... 41 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'GLDT' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nPREH, PRTH\n\nTo include GLDT in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from GLAC\n\nDatabase Schema:\nCREATE TABLE GLAC (\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  Description bdesc,\n  AcctType char(1) NOT NULL,\n  SubType char(1),\n  NormBal char(1),\n  InterfaceDetail byn NOT NULL,\n  Active byn NOT NULL,\n  SummaryAcct bglacct NOT NULL,\n  CashAccrual char(1) NOT NULL,\n  CashOffAcct bglacct,\n  Notes varchar,\n  Part1 varchar(20),\n  Part2 varchar(20),\n  Part3 varchar(20),\n  Part4 varchar(20),\n  Part5 varchar(20),\n  Part6 varchar(20),\n  AllParts varchar(20),\n  CrossRefMemAcct bglacct,\n  -- ... 3 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from GLAC ().\n\n```sql\nSELECT *\nFROM GLAC WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "GLAC"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to count records in aptd by company\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count APTD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM APTD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from APTH\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from APTH ().\n\n```sql\nSELECT *\nFROM APTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "APTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to query Departments\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'Departments' does not exist in Viewpoint Vista.\n\nUse JCDP (JC Department) for department information.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM JCDP WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoice totals with discounts and retainage\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Vendor invoice summary with discounts and retainage:\n1. Join APTH to APVM for vendor details\n2. Aggregate by vendor\n3. Include GrossAmt, DiscOffer, Retainage, and Balance\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(APTH.APTrans) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS GrossAmount,\n  SUM(APTH.DiscOffer) AS DiscountsOffered,\n  SUM(APTH.Retainage) AS RetainageHeld,\n  SUM(APTH.Balance) AS OpenBalance\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "basic",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging with customer contact information\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I can partially answer this query, but the schema is incomplete.\n\nThe query requires ARCM (AR Customer Master) for customer details, but only ARTH is provided in the schema.\n\nHere's what I can provide with the available schema:\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n-- Note: Additional joins for ARCM would be needed for complete results\n```\n\nTo get the complete data you requested, please provide the DDL for ARCM.",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get data from SLHD for analysis\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'SLHD' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nJCJM, JCCD\n\nTo include SLHD in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need to count records in preh by company\n\nDatabase Schema:\nCREATE TABLE PREH (\n  PRCo bcompany NOT NULL,\n  Employee bemployee NOT NULL,\n  LastName varchar(30) NOT NULL,\n  FirstName varchar(30),\n  MidName varchar(15),\n  SortName bsortname NOT NULL,\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  Phone bphone,\n  SSN char(11) NOT NULL,\n  Race char(2) NOT NULL,\n  Sex char(1) NOT NULL,\n  BirthDate smalldatetime,\n  HireDate bdate,\n  TermDate bdate,\n  PRGroup bgroup NOT NULL,\n  PRDept bdept NOT NULL,\n  -- ... 121 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count PREH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM PREH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "PREH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to reconcile ap oncost batch lines with original transactions\n\nDatabase Schema:\nCREATE TABLE APTL (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equip bequip,\n  EMGroup bgroup,\n  -- ... 56 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans, APLine)\n);\n\nCREATE TABLE APLB (\n  Co bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  BatchId bbatchid NOT NULL,\n  BatchSeq int NOT NULL,\n  APLine smallint NOT NULL,\n  BatchTransType char(1) NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  -- ... 120 more columns,\n  PRIMARY KEY (Co, Mth, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APHB (\n  Co bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  BatchId bbatchid NOT NULL,\n  BatchSeq int NOT NULL,\n  BatchTransType char(1) NOT NULL,\n  APTrans btrans,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  -- ... 88 more columns,\n  PRIMARY KEY (Co, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To reconcile AP oncost batches with original transactions:\n1. Join APLB (batch lines) to APTL (original lines) using ocApplyMth, ocApplyTrans, ocApplyLine\n2. Include APHB for batch header info\n3. Join to APTH and APVM for vendor context\n4. Compare batch vs original amounts\n\n```sql\nSELECT \n  APLB.Co AS BatchCo,\n  APLB.Mth AS BatchMth,\n  APLB.BatchId,\n  APLB.BatchSeq,\n  APLB.ocApplyMth,\n  APLB.ocApplyTrans,\n  APLB.ocApplyLine,\n  APTL.APCo AS OrigCo,\n  APTL.Mth AS OrigMth,\n  APTL.APTrans AS OrigTrans,\n  APTL.APLine AS OrigLine,\n  APTL.GrossAmt AS OrigAmount,\n  APLB.GrossAmt AS BatchAmount,\n  APVM.Name AS VendorName\nFROM APLB WITH (NOLOCK)\nINNER JOIN APHB WITH (NOLOCK) ON APLB.Co = APHB.Co AND APLB.Mth = APHB.Mth AND APLB.BatchId = APHB.BatchId\nINNER JOIN APTL WITH (NOLOCK) ON APLB.ocApplyMth = APTL.Mth \n  AND APLB.ocApplyTrans = APTL.APTrans \n  AND APLB.ocApplyLine = APTL.APLine\n  AND APLB.Co = APTL.APCo\nINNER JOIN APTH WITH (NOLOCK) ON APTL.APCo = APTH.APCo AND APTL.Mth = APTH.Mth AND APTL.APTrans = APTH.APTrans\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APLB.Co = @Co\nORDER BY APLB.BatchId, APLB.BatchSeq\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "basic",
      "tables_used": [
        "APLB",
        "APHB",
        "APTL",
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate stored materials (Purchased - Installed) for SL billing\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Stored materials for SL billing:\n1. SLWI contains work item/billing details\n2. StoredMatls = Purchased - Installed (materials on-site but not yet used)\n3. WCCost = Work Completed Cost\n4. WCRetAmt and SMRetAmt = separate retainage for work vs materials\n5. Total billable = WCCost + StoredMatls\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description AS ItemDescription,\n  SLWI.StoredMatls,\n  SLWI.WCCost AS WorkCompletedCost,\n  SLWI.StoredMatls + SLWI.WCCost AS TotalBillable,\n  SLWI.WCRetAmt AS WorkRetainage,\n  SLWI.SMRetAmt AS MaterialsRetainage,\n  SLWI.WCRetAmt + SLWI.SMRetAmt AS TotalRetainage\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\n  AND SLWI.StoredMatls <> 0\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "intermediate",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find all unpaid AR invoices older than 60 days\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find unpaid invoices over 60 days:\n1. Join ARTH to ARCM for customer information\n2. Filter PayFullDate IS NULL (unpaid)\n3. Use DATEDIFF to calculate age and filter > 60 days\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Mth,\n  ARTH.ARTrans,\n  ARCM.Name AS CustomerName,\n  ARTH.TransDate,\n  ARTH.Amount,\n  DATEDIFF(day, ARTH.TransDate, GETDATE()) AS DaysOutstanding\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\n  AND DATEDIFF(day, ARTH.TransDate, GETDATE()) > 60\nORDER BY ARTH.TransDate\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from APTH\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from APTH ().\n\n```sql\nSELECT *\nFROM APTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "APTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How do I track ap hold status distinguishing retainage vs non-retainage holds\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APCO (\n  APCo bcompany NOT NULL,\n  GLCo bcompany NOT NULL,\n  ExpJrnl bjrnl,\n  GLExpInterfaceLvl tinyint NOT NULL,\n  GLExpSummaryDesc varchar(60),\n  GLExpTransDesc varchar(60),\n  GLJobDetailDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLEquipDetailDesc varchar(60),\n  GLExpDetailDesc varchar(60),\n  PayJrnl bjrnl,\n  GLPayInterfaceLvl tinyint NOT NULL,\n  GLPayDetailDesc varchar(60),\n  GLPaySummaryDesc varchar(60),\n  DiscOffGLAcct bglacct,\n  DiscTakenGLAcct bglacct,\n  ExpPayType tinyint,\n  JobPayType tinyint,\n  SubPayType tinyint,\n  RetPayType tinyint,\n  -- ... 92 more columns,\n  PRIMARY KEY (APCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To distinguish retainage vs non-retainage holds:\n1. Join APTD to APHD for hold details\n2. Join APCO to get RetHoldCode setting\n3. Compare APHD.HoldCode to APCO.RetHoldCode\n4. If equal, it's a retainage hold; otherwise non-retainage\n\n```sql\nSELECT \n  APTD.APCo,\n  APTD.Vendor,\n  APTD.Mth,\n  APTD.APTrans,\n  APHD.HoldCode,\n  CASE WHEN APHD.HoldCode = APCO.RetHoldCode \n       THEN 'Retainage Hold' \n       ELSE 'Non-Retainage Hold' END AS HoldType,\n  APTD.Amount\nFROM APTD WITH (NOLOCK)\nINNER JOIN APHD WITH (NOLOCK) ON APTD.APCo = APHD.APCo \n  AND APTD.Mth = APHD.Mth \n  AND APTD.APTrans = APHD.APTrans \n  AND APTD.APLine = APHD.APLine\nINNER JOIN APCO WITH (NOLOCK) ON APTD.APCo = APCO.APCo\nWHERE APTD.APCo = @APCo\n  AND APHD.HoldCode IS NOT NULL\nORDER BY APTD.Vendor, APTD.Mth\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "basic",
      "tables_used": [
        "APTD",
        "APHD",
        "APCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get job cost variance by phase comparing budget to actual\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Job cost variance by phase:\n1. Join JCJM (Job Master) to JCCP (Cost Phase)\n2. Calculate variance as CurrEstCost - ActualCost\n3. Calculate percent complete from actuals vs budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  JCCP.Phase,\n  JCCP.CostType,\n  JCCP.OrigEstCost AS OriginalBudget,\n  JCCP.CurrEstCost AS CurrentBudget,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS Variance,\n  CASE WHEN JCCP.CurrEstCost <> 0 \n       THEN (JCCP.ActualCost / JCCP.CurrEstCost) * 100 \n       ELSE 0 END AS PercentComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.Job = @Job\nORDER BY JCCP.Phase, JCCP.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from PRPC\n\nDatabase Schema:\nCREATE TABLE PRPC (\n  PRCo bcompany NOT NULL,\n  PRGroup bgroup NOT NULL,\n  PREndDate bdate NOT NULL,\n  BeginDate bdate NOT NULL,\n  MultiMth byn NOT NULL,\n  BeginMth bmonth NOT NULL,\n  EndMth bmonth,\n  CutoffDate bdate,\n  LimitMth bmonth NOT NULL,\n  Hrs smallint NOT NULL,\n  Days tinyint NOT NULL,\n  Wks tinyint NOT NULL,\n  Status tinyint NOT NULL,\n  DateClosed smalldatetime,\n  JCInterface byn NOT NULL,\n  EMInterface byn NOT NULL,\n  GLInterface byn NOT NULL,\n  APInterface byn NOT NULL,\n  LeaveProcess byn NOT NULL,\n  InUseBy bvpusername,\n  -- ... 7 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from PRPC ().\n\n```sql\nSELECT *\nFROM PRPC WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "PRPC"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get customer balance summary by customer group\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Customer balance summary by group:\n1. Join ARTH to ARCM for customer details\n2. Use conditional SUM for open vs total balances\n3. Group by CustGroup for summary\n\n```sql\nSELECT \n  ARTH.CustGroup,\n  COUNT(DISTINCT ARTH.Customer) AS CustomerCount,\n  SUM(CASE WHEN ARTH.PayFullDate IS NULL THEN ARTH.Amount ELSE 0 END) AS OpenBalance,\n  SUM(ARTH.Amount) AS TotalBilled\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\nGROUP BY ARTH.CustGroup\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoices with their subcontract details\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I can partially answer this query, but the schema is incomplete.\n\nTo include subcontract details, the SLHD table is needed but not provided in the schema.\n\nHere's what I can provide with the available schema:\n\n```sql\nSELECT *\nFROM APTH WITH (NOLOCK)\nWHERE Co = @Co\n-- Note: Additional joins for SLHD would be needed for complete results\n```\n\nTo get the complete data you requested, please provide the DDL for SLHD.",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": [
        "APTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get subcontractor costs with original, change orders, invoiced, paid, and retainage by vendor\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Subcontractor cost breakdown by vendor:\n1. Join SLHD (Header) to SLIT (Items) for subcontract details\n2. Join APVM for vendor names\n3. OrigCost = original contract amount\n4. CurCost - OrigCost = change order amounts\n5. InvCost = amounts invoiced\n6. Retainage = amounts held back\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  SLHD.SL AS SubcontractNum,\n  SLHD.Description AS SubcontractDesc,\n  SUM(SLIT.OrigCost) AS OriginalCost,\n  SUM(SLIT.CurCost - SLIT.OrigCost) AS ChangeOrderCost,\n  SUM(SLIT.CurCost) AS CurrentCost,\n  SUM(SLIT.InvCost) AS InvoicedCost,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost - SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nINNER JOIN APVM WITH (NOLOCK) ON SLHD.VendorGroup = APVM.VendorGroup AND SLHD.Vendor = APVM.Vendor\nWHERE SLHD.SLCo = @SLCo\nGROUP BY APVM.Vendor, APVM.Name, SLHD.SL, SLHD.Description\nORDER BY APVM.Name, SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "basic",
      "tables_used": [
        "SLHD",
        "SLIT",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from PREH\n\nDatabase Schema:\nCREATE TABLE PREH (\n  PRCo bcompany NOT NULL,\n  Employee bemployee NOT NULL,\n  LastName varchar(30) NOT NULL,\n  FirstName varchar(30),\n  MidName varchar(15),\n  SortName bsortname NOT NULL,\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  Phone bphone,\n  SSN char(11) NOT NULL,\n  Race char(2) NOT NULL,\n  Sex char(1) NOT NULL,\n  BirthDate smalldatetime,\n  HireDate bdate,\n  TermDate bdate,\n  PRGroup bgroup NOT NULL,\n  PRDept bdept NOT NULL,\n  -- ... 121 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from PREH ().\n\n```sql\nSELECT *\nFROM PREH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "PREH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query to aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: List all fields in Employees\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'Employees' does not exist in Viewpoint Vista.\n\nUse PREH (PR Employee Header) for employee information.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM PREH WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find jobs over budget with remaining cost projection\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Find jobs over budget:\n1. Aggregate JCCP by job from JCJM\n2. Compare total ActualCost to CurrEstCost\n3. Use HAVING to filter only over-budget jobs\n4. Sort by amount over budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description,\n  SUM(JCCP.CurrEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.CurrEstCost) - SUM(JCCP.ActualCost) AS RemainingBudget,\n  CASE WHEN SUM(JCCP.CurrEstCost) < SUM(JCCP.ActualCost) \n       THEN 'OVER BUDGET' ELSE 'OK' END AS Status\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\nGROUP BY JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.CurrEstCost)\nORDER BY (SUM(JCCP.ActualCost) - SUM(JCCP.CurrEstCost)) DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCJM",
        "JCCD",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find all unpaid AR invoices older than 60 days\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find unpaid invoices over 60 days:\n1. Join ARTH to ARCM for customer information\n2. Filter PayFullDate IS NULL (unpaid)\n3. Use DATEDIFF to calculate age and filter > 60 days\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Mth,\n  ARTH.ARTrans,\n  ARCM.Name AS CustomerName,\n  ARTH.TransDate,\n  ARTH.Amount,\n  DATEDIFF(day, ARTH.TransDate, GETDATE()) AS DaysOutstanding\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\n  AND DATEDIFF(day, ARTH.TransDate, GETDATE()) > 60\nORDER BY ARTH.TransDate\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Query PREH along with the schema tables\n\nDatabase Schema:\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'PREH' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nSLHD, SLIT\n\nTo include PREH in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate stored materials (Purchased - Installed) for SL billing\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Stored materials for SL billing:\n1. SLWI contains work item/billing details\n2. StoredMatls = Purchased - Installed (materials on-site but not yet used)\n3. WCCost = Work Completed Cost\n4. WCRetAmt and SMRetAmt = separate retainage for work vs materials\n5. Total billable = WCCost + StoredMatls\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description AS ItemDescription,\n  SLWI.StoredMatls,\n  SLWI.WCCost AS WorkCompletedCost,\n  SLWI.StoredMatls + SLWI.WCCost AS TotalBillable,\n  SLWI.WCRetAmt AS WorkRetainage,\n  SLWI.SMRetAmt AS MaterialsRetainage,\n  SLWI.WCRetAmt + SLWI.SMRetAmt AS TotalRetainage\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\n  AND SLWI.StoredMatls <> 0\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "basic",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from SLWI\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from SLWI ().\n\n```sql\nSELECT *\nFROM SLWI WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "SLWI"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to count records in slhd by company\n\nDatabase Schema:\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count SLHD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM SLHD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLHD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to count records in jccd by company\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count JCCD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM JCCD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How do I aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: track ap hold status distinguishing retainage vs non-retainage holds\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APCO (\n  APCo bcompany NOT NULL,\n  GLCo bcompany NOT NULL,\n  ExpJrnl bjrnl,\n  GLExpInterfaceLvl tinyint NOT NULL,\n  GLExpSummaryDesc varchar(60),\n  GLExpTransDesc varchar(60),\n  GLJobDetailDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLEquipDetailDesc varchar(60),\n  GLExpDetailDesc varchar(60),\n  PayJrnl bjrnl,\n  GLPayInterfaceLvl tinyint NOT NULL,\n  GLPayDetailDesc varchar(60),\n  GLPaySummaryDesc varchar(60),\n  DiscOffGLAcct bglacct,\n  DiscTakenGLAcct bglacct,\n  ExpPayType tinyint,\n  JobPayType tinyint,\n  SubPayType tinyint,\n  RetPayType tinyint,\n  -- ... 92 more columns,\n  PRIMARY KEY (APCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To distinguish retainage vs non-retainage holds:\n1. Join APTD to APHD for hold details\n2. Join APCO to get RetHoldCode setting\n3. Compare APHD.HoldCode to APCO.RetHoldCode\n4. If equal, it's a retainage hold; otherwise non-retainage\n\n```sql\nSELECT \n  APTD.APCo,\n  APTD.Vendor,\n  APTD.Mth,\n  APTD.APTrans,\n  APHD.HoldCode,\n  CASE WHEN APHD.HoldCode = APCO.RetHoldCode \n       THEN 'Retainage Hold' \n       ELSE 'Non-Retainage Hold' END AS HoldType,\n  APTD.Amount\nFROM APTD WITH (NOLOCK)\nINNER JOIN APHD WITH (NOLOCK) ON APTD.APCo = APHD.APCo \n  AND APTD.Mth = APHD.Mth \n  AND APTD.APTrans = APHD.APTrans \n  AND APTD.APLine = APHD.APLine\nINNER JOIN APCO WITH (NOLOCK) ON APTD.APCo = APCO.APCo\nWHERE APTD.APCo = @APCo\n  AND APHD.HoldCode IS NOT NULL\nORDER BY APTD.Vendor, APTD.Mth\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "basic",
      "tables_used": [
        "APTD",
        "APHD",
        "APCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query to aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from ARTH\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from ARTH ().\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to count records in aptd by company\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count APTD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM APTD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need to count records in slwi by company\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count SLWI records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM SLWI WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "SLWI"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from APTH\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from APTH ().\n\n```sql\nSELECT *\nFROM APTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "APTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from ARTH\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from ARTH ().\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from GLAC\n\nDatabase Schema:\nCREATE TABLE GLAC (\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  Description bdesc,\n  AcctType char(1) NOT NULL,\n  SubType char(1),\n  NormBal char(1),\n  InterfaceDetail byn NOT NULL,\n  Active byn NOT NULL,\n  SummaryAcct bglacct NOT NULL,\n  CashAccrual char(1) NOT NULL,\n  CashOffAcct bglacct,\n  Notes varchar,\n  Part1 varchar(20),\n  Part2 varchar(20),\n  Part3 varchar(20),\n  Part4 varchar(20),\n  Part5 varchar(20),\n  Part6 varchar(20),\n  AllParts varchar(20),\n  CrossRefMemAcct bglacct,\n  -- ... 3 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from GLAC ().\n\n```sql\nSELECT *\nFROM GLAC WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "GLAC"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging buckets (30/60/90+ days) for unpaid invoices by customer\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Use ARTH for transaction data and ARCM for customer names\n2. Filter PayFullDate IS NULL to get only unpaid invoices\n3. Use DATEDIFF and CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate stored materials (Purchased - Installed) for SL billing\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Stored materials for SL billing:\n1. SLWI contains work item/billing details\n2. StoredMatls = Purchased - Installed (materials on-site but not yet used)\n3. WCCost = Work Completed Cost\n4. WCRetAmt and SMRetAmt = separate retainage for work vs materials\n5. Total billable = WCCost + StoredMatls\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description AS ItemDescription,\n  SLWI.StoredMatls,\n  SLWI.WCCost AS WorkCompletedCost,\n  SLWI.StoredMatls + SLWI.WCCost AS TotalBillable,\n  SLWI.WCRetAmt AS WorkRetainage,\n  SLWI.SMRetAmt AS MaterialsRetainage,\n  SLWI.WCRetAmt + SLWI.SMRetAmt AS TotalRetainage\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\n  AND SLWI.StoredMatls <> 0\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "basic",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from SLHD\n\nDatabase Schema:\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from SLHD ().\n\n```sql\nSELECT *\nFROM SLHD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLHD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need to count records in jccd by company\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count JCCD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM JCCD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get job cost variance by phase comparing budget to actual\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Job cost variance by phase:\n1. Join JCJM (Job Master) to JCCP (Cost Phase)\n2. Calculate variance as CurrEstCost - ActualCost\n3. Calculate percent complete from actuals vs budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  JCCP.Phase,\n  JCCP.CostType,\n  JCCP.OrigEstCost AS OriginalBudget,\n  JCCP.CurrEstCost AS CurrentBudget,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS Variance,\n  CASE WHEN JCCP.CurrEstCost <> 0 \n       THEN (JCCP.ActualCost / JCCP.CurrEstCost) * 100 \n       ELSE 0 END AS PercentComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.Job = @Job\nORDER BY JCCP.Phase, JCCP.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to query TimeCard\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'TimeCard' does not exist in Viewpoint Vista.\n\nUse PRTH (PR Timecard Header) for timecard information.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM PRTH WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from SLWI\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from SLWI ().\n\n```sql\nSELECT *\nFROM SLWI WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLWI"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from JCCD\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from JCCD ().\n\n```sql\nSELECT *\nFROM JCCD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find jobs over budget with remaining cost projection\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Find jobs over budget:\n1. Aggregate JCCP by job from JCJM\n2. Compare total ActualCost to CurrEstCost\n3. Use HAVING to filter only over-budget jobs\n4. Sort by amount over budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description,\n  SUM(JCCP.CurrEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.CurrEstCost) - SUM(JCCP.ActualCost) AS RemainingBudget,\n  CASE WHEN SUM(JCCP.CurrEstCost) < SUM(JCCP.ActualCost) \n       THEN 'OVER BUDGET' ELSE 'OK' END AS Status\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\nGROUP BY JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.CurrEstCost)\nORDER BY (SUM(JCCP.ActualCost) - SUM(JCCP.CurrEstCost)) DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCJM",
        "JCCD",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to count records in jccd by company\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count JCCD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM JCCD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate stored materials (Purchased - Installed) for SL billing\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Stored materials for SL billing:\n1. SLWI contains work item/billing details\n2. StoredMatls = Purchased - Installed (materials on-site but not yet used)\n3. WCCost = Work Completed Cost\n4. WCRetAmt and SMRetAmt = separate retainage for work vs materials\n5. Total billable = WCCost + StoredMatls\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description AS ItemDescription,\n  SLWI.StoredMatls,\n  SLWI.WCCost AS WorkCompletedCost,\n  SLWI.StoredMatls + SLWI.WCCost AS TotalBillable,\n  SLWI.WCRetAmt AS WorkRetainage,\n  SLWI.SMRetAmt AS MaterialsRetainage,\n  SLWI.WCRetAmt + SLWI.SMRetAmt AS TotalRetainage\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\n  AND SLWI.StoredMatls <> 0\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging buckets (30/60/90+ days) for unpaid invoices by customer\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Use ARTH for transaction data and ARCM for customer names\n2. Filter PayFullDate IS NULL to get only unpaid invoices\n3. Use DATEDIFF and CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from SLHD\n\nDatabase Schema:\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from SLHD ().\n\n```sql\nSELECT *\nFROM SLHD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "SLHD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Query SLHD along with the schema tables\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'SLHD' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nJCJM, JCCD\n\nTo include SLHD in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoice totals with discounts and retainage\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Vendor invoice summary with discounts and retainage:\n1. Join APTH to APVM for vendor details\n2. Aggregate by vendor\n3. Include GrossAmt, DiscOffer, Retainage, and Balance\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(APTH.APTrans) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS GrossAmount,\n  SUM(APTH.DiscOffer) AS DiscountsOffered,\n  SUM(APTH.Retainage) AS RetainageHeld,\n  SUM(APTH.Balance) AS OpenBalance\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from JCCD\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from JCCD ().\n\n```sql\nSELECT *\nFROM JCCD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging buckets (30/60/90+ days) for unpaid invoices by customer\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Use ARTH for transaction data and ARCM for customer names\n2. Filter PayFullDate IS NULL to get only unpaid invoices\n3. Use DATEDIFF and CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How do I count records in prco by company\n\nDatabase Schema:\nCREATE TABLE PRCO (\n  PRCo bcompany NOT NULL,\n  GLCo bcompany NOT NULL,\n  Jrnl bjrnl,\n  GLInterface byn NOT NULL,\n  CMCo bcompany NOT NULL,\n  APCo bcompany,\n  AutoOT byn NOT NULL,\n  OTEarnCode bedlcode,\n  JCCo bcompany NOT NULL,\n  AllowNoPhase byn NOT NULL,\n  JCInterface byn NOT NULL,\n  InsByPhase byn NOT NULL,\n  JCICraftClass byn NOT NULL,\n  JCICrew byn NOT NULL,\n  JCIEmployee byn NOT NULL,\n  JCIFactor byn NOT NULL,\n  JCIEarnType byn NOT NULL,\n  JCIShift byn NOT NULL,\n  JCIPostingDate byn NOT NULL,\n  JCILiabType byn NOT NULL,\n  -- ... 66 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count PRCO records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM PRCO WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "PRCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from JCCD\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from JCCD ().\n\n```sql\nSELECT *\nFROM JCCD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find jobs over budget with remaining cost projection\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Find jobs over budget:\n1. Aggregate JCCP by job from JCJM\n2. Compare total ActualCost to CurrEstCost\n3. Use HAVING to filter only over-budget jobs\n4. Sort by amount over budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description,\n  SUM(JCCP.CurrEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.CurrEstCost) - SUM(JCCP.ActualCost) AS RemainingBudget,\n  CASE WHEN SUM(JCCP.CurrEstCost) < SUM(JCCP.ActualCost) \n       THEN 'OVER BUDGET' ELSE 'OK' END AS Status\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\nGROUP BY JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.CurrEstCost)\nORDER BY (SUM(JCCP.ActualCost) - SUM(JCCP.CurrEstCost)) DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCJM",
        "JCCD",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate stored materials (Purchased - Installed) for SL billing\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Stored materials for SL billing:\n1. SLWI contains work item/billing details\n2. StoredMatls = Purchased - Installed (materials on-site but not yet used)\n3. WCCost = Work Completed Cost\n4. WCRetAmt and SMRetAmt = separate retainage for work vs materials\n5. Total billable = WCCost + StoredMatls\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description AS ItemDescription,\n  SLWI.StoredMatls,\n  SLWI.WCCost AS WorkCompletedCost,\n  SLWI.StoredMatls + SLWI.WCCost AS TotalBillable,\n  SLWI.WCRetAmt AS WorkRetainage,\n  SLWI.SMRetAmt AS MaterialsRetainage,\n  SLWI.WCRetAmt + SLWI.SMRetAmt AS TotalRetainage\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\n  AND SLWI.StoredMatls <> 0\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from ARTH\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from ARTH ().\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from JCCD\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from JCCD ().\n\n```sql\nSELECT *\nFROM JCCD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoice totals with discounts and retainage\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Vendor invoice summary with discounts and retainage:\n1. Join APTH to APVM for vendor details\n2. Aggregate by vendor\n3. Include GrossAmt, DiscOffer, Retainage, and Balance\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(APTH.APTrans) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS GrossAmount,\n  SUM(APTH.DiscOffer) AS DiscountsOffered,\n  SUM(APTH.Retainage) AS RetainageHeld,\n  SUM(APTH.Balance) AS OpenBalance\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from SLWI\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from SLWI ().\n\n```sql\nSELECT *\nFROM SLWI WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "SLWI"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Include ARCM in the query\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'ARCM' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nAPTH, APVM\n\nTo include ARCM in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get customer balance summary by customer group\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Customer balance summary by group:\n1. Join ARTH to ARCM for customer details\n2. Use conditional SUM for open vs total balances\n3. Group by CustGroup for summary\n\n```sql\nSELECT \n  ARTH.CustGroup,\n  COUNT(DISTINCT ARTH.Customer) AS CustomerCount,\n  SUM(CASE WHEN ARTH.PayFullDate IS NULL THEN ARTH.Amount ELSE 0 END) AS OpenBalance,\n  SUM(ARTH.Amount) AS TotalBilled\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\nGROUP BY ARTH.CustGroup\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get subcontractor costs with original, change orders, invoiced, paid, and retainage by vendor\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Subcontractor cost breakdown by vendor:\n1. Join SLHD (Header) to SLIT (Items) for subcontract details\n2. Join APVM for vendor names\n3. OrigCost = original contract amount\n4. CurCost - OrigCost = change order amounts\n5. InvCost = amounts invoiced\n6. Retainage = amounts held back\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  SLHD.SL AS SubcontractNum,\n  SLHD.Description AS SubcontractDesc,\n  SUM(SLIT.OrigCost) AS OriginalCost,\n  SUM(SLIT.CurCost - SLIT.OrigCost) AS ChangeOrderCost,\n  SUM(SLIT.CurCost) AS CurrentCost,\n  SUM(SLIT.InvCost) AS InvoicedCost,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost - SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nINNER JOIN APVM WITH (NOLOCK) ON SLHD.VendorGroup = APVM.VendorGroup AND SLHD.Vendor = APVM.Vendor\nWHERE SLHD.SLCo = @SLCo\nGROUP BY APVM.Vendor, APVM.Name, SLHD.SL, SLHD.Description\nORDER BY APVM.Name, SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLHD",
        "SLIT",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging with customer contact information\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I can partially answer this query, but the schema is incomplete.\n\nThe query requires ARCM (AR Customer Master) for customer details, but only ARTH is provided in the schema.\n\nHere's what I can provide with the available schema:\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n-- Note: Additional joins for ARCM would be needed for complete results\n```\n\nTo get the complete data you requested, please provide the DDL for ARCM.",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from GLCO\n\nDatabase Schema:\nCREATE TABLE GLCO (\n  GLCo bcompany NOT NULL,\n  Consolid byn NOT NULL,\n  LastMthSubClsd bmonth NOT NULL,\n  LastMthGLClsd bmonth NOT NULL,\n  MaxOpen tinyint NOT NULL,\n  CashAccrual char(1) NOT NULL,\n  Unbal byn NOT NULL,\n  AuditCoParams byn NOT NULL,\n  AuditAccts byn NOT NULL,\n  AuditAutoJrnl byn NOT NULL,\n  AuditBals byn NOT NULL,\n  AuditBudgets byn NOT NULL,\n  AuditDetail byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  XCompJrnlEntryYN byn NOT NULL,\n  KeyID bigint NOT NULL,\n  LastMthAPClsd bmonth NOT NULL,\n  LastMthARClsd bmonth NOT NULL,\n  AttachBatchReportsYN byn NOT NULL,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from GLCO ().\n\n```sql\nSELECT *\nFROM GLCO WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "GLCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How do I count records in prth by company\n\nDatabase Schema:\nCREATE TABLE PRTH (\n  PRCo bcompany NOT NULL,\n  PRGroup bgroup NOT NULL,\n  PREndDate bdate NOT NULL,\n  Employee bemployee NOT NULL,\n  PaySeq tinyint NOT NULL,\n  PostSeq smallint NOT NULL,\n  Type char(1) NOT NULL,\n  PostDate bdate NOT NULL,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCDept bdept,\n  GLCo bcompany NOT NULL,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equipment bequip,\n  EMGroup tinyint,\n  CostCode bcostcode,\n  -- ... 41 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count PRTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM PRTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "PRTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from GLDT\n\nDatabase Schema:\nCREATE TABLE GLDT (\n  GLCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  GLTrans btrans NOT NULL,\n  GLAcct bglacct NOT NULL,\n  Jrnl bjrnl NOT NULL,\n  GLRef bglref NOT NULL,\n  SourceCo bcompany NOT NULL,\n  Source bsource NOT NULL,\n  ActDate bdate NOT NULL,\n  DatePosted bdate NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid NOT NULL,\n  Amount bdollar NOT NULL,\n  RevStatus tinyint NOT NULL,\n  Adjust char(1) NOT NULL,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  UniqueAttchID uniqueidentifier,\n  SrcTable varchar(128),\n  SrcKeyID bigint,\n  PRIMARY KEY (GLCo, Mth, GLTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from GLDT ().\n\n```sql\nSELECT *\nFROM GLDT WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "GLDT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from ARTH\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from ARTH ().\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to count records in jccd by company\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count JCCD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM JCCD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get subcontractor costs with original, change orders, invoiced, paid, and retainage by vendor\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Subcontractor cost breakdown by vendor:\n1. Join SLHD (Header) to SLIT (Items) for subcontract details\n2. Join APVM for vendor names\n3. OrigCost = original contract amount\n4. CurCost - OrigCost = change order amounts\n5. InvCost = amounts invoiced\n6. Retainage = amounts held back\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  SLHD.SL AS SubcontractNum,\n  SLHD.Description AS SubcontractDesc,\n  SUM(SLIT.OrigCost) AS OriginalCost,\n  SUM(SLIT.CurCost - SLIT.OrigCost) AS ChangeOrderCost,\n  SUM(SLIT.CurCost) AS CurrentCost,\n  SUM(SLIT.InvCost) AS InvoicedCost,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost - SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nINNER JOIN APVM WITH (NOLOCK) ON SLHD.VendorGroup = APVM.VendorGroup AND SLHD.Vendor = APVM.Vendor\nWHERE SLHD.SLCo = @SLCo\nGROUP BY APVM.Vendor, APVM.Name, SLHD.SL, SLHD.Description\nORDER BY APVM.Name, SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "intermediate",
      "tables_used": [
        "SLHD",
        "SLIT",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from PRPC\n\nDatabase Schema:\nCREATE TABLE PRPC (\n  PRCo bcompany NOT NULL,\n  PRGroup bgroup NOT NULL,\n  PREndDate bdate NOT NULL,\n  BeginDate bdate NOT NULL,\n  MultiMth byn NOT NULL,\n  BeginMth bmonth NOT NULL,\n  EndMth bmonth,\n  CutoffDate bdate,\n  LimitMth bmonth NOT NULL,\n  Hrs smallint NOT NULL,\n  Days tinyint NOT NULL,\n  Wks tinyint NOT NULL,\n  Status tinyint NOT NULL,\n  DateClosed smalldatetime,\n  JCInterface byn NOT NULL,\n  EMInterface byn NOT NULL,\n  GLInterface byn NOT NULL,\n  APInterface byn NOT NULL,\n  LeaveProcess byn NOT NULL,\n  InUseBy bvpusername,\n  -- ... 7 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from PRPC ().\n\n```sql\nSELECT *\nFROM PRPC WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "PRPC"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get customer balance summary by customer group\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Customer balance summary by group:\n1. Join ARTH to ARCM for customer details\n2. Use conditional SUM for open vs total balances\n3. Group by CustGroup for summary\n\n```sql\nSELECT \n  ARTH.CustGroup,\n  COUNT(DISTINCT ARTH.Customer) AS CustomerCount,\n  SUM(CASE WHEN ARTH.PayFullDate IS NULL THEN ARTH.Amount ELSE 0 END) AS OpenBalance,\n  SUM(ARTH.Amount) AS TotalBilled\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\nGROUP BY ARTH.CustGroup\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoice totals with discounts and retainage\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Vendor invoice summary with discounts and retainage:\n1. Join APTH to APVM for vendor details\n2. Aggregate by vendor\n3. Include GrossAmt, DiscOffer, Retainage, and Balance\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(APTH.APTrans) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS GrossAmount,\n  SUM(APTH.DiscOffer) AS DiscountsOffered,\n  SUM(APTH.Retainage) AS RetainageHeld,\n  SUM(APTH.Balance) AS OpenBalance\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How do I count records in aptd by company\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count APTD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM APTD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need to count records in glac by company\n\nDatabase Schema:\nCREATE TABLE GLAC (\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  Description bdesc,\n  AcctType char(1) NOT NULL,\n  SubType char(1),\n  NormBal char(1),\n  InterfaceDetail byn NOT NULL,\n  Active byn NOT NULL,\n  SummaryAcct bglacct NOT NULL,\n  CashAccrual char(1) NOT NULL,\n  CashOffAcct bglacct,\n  Notes varchar,\n  Part1 varchar(20),\n  Part2 varchar(20),\n  Part3 varchar(20),\n  Part4 varchar(20),\n  Part5 varchar(20),\n  Part6 varchar(20),\n  AllParts varchar(20),\n  CrossRefMemAcct bglacct,\n  -- ... 3 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count GLAC records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM GLAC WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "GLAC"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How do I count records in jccd by company\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count JCCD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM JCCD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How do I track ap hold status distinguishing retainage vs non-retainage holds\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APCO (\n  APCo bcompany NOT NULL,\n  GLCo bcompany NOT NULL,\n  ExpJrnl bjrnl,\n  GLExpInterfaceLvl tinyint NOT NULL,\n  GLExpSummaryDesc varchar(60),\n  GLExpTransDesc varchar(60),\n  GLJobDetailDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLEquipDetailDesc varchar(60),\n  GLExpDetailDesc varchar(60),\n  PayJrnl bjrnl,\n  GLPayInterfaceLvl tinyint NOT NULL,\n  GLPayDetailDesc varchar(60),\n  GLPaySummaryDesc varchar(60),\n  DiscOffGLAcct bglacct,\n  DiscTakenGLAcct bglacct,\n  ExpPayType tinyint,\n  JobPayType tinyint,\n  SubPayType tinyint,\n  RetPayType tinyint,\n  -- ... 92 more columns,\n  PRIMARY KEY (APCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To distinguish retainage vs non-retainage holds:\n1. Join APTD to APHD for hold details\n2. Join APCO to get RetHoldCode setting\n3. Compare APHD.HoldCode to APCO.RetHoldCode\n4. If equal, it's a retainage hold; otherwise non-retainage\n\n```sql\nSELECT \n  APTD.APCo,\n  APTD.Vendor,\n  APTD.Mth,\n  APTD.APTrans,\n  APHD.HoldCode,\n  CASE WHEN APHD.HoldCode = APCO.RetHoldCode \n       THEN 'Retainage Hold' \n       ELSE 'Non-Retainage Hold' END AS HoldType,\n  APTD.Amount\nFROM APTD WITH (NOLOCK)\nINNER JOIN APHD WITH (NOLOCK) ON APTD.APCo = APHD.APCo \n  AND APTD.Mth = APHD.Mth \n  AND APTD.APTrans = APHD.APTrans \n  AND APTD.APLine = APHD.APLine\nINNER JOIN APCO WITH (NOLOCK) ON APTD.APCo = APCO.APCo\nWHERE APTD.APCo = @APCo\n  AND APHD.HoldCode IS NOT NULL\nORDER BY APTD.Vendor, APTD.Mth\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTD",
        "APHD",
        "APCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to count records in gljr by company\n\nDatabase Schema:\nCREATE TABLE GLJR (\n  GLCo bcompany NOT NULL,\n  Jrnl bjrnl NOT NULL,\n  Description btransdesc,\n  Rev byn NOT NULL,\n  RevJrnl bjrnl,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count GLJR records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM GLJR WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "GLJR"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to count records in glco by company\n\nDatabase Schema:\nCREATE TABLE GLCO (\n  GLCo bcompany NOT NULL,\n  Consolid byn NOT NULL,\n  LastMthSubClsd bmonth NOT NULL,\n  LastMthGLClsd bmonth NOT NULL,\n  MaxOpen tinyint NOT NULL,\n  CashAccrual char(1) NOT NULL,\n  Unbal byn NOT NULL,\n  AuditCoParams byn NOT NULL,\n  AuditAccts byn NOT NULL,\n  AuditAutoJrnl byn NOT NULL,\n  AuditBals byn NOT NULL,\n  AuditBudgets byn NOT NULL,\n  AuditDetail byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  XCompJrnlEntryYN byn NOT NULL,\n  KeyID bigint NOT NULL,\n  LastMthAPClsd bmonth NOT NULL,\n  LastMthARClsd bmonth NOT NULL,\n  AttachBatchReportsYN byn NOT NULL,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count GLCO records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM GLCO WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "GLCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How do I count records in aptd by company\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count APTD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM APTD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query to count records in gldt by company\n\nDatabase Schema:\nCREATE TABLE GLDT (\n  GLCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  GLTrans btrans NOT NULL,\n  GLAcct bglacct NOT NULL,\n  Jrnl bjrnl NOT NULL,\n  GLRef bglref NOT NULL,\n  SourceCo bcompany NOT NULL,\n  Source bsource NOT NULL,\n  ActDate bdate NOT NULL,\n  DatePosted bdate NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid NOT NULL,\n  Amount bdollar NOT NULL,\n  RevStatus tinyint NOT NULL,\n  Adjust char(1) NOT NULL,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  UniqueAttchID uniqueidentifier,\n  SrcTable varchar(128),\n  SrcKeyID bigint,\n  PRIMARY KEY (GLCo, Mth, GLTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count GLDT records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM GLDT WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "GLDT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from ARTH\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from ARTH ().\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from SLWI\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from SLWI ().\n\n```sql\nSELECT *\nFROM SLWI WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "SLWI"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How do I count records in arth by company\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count ARTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM ARTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find all unpaid AR invoices older than 60 days\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find unpaid invoices over 60 days:\n1. Join ARTH to ARCM for customer information\n2. Filter PayFullDate IS NULL (unpaid)\n3. Use DATEDIFF to calculate age and filter > 60 days\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Mth,\n  ARTH.ARTrans,\n  ARCM.Name AS CustomerName,\n  ARTH.TransDate,\n  ARTH.Amount,\n  DATEDIFF(day, ARTH.TransDate, GETDATE()) AS DaysOutstanding\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\n  AND DATEDIFF(day, ARTH.TransDate, GETDATE()) > 60\nORDER BY ARTH.TransDate\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to count records in prco by company\n\nDatabase Schema:\nCREATE TABLE PRCO (\n  PRCo bcompany NOT NULL,\n  GLCo bcompany NOT NULL,\n  Jrnl bjrnl,\n  GLInterface byn NOT NULL,\n  CMCo bcompany NOT NULL,\n  APCo bcompany,\n  AutoOT byn NOT NULL,\n  OTEarnCode bedlcode,\n  JCCo bcompany NOT NULL,\n  AllowNoPhase byn NOT NULL,\n  JCInterface byn NOT NULL,\n  InsByPhase byn NOT NULL,\n  JCICraftClass byn NOT NULL,\n  JCICrew byn NOT NULL,\n  JCIEmployee byn NOT NULL,\n  JCIFactor byn NOT NULL,\n  JCIEarnType byn NOT NULL,\n  JCIShift byn NOT NULL,\n  JCIPostingDate byn NOT NULL,\n  JCILiabType byn NOT NULL,\n  -- ... 66 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count PRCO records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM PRCO WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "PRCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Include GLDT in the query\n\nDatabase Schema:\nCREATE TABLE PREH (\n  PRCo bcompany NOT NULL,\n  Employee bemployee NOT NULL,\n  LastName varchar(30) NOT NULL,\n  FirstName varchar(30),\n  MidName varchar(15),\n  SortName bsortname NOT NULL,\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  Phone bphone,\n  SSN char(11) NOT NULL,\n  Race char(2) NOT NULL,\n  Sex char(1) NOT NULL,\n  BirthDate smalldatetime,\n  HireDate bdate,\n  TermDate bdate,\n  PRGroup bgroup NOT NULL,\n  PRDept bdept NOT NULL,\n  -- ... 121 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nCREATE TABLE PRTH (\n  PRCo bcompany NOT NULL,\n  PRGroup bgroup NOT NULL,\n  PREndDate bdate NOT NULL,\n  Employee bemployee NOT NULL,\n  PaySeq tinyint NOT NULL,\n  PostSeq smallint NOT NULL,\n  Type char(1) NOT NULL,\n  PostDate bdate NOT NULL,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCDept bdept,\n  GLCo bcompany NOT NULL,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equipment bequip,\n  EMGroup tinyint,\n  CostCode bcostcode,\n  -- ... 41 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'GLDT' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nPREH, PRTH\n\nTo include GLDT in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from SLWI\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from SLWI ().\n\n```sql\nSELECT *\nFROM SLWI WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "SLWI"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate stored materials (Purchased - Installed) for SL billing\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Stored materials for SL billing:\n1. SLWI contains work item/billing details\n2. StoredMatls = Purchased - Installed (materials on-site but not yet used)\n3. WCCost = Work Completed Cost\n4. WCRetAmt and SMRetAmt = separate retainage for work vs materials\n5. Total billable = WCCost + StoredMatls\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description AS ItemDescription,\n  SLWI.StoredMatls,\n  SLWI.WCCost AS WorkCompletedCost,\n  SLWI.StoredMatls + SLWI.WCCost AS TotalBillable,\n  SLWI.WCRetAmt AS WorkRetainage,\n  SLWI.SMRetAmt AS MaterialsRetainage,\n  SLWI.WCRetAmt + SLWI.SMRetAmt AS TotalRetainage\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\n  AND SLWI.StoredMatls <> 0\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: count records in apth by company\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count APTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM APTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: count records in prpc by company\n\nDatabase Schema:\nCREATE TABLE PRPC (\n  PRCo bcompany NOT NULL,\n  PRGroup bgroup NOT NULL,\n  PREndDate bdate NOT NULL,\n  BeginDate bdate NOT NULL,\n  MultiMth byn NOT NULL,\n  BeginMth bmonth NOT NULL,\n  EndMth bmonth,\n  CutoffDate bdate,\n  LimitMth bmonth NOT NULL,\n  Hrs smallint NOT NULL,\n  Days tinyint NOT NULL,\n  Wks tinyint NOT NULL,\n  Status tinyint NOT NULL,\n  DateClosed smalldatetime,\n  JCInterface byn NOT NULL,\n  EMInterface byn NOT NULL,\n  GLInterface byn NOT NULL,\n  APInterface byn NOT NULL,\n  LeaveProcess byn NOT NULL,\n  InUseBy bvpusername,\n  -- ... 7 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count PRPC records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM PRPC WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "PRPC"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from APTD\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from APTD ().\n\n```sql\nSELECT *\nFROM APTD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from GLDT\n\nDatabase Schema:\nCREATE TABLE GLDT (\n  GLCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  GLTrans btrans NOT NULL,\n  GLAcct bglacct NOT NULL,\n  Jrnl bjrnl NOT NULL,\n  GLRef bglref NOT NULL,\n  SourceCo bcompany NOT NULL,\n  Source bsource NOT NULL,\n  ActDate bdate NOT NULL,\n  DatePosted bdate NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid NOT NULL,\n  Amount bdollar NOT NULL,\n  RevStatus tinyint NOT NULL,\n  Adjust char(1) NOT NULL,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  UniqueAttchID uniqueidentifier,\n  SrcTable varchar(128),\n  SrcKeyID bigint,\n  PRIMARY KEY (GLCo, Mth, GLTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from GLDT ().\n\n```sql\nSELECT *\nFROM GLDT WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "GLDT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Show job costs with GL account descriptions\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I can partially answer this query, but the schema is incomplete.\n\nThe query requires GLAC for GL account descriptions, which is not in the provided schema.\n\nHere's what I can provide with the available schema:\n\n```sql\nSELECT *\nFROM JCCD WITH (NOLOCK)\nWHERE Co = @Co\n-- Note: Additional joins for GLAC would be needed for complete results\n```\n\nTo get the complete data you requested, please provide the DDL for GLAC.",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to join PREH with the available tables\n\nDatabase Schema:\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'PREH' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nSLHD, SLIT\n\nTo include PREH in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from GLAC\n\nDatabase Schema:\nCREATE TABLE GLAC (\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  Description bdesc,\n  AcctType char(1) NOT NULL,\n  SubType char(1),\n  NormBal char(1),\n  InterfaceDetail byn NOT NULL,\n  Active byn NOT NULL,\n  SummaryAcct bglacct NOT NULL,\n  CashAccrual char(1) NOT NULL,\n  CashOffAcct bglacct,\n  Notes varchar,\n  Part1 varchar(20),\n  Part2 varchar(20),\n  Part3 varchar(20),\n  Part4 varchar(20),\n  Part5 varchar(20),\n  Part6 varchar(20),\n  AllParts varchar(20),\n  CrossRefMemAcct bglacct,\n  -- ... 3 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from GLAC ().\n\n```sql\nSELECT *\nFROM GLAC WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "GLAC"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from ARTH\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from ARTH ().\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How do I aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get subcontractor costs with original, change orders, invoiced, paid, and retainage by vendor\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Subcontractor cost breakdown by vendor:\n1. Join SLHD (Header) to SLIT (Items) for subcontract details\n2. Join APVM for vendor names\n3. OrigCost = original contract amount\n4. CurCost - OrigCost = change order amounts\n5. InvCost = amounts invoiced\n6. Retainage = amounts held back\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  SLHD.SL AS SubcontractNum,\n  SLHD.Description AS SubcontractDesc,\n  SUM(SLIT.OrigCost) AS OriginalCost,\n  SUM(SLIT.CurCost - SLIT.OrigCost) AS ChangeOrderCost,\n  SUM(SLIT.CurCost) AS CurrentCost,\n  SUM(SLIT.InvCost) AS InvoicedCost,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost - SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nINNER JOIN APVM WITH (NOLOCK) ON SLHD.VendorGroup = APVM.VendorGroup AND SLHD.Vendor = APVM.Vendor\nWHERE SLHD.SLCo = @SLCo\nGROUP BY APVM.Vendor, APVM.Name, SLHD.SL, SLHD.Description\nORDER BY APVM.Name, SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLHD",
        "SLIT",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find all unpaid AR invoices older than 60 days\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find unpaid invoices over 60 days:\n1. Join ARTH to ARCM for customer information\n2. Filter PayFullDate IS NULL (unpaid)\n3. Use DATEDIFF to calculate age and filter > 60 days\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Mth,\n  ARTH.ARTrans,\n  ARCM.Name AS CustomerName,\n  ARTH.TransDate,\n  ARTH.Amount,\n  DATEDIFF(day, ARTH.TransDate, GETDATE()) AS DaysOutstanding\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\n  AND DATEDIFF(day, ARTH.TransDate, GETDATE()) > 60\nORDER BY ARTH.TransDate\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to count records in prtd by company\n\nDatabase Schema:\nCREATE TABLE PRTD (\n  PRCo bcompany NOT NULL,\n  Craft bcraft NOT NULL,\n  Class bclass NOT NULL,\n  Template smallint NOT NULL,\n  DLCode bedlcode NOT NULL,\n  Factor brate NOT NULL,\n  OldRate bunitcost NOT NULL,\n  NewRate bunitcost NOT NULL,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count PRTD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM PRTD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "PRTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How do I count records in arth by company\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count ARTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM ARTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to track ap hold status distinguishing retainage vs non-retainage holds\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APCO (\n  APCo bcompany NOT NULL,\n  GLCo bcompany NOT NULL,\n  ExpJrnl bjrnl,\n  GLExpInterfaceLvl tinyint NOT NULL,\n  GLExpSummaryDesc varchar(60),\n  GLExpTransDesc varchar(60),\n  GLJobDetailDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLEquipDetailDesc varchar(60),\n  GLExpDetailDesc varchar(60),\n  PayJrnl bjrnl,\n  GLPayInterfaceLvl tinyint NOT NULL,\n  GLPayDetailDesc varchar(60),\n  GLPaySummaryDesc varchar(60),\n  DiscOffGLAcct bglacct,\n  DiscTakenGLAcct bglacct,\n  ExpPayType tinyint,\n  JobPayType tinyint,\n  SubPayType tinyint,\n  RetPayType tinyint,\n  -- ... 92 more columns,\n  PRIMARY KEY (APCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To distinguish retainage vs non-retainage holds:\n1. Join APTD to APHD for hold details\n2. Join APCO to get RetHoldCode setting\n3. Compare APHD.HoldCode to APCO.RetHoldCode\n4. If equal, it's a retainage hold; otherwise non-retainage\n\n```sql\nSELECT \n  APTD.APCo,\n  APTD.Vendor,\n  APTD.Mth,\n  APTD.APTrans,\n  APHD.HoldCode,\n  CASE WHEN APHD.HoldCode = APCO.RetHoldCode \n       THEN 'Retainage Hold' \n       ELSE 'Non-Retainage Hold' END AS HoldType,\n  APTD.Amount\nFROM APTD WITH (NOLOCK)\nINNER JOIN APHD WITH (NOLOCK) ON APTD.APCo = APHD.APCo \n  AND APTD.Mth = APHD.Mth \n  AND APTD.APTrans = APHD.APTrans \n  AND APTD.APLine = APHD.APLine\nINNER JOIN APCO WITH (NOLOCK) ON APTD.APCo = APCO.APCo\nWHERE APTD.APCo = @APCo\n  AND APHD.HoldCode IS NOT NULL\nORDER BY APTD.Vendor, APTD.Mth\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTD",
        "APHD",
        "APCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get subcontractor costs with original, change orders, invoiced, paid, and retainage by vendor\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Subcontractor cost breakdown by vendor:\n1. Join SLHD (Header) to SLIT (Items) for subcontract details\n2. Join APVM for vendor names\n3. OrigCost = original contract amount\n4. CurCost - OrigCost = change order amounts\n5. InvCost = amounts invoiced\n6. Retainage = amounts held back\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  SLHD.SL AS SubcontractNum,\n  SLHD.Description AS SubcontractDesc,\n  SUM(SLIT.OrigCost) AS OriginalCost,\n  SUM(SLIT.CurCost - SLIT.OrigCost) AS ChangeOrderCost,\n  SUM(SLIT.CurCost) AS CurrentCost,\n  SUM(SLIT.InvCost) AS InvoicedCost,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost - SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nINNER JOIN APVM WITH (NOLOCK) ON SLHD.VendorGroup = APVM.VendorGroup AND SLHD.Vendor = APVM.Vendor\nWHERE SLHD.SLCo = @SLCo\nGROUP BY APVM.Vendor, APVM.Name, SLHD.SL, SLHD.Description\nORDER BY APVM.Name, SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLHD",
        "SLIT",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: count records in prth by company\n\nDatabase Schema:\nCREATE TABLE PRTH (\n  PRCo bcompany NOT NULL,\n  PRGroup bgroup NOT NULL,\n  PREndDate bdate NOT NULL,\n  Employee bemployee NOT NULL,\n  PaySeq tinyint NOT NULL,\n  PostSeq smallint NOT NULL,\n  Type char(1) NOT NULL,\n  PostDate bdate NOT NULL,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCDept bdept,\n  GLCo bcompany NOT NULL,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equipment bequip,\n  EMGroup tinyint,\n  CostCode bcostcode,\n  -- ... 41 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count PRTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM PRTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "PRTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query to count records in prco by company\n\nDatabase Schema:\nCREATE TABLE PRCO (\n  PRCo bcompany NOT NULL,\n  GLCo bcompany NOT NULL,\n  Jrnl bjrnl,\n  GLInterface byn NOT NULL,\n  CMCo bcompany NOT NULL,\n  APCo bcompany,\n  AutoOT byn NOT NULL,\n  OTEarnCode bedlcode,\n  JCCo bcompany NOT NULL,\n  AllowNoPhase byn NOT NULL,\n  JCInterface byn NOT NULL,\n  InsByPhase byn NOT NULL,\n  JCICraftClass byn NOT NULL,\n  JCICrew byn NOT NULL,\n  JCIEmployee byn NOT NULL,\n  JCIFactor byn NOT NULL,\n  JCIEarnType byn NOT NULL,\n  JCIShift byn NOT NULL,\n  JCIPostingDate byn NOT NULL,\n  JCILiabType byn NOT NULL,\n  -- ... 66 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count PRCO records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM PRCO WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "PRCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoice totals with discounts and retainage\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Vendor invoice summary with discounts and retainage:\n1. Join APTH to APVM for vendor details\n2. Aggregate by vendor\n3. Include GrossAmt, DiscOffer, Retainage, and Balance\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(APTH.APTrans) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS GrossAmount,\n  SUM(APTH.DiscOffer) AS DiscountsOffered,\n  SUM(APTH.Retainage) AS RetainageHeld,\n  SUM(APTH.Balance) AS OpenBalance\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to count records in preh by company\n\nDatabase Schema:\nCREATE TABLE PREH (\n  PRCo bcompany NOT NULL,\n  Employee bemployee NOT NULL,\n  LastName varchar(30) NOT NULL,\n  FirstName varchar(30),\n  MidName varchar(15),\n  SortName bsortname NOT NULL,\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  Phone bphone,\n  SSN char(11) NOT NULL,\n  Race char(2) NOT NULL,\n  Sex char(1) NOT NULL,\n  BirthDate smalldatetime,\n  HireDate bdate,\n  TermDate bdate,\n  PRGroup bgroup NOT NULL,\n  PRDept bdept NOT NULL,\n  -- ... 121 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count PREH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM PREH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "PREH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How do I count records in glac by company\n\nDatabase Schema:\nCREATE TABLE GLAC (\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  Description bdesc,\n  AcctType char(1) NOT NULL,\n  SubType char(1),\n  NormBal char(1),\n  InterfaceDetail byn NOT NULL,\n  Active byn NOT NULL,\n  SummaryAcct bglacct NOT NULL,\n  CashAccrual char(1) NOT NULL,\n  CashOffAcct bglacct,\n  Notes varchar,\n  Part1 varchar(20),\n  Part2 varchar(20),\n  Part3 varchar(20),\n  Part4 varchar(20),\n  Part5 varchar(20),\n  Part6 varchar(20),\n  AllParts varchar(20),\n  CrossRefMemAcct bglacct,\n  -- ... 3 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count GLAC records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM GLAC WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "GLAC"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from SLWI\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from SLWI ().\n\n```sql\nSELECT *\nFROM SLWI WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLWI"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query to track ap hold status distinguishing retainage vs non-retainage holds\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APCO (\n  APCo bcompany NOT NULL,\n  GLCo bcompany NOT NULL,\n  ExpJrnl bjrnl,\n  GLExpInterfaceLvl tinyint NOT NULL,\n  GLExpSummaryDesc varchar(60),\n  GLExpTransDesc varchar(60),\n  GLJobDetailDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLEquipDetailDesc varchar(60),\n  GLExpDetailDesc varchar(60),\n  PayJrnl bjrnl,\n  GLPayInterfaceLvl tinyint NOT NULL,\n  GLPayDetailDesc varchar(60),\n  GLPaySummaryDesc varchar(60),\n  DiscOffGLAcct bglacct,\n  DiscTakenGLAcct bglacct,\n  ExpPayType tinyint,\n  JobPayType tinyint,\n  SubPayType tinyint,\n  RetPayType tinyint,\n  -- ... 92 more columns,\n  PRIMARY KEY (APCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To distinguish retainage vs non-retainage holds:\n1. Join APTD to APHD for hold details\n2. Join APCO to get RetHoldCode setting\n3. Compare APHD.HoldCode to APCO.RetHoldCode\n4. If equal, it's a retainage hold; otherwise non-retainage\n\n```sql\nSELECT \n  APTD.APCo,\n  APTD.Vendor,\n  APTD.Mth,\n  APTD.APTrans,\n  APHD.HoldCode,\n  CASE WHEN APHD.HoldCode = APCO.RetHoldCode \n       THEN 'Retainage Hold' \n       ELSE 'Non-Retainage Hold' END AS HoldType,\n  APTD.Amount\nFROM APTD WITH (NOLOCK)\nINNER JOIN APHD WITH (NOLOCK) ON APTD.APCo = APHD.APCo \n  AND APTD.Mth = APHD.Mth \n  AND APTD.APTrans = APHD.APTrans \n  AND APTD.APLine = APHD.APLine\nINNER JOIN APCO WITH (NOLOCK) ON APTD.APCo = APCO.APCo\nWHERE APTD.APCo = @APCo\n  AND APHD.HoldCode IS NOT NULL\nORDER BY APTD.Vendor, APTD.Mth\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "basic",
      "tables_used": [
        "APTD",
        "APHD",
        "APCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to join ARCM with the available tables\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'ARCM' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nAPTH, APVM\n\nTo include ARCM in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging buckets (30/60/90+ days) for unpaid invoices by customer\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Use ARTH for transaction data and ARCM for customer names\n2. Filter PayFullDate IS NULL to get only unpaid invoices\n3. Use DATEDIFF and CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get job cost variance by phase comparing budget to actual\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Job cost variance by phase:\n1. Join JCJM (Job Master) to JCCP (Cost Phase)\n2. Calculate variance as CurrEstCost - ActualCost\n3. Calculate percent complete from actuals vs budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  JCCP.Phase,\n  JCCP.CostType,\n  JCCP.OrigEstCost AS OriginalBudget,\n  JCCP.CurrEstCost AS CurrentBudget,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS Variance,\n  CASE WHEN JCCP.CurrEstCost <> 0 \n       THEN (JCCP.ActualCost / JCCP.CurrEstCost) * 100 \n       ELSE 0 END AS PercentComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.Job = @Job\nORDER BY JCCP.Phase, JCCP.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query to count records in arth by company\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count ARTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM ARTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to join SLHD with the available tables\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'SLHD' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nJCJM, JCCD\n\nTo include SLHD in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from PRTD\n\nDatabase Schema:\nCREATE TABLE PRTD (\n  PRCo bcompany NOT NULL,\n  Craft bcraft NOT NULL,\n  Class bclass NOT NULL,\n  Template smallint NOT NULL,\n  DLCode bedlcode NOT NULL,\n  Factor brate NOT NULL,\n  OldRate bunitcost NOT NULL,\n  NewRate bunitcost NOT NULL,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from PRTD ().\n\n```sql\nSELECT *\nFROM PRTD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "PRTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate stored materials (Purchased - Installed) for SL billing\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Stored materials for SL billing:\n1. SLWI contains work item/billing details\n2. StoredMatls = Purchased - Installed (materials on-site but not yet used)\n3. WCCost = Work Completed Cost\n4. WCRetAmt and SMRetAmt = separate retainage for work vs materials\n5. Total billable = WCCost + StoredMatls\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description AS ItemDescription,\n  SLWI.StoredMatls,\n  SLWI.WCCost AS WorkCompletedCost,\n  SLWI.StoredMatls + SLWI.WCCost AS TotalBillable,\n  SLWI.WCRetAmt AS WorkRetainage,\n  SLWI.SMRetAmt AS MaterialsRetainage,\n  SLWI.WCRetAmt + SLWI.SMRetAmt AS TotalRetainage\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\n  AND SLWI.StoredMatls <> 0\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "intermediate",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from JCCD\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from JCCD ().\n\n```sql\nSELECT *\nFROM JCCD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get subcontractor costs with original, change orders, invoiced, paid, and retainage by vendor\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Subcontractor cost breakdown by vendor:\n1. Join SLHD (Header) to SLIT (Items) for subcontract details\n2. Join APVM for vendor names\n3. OrigCost = original contract amount\n4. CurCost - OrigCost = change order amounts\n5. InvCost = amounts invoiced\n6. Retainage = amounts held back\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  SLHD.SL AS SubcontractNum,\n  SLHD.Description AS SubcontractDesc,\n  SUM(SLIT.OrigCost) AS OriginalCost,\n  SUM(SLIT.CurCost - SLIT.OrigCost) AS ChangeOrderCost,\n  SUM(SLIT.CurCost) AS CurrentCost,\n  SUM(SLIT.InvCost) AS InvoicedCost,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost - SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nINNER JOIN APVM WITH (NOLOCK) ON SLHD.VendorGroup = APVM.VendorGroup AND SLHD.Vendor = APVM.Vendor\nWHERE SLHD.SLCo = @SLCo\nGROUP BY APVM.Vendor, APVM.Name, SLHD.SL, SLHD.Description\nORDER BY APVM.Name, SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "intermediate",
      "tables_used": [
        "SLHD",
        "SLIT",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from JCCD\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from JCCD ().\n\n```sql\nSELECT *\nFROM JCCD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query to count records in aptd by company\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count APTD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM APTD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get customer balance summary by customer group\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Customer balance summary by group:\n1. Join ARTH to ARCM for customer details\n2. Use conditional SUM for open vs total balances\n3. Group by CustGroup for summary\n\n```sql\nSELECT \n  ARTH.CustGroup,\n  COUNT(DISTINCT ARTH.Customer) AS CustomerCount,\n  SUM(CASE WHEN ARTH.PayFullDate IS NULL THEN ARTH.Amount ELSE 0 END) AS OpenBalance,\n  SUM(ARTH.Amount) AS TotalBilled\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\nGROUP BY ARTH.CustGroup\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get job cost variance by phase comparing budget to actual\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Job cost variance by phase:\n1. Join JCJM (Job Master) to JCCP (Cost Phase)\n2. Calculate variance as CurrEstCost - ActualCost\n3. Calculate percent complete from actuals vs budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  JCCP.Phase,\n  JCCP.CostType,\n  JCCP.OrigEstCost AS OriginalBudget,\n  JCCP.CurrEstCost AS CurrentBudget,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS Variance,\n  CASE WHEN JCCP.CurrEstCost <> 0 \n       THEN (JCCP.ActualCost / JCCP.CurrEstCost) * 100 \n       ELSE 0 END AS PercentComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.Job = @Job\nORDER BY JCCP.Phase, JCCP.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging with customer contact information\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I can partially answer this query, but the schema is incomplete.\n\nThe query requires ARCM (AR Customer Master) for customer details, but only ARTH is provided in the schema.\n\nHere's what I can provide with the available schema:\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n-- Note: Additional joins for ARCM would be needed for complete results\n```\n\nTo get the complete data you requested, please provide the DDL for ARCM.",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoice totals with discounts and retainage\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Vendor invoice summary with discounts and retainage:\n1. Join APTH to APVM for vendor details\n2. Aggregate by vendor\n3. Include GrossAmt, DiscOffer, Retainage, and Balance\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(APTH.APTrans) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS GrossAmount,\n  SUM(APTH.DiscOffer) AS DiscountsOffered,\n  SUM(APTH.Retainage) AS RetainageHeld,\n  SUM(APTH.Balance) AS OpenBalance\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "basic",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need to count records in glac by company\n\nDatabase Schema:\nCREATE TABLE GLAC (\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  Description bdesc,\n  AcctType char(1) NOT NULL,\n  SubType char(1),\n  NormBal char(1),\n  InterfaceDetail byn NOT NULL,\n  Active byn NOT NULL,\n  SummaryAcct bglacct NOT NULL,\n  CashAccrual char(1) NOT NULL,\n  CashOffAcct bglacct,\n  Notes varchar,\n  Part1 varchar(20),\n  Part2 varchar(20),\n  Part3 varchar(20),\n  Part4 varchar(20),\n  Part5 varchar(20),\n  Part6 varchar(20),\n  AllParts varchar(20),\n  CrossRefMemAcct bglacct,\n  -- ... 3 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count GLAC records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM GLAC WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "GLAC"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoice totals with discounts and retainage\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Vendor invoice summary with discounts and retainage:\n1. Join APTH to APVM for vendor details\n2. Aggregate by vendor\n3. Include GrossAmt, DiscOffer, Retainage, and Balance\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(APTH.APTrans) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS GrossAmount,\n  SUM(APTH.DiscOffer) AS DiscountsOffered,\n  SUM(APTH.Retainage) AS RetainageHeld,\n  SUM(APTH.Balance) AS OpenBalance\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How do I count records in arth by company\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count ARTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM ARTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get subcontractor costs with original, change orders, invoiced, paid, and retainage by vendor\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Subcontractor cost breakdown by vendor:\n1. Join SLHD (Header) to SLIT (Items) for subcontract details\n2. Join APVM for vendor names\n3. OrigCost = original contract amount\n4. CurCost - OrigCost = change order amounts\n5. InvCost = amounts invoiced\n6. Retainage = amounts held back\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  SLHD.SL AS SubcontractNum,\n  SLHD.Description AS SubcontractDesc,\n  SUM(SLIT.OrigCost) AS OriginalCost,\n  SUM(SLIT.CurCost - SLIT.OrigCost) AS ChangeOrderCost,\n  SUM(SLIT.CurCost) AS CurrentCost,\n  SUM(SLIT.InvCost) AS InvoicedCost,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost - SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nINNER JOIN APVM WITH (NOLOCK) ON SLHD.VendorGroup = APVM.VendorGroup AND SLHD.Vendor = APVM.Vendor\nWHERE SLHD.SLCo = @SLCo\nGROUP BY APVM.Vendor, APVM.Name, SLHD.SL, SLHD.Description\nORDER BY APVM.Name, SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "intermediate",
      "tables_used": [
        "SLHD",
        "SLIT",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query to aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need to reconcile ap oncost batch lines with original transactions\n\nDatabase Schema:\nCREATE TABLE APTL (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equip bequip,\n  EMGroup bgroup,\n  -- ... 56 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans, APLine)\n);\n\nCREATE TABLE APLB (\n  Co bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  BatchId bbatchid NOT NULL,\n  BatchSeq int NOT NULL,\n  APLine smallint NOT NULL,\n  BatchTransType char(1) NOT NULL,\n  LineType tinyint NOT NULL,\n  PO varchar(30),\n  POItem bitem,\n  ItemType tinyint,\n  SL varchar(30),\n  SLItem bitem,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCCType bjcctype,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  -- ... 120 more columns,\n  PRIMARY KEY (Co, Mth, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APHB (\n  Co bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  BatchId bbatchid NOT NULL,\n  BatchSeq int NOT NULL,\n  BatchTransType char(1) NOT NULL,\n  APTrans btrans,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  -- ... 88 more columns,\n  PRIMARY KEY (Co, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To reconcile AP oncost batches with original transactions:\n1. Join APLB (batch lines) to APTL (original lines) using ocApplyMth, ocApplyTrans, ocApplyLine\n2. Include APHB for batch header info\n3. Join to APTH and APVM for vendor context\n4. Compare batch vs original amounts\n\n```sql\nSELECT \n  APLB.Co AS BatchCo,\n  APLB.Mth AS BatchMth,\n  APLB.BatchId,\n  APLB.BatchSeq,\n  APLB.ocApplyMth,\n  APLB.ocApplyTrans,\n  APLB.ocApplyLine,\n  APTL.APCo AS OrigCo,\n  APTL.Mth AS OrigMth,\n  APTL.APTrans AS OrigTrans,\n  APTL.APLine AS OrigLine,\n  APTL.GrossAmt AS OrigAmount,\n  APLB.GrossAmt AS BatchAmount,\n  APVM.Name AS VendorName\nFROM APLB WITH (NOLOCK)\nINNER JOIN APHB WITH (NOLOCK) ON APLB.Co = APHB.Co AND APLB.Mth = APHB.Mth AND APLB.BatchId = APHB.BatchId\nINNER JOIN APTL WITH (NOLOCK) ON APLB.ocApplyMth = APTL.Mth \n  AND APLB.ocApplyTrans = APTL.APTrans \n  AND APLB.ocApplyLine = APTL.APLine\n  AND APLB.Co = APTL.APCo\nINNER JOIN APTH WITH (NOLOCK) ON APTL.APCo = APTH.APCo AND APTL.Mth = APTH.Mth AND APTL.APTrans = APTH.APTrans\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APLB.Co = @Co\nORDER BY APLB.BatchId, APLB.BatchSeq\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "basic",
      "tables_used": [
        "APLB",
        "APHB",
        "APTL",
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get subcontractor costs with original, change orders, invoiced, paid, and retainage by vendor\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Subcontractor cost breakdown by vendor:\n1. Join SLHD (Header) to SLIT (Items) for subcontract details\n2. Join APVM for vendor names\n3. OrigCost = original contract amount\n4. CurCost - OrigCost = change order amounts\n5. InvCost = amounts invoiced\n6. Retainage = amounts held back\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  SLHD.SL AS SubcontractNum,\n  SLHD.Description AS SubcontractDesc,\n  SUM(SLIT.OrigCost) AS OriginalCost,\n  SUM(SLIT.CurCost - SLIT.OrigCost) AS ChangeOrderCost,\n  SUM(SLIT.CurCost) AS CurrentCost,\n  SUM(SLIT.InvCost) AS InvoicedCost,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost - SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nINNER JOIN APVM WITH (NOLOCK) ON SLHD.VendorGroup = APVM.VendorGroup AND SLHD.Vendor = APVM.Vendor\nWHERE SLHD.SLCo = @SLCo\nGROUP BY APVM.Vendor, APVM.Name, SLHD.SL, SLHD.Description\nORDER BY APVM.Name, SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "intermediate",
      "tables_used": [
        "SLHD",
        "SLIT",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging buckets (30/60/90+ days) for unpaid invoices by customer\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Use ARTH for transaction data and ARCM for customer names\n2. Filter PayFullDate IS NULL to get only unpaid invoices\n3. Use DATEDIFF and CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How do I aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get subcontractor costs with original, change orders, invoiced, paid, and retainage by vendor\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Subcontractor cost breakdown by vendor:\n1. Join SLHD (Header) to SLIT (Items) for subcontract details\n2. Join APVM for vendor names\n3. OrigCost = original contract amount\n4. CurCost - OrigCost = change order amounts\n5. InvCost = amounts invoiced\n6. Retainage = amounts held back\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  SLHD.SL AS SubcontractNum,\n  SLHD.Description AS SubcontractDesc,\n  SUM(SLIT.OrigCost) AS OriginalCost,\n  SUM(SLIT.CurCost - SLIT.OrigCost) AS ChangeOrderCost,\n  SUM(SLIT.CurCost) AS CurrentCost,\n  SUM(SLIT.InvCost) AS InvoicedCost,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost - SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nINNER JOIN APVM WITH (NOLOCK) ON SLHD.VendorGroup = APVM.VendorGroup AND SLHD.Vendor = APVM.Vendor\nWHERE SLHD.SLCo = @SLCo\nGROUP BY APVM.Vendor, APVM.Name, SLHD.SL, SLHD.Description\nORDER BY APVM.Name, SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "basic",
      "tables_used": [
        "SLHD",
        "SLIT",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from APTH\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from APTH ().\n\n```sql\nSELECT *\nFROM APTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging with customer contact information\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I can partially answer this query, but the schema is incomplete.\n\nThe query requires ARCM (AR Customer Master) for customer details, but only ARTH is provided in the schema.\n\nHere's what I can provide with the available schema:\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n-- Note: Additional joins for ARCM would be needed for complete results\n```\n\nTo get the complete data you requested, please provide the DDL for ARCM.",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: count records in prpc by company\n\nDatabase Schema:\nCREATE TABLE PRPC (\n  PRCo bcompany NOT NULL,\n  PRGroup bgroup NOT NULL,\n  PREndDate bdate NOT NULL,\n  BeginDate bdate NOT NULL,\n  MultiMth byn NOT NULL,\n  BeginMth bmonth NOT NULL,\n  EndMth bmonth,\n  CutoffDate bdate,\n  LimitMth bmonth NOT NULL,\n  Hrs smallint NOT NULL,\n  Days tinyint NOT NULL,\n  Wks tinyint NOT NULL,\n  Status tinyint NOT NULL,\n  DateClosed smalldatetime,\n  JCInterface byn NOT NULL,\n  EMInterface byn NOT NULL,\n  GLInterface byn NOT NULL,\n  APInterface byn NOT NULL,\n  LeaveProcess byn NOT NULL,\n  InUseBy bvpusername,\n  -- ... 7 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count PRPC records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM PRPC WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "PRPC"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find jobs over budget with remaining cost projection\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Find jobs over budget:\n1. Aggregate JCCP by job from JCJM\n2. Compare total ActualCost to CurrEstCost\n3. Use HAVING to filter only over-budget jobs\n4. Sort by amount over budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description,\n  SUM(JCCP.CurrEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.CurrEstCost) - SUM(JCCP.ActualCost) AS RemainingBudget,\n  CASE WHEN SUM(JCCP.CurrEstCost) < SUM(JCCP.ActualCost) \n       THEN 'OVER BUDGET' ELSE 'OK' END AS Status\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\nGROUP BY JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.CurrEstCost)\nORDER BY (SUM(JCCP.ActualCost) - SUM(JCCP.CurrEstCost)) DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCJM",
        "JCCD",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get job cost variance by phase comparing budget to actual\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Job cost variance by phase:\n1. Join JCJM (Job Master) to JCCP (Cost Phase)\n2. Calculate variance as CurrEstCost - ActualCost\n3. Calculate percent complete from actuals vs budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  JCCP.Phase,\n  JCCP.CostType,\n  JCCP.OrigEstCost AS OriginalBudget,\n  JCCP.CurrEstCost AS CurrentBudget,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS Variance,\n  CASE WHEN JCCP.CurrEstCost <> 0 \n       THEN (JCCP.ActualCost / JCCP.CurrEstCost) * 100 \n       ELSE 0 END AS PercentComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.Job = @Job\nORDER BY JCCP.Phase, JCCP.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from PRTD\n\nDatabase Schema:\nCREATE TABLE PRTD (\n  PRCo bcompany NOT NULL,\n  Craft bcraft NOT NULL,\n  Class bclass NOT NULL,\n  Template smallint NOT NULL,\n  DLCode bedlcode NOT NULL,\n  Factor brate NOT NULL,\n  OldRate bunitcost NOT NULL,\n  NewRate bunitcost NOT NULL,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from PRTD ().\n\n```sql\nSELECT *\nFROM PRTD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "PRTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to track ap hold status distinguishing retainage vs non-retainage holds\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APCO (\n  APCo bcompany NOT NULL,\n  GLCo bcompany NOT NULL,\n  ExpJrnl bjrnl,\n  GLExpInterfaceLvl tinyint NOT NULL,\n  GLExpSummaryDesc varchar(60),\n  GLExpTransDesc varchar(60),\n  GLJobDetailDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLEquipDetailDesc varchar(60),\n  GLExpDetailDesc varchar(60),\n  PayJrnl bjrnl,\n  GLPayInterfaceLvl tinyint NOT NULL,\n  GLPayDetailDesc varchar(60),\n  GLPaySummaryDesc varchar(60),\n  DiscOffGLAcct bglacct,\n  DiscTakenGLAcct bglacct,\n  ExpPayType tinyint,\n  JobPayType tinyint,\n  SubPayType tinyint,\n  RetPayType tinyint,\n  -- ... 92 more columns,\n  PRIMARY KEY (APCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To distinguish retainage vs non-retainage holds:\n1. Join APTD to APHD for hold details\n2. Join APCO to get RetHoldCode setting\n3. Compare APHD.HoldCode to APCO.RetHoldCode\n4. If equal, it's a retainage hold; otherwise non-retainage\n\n```sql\nSELECT \n  APTD.APCo,\n  APTD.Vendor,\n  APTD.Mth,\n  APTD.APTrans,\n  APHD.HoldCode,\n  CASE WHEN APHD.HoldCode = APCO.RetHoldCode \n       THEN 'Retainage Hold' \n       ELSE 'Non-Retainage Hold' END AS HoldType,\n  APTD.Amount\nFROM APTD WITH (NOLOCK)\nINNER JOIN APHD WITH (NOLOCK) ON APTD.APCo = APHD.APCo \n  AND APTD.Mth = APHD.Mth \n  AND APTD.APTrans = APHD.APTrans \n  AND APTD.APLine = APHD.APLine\nINNER JOIN APCO WITH (NOLOCK) ON APTD.APCo = APCO.APCo\nWHERE APTD.APCo = @APCo\n  AND APHD.HoldCode IS NOT NULL\nORDER BY APTD.Vendor, APTD.Mth\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTD",
        "APHD",
        "APCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from GLAC\n\nDatabase Schema:\nCREATE TABLE GLAC (\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  Description bdesc,\n  AcctType char(1) NOT NULL,\n  SubType char(1),\n  NormBal char(1),\n  InterfaceDetail byn NOT NULL,\n  Active byn NOT NULL,\n  SummaryAcct bglacct NOT NULL,\n  CashAccrual char(1) NOT NULL,\n  CashOffAcct bglacct,\n  Notes varchar,\n  Part1 varchar(20),\n  Part2 varchar(20),\n  Part3 varchar(20),\n  Part4 varchar(20),\n  Part5 varchar(20),\n  Part6 varchar(20),\n  AllParts varchar(20),\n  CrossRefMemAcct bglacct,\n  -- ... 3 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from GLAC ().\n\n```sql\nSELECT *\nFROM GLAC WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "GLAC"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find jobs over budget with remaining cost projection\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Find jobs over budget:\n1. Aggregate JCCP by job from JCJM\n2. Compare total ActualCost to CurrEstCost\n3. Use HAVING to filter only over-budget jobs\n4. Sort by amount over budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description,\n  SUM(JCCP.CurrEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.CurrEstCost) - SUM(JCCP.ActualCost) AS RemainingBudget,\n  CASE WHEN SUM(JCCP.CurrEstCost) < SUM(JCCP.ActualCost) \n       THEN 'OVER BUDGET' ELSE 'OK' END AS Status\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\nGROUP BY JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.CurrEstCost)\nORDER BY (SUM(JCCP.ActualCost) - SUM(JCCP.CurrEstCost)) DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM",
        "JCCD",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from GLDT\n\nDatabase Schema:\nCREATE TABLE GLDT (\n  GLCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  GLTrans btrans NOT NULL,\n  GLAcct bglacct NOT NULL,\n  Jrnl bjrnl NOT NULL,\n  GLRef bglref NOT NULL,\n  SourceCo bcompany NOT NULL,\n  Source bsource NOT NULL,\n  ActDate bdate NOT NULL,\n  DatePosted bdate NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid NOT NULL,\n  Amount bdollar NOT NULL,\n  RevStatus tinyint NOT NULL,\n  Adjust char(1) NOT NULL,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  UniqueAttchID uniqueidentifier,\n  SrcTable varchar(128),\n  SrcKeyID bigint,\n  PRIMARY KEY (GLCo, Mth, GLTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from GLDT ().\n\n```sql\nSELECT *\nFROM GLDT WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "GLDT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query to count records in arth by company\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count ARTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM ARTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from PRTH\n\nDatabase Schema:\nCREATE TABLE PRTH (\n  PRCo bcompany NOT NULL,\n  PRGroup bgroup NOT NULL,\n  PREndDate bdate NOT NULL,\n  Employee bemployee NOT NULL,\n  PaySeq tinyint NOT NULL,\n  PostSeq smallint NOT NULL,\n  Type char(1) NOT NULL,\n  PostDate bdate NOT NULL,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCDept bdept,\n  GLCo bcompany NOT NULL,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equipment bequip,\n  EMGroup tinyint,\n  CostCode bcostcode,\n  -- ... 41 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from PRTH ().\n\n```sql\nSELECT *\nFROM PRTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "PRTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get customer balance summary by customer group\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Customer balance summary by group:\n1. Join ARTH to ARCM for customer details\n2. Use conditional SUM for open vs total balances\n3. Group by CustGroup for summary\n\n```sql\nSELECT \n  ARTH.CustGroup,\n  COUNT(DISTINCT ARTH.Customer) AS CustomerCount,\n  SUM(CASE WHEN ARTH.PayFullDate IS NULL THEN ARTH.Amount ELSE 0 END) AS OpenBalance,\n  SUM(ARTH.Amount) AS TotalBilled\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\nGROUP BY ARTH.CustGroup\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query to aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoice totals with discounts and retainage\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Vendor invoice summary with discounts and retainage:\n1. Join APTH to APVM for vendor details\n2. Aggregate by vendor\n3. Include GrossAmt, DiscOffer, Retainage, and Balance\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(APTH.APTrans) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS GrossAmount,\n  SUM(APTH.DiscOffer) AS DiscountsOffered,\n  SUM(APTH.Retainage) AS RetainageHeld,\n  SUM(APTH.Balance) AS OpenBalance\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "basic",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to count records in arth by company\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count ARTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM ARTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find jobs over budget with remaining cost projection\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Find jobs over budget:\n1. Aggregate JCCP by job from JCJM\n2. Compare total ActualCost to CurrEstCost\n3. Use HAVING to filter only over-budget jobs\n4. Sort by amount over budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description,\n  SUM(JCCP.CurrEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.CurrEstCost) - SUM(JCCP.ActualCost) AS RemainingBudget,\n  CASE WHEN SUM(JCCP.CurrEstCost) < SUM(JCCP.ActualCost) \n       THEN 'OVER BUDGET' ELSE 'OK' END AS Status\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\nGROUP BY JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.CurrEstCost)\nORDER BY (SUM(JCCP.ActualCost) - SUM(JCCP.CurrEstCost)) DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCJM",
        "JCCD",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get customer balance summary by customer group\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Customer balance summary by group:\n1. Join ARTH to ARCM for customer details\n2. Use conditional SUM for open vs total balances\n3. Group by CustGroup for summary\n\n```sql\nSELECT \n  ARTH.CustGroup,\n  COUNT(DISTINCT ARTH.Customer) AS CustomerCount,\n  SUM(CASE WHEN ARTH.PayFullDate IS NULL THEN ARTH.Amount ELSE 0 END) AS OpenBalance,\n  SUM(ARTH.Amount) AS TotalBilled\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\nGROUP BY ARTH.CustGroup\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate stored materials (Purchased - Installed) for SL billing\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Stored materials for SL billing:\n1. SLWI contains work item/billing details\n2. StoredMatls = Purchased - Installed (materials on-site but not yet used)\n3. WCCost = Work Completed Cost\n4. WCRetAmt and SMRetAmt = separate retainage for work vs materials\n5. Total billable = WCCost + StoredMatls\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description AS ItemDescription,\n  SLWI.StoredMatls,\n  SLWI.WCCost AS WorkCompletedCost,\n  SLWI.StoredMatls + SLWI.WCCost AS TotalBillable,\n  SLWI.WCRetAmt AS WorkRetainage,\n  SLWI.SMRetAmt AS MaterialsRetainage,\n  SLWI.WCRetAmt + SLWI.SMRetAmt AS TotalRetainage\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\n  AND SLWI.StoredMatls <> 0\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "intermediate",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to join GLDT with the available tables\n\nDatabase Schema:\nCREATE TABLE PREH (\n  PRCo bcompany NOT NULL,\n  Employee bemployee NOT NULL,\n  LastName varchar(30) NOT NULL,\n  FirstName varchar(30),\n  MidName varchar(15),\n  SortName bsortname NOT NULL,\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  Phone bphone,\n  SSN char(11) NOT NULL,\n  Race char(2) NOT NULL,\n  Sex char(1) NOT NULL,\n  BirthDate smalldatetime,\n  HireDate bdate,\n  TermDate bdate,\n  PRGroup bgroup NOT NULL,\n  PRDept bdept NOT NULL,\n  -- ... 121 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nCREATE TABLE PRTH (\n  PRCo bcompany NOT NULL,\n  PRGroup bgroup NOT NULL,\n  PREndDate bdate NOT NULL,\n  Employee bemployee NOT NULL,\n  PaySeq tinyint NOT NULL,\n  PostSeq smallint NOT NULL,\n  Type char(1) NOT NULL,\n  PostDate bdate NOT NULL,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCDept bdept,\n  GLCo bcompany NOT NULL,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equipment bequip,\n  EMGroup tinyint,\n  CostCode bcostcode,\n  -- ... 41 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'GLDT' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nPREH, PRTH\n\nTo include GLDT in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get subcontractor costs with original, change orders, invoiced, paid, and retainage by vendor\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Subcontractor cost breakdown by vendor:\n1. Join SLHD (Header) to SLIT (Items) for subcontract details\n2. Join APVM for vendor names\n3. OrigCost = original contract amount\n4. CurCost - OrigCost = change order amounts\n5. InvCost = amounts invoiced\n6. Retainage = amounts held back\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  SLHD.SL AS SubcontractNum,\n  SLHD.Description AS SubcontractDesc,\n  SUM(SLIT.OrigCost) AS OriginalCost,\n  SUM(SLIT.CurCost - SLIT.OrigCost) AS ChangeOrderCost,\n  SUM(SLIT.CurCost) AS CurrentCost,\n  SUM(SLIT.InvCost) AS InvoicedCost,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost - SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nINNER JOIN APVM WITH (NOLOCK) ON SLHD.VendorGroup = APVM.VendorGroup AND SLHD.Vendor = APVM.Vendor\nWHERE SLHD.SLCo = @SLCo\nGROUP BY APVM.Vendor, APVM.Name, SLHD.SL, SLHD.Description\nORDER BY APVM.Name, SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLHD",
        "SLIT",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging with customer contact information\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I can partially answer this query, but the schema is incomplete.\n\nThe query requires ARCM (AR Customer Master) for customer details, but only ARTH is provided in the schema.\n\nHere's what I can provide with the available schema:\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n-- Note: Additional joins for ARCM would be needed for complete results\n```\n\nTo get the complete data you requested, please provide the DDL for ARCM.",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging buckets (30/60/90+ days) for unpaid invoices by customer\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Use ARTH for transaction data and ARCM for customer names\n2. Filter PayFullDate IS NULL to get only unpaid invoices\n3. Use DATEDIFF and CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate stored materials (Purchased - Installed) for SL billing\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Stored materials for SL billing:\n1. SLWI contains work item/billing details\n2. StoredMatls = Purchased - Installed (materials on-site but not yet used)\n3. WCCost = Work Completed Cost\n4. WCRetAmt and SMRetAmt = separate retainage for work vs materials\n5. Total billable = WCCost + StoredMatls\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description AS ItemDescription,\n  SLWI.StoredMatls,\n  SLWI.WCCost AS WorkCompletedCost,\n  SLWI.StoredMatls + SLWI.WCCost AS TotalBillable,\n  SLWI.WCRetAmt AS WorkRetainage,\n  SLWI.SMRetAmt AS MaterialsRetainage,\n  SLWI.WCRetAmt + SLWI.SMRetAmt AS TotalRetainage\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\n  AND SLWI.StoredMatls <> 0\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "intermediate",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoice totals with discounts and retainage\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Vendor invoice summary with discounts and retainage:\n1. Join APTH to APVM for vendor details\n2. Aggregate by vendor\n3. Include GrossAmt, DiscOffer, Retainage, and Balance\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(APTH.APTrans) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS GrossAmount,\n  SUM(APTH.DiscOffer) AS DiscountsOffered,\n  SUM(APTH.Retainage) AS RetainageHeld,\n  SUM(APTH.Balance) AS OpenBalance\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate stored materials (Purchased - Installed) for SL billing\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Stored materials for SL billing:\n1. SLWI contains work item/billing details\n2. StoredMatls = Purchased - Installed (materials on-site but not yet used)\n3. WCCost = Work Completed Cost\n4. WCRetAmt and SMRetAmt = separate retainage for work vs materials\n5. Total billable = WCCost + StoredMatls\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description AS ItemDescription,\n  SLWI.StoredMatls,\n  SLWI.WCCost AS WorkCompletedCost,\n  SLWI.StoredMatls + SLWI.WCCost AS TotalBillable,\n  SLWI.WCRetAmt AS WorkRetainage,\n  SLWI.SMRetAmt AS MaterialsRetainage,\n  SLWI.WCRetAmt + SLWI.SMRetAmt AS TotalRetainage\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\n  AND SLWI.StoredMatls <> 0\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "basic",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need to count records in jccd by company\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count JCCD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM JCCD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to query ARAgingReport\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'ARAgingReport' does not exist in Viewpoint Vista.\n\nUse ARTH (AR Transaction Header) with DATEDIFF calculations for aging. There is no pre-built ARAgingReport table in Vista.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to count records in slhd by company\n\nDatabase Schema:\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count SLHD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM SLHD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "SLHD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find jobs over budget with remaining cost projection\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Find jobs over budget:\n1. Aggregate JCCP by job from JCJM\n2. Compare total ActualCost to CurrEstCost\n3. Use HAVING to filter only over-budget jobs\n4. Sort by amount over budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description,\n  SUM(JCCP.CurrEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.CurrEstCost) - SUM(JCCP.ActualCost) AS RemainingBudget,\n  CASE WHEN SUM(JCCP.CurrEstCost) < SUM(JCCP.ActualCost) \n       THEN 'OVER BUDGET' ELSE 'OK' END AS Status\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\nGROUP BY JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.CurrEstCost)\nORDER BY (SUM(JCCP.ActualCost) - SUM(JCCP.CurrEstCost)) DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM",
        "JCCD",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get subcontractor costs with original, change orders, invoiced, paid, and retainage by vendor\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Subcontractor cost breakdown by vendor:\n1. Join SLHD (Header) to SLIT (Items) for subcontract details\n2. Join APVM for vendor names\n3. OrigCost = original contract amount\n4. CurCost - OrigCost = change order amounts\n5. InvCost = amounts invoiced\n6. Retainage = amounts held back\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  SLHD.SL AS SubcontractNum,\n  SLHD.Description AS SubcontractDesc,\n  SUM(SLIT.OrigCost) AS OriginalCost,\n  SUM(SLIT.CurCost - SLIT.OrigCost) AS ChangeOrderCost,\n  SUM(SLIT.CurCost) AS CurrentCost,\n  SUM(SLIT.InvCost) AS InvoicedCost,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost - SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nINNER JOIN APVM WITH (NOLOCK) ON SLHD.VendorGroup = APVM.VendorGroup AND SLHD.Vendor = APVM.Vendor\nWHERE SLHD.SLCo = @SLCo\nGROUP BY APVM.Vendor, APVM.Name, SLHD.SL, SLHD.Description\nORDER BY APVM.Name, SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLHD",
        "SLIT",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoice totals with discounts and retainage\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Vendor invoice summary with discounts and retainage:\n1. Join APTH to APVM for vendor details\n2. Aggregate by vendor\n3. Include GrossAmt, DiscOffer, Retainage, and Balance\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(APTH.APTrans) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS GrossAmount,\n  SUM(APTH.DiscOffer) AS DiscountsOffered,\n  SUM(APTH.Retainage) AS RetainageHeld,\n  SUM(APTH.Balance) AS OpenBalance\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "basic",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from SLWI\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from SLWI ().\n\n```sql\nSELECT *\nFROM SLWI WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLWI"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to count records in slwi by company\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count SLWI records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM SLWI WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "SLWI"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging with customer contact information\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I can partially answer this query, but the schema is incomplete.\n\nThe query requires ARCM (AR Customer Master) for customer details, but only ARTH is provided in the schema.\n\nHere's what I can provide with the available schema:\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n-- Note: Additional joins for ARCM would be needed for complete results\n```\n\nTo get the complete data you requested, please provide the DDL for ARCM.",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How do I count records in gljr by company\n\nDatabase Schema:\nCREATE TABLE GLJR (\n  GLCo bcompany NOT NULL,\n  Jrnl bjrnl NOT NULL,\n  Description btransdesc,\n  Rev byn NOT NULL,\n  RevJrnl bjrnl,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count GLJR records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM GLJR WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "GLJR"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from JCCD\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from JCCD ().\n\n```sql\nSELECT *\nFROM JCCD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to count records in glac by company\n\nDatabase Schema:\nCREATE TABLE GLAC (\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  Description bdesc,\n  AcctType char(1) NOT NULL,\n  SubType char(1),\n  NormBal char(1),\n  InterfaceDetail byn NOT NULL,\n  Active byn NOT NULL,\n  SummaryAcct bglacct NOT NULL,\n  CashAccrual char(1) NOT NULL,\n  CashOffAcct bglacct,\n  Notes varchar,\n  Part1 varchar(20),\n  Part2 varchar(20),\n  Part3 varchar(20),\n  Part4 varchar(20),\n  Part5 varchar(20),\n  Part6 varchar(20),\n  AllParts varchar(20),\n  CrossRefMemAcct bglacct,\n  -- ... 3 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count GLAC records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM GLAC WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "GLAC"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How do I count records in gldt by company\n\nDatabase Schema:\nCREATE TABLE GLDT (\n  GLCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  GLTrans btrans NOT NULL,\n  GLAcct bglacct NOT NULL,\n  Jrnl bjrnl NOT NULL,\n  GLRef bglref NOT NULL,\n  SourceCo bcompany NOT NULL,\n  Source bsource NOT NULL,\n  ActDate bdate NOT NULL,\n  DatePosted bdate NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid NOT NULL,\n  Amount bdollar NOT NULL,\n  RevStatus tinyint NOT NULL,\n  Adjust char(1) NOT NULL,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  UniqueAttchID uniqueidentifier,\n  SrcTable varchar(128),\n  SrcKeyID bigint,\n  PRIMARY KEY (GLCo, Mth, GLTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count GLDT records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM GLDT WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "GLDT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find jobs over budget with remaining cost projection\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Find jobs over budget:\n1. Aggregate JCCP by job from JCJM\n2. Compare total ActualCost to CurrEstCost\n3. Use HAVING to filter only over-budget jobs\n4. Sort by amount over budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description,\n  SUM(JCCP.CurrEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.CurrEstCost) - SUM(JCCP.ActualCost) AS RemainingBudget,\n  CASE WHEN SUM(JCCP.CurrEstCost) < SUM(JCCP.ActualCost) \n       THEN 'OVER BUDGET' ELSE 'OK' END AS Status\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\nGROUP BY JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.CurrEstCost)\nORDER BY (SUM(JCCP.ActualCost) - SUM(JCCP.CurrEstCost)) DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCJM",
        "JCCD",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find all unpaid AR invoices older than 60 days\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find unpaid invoices over 60 days:\n1. Join ARTH to ARCM for customer information\n2. Filter PayFullDate IS NULL (unpaid)\n3. Use DATEDIFF to calculate age and filter > 60 days\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Mth,\n  ARTH.ARTrans,\n  ARCM.Name AS CustomerName,\n  ARTH.TransDate,\n  ARTH.Amount,\n  DATEDIFF(day, ARTH.TransDate, GETDATE()) AS DaysOutstanding\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\n  AND DATEDIFF(day, ARTH.TransDate, GETDATE()) > 60\nORDER BY ARTH.TransDate\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from JCCD\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from JCCD ().\n\n```sql\nSELECT *\nFROM JCCD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: count records in jccd by company\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count JCCD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM JCCD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How do I count records in slhd by company\n\nDatabase Schema:\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count SLHD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM SLHD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "SLHD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from GLAC\n\nDatabase Schema:\nCREATE TABLE GLAC (\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  Description bdesc,\n  AcctType char(1) NOT NULL,\n  SubType char(1),\n  NormBal char(1),\n  InterfaceDetail byn NOT NULL,\n  Active byn NOT NULL,\n  SummaryAcct bglacct NOT NULL,\n  CashAccrual char(1) NOT NULL,\n  CashOffAcct bglacct,\n  Notes varchar,\n  Part1 varchar(20),\n  Part2 varchar(20),\n  Part3 varchar(20),\n  Part4 varchar(20),\n  Part5 varchar(20),\n  Part6 varchar(20),\n  AllParts varchar(20),\n  CrossRefMemAcct bglacct,\n  -- ... 3 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from GLAC ().\n\n```sql\nSELECT *\nFROM GLAC WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "GLAC"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoice totals with discounts and retainage\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Vendor invoice summary with discounts and retainage:\n1. Join APTH to APVM for vendor details\n2. Aggregate by vendor\n3. Include GrossAmt, DiscOffer, Retainage, and Balance\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(APTH.APTrans) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS GrossAmount,\n  SUM(APTH.DiscOffer) AS DiscountsOffered,\n  SUM(APTH.Retainage) AS RetainageHeld,\n  SUM(APTH.Balance) AS OpenBalance\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "basic",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get subcontractor costs with original, change orders, invoiced, paid, and retainage by vendor\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Subcontractor cost breakdown by vendor:\n1. Join SLHD (Header) to SLIT (Items) for subcontract details\n2. Join APVM for vendor names\n3. OrigCost = original contract amount\n4. CurCost - OrigCost = change order amounts\n5. InvCost = amounts invoiced\n6. Retainage = amounts held back\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  SLHD.SL AS SubcontractNum,\n  SLHD.Description AS SubcontractDesc,\n  SUM(SLIT.OrigCost) AS OriginalCost,\n  SUM(SLIT.CurCost - SLIT.OrigCost) AS ChangeOrderCost,\n  SUM(SLIT.CurCost) AS CurrentCost,\n  SUM(SLIT.InvCost) AS InvoicedCost,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost - SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nINNER JOIN APVM WITH (NOLOCK) ON SLHD.VendorGroup = APVM.VendorGroup AND SLHD.Vendor = APVM.Vendor\nWHERE SLHD.SLCo = @SLCo\nGROUP BY APVM.Vendor, APVM.Name, SLHD.SL, SLHD.Description\nORDER BY APVM.Name, SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "basic",
      "tables_used": [
        "SLHD",
        "SLIT",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get job cost variance by phase comparing budget to actual\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Job cost variance by phase:\n1. Join JCJM (Job Master) to JCCP (Cost Phase)\n2. Calculate variance as CurrEstCost - ActualCost\n3. Calculate percent complete from actuals vs budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  JCCP.Phase,\n  JCCP.CostType,\n  JCCP.OrigEstCost AS OriginalBudget,\n  JCCP.CurrEstCost AS CurrentBudget,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS Variance,\n  CASE WHEN JCCP.CurrEstCost <> 0 \n       THEN (JCCP.ActualCost / JCCP.CurrEstCost) * 100 \n       ELSE 0 END AS PercentComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.Job = @Job\nORDER BY JCCP.Phase, JCCP.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging buckets (30/60/90+ days) for unpaid invoices by customer\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Use ARTH for transaction data and ARCM for customer names\n2. Filter PayFullDate IS NULL to get only unpaid invoices\n3. Use DATEDIFF and CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find all unpaid AR invoices older than 60 days\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find unpaid invoices over 60 days:\n1. Join ARTH to ARCM for customer information\n2. Filter PayFullDate IS NULL (unpaid)\n3. Use DATEDIFF to calculate age and filter > 60 days\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Mth,\n  ARTH.ARTrans,\n  ARCM.Name AS CustomerName,\n  ARTH.TransDate,\n  ARTH.Amount,\n  DATEDIFF(day, ARTH.TransDate, GETDATE()) AS DaysOutstanding\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\n  AND DATEDIFF(day, ARTH.TransDate, GETDATE()) > 60\nORDER BY ARTH.TransDate\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find all unpaid AR invoices older than 60 days\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find unpaid invoices over 60 days:\n1. Join ARTH to ARCM for customer information\n2. Filter PayFullDate IS NULL (unpaid)\n3. Use DATEDIFF to calculate age and filter > 60 days\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Mth,\n  ARTH.ARTrans,\n  ARCM.Name AS CustomerName,\n  ARTH.TransDate,\n  ARTH.Amount,\n  DATEDIFF(day, ARTH.TransDate, GETDATE()) AS DaysOutstanding\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\n  AND DATEDIFF(day, ARTH.TransDate, GETDATE()) > 60\nORDER BY ARTH.TransDate\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need to aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from APTH\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from APTH ().\n\n```sql\nSELECT *\nFROM APTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate stored materials (Purchased - Installed) for SL billing\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Stored materials for SL billing:\n1. SLWI contains work item/billing details\n2. StoredMatls = Purchased - Installed (materials on-site but not yet used)\n3. WCCost = Work Completed Cost\n4. WCRetAmt and SMRetAmt = separate retainage for work vs materials\n5. Total billable = WCCost + StoredMatls\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description AS ItemDescription,\n  SLWI.StoredMatls,\n  SLWI.WCCost AS WorkCompletedCost,\n  SLWI.StoredMatls + SLWI.WCCost AS TotalBillable,\n  SLWI.WCRetAmt AS WorkRetainage,\n  SLWI.SMRetAmt AS MaterialsRetainage,\n  SLWI.WCRetAmt + SLWI.SMRetAmt AS TotalRetainage\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\n  AND SLWI.StoredMatls <> 0\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "intermediate",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to count records in glac by company\n\nDatabase Schema:\nCREATE TABLE GLAC (\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  Description bdesc,\n  AcctType char(1) NOT NULL,\n  SubType char(1),\n  NormBal char(1),\n  InterfaceDetail byn NOT NULL,\n  Active byn NOT NULL,\n  SummaryAcct bglacct NOT NULL,\n  CashAccrual char(1) NOT NULL,\n  CashOffAcct bglacct,\n  Notes varchar,\n  Part1 varchar(20),\n  Part2 varchar(20),\n  Part3 varchar(20),\n  Part4 varchar(20),\n  Part5 varchar(20),\n  Part6 varchar(20),\n  AllParts varchar(20),\n  CrossRefMemAcct bglacct,\n  -- ... 3 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count GLAC records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM GLAC WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "GLAC"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from PRCO\n\nDatabase Schema:\nCREATE TABLE PRCO (\n  PRCo bcompany NOT NULL,\n  GLCo bcompany NOT NULL,\n  Jrnl bjrnl,\n  GLInterface byn NOT NULL,\n  CMCo bcompany NOT NULL,\n  APCo bcompany,\n  AutoOT byn NOT NULL,\n  OTEarnCode bedlcode,\n  JCCo bcompany NOT NULL,\n  AllowNoPhase byn NOT NULL,\n  JCInterface byn NOT NULL,\n  InsByPhase byn NOT NULL,\n  JCICraftClass byn NOT NULL,\n  JCICrew byn NOT NULL,\n  JCIEmployee byn NOT NULL,\n  JCIFactor byn NOT NULL,\n  JCIEarnType byn NOT NULL,\n  JCIShift byn NOT NULL,\n  JCIPostingDate byn NOT NULL,\n  JCILiabType byn NOT NULL,\n  -- ... 66 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from PRCO ().\n\n```sql\nSELECT *\nFROM PRCO WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "PRCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from ARTH\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from ARTH ().\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get job cost variance by phase comparing budget to actual\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Job cost variance by phase:\n1. Join JCJM (Job Master) to JCCP (Cost Phase)\n2. Calculate variance as CurrEstCost - ActualCost\n3. Calculate percent complete from actuals vs budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  JCCP.Phase,\n  JCCP.CostType,\n  JCCP.OrigEstCost AS OriginalBudget,\n  JCCP.CurrEstCost AS CurrentBudget,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS Variance,\n  CASE WHEN JCCP.CurrEstCost <> 0 \n       THEN (JCCP.ActualCost / JCCP.CurrEstCost) * 100 \n       ELSE 0 END AS PercentComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.Job = @Job\nORDER BY JCCP.Phase, JCCP.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to count records in jccd by company\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count JCCD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM JCCD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from JCCD\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from JCCD ().\n\n```sql\nSELECT *\nFROM JCCD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate stored materials (Purchased - Installed) for SL billing\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Stored materials for SL billing:\n1. SLWI contains work item/billing details\n2. StoredMatls = Purchased - Installed (materials on-site but not yet used)\n3. WCCost = Work Completed Cost\n4. WCRetAmt and SMRetAmt = separate retainage for work vs materials\n5. Total billable = WCCost + StoredMatls\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description AS ItemDescription,\n  SLWI.StoredMatls,\n  SLWI.WCCost AS WorkCompletedCost,\n  SLWI.StoredMatls + SLWI.WCCost AS TotalBillable,\n  SLWI.WCRetAmt AS WorkRetainage,\n  SLWI.SMRetAmt AS MaterialsRetainage,\n  SLWI.WCRetAmt + SLWI.SMRetAmt AS TotalRetainage\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\n  AND SLWI.StoredMatls <> 0\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "intermediate",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get job cost variance by phase comparing budget to actual\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Job cost variance by phase:\n1. Join JCJM (Job Master) to JCCP (Cost Phase)\n2. Calculate variance as CurrEstCost - ActualCost\n3. Calculate percent complete from actuals vs budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  JCCP.Phase,\n  JCCP.CostType,\n  JCCP.OrigEstCost AS OriginalBudget,\n  JCCP.CurrEstCost AS CurrentBudget,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS Variance,\n  CASE WHEN JCCP.CurrEstCost <> 0 \n       THEN (JCCP.ActualCost / JCCP.CurrEstCost) * 100 \n       ELSE 0 END AS PercentComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.Job = @Job\nORDER BY JCCP.Phase, JCCP.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get subcontractor costs with original, change orders, invoiced, paid, and retainage by vendor\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Subcontractor cost breakdown by vendor:\n1. Join SLHD (Header) to SLIT (Items) for subcontract details\n2. Join APVM for vendor names\n3. OrigCost = original contract amount\n4. CurCost - OrigCost = change order amounts\n5. InvCost = amounts invoiced\n6. Retainage = amounts held back\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  SLHD.SL AS SubcontractNum,\n  SLHD.Description AS SubcontractDesc,\n  SUM(SLIT.OrigCost) AS OriginalCost,\n  SUM(SLIT.CurCost - SLIT.OrigCost) AS ChangeOrderCost,\n  SUM(SLIT.CurCost) AS CurrentCost,\n  SUM(SLIT.InvCost) AS InvoicedCost,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost - SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nINNER JOIN APVM WITH (NOLOCK) ON SLHD.VendorGroup = APVM.VendorGroup AND SLHD.Vendor = APVM.Vendor\nWHERE SLHD.SLCo = @SLCo\nGROUP BY APVM.Vendor, APVM.Name, SLHD.SL, SLHD.Description\nORDER BY APVM.Name, SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "intermediate",
      "tables_used": [
        "SLHD",
        "SLIT",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate stored materials (Purchased - Installed) for SL billing\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Stored materials for SL billing:\n1. SLWI contains work item/billing details\n2. StoredMatls = Purchased - Installed (materials on-site but not yet used)\n3. WCCost = Work Completed Cost\n4. WCRetAmt and SMRetAmt = separate retainage for work vs materials\n5. Total billable = WCCost + StoredMatls\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description AS ItemDescription,\n  SLWI.StoredMatls,\n  SLWI.WCCost AS WorkCompletedCost,\n  SLWI.StoredMatls + SLWI.WCCost AS TotalBillable,\n  SLWI.WCRetAmt AS WorkRetainage,\n  SLWI.SMRetAmt AS MaterialsRetainage,\n  SLWI.WCRetAmt + SLWI.SMRetAmt AS TotalRetainage\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\n  AND SLWI.StoredMatls <> 0\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get subcontractor costs with original, change orders, invoiced, paid, and retainage by vendor\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Subcontractor cost breakdown by vendor:\n1. Join SLHD (Header) to SLIT (Items) for subcontract details\n2. Join APVM for vendor names\n3. OrigCost = original contract amount\n4. CurCost - OrigCost = change order amounts\n5. InvCost = amounts invoiced\n6. Retainage = amounts held back\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  SLHD.SL AS SubcontractNum,\n  SLHD.Description AS SubcontractDesc,\n  SUM(SLIT.OrigCost) AS OriginalCost,\n  SUM(SLIT.CurCost - SLIT.OrigCost) AS ChangeOrderCost,\n  SUM(SLIT.CurCost) AS CurrentCost,\n  SUM(SLIT.InvCost) AS InvoicedCost,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost - SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nINNER JOIN APVM WITH (NOLOCK) ON SLHD.VendorGroup = APVM.VendorGroup AND SLHD.Vendor = APVM.Vendor\nWHERE SLHD.SLCo = @SLCo\nGROUP BY APVM.Vendor, APVM.Name, SLHD.SL, SLHD.Description\nORDER BY APVM.Name, SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "intermediate",
      "tables_used": [
        "SLHD",
        "SLIT",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from SLHD\n\nDatabase Schema:\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from SLHD ().\n\n```sql\nSELECT *\nFROM SLHD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "SLHD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get job cost variance by phase comparing budget to actual\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Job cost variance by phase:\n1. Join JCJM (Job Master) to JCCP (Cost Phase)\n2. Calculate variance as CurrEstCost - ActualCost\n3. Calculate percent complete from actuals vs budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  JCCP.Phase,\n  JCCP.CostType,\n  JCCP.OrigEstCost AS OriginalBudget,\n  JCCP.CurrEstCost AS CurrentBudget,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS Variance,\n  CASE WHEN JCCP.CurrEstCost <> 0 \n       THEN (JCCP.ActualCost / JCCP.CurrEstCost) * 100 \n       ELSE 0 END AS PercentComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.Job = @Job\nORDER BY JCCP.Phase, JCCP.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need to aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from SLHD\n\nDatabase Schema:\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from SLHD ().\n\n```sql\nSELECT *\nFROM SLHD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLHD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get customer balance summary by customer group\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Customer balance summary by group:\n1. Join ARTH to ARCM for customer details\n2. Use conditional SUM for open vs total balances\n3. Group by CustGroup for summary\n\n```sql\nSELECT \n  ARTH.CustGroup,\n  COUNT(DISTINCT ARTH.Customer) AS CustomerCount,\n  SUM(CASE WHEN ARTH.PayFullDate IS NULL THEN ARTH.Amount ELSE 0 END) AS OpenBalance,\n  SUM(ARTH.Amount) AS TotalBilled\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\nGROUP BY ARTH.CustGroup\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from APTH\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from APTH ().\n\n```sql\nSELECT *\nFROM APTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "APTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to count records in jccd by company\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count JCCD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM JCCD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get subcontractor costs with original, change orders, invoiced, paid, and retainage by vendor\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Subcontractor cost breakdown by vendor:\n1. Join SLHD (Header) to SLIT (Items) for subcontract details\n2. Join APVM for vendor names\n3. OrigCost = original contract amount\n4. CurCost - OrigCost = change order amounts\n5. InvCost = amounts invoiced\n6. Retainage = amounts held back\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  SLHD.SL AS SubcontractNum,\n  SLHD.Description AS SubcontractDesc,\n  SUM(SLIT.OrigCost) AS OriginalCost,\n  SUM(SLIT.CurCost - SLIT.OrigCost) AS ChangeOrderCost,\n  SUM(SLIT.CurCost) AS CurrentCost,\n  SUM(SLIT.InvCost) AS InvoicedCost,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost - SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nINNER JOIN APVM WITH (NOLOCK) ON SLHD.VendorGroup = APVM.VendorGroup AND SLHD.Vendor = APVM.Vendor\nWHERE SLHD.SLCo = @SLCo\nGROUP BY APVM.Vendor, APVM.Name, SLHD.SL, SLHD.Description\nORDER BY APVM.Name, SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "basic",
      "tables_used": [
        "SLHD",
        "SLIT",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging with customer contact information\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I can partially answer this query, but the schema is incomplete.\n\nThe query requires ARCM (AR Customer Master) for customer details, but only ARTH is provided in the schema.\n\nHere's what I can provide with the available schema:\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n-- Note: Additional joins for ARCM would be needed for complete results\n```\n\nTo get the complete data you requested, please provide the DDL for ARCM.",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get subcontractor costs with original, change orders, invoiced, paid, and retainage by vendor\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Subcontractor cost breakdown by vendor:\n1. Join SLHD (Header) to SLIT (Items) for subcontract details\n2. Join APVM for vendor names\n3. OrigCost = original contract amount\n4. CurCost - OrigCost = change order amounts\n5. InvCost = amounts invoiced\n6. Retainage = amounts held back\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  SLHD.SL AS SubcontractNum,\n  SLHD.Description AS SubcontractDesc,\n  SUM(SLIT.OrigCost) AS OriginalCost,\n  SUM(SLIT.CurCost - SLIT.OrigCost) AS ChangeOrderCost,\n  SUM(SLIT.CurCost) AS CurrentCost,\n  SUM(SLIT.InvCost) AS InvoicedCost,\n  SUM(SLIT.Retainage) AS RetainageHeld,\n  SUM(SLIT.CurCost - SLIT.InvCost) AS RemainingToBill\nFROM SLHD WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLHD.SLCo = SLIT.SLCo AND SLHD.SL = SLIT.SL\nINNER JOIN APVM WITH (NOLOCK) ON SLHD.VendorGroup = APVM.VendorGroup AND SLHD.Vendor = APVM.Vendor\nWHERE SLHD.SLCo = @SLCo\nGROUP BY APVM.Vendor, APVM.Name, SLHD.SL, SLHD.Description\nORDER BY APVM.Name, SLHD.SL\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLHD",
        "SLIT",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoice totals with discounts and retainage\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Vendor invoice summary with discounts and retainage:\n1. Join APTH to APVM for vendor details\n2. Aggregate by vendor\n3. Include GrossAmt, DiscOffer, Retainage, and Balance\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(APTH.APTrans) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS GrossAmount,\n  SUM(APTH.DiscOffer) AS DiscountsOffered,\n  SUM(APTH.Retainage) AS RetainageHeld,\n  SUM(APTH.Balance) AS OpenBalance\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to track ap hold status distinguishing retainage vs non-retainage holds\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APCO (\n  APCo bcompany NOT NULL,\n  GLCo bcompany NOT NULL,\n  ExpJrnl bjrnl,\n  GLExpInterfaceLvl tinyint NOT NULL,\n  GLExpSummaryDesc varchar(60),\n  GLExpTransDesc varchar(60),\n  GLJobDetailDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLEquipDetailDesc varchar(60),\n  GLExpDetailDesc varchar(60),\n  PayJrnl bjrnl,\n  GLPayInterfaceLvl tinyint NOT NULL,\n  GLPayDetailDesc varchar(60),\n  GLPaySummaryDesc varchar(60),\n  DiscOffGLAcct bglacct,\n  DiscTakenGLAcct bglacct,\n  ExpPayType tinyint,\n  JobPayType tinyint,\n  SubPayType tinyint,\n  RetPayType tinyint,\n  -- ... 92 more columns,\n  PRIMARY KEY (APCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To distinguish retainage vs non-retainage holds:\n1. Join APTD to APHD for hold details\n2. Join APCO to get RetHoldCode setting\n3. Compare APHD.HoldCode to APCO.RetHoldCode\n4. If equal, it's a retainage hold; otherwise non-retainage\n\n```sql\nSELECT \n  APTD.APCo,\n  APTD.Vendor,\n  APTD.Mth,\n  APTD.APTrans,\n  APHD.HoldCode,\n  CASE WHEN APHD.HoldCode = APCO.RetHoldCode \n       THEN 'Retainage Hold' \n       ELSE 'Non-Retainage Hold' END AS HoldType,\n  APTD.Amount\nFROM APTD WITH (NOLOCK)\nINNER JOIN APHD WITH (NOLOCK) ON APTD.APCo = APHD.APCo \n  AND APTD.Mth = APHD.Mth \n  AND APTD.APTrans = APHD.APTrans \n  AND APTD.APLine = APHD.APLine\nINNER JOIN APCO WITH (NOLOCK) ON APTD.APCo = APCO.APCo\nWHERE APTD.APCo = @APCo\n  AND APHD.HoldCode IS NOT NULL\nORDER BY APTD.Vendor, APTD.Mth\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTD",
        "APHD",
        "APCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoice totals with discounts and retainage\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Vendor invoice summary with discounts and retainage:\n1. Join APTH to APVM for vendor details\n2. Aggregate by vendor\n3. Include GrossAmt, DiscOffer, Retainage, and Balance\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(APTH.APTrans) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS GrossAmount,\n  SUM(APTH.DiscOffer) AS DiscountsOffered,\n  SUM(APTH.Retainage) AS RetainageHeld,\n  SUM(APTH.Balance) AS OpenBalance\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from JCCD\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from JCCD ().\n\n```sql\nSELECT *\nFROM JCCD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from SLHD\n\nDatabase Schema:\nCREATE TABLE SLHD (\n  SLCo bcompany NOT NULL,\n  SL varchar(30) NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  HoldCode bholdcode,\n  PayTerms bpayterms,\n  CompGroup varchar(10),\n  Status tinyint NOT NULL,\n  MthClosed bmonth,\n  InUseMth bmonth,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  Approved byn,\n  ApprovedBy bvpusername,\n  Notes varchar,\n  AddedMth bmonth,\n  AddedBatchID bbatchid,\n  -- ... 15 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from SLHD ().\n\n```sql\nSELECT *\nFROM SLHD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "SLHD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to count records in arth by company\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count ARTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM ARTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from GLDT\n\nDatabase Schema:\nCREATE TABLE GLDT (\n  GLCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  GLTrans btrans NOT NULL,\n  GLAcct bglacct NOT NULL,\n  Jrnl bjrnl NOT NULL,\n  GLRef bglref NOT NULL,\n  SourceCo bcompany NOT NULL,\n  Source bsource NOT NULL,\n  ActDate bdate NOT NULL,\n  DatePosted bdate NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid NOT NULL,\n  Amount bdollar NOT NULL,\n  RevStatus tinyint NOT NULL,\n  Adjust char(1) NOT NULL,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  UniqueAttchID uniqueidentifier,\n  SrcTable varchar(128),\n  SrcKeyID bigint,\n  PRIMARY KEY (GLCo, Mth, GLTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from GLDT ().\n\n```sql\nSELECT *\nFROM GLDT WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "GLDT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get customer balance summary by customer group\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Customer balance summary by group:\n1. Join ARTH to ARCM for customer details\n2. Use conditional SUM for open vs total balances\n3. Group by CustGroup for summary\n\n```sql\nSELECT \n  ARTH.CustGroup,\n  COUNT(DISTINCT ARTH.Customer) AS CustomerCount,\n  SUM(CASE WHEN ARTH.PayFullDate IS NULL THEN ARTH.Amount ELSE 0 END) AS OpenBalance,\n  SUM(ARTH.Amount) AS TotalBilled\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\nGROUP BY ARTH.CustGroup\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How do I count records in prth by company\n\nDatabase Schema:\nCREATE TABLE PRTH (\n  PRCo bcompany NOT NULL,\n  PRGroup bgroup NOT NULL,\n  PREndDate bdate NOT NULL,\n  Employee bemployee NOT NULL,\n  PaySeq tinyint NOT NULL,\n  PostSeq smallint NOT NULL,\n  Type char(1) NOT NULL,\n  PostDate bdate NOT NULL,\n  JCCo bcompany,\n  Job bjob,\n  PhaseGroup bgroup,\n  Phase bphase,\n  JCDept bdept,\n  GLCo bcompany NOT NULL,\n  EMCo bcompany,\n  WO bwo,\n  WOItem bitem,\n  Equipment bequip,\n  EMGroup tinyint,\n  CostCode bcostcode,\n  -- ... 41 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count PRTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM PRTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "PRTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need to aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging buckets (30/60/90+ days) for unpaid invoices by customer\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Use ARTH for transaction data and ARCM for customer names\n2. Filter PayFullDate IS NULL to get only unpaid invoices\n3. Use DATEDIFF and CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to count records in apth by company\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count APTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM APTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from GLJR\n\nDatabase Schema:\nCREATE TABLE GLJR (\n  GLCo bcompany NOT NULL,\n  Jrnl bjrnl NOT NULL,\n  Description btransdesc,\n  Rev byn NOT NULL,\n  RevJrnl bjrnl,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from GLJR ().\n\n```sql\nSELECT *\nFROM GLJR WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "GLJR"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate stored materials (Purchased - Installed) for SL billing\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Stored materials for SL billing:\n1. SLWI contains work item/billing details\n2. StoredMatls = Purchased - Installed (materials on-site but not yet used)\n3. WCCost = Work Completed Cost\n4. WCRetAmt and SMRetAmt = separate retainage for work vs materials\n5. Total billable = WCCost + StoredMatls\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description AS ItemDescription,\n  SLWI.StoredMatls,\n  SLWI.WCCost AS WorkCompletedCost,\n  SLWI.StoredMatls + SLWI.WCCost AS TotalBillable,\n  SLWI.WCRetAmt AS WorkRetainage,\n  SLWI.SMRetAmt AS MaterialsRetainage,\n  SLWI.WCRetAmt + SLWI.SMRetAmt AS TotalRetainage\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\n  AND SLWI.StoredMatls <> 0\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "intermediate",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging buckets (30/60/90+ days) for unpaid invoices by customer\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Use ARTH for transaction data and ARCM for customer names\n2. Filter PayFullDate IS NULL to get only unpaid invoices\n3. Use DATEDIFF and CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find all unpaid AR invoices older than 60 days\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find unpaid invoices over 60 days:\n1. Join ARTH to ARCM for customer information\n2. Filter PayFullDate IS NULL (unpaid)\n3. Use DATEDIFF to calculate age and filter > 60 days\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Mth,\n  ARTH.ARTrans,\n  ARCM.Name AS CustomerName,\n  ARTH.TransDate,\n  ARTH.Amount,\n  DATEDIFF(day, ARTH.TransDate, GETDATE()) AS DaysOutstanding\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\n  AND DATEDIFF(day, ARTH.TransDate, GETDATE()) > 60\nORDER BY ARTH.TransDate\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need to aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate stored materials (Purchased - Installed) for SL billing\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Stored materials for SL billing:\n1. SLWI contains work item/billing details\n2. StoredMatls = Purchased - Installed (materials on-site but not yet used)\n3. WCCost = Work Completed Cost\n4. WCRetAmt and SMRetAmt = separate retainage for work vs materials\n5. Total billable = WCCost + StoredMatls\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description AS ItemDescription,\n  SLWI.StoredMatls,\n  SLWI.WCCost AS WorkCompletedCost,\n  SLWI.StoredMatls + SLWI.WCCost AS TotalBillable,\n  SLWI.WCRetAmt AS WorkRetainage,\n  SLWI.SMRetAmt AS MaterialsRetainage,\n  SLWI.WCRetAmt + SLWI.SMRetAmt AS TotalRetainage\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\n  AND SLWI.StoredMatls <> 0\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "basic",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from APTD\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from APTD ().\n\n```sql\nSELECT *\nFROM APTD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging buckets (30/60/90+ days) for unpaid invoices by customer\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Use ARTH for transaction data and ARCM for customer names\n2. Filter PayFullDate IS NULL to get only unpaid invoices\n3. Use DATEDIFF and CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from JCCD\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from JCCD ().\n\n```sql\nSELECT *\nFROM JCCD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get job cost variance by phase comparing budget to actual\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Job cost variance by phase:\n1. Join JCJM (Job Master) to JCCP (Cost Phase)\n2. Calculate variance as CurrEstCost - ActualCost\n3. Calculate percent complete from actuals vs budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  JCCP.Phase,\n  JCCP.CostType,\n  JCCP.OrigEstCost AS OriginalBudget,\n  JCCP.CurrEstCost AS CurrentBudget,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS Variance,\n  CASE WHEN JCCP.CurrEstCost <> 0 \n       THEN (JCCP.ActualCost / JCCP.CurrEstCost) * 100 \n       ELSE 0 END AS PercentComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.Job = @Job\nORDER BY JCCP.Phase, JCCP.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need to aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from ARTH\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from ARTH ().\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get job cost variance by phase comparing budget to actual\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Job cost variance by phase:\n1. Join JCJM (Job Master) to JCCP (Cost Phase)\n2. Calculate variance as CurrEstCost - ActualCost\n3. Calculate percent complete from actuals vs budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  JCCP.Phase,\n  JCCP.CostType,\n  JCCP.OrigEstCost AS OriginalBudget,\n  JCCP.CurrEstCost AS CurrentBudget,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS Variance,\n  CASE WHEN JCCP.CurrEstCost <> 0 \n       THEN (JCCP.ActualCost / JCCP.CurrEstCost) * 100 \n       ELSE 0 END AS PercentComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.Job = @Job\nORDER BY JCCP.Phase, JCCP.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoice totals with discounts and retainage\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Vendor invoice summary with discounts and retainage:\n1. Join APTH to APVM for vendor details\n2. Aggregate by vendor\n3. Include GrossAmt, DiscOffer, Retainage, and Balance\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(APTH.APTrans) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS GrossAmount,\n  SUM(APTH.DiscOffer) AS DiscountsOffered,\n  SUM(APTH.Retainage) AS RetainageHeld,\n  SUM(APTH.Balance) AS OpenBalance\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "intermediate",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Query JCJM along with the schema tables\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'JCJM' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nARTH, ARCM\n\nTo include JCJM in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to count records in aptd by company\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count APTD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM APTD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging buckets (30/60/90+ days) for unpaid invoices by customer\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Use ARTH for transaction data and ARCM for customer names\n2. Filter PayFullDate IS NULL to get only unpaid invoices\n3. Use DATEDIFF and CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from SLWI\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from SLWI ().\n\n```sql\nSELECT *\nFROM SLWI WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "SLWI"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: I need to count records in glco by company\n\nDatabase Schema:\nCREATE TABLE GLCO (\n  GLCo bcompany NOT NULL,\n  Consolid byn NOT NULL,\n  LastMthSubClsd bmonth NOT NULL,\n  LastMthGLClsd bmonth NOT NULL,\n  MaxOpen tinyint NOT NULL,\n  CashAccrual char(1) NOT NULL,\n  Unbal byn NOT NULL,\n  AuditCoParams byn NOT NULL,\n  AuditAccts byn NOT NULL,\n  AuditAutoJrnl byn NOT NULL,\n  AuditBals byn NOT NULL,\n  AuditBudgets byn NOT NULL,\n  AuditDetail byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  XCompJrnlEntryYN byn NOT NULL,\n  KeyID bigint NOT NULL,\n  LastMthAPClsd bmonth NOT NULL,\n  LastMthARClsd bmonth NOT NULL,\n  AttachBatchReportsYN byn NOT NULL,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count GLCO records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM GLCO WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "GLCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: How do I aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to count records in slwi by company\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count SLWI records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM SLWI WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "SLWI"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find all unpaid AR invoices older than 60 days\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find unpaid invoices over 60 days:\n1. Join ARTH to ARCM for customer information\n2. Filter PayFullDate IS NULL (unpaid)\n3. Use DATEDIFF to calculate age and filter > 60 days\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Mth,\n  ARTH.ARTrans,\n  ARCM.Name AS CustomerName,\n  ARTH.TransDate,\n  ARTH.Amount,\n  DATEDIFF(day, ARTH.TransDate, GETDATE()) AS DaysOutstanding\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\n  AND DATEDIFF(day, ARTH.TransDate, GETDATE()) > 60\nORDER BY ARTH.TransDate\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find all unpaid AR invoices older than 60 days\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To find unpaid invoices over 60 days:\n1. Join ARTH to ARCM for customer information\n2. Filter PayFullDate IS NULL (unpaid)\n3. Use DATEDIFF to calculate age and filter > 60 days\n\n```sql\nSELECT \n  ARTH.ARCo,\n  ARTH.Mth,\n  ARTH.ARTrans,\n  ARCM.Name AS CustomerName,\n  ARTH.TransDate,\n  ARTH.Amount,\n  DATEDIFF(day, ARTH.TransDate, GETDATE()) AS DaysOutstanding\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\n  AND DATEDIFF(day, ARTH.TransDate, GETDATE()) > 60\nORDER BY ARTH.TransDate\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from GLDT\n\nDatabase Schema:\nCREATE TABLE GLDT (\n  GLCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  GLTrans btrans NOT NULL,\n  GLAcct bglacct NOT NULL,\n  Jrnl bjrnl NOT NULL,\n  GLRef bglref NOT NULL,\n  SourceCo bcompany NOT NULL,\n  Source bsource NOT NULL,\n  ActDate bdate NOT NULL,\n  DatePosted bdate NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid NOT NULL,\n  Amount bdollar NOT NULL,\n  RevStatus tinyint NOT NULL,\n  Adjust char(1) NOT NULL,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  UniqueAttchID uniqueidentifier,\n  SrcTable varchar(128),\n  SrcKeyID bigint,\n  PRIMARY KEY (GLCo, Mth, GLTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from GLDT ().\n\n```sql\nSELECT *\nFROM GLDT WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "GLDT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get job cost variance by phase comparing budget to actual\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Job cost variance by phase:\n1. Join JCJM (Job Master) to JCCP (Cost Phase)\n2. Calculate variance as CurrEstCost - ActualCost\n3. Calculate percent complete from actuals vs budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  JCCP.Phase,\n  JCCP.CostType,\n  JCCP.OrigEstCost AS OriginalBudget,\n  JCCP.CurrEstCost AS CurrentBudget,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS Variance,\n  CASE WHEN JCCP.CurrEstCost <> 0 \n       THEN (JCCP.ActualCost / JCCP.CurrEstCost) * 100 \n       ELSE 0 END AS PercentComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.Job = @Job\nORDER BY JCCP.Phase, JCCP.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to track ap hold status distinguishing retainage vs non-retainage holds\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APHD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  HoldCode bholdcode NOT NULL,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APCO (\n  APCo bcompany NOT NULL,\n  GLCo bcompany NOT NULL,\n  ExpJrnl bjrnl,\n  GLExpInterfaceLvl tinyint NOT NULL,\n  GLExpSummaryDesc varchar(60),\n  GLExpTransDesc varchar(60),\n  GLJobDetailDesc varchar(60),\n  GLInvDetailDesc varchar(60),\n  GLEquipDetailDesc varchar(60),\n  GLExpDetailDesc varchar(60),\n  PayJrnl bjrnl,\n  GLPayInterfaceLvl tinyint NOT NULL,\n  GLPayDetailDesc varchar(60),\n  GLPaySummaryDesc varchar(60),\n  DiscOffGLAcct bglacct,\n  DiscTakenGLAcct bglacct,\n  ExpPayType tinyint,\n  JobPayType tinyint,\n  SubPayType tinyint,\n  RetPayType tinyint,\n  -- ... 92 more columns,\n  PRIMARY KEY (APCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To distinguish retainage vs non-retainage holds:\n1. Join APTD to APHD for hold details\n2. Join APCO to get RetHoldCode setting\n3. Compare APHD.HoldCode to APCO.RetHoldCode\n4. If equal, it's a retainage hold; otherwise non-retainage\n\n```sql\nSELECT \n  APTD.APCo,\n  APTD.Vendor,\n  APTD.Mth,\n  APTD.APTrans,\n  APHD.HoldCode,\n  CASE WHEN APHD.HoldCode = APCO.RetHoldCode \n       THEN 'Retainage Hold' \n       ELSE 'Non-Retainage Hold' END AS HoldType,\n  APTD.Amount\nFROM APTD WITH (NOLOCK)\nINNER JOIN APHD WITH (NOLOCK) ON APTD.APCo = APHD.APCo \n  AND APTD.Mth = APHD.Mth \n  AND APTD.APTrans = APHD.APTrans \n  AND APTD.APLine = APHD.APLine\nINNER JOIN APCO WITH (NOLOCK) ON APTD.APCo = APCO.APCo\nWHERE APTD.APCo = @APCo\n  AND APHD.HoldCode IS NOT NULL\nORDER BY APTD.Vendor, APTD.Mth\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTD",
        "APHD",
        "APCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from GLCO\n\nDatabase Schema:\nCREATE TABLE GLCO (\n  GLCo bcompany NOT NULL,\n  Consolid byn NOT NULL,\n  LastMthSubClsd bmonth NOT NULL,\n  LastMthGLClsd bmonth NOT NULL,\n  MaxOpen tinyint NOT NULL,\n  CashAccrual char(1) NOT NULL,\n  Unbal byn NOT NULL,\n  AuditCoParams byn NOT NULL,\n  AuditAccts byn NOT NULL,\n  AuditAutoJrnl byn NOT NULL,\n  AuditBals byn NOT NULL,\n  AuditBudgets byn NOT NULL,\n  AuditDetail byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  XCompJrnlEntryYN byn NOT NULL,\n  KeyID bigint NOT NULL,\n  LastMthAPClsd bmonth NOT NULL,\n  LastMthARClsd bmonth NOT NULL,\n  AttachBatchReportsYN byn NOT NULL,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from GLCO ().\n\n```sql\nSELECT *\nFROM GLCO WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "GLCO"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from SLWI\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from SLWI ().\n\n```sql\nSELECT *\nFROM SLWI WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "SLWI"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to count records in aptd by company\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count APTD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM APTD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from GLDT\n\nDatabase Schema:\nCREATE TABLE GLDT (\n  GLCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  GLTrans btrans NOT NULL,\n  GLAcct bglacct NOT NULL,\n  Jrnl bjrnl NOT NULL,\n  GLRef bglref NOT NULL,\n  SourceCo bcompany NOT NULL,\n  Source bsource NOT NULL,\n  ActDate bdate NOT NULL,\n  DatePosted bdate NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid NOT NULL,\n  Amount bdollar NOT NULL,\n  RevStatus tinyint NOT NULL,\n  Adjust char(1) NOT NULL,\n  InUseBatchId bbatchid,\n  Purge byn NOT NULL,\n  UniqueAttchID uniqueidentifier,\n  SrcTable varchar(128),\n  SrcKeyID bigint,\n  PRIMARY KEY (GLCo, Mth, GLTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from GLDT ().\n\n```sql\nSELECT *\nFROM GLDT WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "GLDT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: count records in arth by company\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count ARTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM ARTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query to aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: count records in aptd by company\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count APTD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM APTD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get vendor invoice totals with discounts and retainage\n\nDatabase Schema:\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Vendor invoice summary with discounts and retainage:\n1. Join APTH to APVM for vendor details\n2. Aggregate by vendor\n3. Include GrossAmt, DiscOffer, Retainage, and Balance\n\n```sql\nSELECT \n  APVM.Vendor,\n  APVM.Name AS VendorName,\n  COUNT(APTH.APTrans) AS InvoiceCount,\n  SUM(APTH.GrossAmt) AS GrossAmount,\n  SUM(APTH.DiscOffer) AS DiscountsOffered,\n  SUM(APTH.Retainage) AS RetainageHeld,\n  SUM(APTH.Balance) AS OpenBalance\nFROM APTH WITH (NOLOCK)\nINNER JOIN APVM WITH (NOLOCK) ON APTH.VendorGroup = APVM.VendorGroup AND APTH.Vendor = APVM.Vendor\nWHERE APTH.APCo = @APCo\nGROUP BY APVM.Vendor, APVM.Name\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ap_queries",
      "complexity": "basic",
      "tables_used": [
        "APTH",
        "APVM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from JCCD\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from JCCD ().\n\n```sql\nSELECT *\nFROM JCCD WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Join GLTransactions with other tables\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'GLTransactions' does not exist in Viewpoint Vista.\n\nUse GLDT (GL Detail) for GL transaction details.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM GLDT WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get job cost variance by phase comparing budget to actual\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Job cost variance by phase:\n1. Join JCJM (Job Master) to JCCP (Cost Phase)\n2. Calculate variance as CurrEstCost - ActualCost\n3. Calculate percent complete from actuals vs budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  JCCP.Phase,\n  JCCP.CostType,\n  JCCP.OrigEstCost AS OriginalBudget,\n  JCCP.CurrEstCost AS CurrentBudget,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS Variance,\n  CASE WHEN JCCP.CurrEstCost <> 0 \n       THEN (JCCP.ActualCost / JCCP.CurrEstCost) * 100 \n       ELSE 0 END AS PercentComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.Job = @Job\nORDER BY JCCP.Phase, JCCP.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging buckets (30/60/90+ days) for unpaid invoices by customer\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Use ARTH for transaction data and ARCM for customer names\n2. Filter PayFullDate IS NULL to get only unpaid invoices\n3. Use DATEDIFF and CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from GLAC\n\nDatabase Schema:\nCREATE TABLE GLAC (\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  Description bdesc,\n  AcctType char(1) NOT NULL,\n  SubType char(1),\n  NormBal char(1),\n  InterfaceDetail byn NOT NULL,\n  Active byn NOT NULL,\n  SummaryAcct bglacct NOT NULL,\n  CashAccrual char(1) NOT NULL,\n  CashOffAcct bglacct,\n  Notes varchar,\n  Part1 varchar(20),\n  Part2 varchar(20),\n  Part3 varchar(20),\n  Part4 varchar(20),\n  Part5 varchar(20),\n  Part6 varchar(20),\n  AllParts varchar(20),\n  CrossRefMemAcct bglacct,\n  -- ... 3 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from GLAC ().\n\n```sql\nSELECT *\nFROM GLAC WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "GLAC"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: List all fields in ContractMaster\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'ContractMaster' does not exist in Viewpoint Vista.\n\nUse JCCM (JC Contract Master) for contract master information.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM JCCM WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Include JCJM in the query\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'JCJM' is not present in the provided database schema.\n\nThe available tables in the provided schema are:\nARTH, ARCM\n\nTo include JCJM in your query, please provide its DDL in the schema context.\n\nAlternatively, I can help you write a query using only the available tables. Would you like me to do that?",
    "metadata": {
      "category": "negative",
      "complexity": "intermediate",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from APTH\n\nDatabase Schema:\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from APTH ().\n\n```sql\nSELECT *\nFROM APTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging buckets (30/60/90+ days) for unpaid invoices by customer\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Use ARTH for transaction data and ARCM for customer names\n2. Filter PayFullDate IS NULL to get only unpaid invoices\n3. Use DATEDIFF and CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to count records in aptd by company\n\nDatabase Schema:\nCREATE TABLE APTD (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  APLine smallint NOT NULL,\n  APSeq tinyint NOT NULL,\n  PayType tinyint NOT NULL,\n  Amount bdollar NOT NULL,\n  DiscOffer bdollar NOT NULL,\n  DiscTaken bdollar NOT NULL,\n  DueDate bdate NOT NULL,\n  Status tinyint NOT NULL,\n  PaidMth bmonth,\n  PaidDate bdate,\n  CMCo bcompany,\n  CMAcct bcmacct,\n  PayMethod char(1),\n  CMRef bcmref,\n  CMRefSeq tinyint,\n  EFTSeq smallint,\n  VendorGroup bgroup,\n  -- ... 13 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count APTD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM APTD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "APTD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get job cost variance by phase comparing budget to actual\n\nDatabase Schema:\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Job cost variance by phase:\n1. Join JCJM (Job Master) to JCCP (Cost Phase)\n2. Calculate variance as CurrEstCost - ActualCost\n3. Calculate percent complete from actuals vs budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description AS JobDescription,\n  JCCP.Phase,\n  JCCP.CostType,\n  JCCP.OrigEstCost AS OriginalBudget,\n  JCCP.CurrEstCost AS CurrentBudget,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS Variance,\n  CASE WHEN JCCP.CurrEstCost <> 0 \n       THEN (JCCP.ActualCost / JCCP.CurrEstCost) * 100 \n       ELSE 0 END AS PercentComplete\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\n  AND JCJM.Job = @Job\nORDER BY JCCP.Phase, JCCP.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Generate SQL to aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to count records in jccd by company\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count JCCD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM JCCD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from ARTH\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from ARTH ().\n\n```sql\nSELECT *\nFROM ARTH WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Create a query to count records in jccd by company\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count JCCD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM JCCD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get customer balance summary by customer group\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Customer balance summary by group:\n1. Join ARTH to ARCM for customer details\n2. Use conditional SUM for open vs total balances\n3. Group by CustGroup for summary\n\n```sql\nSELECT \n  ARTH.CustGroup,\n  COUNT(DISTINCT ARTH.Customer) AS CustomerCount,\n  SUM(CASE WHEN ARTH.PayFullDate IS NULL THEN ARTH.Amount ELSE 0 END) AS OpenBalance,\n  SUM(ARTH.Amount) AS TotalBilled\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\nGROUP BY ARTH.CustGroup\nORDER BY OpenBalance DESC\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate AR aging buckets (30/60/90+ days) for unpaid invoices by customer\n\nDatabase Schema:\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To calculate AR aging buckets for unpaid invoices:\n1. Use ARTH for transaction data and ARCM for customer names\n2. Filter PayFullDate IS NULL to get only unpaid invoices\n3. Use DATEDIFF and CASE WHEN to bucket by age\n4. Group by customer for the summary\n\n```sql\nSELECT \n  ARCM.Name AS CustomerName,\n  ARTH.CustGroup,\n  ARTH.Customer,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) <= 30 \n      THEN ARTH.Amount ELSE 0 END) AS Current_0_30,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 31 AND 60 \n      THEN ARTH.Amount ELSE 0 END) AS Days_31_60,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) BETWEEN 61 AND 90 \n      THEN ARTH.Amount ELSE 0 END) AS Days_61_90,\n  SUM(CASE WHEN DATEDIFF(day, ARTH.TransDate, GETDATE()) > 90 \n      THEN ARTH.Amount ELSE 0 END) AS Over_90\nFROM ARTH WITH (NOLOCK)\nINNER JOIN ARCM WITH (NOLOCK) ON ARTH.CustGroup = ARCM.CustGroup AND ARTH.Customer = ARCM.Customer\nWHERE ARTH.ARCo = @ARCo\n  AND ARTH.PayFullDate IS NULL\nGROUP BY ARCM.Name, ARTH.CustGroup, ARTH.Customer\nORDER BY ARCM.Name\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "ARTH",
        "ARCM"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate stored materials (Purchased - Installed) for SL billing\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Stored materials for SL billing:\n1. SLWI contains work item/billing details\n2. StoredMatls = Purchased - Installed (materials on-site but not yet used)\n3. WCCost = Work Completed Cost\n4. WCRetAmt and SMRetAmt = separate retainage for work vs materials\n5. Total billable = WCCost + StoredMatls\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description AS ItemDescription,\n  SLWI.StoredMatls,\n  SLWI.WCCost AS WorkCompletedCost,\n  SLWI.StoredMatls + SLWI.WCCost AS TotalBillable,\n  SLWI.WCRetAmt AS WorkRetainage,\n  SLWI.SMRetAmt AS MaterialsRetainage,\n  SLWI.WCRetAmt + SLWI.SMRetAmt AS TotalRetainage\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\n  AND SLWI.StoredMatls <> 0\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "intermediate",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: count records in jccd by company\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count JCCD records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM JCCD WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCCD"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Write SQL to aggregate job cost estimates by phase and cost type with item vs phase unit distinctions\n\nDatabase Schema:\nCREATE TABLE JCCH (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  UM bum NOT NULL,\n  BillFlag char(1) NOT NULL,\n  ItemUnitFlag byn NOT NULL,\n  PhaseUnitFlag byn NOT NULL,\n  BuyOutYN byn NOT NULL,\n  LastProjDate smalldatetime,\n  Plugged byn NOT NULL,\n  ActiveYN byn NOT NULL,\n  OrigHours bhrs NOT NULL,\n  OrigUnits bunits NOT NULL,\n  OrigCost bdollar NOT NULL,\n  ProjNotes varchar,\n  SourceStatus char(1) NOT NULL,\n  InterfaceDate bdate,\n  Notes varchar,\n  -- ... 2 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCT (\n  PhaseGroup tinyint NOT NULL,\n  CostType bjcctype NOT NULL,\n  Description bdesc,\n  Abbreviation varchar(10),\n  TrackHours byn,\n  LinkProgress bjcctype,\n  Notes varchar,\n  JBCostTypeCategory char(1),\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup tinyint NOT NULL,\n  Phase bphase NOT NULL,\n  Description bitemdesc,\n  Contract bcontract NOT NULL,\n  Item bcontractitem NOT NULL,\n  ProjMinPct bpct,\n  ActiveYN byn NOT NULL,\n  Notes varchar,\n  UniqueAttchID uniqueidentifier,\n  KeyID bigint NOT NULL,\n  InsCode binscode,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "To aggregate job cost estimates with unit type distinctions:\n1. Start with JCJP (Job Phase) for phase definitions\n2. Join JCCP (Cost Phase) for estimate and actual amounts\n3. Join JCCH (Cost Header) for ItemUnitFlag/PhaseUnitFlag settings\n4. Join JCCT for cost type descriptions\n5. Use CASE WHEN to label unit types\n\n```sql\nSELECT \n  JCJP.JCCo,\n  JCJP.Job,\n  JCJP.Phase,\n  JCCT.Description AS CostTypeDesc,\n  JCCH.ItemUnitFlag,\n  JCCH.PhaseUnitFlag,\n  CASE WHEN JCCH.ItemUnitFlag = 'Y' THEN 'Item Units'\n       WHEN JCCH.PhaseUnitFlag = 'Y' THEN 'Phase Units'\n       ELSE 'No Units' END AS UnitType,\n  JCCP.OrigEstCost,\n  JCCP.CurrEstCost,\n  JCCP.CurrEstHours,\n  JCCP.ActualCost,\n  JCCP.CurrEstCost - JCCP.ActualCost AS RemainingBudget\nFROM JCJP WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJP.JCCo = JCCP.JCCo \n  AND JCJP.Job = JCCP.Job \n  AND JCJP.PhaseGroup = JCCP.PhaseGroup \n  AND JCJP.Phase = JCCP.Phase\nINNER JOIN JCCH WITH (NOLOCK) ON JCCP.JCCo = JCCH.JCCo \n  AND JCCP.Job = JCCH.Job \n  AND JCCP.PhaseGroup = JCCH.PhaseGroup \n  AND JCCP.Phase = JCCH.Phase \n  AND JCCP.CostType = JCCH.CostType\nINNER JOIN JCCT WITH (NOLOCK) ON JCCP.PhaseGroup = JCCT.PhaseGroup AND JCCP.CostType = JCCT.CostType\nWHERE JCJP.JCCo = @JCCo\n  AND JCJP.Job = @Job\nORDER BY JCJP.Phase, JCCT.CostType\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "advanced",
      "tables_used": [
        "JCJP",
        "JCCH",
        "JCCP",
        "JCCT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: count records in arth by company\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Count ARTH records grouped by company.\n\n```sql\nSELECT Co, COUNT(*) AS RecordCount\nFROM ARTH WITH (NOLOCK)\nGROUP BY Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "basic",
      "tables_used": [
        "ARTH"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Find jobs over budget with remaining cost projection\n\nDatabase Schema:\nCREATE TABLE JCCD (\n  JCCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  CostTrans btrans NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  PostedDate bdate NOT NULL,\n  ActualDate bdate NOT NULL,\n  JCTransType varchar(2) NOT NULL,\n  Source bsource NOT NULL,\n  Description btransdesc,\n  BatchId bbatchid,\n  InUseBatchId bbatchid,\n  GLCo bcompany,\n  GLTransAcct bglacct,\n  GLOffsetAcct bglacct,\n  ReversalStatus tinyint NOT NULL,\n  UM bum,\n  ActualUnitCost bunitcost NOT NULL,\n  -- ... 85 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nCREATE TABLE JCCP (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  CostType bjcctype NOT NULL,\n  Mth bmonth NOT NULL,\n  ActualHours bhrs NOT NULL,\n  ActualUnits bunits NOT NULL,\n  ActualCost bdollar NOT NULL,\n  OrigEstHours bhrs NOT NULL,\n  OrigEstUnits bunits NOT NULL,\n  OrigEstCost bdollar NOT NULL,\n  CurrEstHours bhrs NOT NULL,\n  CurrEstUnits bunits NOT NULL,\n  CurrEstCost bdollar NOT NULL,\n  ProjHours bhrs NOT NULL,\n  ProjUnits bunits NOT NULL,\n  ProjCost bdollar NOT NULL,\n  ForecastHours bhrs NOT NULL,\n  ForecastUnits bunits NOT NULL,\n  -- ... 9 more columns,\n  PRIMARY KEY (JCCo, Mth, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Find jobs over budget:\n1. Aggregate JCCP by job from JCJM\n2. Compare total ActualCost to CurrEstCost\n3. Use HAVING to filter only over-budget jobs\n4. Sort by amount over budget\n\n```sql\nSELECT \n  JCJM.Job,\n  JCJM.Description,\n  SUM(JCCP.CurrEstCost) AS TotalBudget,\n  SUM(JCCP.ActualCost) AS TotalActual,\n  SUM(JCCP.CurrEstCost) - SUM(JCCP.ActualCost) AS RemainingBudget,\n  CASE WHEN SUM(JCCP.CurrEstCost) < SUM(JCCP.ActualCost) \n       THEN 'OVER BUDGET' ELSE 'OK' END AS Status\nFROM JCJM WITH (NOLOCK)\nINNER JOIN JCCP WITH (NOLOCK) ON JCJM.JCCo = JCCP.JCCo AND JCJM.Job = JCCP.Job\nWHERE JCJM.JCCo = @JCCo\nGROUP BY JCJM.Job, JCJM.Description\nHAVING SUM(JCCP.ActualCost) > SUM(JCCP.CurrEstCost)\nORDER BY (SUM(JCCP.ActualCost) - SUM(JCCP.CurrEstCost)) DESC\n```",
    "metadata": {
      "category": "jc_queries",
      "complexity": "basic",
      "tables_used": [
        "JCJM",
        "JCCD",
        "JCCP"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from APInvoice\n\nDatabase Schema:\nCREATE TABLE ARTH (\n  ARCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  ARTrans btrans NOT NULL,\n  ARTransType char(1) NOT NULL,\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer,\n  CustRef varchar(20),\n  CustPO varchar(20),\n  RecType tinyint,\n  JCCo bcompany,\n  Contract bcontract,\n  Invoice varchar(10),\n  CheckNo varchar(10),\n  Source char(10) NOT NULL,\n  MSCo bcompany,\n  TransDate bdate NOT NULL,\n  DueDate bdate,\n  DiscDate bdate,\n  CheckDate bdate,\n  Description bdesc,\n  -- ... 23 more columns,\n  PRIMARY KEY (ARCo, Mth, ARTrans)\n);\n\nCREATE TABLE ARCM (\n  CustGroup bgroup NOT NULL,\n  Customer bcustomer NOT NULL,\n  Name varchar(60),\n  SortName bsortname NOT NULL,\n  TempYN byn NOT NULL,\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Contact varchar(30),\n  ContactExt varchar(10),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  BillAddress varchar(60),\n  BillCity varchar(30),\n  BillState varchar(4),\n  BillZip bzip,\n  -- ... 35 more columns,\n  PRIMARY KEY (KeyID)\n);\n\nCREATE TABLE APTH (\n  APCo bcompany NOT NULL,\n  Mth bmonth NOT NULL,\n  APTrans btrans NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  InvId char(10),\n  APRef bapreference,\n  Description bdesc,\n  InvDate bdate NOT NULL,\n  DiscDate bdate,\n  DueDate bdate NOT NULL,\n  InvTotal bdollar NOT NULL,\n  HoldCode bholdcode,\n  PayControl varchar(10),\n  PayMethod char(1) NOT NULL,\n  CMCo bcompany NOT NULL,\n  CMAcct bcmacct,\n  PrePaidYN byn NOT NULL,\n  PrePaidMth bmonth,\n  PrePaidDate bdate,\n  -- ... 41 more columns,\n  PRIMARY KEY (APCo, Mth, APTrans)\n);\n\nCREATE TABLE APVM (\n  VendorGroup bgroup NOT NULL,\n  Vendor bvendor NOT NULL,\n  SortName bsortname NOT NULL,\n  Name varchar(60),\n  Type char(1) NOT NULL,\n  TempYN byn NOT NULL,\n  Contact varchar(30),\n  Phone bphone,\n  Fax bphone,\n  EMail varchar(255),\n  URL varchar(60),\n  Address varchar(60),\n  City varchar(30),\n  State varchar(4),\n  Zip bzip,\n  Address2 varchar(60),\n  POAddress varchar(60),\n  POCity varchar(30),\n  POState varchar(4),\n  POZip bzip,\n  -- ... 83 more columns,\n  PRIMARY KEY (GLCo, KeyID)\n);\n\nCREATE TABLE JCJM (\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  Description bitemdesc,\n  Contract bcontract,\n  JobStatus tinyint NOT NULL,\n  BidNumber varchar(10),\n  LockPhases byn NOT NULL,\n  ProjectMgr int,\n  JobPhone bphone,\n  JobFax bphone,\n  MailAddress varchar(60),\n  MailCity varchar(30),\n  MailState varchar(4),\n  MailZip bzip,\n  MailAddress2 varchar(60),\n  ShipAddress varchar(60),\n  ShipCity varchar(30),\n  ShipState varchar(4),\n  ShipZip bzip,\n  ShipAddress2 varchar(60),\n  -- ... 64 more columns,\n  PRIMARY KEY (JCCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "I cannot generate this query. The table 'APInvoice' does not exist in Viewpoint Vista.\n\nUse APTH (AP Transaction Header) for AP invoices.\n\nHere's the correct approach:\n\n```sql\nSELECT *\nFROM APTH WITH (NOLOCK)\nWHERE Co = @Co\n```\n\nWould you like me to provide a more specific query for your use case?",
    "metadata": {
      "category": "negative",
      "complexity": "basic",
      "tables_used": []
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Calculate stored materials (Purchased - Installed) for SL billing\n\nDatabase Schema:\nCREATE TABLE SLWI (\n  SLCo bcompany NOT NULL,\n  UserName bvpusername NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Description bitemdesc,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  UM bum NOT NULL,\n  CurUnits bunits NOT NULL,\n  CurUnitCost bunitcost NOT NULL,\n  CurCost bdollar NOT NULL,\n  PrevWCUnits bunits NOT NULL,\n  PrevWCCost bdollar NOT NULL,\n  WCUnits bunits NOT NULL,\n  WCCost bdollar NOT NULL,\n  WCRetPct bpct NOT NULL,\n  WCRetAmt bdollar NOT NULL,\n  PrevSM bdollar NOT NULL,\n  Purchased bdollar NOT NULL,\n  -- ... 17 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nCREATE TABLE SLIT (\n  SLCo bcompany NOT NULL,\n  SL varchar(30),\n  SLItem bitem NOT NULL,\n  ItemType tinyint NOT NULL,\n  Addon tinyint,\n  AddonPct bpct NOT NULL,\n  JCCo bcompany NOT NULL,\n  Job bjob NOT NULL,\n  PhaseGroup bgroup NOT NULL,\n  Phase bphase NOT NULL,\n  JCCType bjcctype NOT NULL,\n  Description bitemdesc,\n  UM bum NOT NULL,\n  GLCo bcompany NOT NULL,\n  GLAcct bglacct NOT NULL,\n  WCRetPct bpct NOT NULL,\n  SMRetPct bpct NOT NULL,\n  VendorGroup bgroup NOT NULL,\n  Supplier bvendor,\n  OrigUnits bunits NOT NULL,\n  -- ... 28 more columns,\n  PRIMARY KEY (SLCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Stored materials for SL billing:\n1. SLWI contains work item/billing details\n2. StoredMatls = Purchased - Installed (materials on-site but not yet used)\n3. WCCost = Work Completed Cost\n4. WCRetAmt and SMRetAmt = separate retainage for work vs materials\n5. Total billable = WCCost + StoredMatls\n\n```sql\nSELECT \n  SLWI.SLCo,\n  SLWI.SL,\n  SLWI.SLItem,\n  SLIT.Description AS ItemDescription,\n  SLWI.StoredMatls,\n  SLWI.WCCost AS WorkCompletedCost,\n  SLWI.StoredMatls + SLWI.WCCost AS TotalBillable,\n  SLWI.WCRetAmt AS WorkRetainage,\n  SLWI.SMRetAmt AS MaterialsRetainage,\n  SLWI.WCRetAmt + SLWI.SMRetAmt AS TotalRetainage\nFROM SLWI WITH (NOLOCK)\nINNER JOIN SLIT WITH (NOLOCK) ON SLWI.SLCo = SLIT.SLCo AND SLWI.SL = SLIT.SL AND SLWI.SLItem = SLIT.SLItem\nWHERE SLWI.SLCo = @SLCo\n  AND SLWI.StoredMatls <> 0\nORDER BY SLWI.SL, SLWI.SLItem\n```",
    "metadata": {
      "category": "sl_queries",
      "complexity": "basic",
      "tables_used": [
        "SLWI",
        "SLIT"
      ]
    }
  },
  {
    "instruction": "Generate a SQL query to answer the following question.\n\nQuestion: Get all records from PRPC\n\nDatabase Schema:\nCREATE TABLE PRPC (\n  PRCo bcompany NOT NULL,\n  PRGroup bgroup NOT NULL,\n  PREndDate bdate NOT NULL,\n  BeginDate bdate NOT NULL,\n  MultiMth byn NOT NULL,\n  BeginMth bmonth NOT NULL,\n  EndMth bmonth,\n  CutoffDate bdate,\n  LimitMth bmonth NOT NULL,\n  Hrs smallint NOT NULL,\n  Days tinyint NOT NULL,\n  Wks tinyint NOT NULL,\n  Status tinyint NOT NULL,\n  DateClosed smalldatetime,\n  JCInterface byn NOT NULL,\n  EMInterface byn NOT NULL,\n  GLInterface byn NOT NULL,\n  APInterface byn NOT NULL,\n  LeaveProcess byn NOT NULL,\n  InUseBy bvpusername,\n  -- ... 7 more columns,\n  PRIMARY KEY (PRCo, KeyID)\n);\n\nProvide:\n1. A brief explanation of the approach\n2. The SQL query\n3. Any important notes about Vista-specific conventions used",
    "input": "",
    "output": "Query all records from PRPC ().\n\n```sql\nSELECT *\nFROM PRPC WITH (NOLOCK)\nWHERE Co = @Co\n```",
    "metadata": {
      "category": "ar_queries",
      "complexity": "intermediate",
      "tables_used": [
        "PRPC"
      ]
    }
  }
]